<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>3 Sampling the Imaginary | Statistical Rethinking Second Edition</title>
  <meta name="description" content="3 Sampling the Imaginary | Statistical Rethinking Second Edition" />
  <meta name="generator" content="bookdown 0.31 and GitBook 2.6.7" />

  <meta property="og:title" content="3 Sampling the Imaginary | Statistical Rethinking Second Edition" />
  <meta property="og:type" content="book" />
  
  
  

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="3 Sampling the Imaginary | Statistical Rethinking Second Edition" />
  
  
  

<meta name="author" content="Tsubasa Yamaguchi" />


<meta name="date" content="2023-02-01" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="small-worlds-and-large-worlds.html"/>
<link rel="next" href="geocentric-model.html"/>
<script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/fuse.js@6.4.6/dist/fuse.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />








<link href="libs/anchor-sections-1.1.0/anchor-sections.css" rel="stylesheet" />
<link href="libs/anchor-sections-1.1.0/anchor-sections-hash.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.1.0/anchor-sections.js"></script>
<script src="libs/htmlwidgets-1.6.1/htmlwidgets.js"></script>
<link href="libs/datatables-css-0.0.0/datatables-crosstalk.css" rel="stylesheet" />
<script src="libs/datatables-binding-0.27/datatables.js"></script>
<link href="libs/dt-core-1.12.1/css/jquery.dataTables.min.css" rel="stylesheet" />
<link href="libs/dt-core-1.12.1/css/jquery.dataTables.extra.css" rel="stylesheet" />
<script src="libs/dt-core-1.12.1/js/jquery.dataTables.min.js"></script>
<link href="libs/crosstalk-1.2.0/css/crosstalk.min.css" rel="stylesheet" />
<script src="libs/crosstalk-1.2.0/js/crosstalk.min.js"></script>
<link href="libs/tabwid-1.1.2/tabwid.css" rel="stylesheet" />
<script src="libs/kePrint-0.0.1/kePrint.js"></script>
<link href="libs/lightable-0.0.1/lightable.css" rel="stylesheet" />


<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { color: #008000; } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { color: #008000; font-weight: bold; } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<style type="text/css">
/* Used with Pandoc 2.11+ new --citeproc when CSL is used */
div.csl-bib-body { }
div.csl-entry {
  clear: both;
}
.hanging div.csl-entry {
  margin-left:2em;
  text-indent:-2em;
}
div.csl-left-margin {
  min-width:2em;
  float:left;
}
div.csl-right-inline {
  margin-left:2em;
  padding-left:1em;
}
div.csl-indent {
  margin-left: 2em;
}
</style>

<link rel="stylesheet" href="custom_style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li class="chapter" data-level="" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i>本稿の目的</a></li>
<li class="chapter" data-level="" data-path="パッケージの読み込み.html"><a href="パッケージの読み込み.html"><i class="fa fa-check"></i>パッケージの読み込み</a></li>
<li class="chapter" data-level="1" data-path="the-golem-of-prague.html"><a href="the-golem-of-prague.html"><i class="fa fa-check"></i><b>1</b> The Golem of Prague 　</a></li>
<li class="chapter" data-level="2" data-path="small-worlds-and-large-worlds.html"><a href="small-worlds-and-large-worlds.html"><i class="fa fa-check"></i><b>2</b> Small Worlds and Large Worlds</a>
<ul>
<li class="chapter" data-level="2.1" data-path="small-worlds-and-large-worlds.html"><a href="small-worlds-and-large-worlds.html#byesian-updating"><i class="fa fa-check"></i><b>2.1</b> Byesian Updating</a></li>
<li class="chapter" data-level="2.2" data-path="small-worlds-and-large-worlds.html"><a href="small-worlds-and-large-worlds.html#making-th-model"><i class="fa fa-check"></i><b>2.2</b> Making th model</a>
<ul>
<li class="chapter" data-level="2.2.1" data-path="small-worlds-and-large-worlds.html"><a href="small-worlds-and-large-worlds.html#grid-approximation"><i class="fa fa-check"></i><b>2.2.1</b> Grid approximation</a></li>
<li class="chapter" data-level="2.2.2" data-path="small-worlds-and-large-worlds.html"><a href="small-worlds-and-large-worlds.html#quadratic-approximation"><i class="fa fa-check"></i><b>2.2.2</b> Quadratic approximation</a></li>
<li class="chapter" data-level="2.2.3" data-path="small-worlds-and-large-worlds.html"><a href="small-worlds-and-large-worlds.html#mcmc"><i class="fa fa-check"></i><b>2.2.3</b> MCMC</a></li>
</ul></li>
<li class="chapter" data-level="2.3" data-path="small-worlds-and-large-worlds.html"><a href="small-worlds-and-large-worlds.html#practice"><i class="fa fa-check"></i><b>2.3</b> Practice</a>
<ul>
<li class="chapter" data-level="2.3.1" data-path="small-worlds-and-large-worlds.html"><a href="small-worlds-and-large-worlds.html#m1"><i class="fa fa-check"></i><b>2.3.1</b> 2M1</a></li>
<li class="chapter" data-level="2.3.2" data-path="small-worlds-and-large-worlds.html"><a href="small-worlds-and-large-worlds.html#m2"><i class="fa fa-check"></i><b>2.3.2</b> 2M2</a></li>
<li class="chapter" data-level="2.3.3" data-path="small-worlds-and-large-worlds.html"><a href="small-worlds-and-large-worlds.html#m3"><i class="fa fa-check"></i><b>2.3.3</b> 2M3</a></li>
<li class="chapter" data-level="2.3.4" data-path="small-worlds-and-large-worlds.html"><a href="small-worlds-and-large-worlds.html#m4"><i class="fa fa-check"></i><b>2.3.4</b> 2M4</a></li>
<li class="chapter" data-level="2.3.5" data-path="small-worlds-and-large-worlds.html"><a href="small-worlds-and-large-worlds.html#m5"><i class="fa fa-check"></i><b>2.3.5</b> 2M5</a></li>
<li class="chapter" data-level="2.3.6" data-path="small-worlds-and-large-worlds.html"><a href="small-worlds-and-large-worlds.html#m7"><i class="fa fa-check"></i><b>2.3.6</b> 2M7</a></li>
<li class="chapter" data-level="2.3.7" data-path="small-worlds-and-large-worlds.html"><a href="small-worlds-and-large-worlds.html#h1"><i class="fa fa-check"></i><b>2.3.7</b> 2H1</a></li>
<li class="chapter" data-level="2.3.8" data-path="small-worlds-and-large-worlds.html"><a href="small-worlds-and-large-worlds.html#h2"><i class="fa fa-check"></i><b>2.3.8</b> 2H2</a></li>
<li class="chapter" data-level="2.3.9" data-path="small-worlds-and-large-worlds.html"><a href="small-worlds-and-large-worlds.html#h3"><i class="fa fa-check"></i><b>2.3.9</b> 2H3</a></li>
<li class="chapter" data-level="2.3.10" data-path="small-worlds-and-large-worlds.html"><a href="small-worlds-and-large-worlds.html#h4"><i class="fa fa-check"></i><b>2.3.10</b> 2H4</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="3" data-path="sampling-the-imaginary.html"><a href="sampling-the-imaginary.html"><i class="fa fa-check"></i><b>3</b> Sampling the Imaginary</a>
<ul>
<li class="chapter" data-level="3.1" data-path="sampling-the-imaginary.html"><a href="sampling-the-imaginary.html#sampling-from-a-grid-aproximate-posterior"><i class="fa fa-check"></i><b>3.1</b> Sampling from a grid-aproximate posterior</a></li>
<li class="chapter" data-level="3.2" data-path="sampling-the-imaginary.html"><a href="sampling-the-imaginary.html#sampling-to-summarize"><i class="fa fa-check"></i><b>3.2</b> Sampling to summarize</a>
<ul>
<li class="chapter" data-level="3.2.1" data-path="sampling-the-imaginary.html"><a href="sampling-the-imaginary.html#intervals-of-defined-mass"><i class="fa fa-check"></i><b>3.2.1</b> Intervals of defined mass</a></li>
<li class="chapter" data-level="3.2.2" data-path="sampling-the-imaginary.html"><a href="sampling-the-imaginary.html#highly-skewed-example"><i class="fa fa-check"></i><b>3.2.2</b> highly skewed example</a></li>
<li class="chapter" data-level="3.2.3" data-path="sampling-the-imaginary.html"><a href="sampling-the-imaginary.html#point-estimate"><i class="fa fa-check"></i><b>3.2.3</b> Point estimate　　</a></li>
</ul></li>
<li class="chapter" data-level="3.3" data-path="sampling-the-imaginary.html"><a href="sampling-the-imaginary.html#sampling-to-simulate-prediction"><i class="fa fa-check"></i><b>3.3</b> Sampling to simulate prediction</a>
<ul>
<li class="chapter" data-level="3.3.1" data-path="sampling-the-imaginary.html"><a href="sampling-the-imaginary.html#model-checking"><i class="fa fa-check"></i><b>3.3.1</b> Model checking</a></li>
<li class="chapter" data-level="3.3.2" data-path="sampling-the-imaginary.html"><a href="sampling-the-imaginary.html#practice-with-brms"><i class="fa fa-check"></i><b>3.3.2</b> Practice with brms</a></li>
</ul></li>
<li class="chapter" data-level="3.4" data-path="sampling-the-imaginary.html"><a href="sampling-the-imaginary.html#practice-1"><i class="fa fa-check"></i><b>3.4</b> Practice</a>
<ul>
<li class="chapter" data-level="3.4.1" data-path="sampling-the-imaginary.html"><a href="sampling-the-imaginary.html#e"><i class="fa fa-check"></i><b>3.4.1</b> 3E</a></li>
<li class="chapter" data-level="3.4.2" data-path="sampling-the-imaginary.html"><a href="sampling-the-imaginary.html#m"><i class="fa fa-check"></i><b>3.4.2</b> 3M</a></li>
<li class="chapter" data-level="3.4.3" data-path="sampling-the-imaginary.html"><a href="sampling-the-imaginary.html#h"><i class="fa fa-check"></i><b>3.4.3</b> 3H</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="4" data-path="geocentric-model.html"><a href="geocentric-model.html"><i class="fa fa-check"></i><b>4</b> Geocentric Model</a>
<ul>
<li class="chapter" data-level="4.1" data-path="geocentric-model.html"><a href="geocentric-model.html#why-normal-distributions-are-normal"><i class="fa fa-check"></i><b>4.1</b> Why normal distributions are normal</a></li>
<li class="chapter" data-level="4.2" data-path="geocentric-model.html"><a href="geocentric-model.html#normal-by-multiplication"><i class="fa fa-check"></i><b>4.2</b> Normal by multiplication</a></li>
<li class="chapter" data-level="4.3" data-path="geocentric-model.html"><a href="geocentric-model.html#gaussian-model-of-height"><i class="fa fa-check"></i><b>4.3</b> Gaussian model of height</a></li>
<li class="chapter" data-level="4.4" data-path="geocentric-model.html"><a href="geocentric-model.html#grid-approximationで事後分布を描く"><i class="fa fa-check"></i><b>4.4</b> Grid approximationで事後分布を描く</a>
<ul>
<li class="chapter" data-level="4.4.1" data-path="geocentric-model.html"><a href="geocentric-model.html#事後分布からサンプリングする"><i class="fa fa-check"></i><b>4.4.1</b> 事後分布からサンプリングする</a></li>
<li class="chapter" data-level="4.4.2" data-path="geocentric-model.html"><a href="geocentric-model.html#rethinking"><i class="fa fa-check"></i><b>4.4.2</b> rethinking</a></li>
<li class="chapter" data-level="4.4.3" data-path="geocentric-model.html"><a href="geocentric-model.html#finding-posterior-with-brms"><i class="fa fa-check"></i><b>4.4.3</b> Finding posterior with brms</a></li>
<li class="chapter" data-level="4.4.4" data-path="geocentric-model.html"><a href="geocentric-model.html#事後分布からのサンプリング"><i class="fa fa-check"></i><b>4.4.4</b> 事後分布からのサンプリング</a></li>
</ul></li>
<li class="chapter" data-level="4.5" data-path="geocentric-model.html"><a href="geocentric-model.html#linear-prediction"><i class="fa fa-check"></i><b>4.5</b> Linear prediction</a>
<ul>
<li class="chapter" data-level="4.5.1" data-path="geocentric-model.html"><a href="geocentric-model.html#finding-the-posterior-distribution"><i class="fa fa-check"></i><b>4.5.1</b> Finding the posterior distribution</a></li>
<li class="chapter" data-level="4.5.2" data-path="geocentric-model.html"><a href="geocentric-model.html#plotting-posterior-inference-agaist-the-data"><i class="fa fa-check"></i><b>4.5.2</b> Plotting posterior inference agaist the data</a></li>
<li class="chapter" data-level="4.5.3" data-path="geocentric-model.html"><a href="geocentric-model.html#plotting-regression-intervals-and-contours"><i class="fa fa-check"></i><b>4.5.3</b> Plotting regression intervals and contours</a></li>
<li class="chapter" data-level="4.5.4" data-path="geocentric-model.html"><a href="geocentric-model.html#prediction-intervals"><i class="fa fa-check"></i><b>4.5.4</b> Prediction intervals</a></li>
</ul></li>
<li class="chapter" data-level="4.6" data-path="geocentric-model.html"><a href="geocentric-model.html#curves-from-lines"><i class="fa fa-check"></i><b>4.6</b> Curves from lines</a>
<ul>
<li class="chapter" data-level="4.6.1" data-path="geocentric-model.html"><a href="geocentric-model.html#polynomial-regression"><i class="fa fa-check"></i><b>4.6.1</b> Polynomial regression</a></li>
<li class="chapter" data-level="4.6.2" data-path="geocentric-model.html"><a href="geocentric-model.html#overthinking"><i class="fa fa-check"></i><b>4.6.2</b> overthinking</a></li>
<li class="chapter" data-level="4.6.3" data-path="geocentric-model.html"><a href="geocentric-model.html#splines"><i class="fa fa-check"></i><b>4.6.3</b> Splines</a></li>
</ul></li>
<li class="chapter" data-level="4.7" data-path="geocentric-model.html"><a href="geocentric-model.html#practice-2"><i class="fa fa-check"></i><b>4.7</b> Practice</a>
<ul>
<li class="chapter" data-level="4.7.1" data-path="geocentric-model.html"><a href="geocentric-model.html#m1-2"><i class="fa fa-check"></i><b>4.7.1</b> 4M1</a></li>
<li class="chapter" data-level="4.7.2" data-path="geocentric-model.html"><a href="geocentric-model.html#m2-2"><i class="fa fa-check"></i><b>4.7.2</b> 4M2</a></li>
<li class="chapter" data-level="4.7.3" data-path="geocentric-model.html"><a href="geocentric-model.html#m4-2"><i class="fa fa-check"></i><b>4.7.3</b> 4M4</a></li>
<li class="chapter" data-level="4.7.4" data-path="geocentric-model.html"><a href="geocentric-model.html#m5-2"><i class="fa fa-check"></i><b>4.7.4</b> 4M5</a></li>
<li class="chapter" data-level="4.7.5" data-path="geocentric-model.html"><a href="geocentric-model.html#m6-1"><i class="fa fa-check"></i><b>4.7.5</b> 4M6</a></li>
<li class="chapter" data-level="4.7.6" data-path="geocentric-model.html"><a href="geocentric-model.html#m7-1"><i class="fa fa-check"></i><b>4.7.6</b> 4M7</a></li>
<li class="chapter" data-level="4.7.7" data-path="geocentric-model.html"><a href="geocentric-model.html#m8"><i class="fa fa-check"></i><b>4.7.7</b> 4M8</a></li>
<li class="chapter" data-level="4.7.8" data-path="geocentric-model.html"><a href="geocentric-model.html#h1-2"><i class="fa fa-check"></i><b>4.7.8</b> 4H1</a></li>
<li class="chapter" data-level="4.7.9" data-path="geocentric-model.html"><a href="geocentric-model.html#h2-2"><i class="fa fa-check"></i><b>4.7.9</b> 4H2</a></li>
<li class="chapter" data-level="4.7.10" data-path="geocentric-model.html"><a href="geocentric-model.html#h3-2"><i class="fa fa-check"></i><b>4.7.10</b> 4H3</a></li>
<li class="chapter" data-level="4.7.11" data-path="geocentric-model.html"><a href="geocentric-model.html#h4-2"><i class="fa fa-check"></i><b>4.7.11</b> 4H4</a></li>
<li class="chapter" data-level="4.7.12" data-path="geocentric-model.html"><a href="geocentric-model.html#h5-1"><i class="fa fa-check"></i><b>4.7.12</b> 4H5</a></li>
<li class="chapter" data-level="4.7.13" data-path="geocentric-model.html"><a href="geocentric-model.html#h6"><i class="fa fa-check"></i><b>4.7.13</b> 4H6</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="5" data-path="the-many-variables-the-spurious-waffles.html"><a href="the-many-variables-the-spurious-waffles.html"><i class="fa fa-check"></i><b>5</b> The many variables &amp; the spurious waffles</a>
<ul>
<li class="chapter" data-level="5.1" data-path="the-many-variables-the-spurious-waffles.html"><a href="the-many-variables-the-spurious-waffles.html#spurious-association"><i class="fa fa-check"></i><b>5.1</b> Spurious association</a>
<ul>
<li class="chapter" data-level="5.1.1" data-path="the-many-variables-the-spurious-waffles.html"><a href="the-many-variables-the-spurious-waffles.html#グラフを用いて因果モデルを考える"><i class="fa fa-check"></i><b>5.1.1</b> グラフを用いて因果モデルを考える</a></li>
<li class="chapter" data-level="5.1.2" data-path="the-many-variables-the-spurious-waffles.html"><a href="the-many-variables-the-spurious-waffles.html#predictor-residual-plots"><i class="fa fa-check"></i><b>5.1.2</b> Predictor residual plots</a></li>
<li class="chapter" data-level="5.1.3" data-path="the-many-variables-the-spurious-waffles.html"><a href="the-many-variables-the-spurious-waffles.html#posterior-prediction-plots"><i class="fa fa-check"></i><b>5.1.3</b> Posterior prediction plots</a></li>
<li class="chapter" data-level="5.1.4" data-path="the-many-variables-the-spurious-waffles.html"><a href="the-many-variables-the-spurious-waffles.html#counterfactual-plot"><i class="fa fa-check"></i><b>5.1.4</b> Counterfactual plot</a></li>
</ul></li>
<li class="chapter" data-level="5.2" data-path="the-many-variables-the-spurious-waffles.html"><a href="the-many-variables-the-spurious-waffles.html#masked-relationship"><i class="fa fa-check"></i><b>5.2</b> Masked relationship</a>
<ul>
<li class="chapter" data-level="5.2.1" data-path="the-many-variables-the-spurious-waffles.html"><a href="the-many-variables-the-spurious-waffles.html#k-nモデル"><i class="fa fa-check"></i><b>5.2.1</b> K ~ Nモデル</a></li>
<li class="chapter" data-level="5.2.2" data-path="the-many-variables-the-spurious-waffles.html"><a href="the-many-variables-the-spurious-waffles.html#k-mモデル"><i class="fa fa-check"></i><b>5.2.2</b> K ~ Mモデル</a></li>
<li class="chapter" data-level="5.2.3" data-path="the-many-variables-the-spurious-waffles.html"><a href="the-many-variables-the-spurious-waffles.html#k-n-mモデル"><i class="fa fa-check"></i><b>5.2.3</b> K ~ N + Mモデル</a></li>
<li class="chapter" data-level="5.2.4" data-path="the-many-variables-the-spurious-waffles.html"><a href="the-many-variables-the-spurious-waffles.html#counterfactual-plot-を描く"><i class="fa fa-check"></i><b>5.2.4</b> Counterfactual plot を描く</a></li>
<li class="chapter" data-level="5.2.5" data-path="the-many-variables-the-spurious-waffles.html"><a href="the-many-variables-the-spurious-waffles.html#overthinking-1"><i class="fa fa-check"></i><b>5.2.5</b> Overthinking</a></li>
</ul></li>
<li class="chapter" data-level="5.3" data-path="the-many-variables-the-spurious-waffles.html"><a href="the-many-variables-the-spurious-waffles.html#categorical-variables"><i class="fa fa-check"></i><b>5.3</b> Categorical variables</a>
<ul>
<li class="chapter" data-level="5.3.1" data-path="the-many-variables-the-spurious-waffles.html"><a href="the-many-variables-the-spurious-waffles.html#two-categories"><i class="fa fa-check"></i><b>5.3.1</b> Two categories</a></li>
<li class="chapter" data-level="5.3.2" data-path="the-many-variables-the-spurious-waffles.html"><a href="the-many-variables-the-spurious-waffles.html#many-categories"><i class="fa fa-check"></i><b>5.3.2</b> Many Categories</a></li>
</ul></li>
<li class="chapter" data-level="5.4" data-path="the-many-variables-the-spurious-waffles.html"><a href="the-many-variables-the-spurious-waffles.html#practice-3"><i class="fa fa-check"></i><b>5.4</b> Practice</a>
<ul>
<li class="chapter" data-level="5.4.1" data-path="the-many-variables-the-spurious-waffles.html"><a href="the-many-variables-the-spurious-waffles.html#m1-3"><i class="fa fa-check"></i><b>5.4.1</b> 5M1</a></li>
<li class="chapter" data-level="5.4.2" data-path="the-many-variables-the-spurious-waffles.html"><a href="the-many-variables-the-spurious-waffles.html#m2-3"><i class="fa fa-check"></i><b>5.4.2</b> 5M2</a></li>
<li class="chapter" data-level="5.4.3" data-path="the-many-variables-the-spurious-waffles.html"><a href="the-many-variables-the-spurious-waffles.html#m4-3"><i class="fa fa-check"></i><b>5.4.3</b> 5M4</a></li>
<li class="chapter" data-level="5.4.4" data-path="the-many-variables-the-spurious-waffles.html"><a href="the-many-variables-the-spurious-waffles.html#h1-3"><i class="fa fa-check"></i><b>5.4.4</b> 5H1</a></li>
<li class="chapter" data-level="5.4.5" data-path="the-many-variables-the-spurious-waffles.html"><a href="the-many-variables-the-spurious-waffles.html#h2-3"><i class="fa fa-check"></i><b>5.4.5</b> 5H2</a></li>
<li class="chapter" data-level="5.4.6" data-path="the-many-variables-the-spurious-waffles.html"><a href="the-many-variables-the-spurious-waffles.html#h3-3"><i class="fa fa-check"></i><b>5.4.6</b> 5H3</a></li>
<li class="chapter" data-level="5.4.7" data-path="the-many-variables-the-spurious-waffles.html"><a href="the-many-variables-the-spurious-waffles.html#h4-3"><i class="fa fa-check"></i><b>5.4.7</b> 5H4</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="6" data-path="the-haunted-dag-the-causal-terror.html"><a href="the-haunted-dag-the-causal-terror.html"><i class="fa fa-check"></i><b>6</b> The Haunted DAG &amp; the Causal Terror</a>
<ul>
<li class="chapter" data-level="6.1" data-path="the-haunted-dag-the-causal-terror.html"><a href="the-haunted-dag-the-causal-terror.html#multicollinearity"><i class="fa fa-check"></i><b>6.1</b> Multicollinearity</a>
<ul>
<li class="chapter" data-level="6.1.1" data-path="the-haunted-dag-the-causal-terror.html"><a href="the-haunted-dag-the-causal-terror.html#multicollinear-milk"><i class="fa fa-check"></i><b>6.1.1</b> Multicollinear milk</a></li>
</ul></li>
<li class="chapter" data-level="6.2" data-path="the-haunted-dag-the-causal-terror.html"><a href="the-haunted-dag-the-causal-terror.html#post-treatment-bias"><i class="fa fa-check"></i><b>6.2</b> Post-treatment bias</a>
<ul>
<li class="chapter" data-level="6.2.1" data-path="the-haunted-dag-the-causal-terror.html"><a href="the-haunted-dag-the-causal-terror.html#blocked-by-consequence"><i class="fa fa-check"></i><b>6.2.1</b> Blocked by consequence</a></li>
<li class="chapter" data-level="6.2.2" data-path="the-haunted-dag-the-causal-terror.html"><a href="the-haunted-dag-the-causal-terror.html#fungus-and-d-separation"><i class="fa fa-check"></i><b>6.2.2</b> Fungus and d-separation</a></li>
</ul></li>
<li class="chapter" data-level="6.3" data-path="the-haunted-dag-the-causal-terror.html"><a href="the-haunted-dag-the-causal-terror.html#collider-bias"><i class="fa fa-check"></i><b>6.3</b> Collider bias</a>
<ul>
<li class="chapter" data-level="6.3.1" data-path="the-haunted-dag-the-causal-terror.html"><a href="the-haunted-dag-the-causal-terror.html#collider-of-false-sorrow"><i class="fa fa-check"></i><b>6.3.1</b> Collider of false sorrow</a></li>
<li class="chapter" data-level="6.3.2" data-path="the-haunted-dag-the-causal-terror.html"><a href="the-haunted-dag-the-causal-terror.html#the-haunted-dag"><i class="fa fa-check"></i><b>6.3.2</b> The haunted DAG</a></li>
</ul></li>
<li class="chapter" data-level="6.4" data-path="the-haunted-dag-the-causal-terror.html"><a href="the-haunted-dag-the-causal-terror.html#confronting-confoundings"><i class="fa fa-check"></i><b>6.4</b> Confronting confoundings</a>
<ul>
<li class="chapter" data-level="6.4.1" data-path="the-haunted-dag-the-causal-terror.html"><a href="the-haunted-dag-the-causal-terror.html#two-roads"><i class="fa fa-check"></i><b>6.4.1</b> Two roads</a></li>
<li class="chapter" data-level="6.4.2" data-path="the-haunted-dag-the-causal-terror.html"><a href="the-haunted-dag-the-causal-terror.html#backdoor-waffles"><i class="fa fa-check"></i><b>6.4.2</b> Backdoor Waffles</a></li>
</ul></li>
<li class="chapter" data-level="6.5" data-path="the-haunted-dag-the-causal-terror.html"><a href="the-haunted-dag-the-causal-terror.html#practice-4"><i class="fa fa-check"></i><b>6.5</b> Practice</a>
<ul>
<li class="chapter" data-level="6.5.1" data-path="the-haunted-dag-the-causal-terror.html"><a href="the-haunted-dag-the-causal-terror.html#m1-4"><i class="fa fa-check"></i><b>6.5.1</b> 6M1</a></li>
<li class="chapter" data-level="6.5.2" data-path="the-haunted-dag-the-causal-terror.html"><a href="the-haunted-dag-the-causal-terror.html#m2-4"><i class="fa fa-check"></i><b>6.5.2</b> 6M2</a></li>
<li class="chapter" data-level="6.5.3" data-path="the-haunted-dag-the-causal-terror.html"><a href="the-haunted-dag-the-causal-terror.html#h1-4"><i class="fa fa-check"></i><b>6.5.3</b> 6H1</a></li>
<li class="chapter" data-level="6.5.4" data-path="the-haunted-dag-the-causal-terror.html"><a href="the-haunted-dag-the-causal-terror.html#h2-4"><i class="fa fa-check"></i><b>6.5.4</b> 6H2</a></li>
<li class="chapter" data-level="6.5.5" data-path="the-haunted-dag-the-causal-terror.html"><a href="the-haunted-dag-the-causal-terror.html#h3-4"><i class="fa fa-check"></i><b>6.5.5</b> 6H3</a></li>
<li class="chapter" data-level="6.5.6" data-path="the-haunted-dag-the-causal-terror.html"><a href="the-haunted-dag-the-causal-terror.html#h4-4"><i class="fa fa-check"></i><b>6.5.6</b> 6H4</a></li>
<li class="chapter" data-level="6.5.7" data-path="the-haunted-dag-the-causal-terror.html"><a href="the-haunted-dag-the-causal-terror.html#h5-2"><i class="fa fa-check"></i><b>6.5.7</b> 6H5</a></li>
</ul></li>
<li class="chapter" data-level="6.6" data-path="the-haunted-dag-the-causal-terror.html"><a href="the-haunted-dag-the-causal-terror.html#おまけ-ランダム効果を入れてみる"><i class="fa fa-check"></i><b>6.6</b> おまけ　ランダム効果を入れてみる</a></li>
</ul></li>
<li class="chapter" data-level="7" data-path="ulysses-compass.html"><a href="ulysses-compass.html"><i class="fa fa-check"></i><b>7</b> Ulysses’ Compass</a>
<ul>
<li class="chapter" data-level="7.1" data-path="ulysses-compass.html"><a href="ulysses-compass.html#the-problems-with-parameters"><i class="fa fa-check"></i><b>7.1</b> The problems with parameters</a>
<ul>
<li class="chapter" data-level="7.1.1" data-path="ulysses-compass.html"><a href="ulysses-compass.html#more-parameters-always-improve-fit"><i class="fa fa-check"></i><b>7.1.1</b> More parameters always improve fit</a></li>
<li class="chapter" data-level="7.1.2" data-path="ulysses-compass.html"><a href="ulysses-compass.html#too-few-parameters-hurts-too"><i class="fa fa-check"></i><b>7.1.2</b> Too few parameters hurts too</a></li>
</ul></li>
<li class="chapter" data-level="7.2" data-path="ulysses-compass.html"><a href="ulysses-compass.html#entropy-and-accuracy"><i class="fa fa-check"></i><b>7.2</b> Entropy and accuracy</a>
<ul>
<li class="chapter" data-level="7.2.1" data-path="ulysses-compass.html"><a href="ulysses-compass.html#information-and-uncertainty"><i class="fa fa-check"></i><b>7.2.1</b> Information and uncertainty</a></li>
<li class="chapter" data-level="7.2.2" data-path="ulysses-compass.html"><a href="ulysses-compass.html#from-entropy-to-acculacy"><i class="fa fa-check"></i><b>7.2.2</b> From entropy to acculacy</a></li>
<li class="chapter" data-level="7.2.3" data-path="ulysses-compass.html"><a href="ulysses-compass.html#estimating-divergence"><i class="fa fa-check"></i><b>7.2.3</b> Estimating divergence</a></li>
<li class="chapter" data-level="7.2.4" data-path="ulysses-compass.html"><a href="ulysses-compass.html#scoring-the-right-data"><i class="fa fa-check"></i><b>7.2.4</b> Scoring the right data</a></li>
</ul></li>
<li class="chapter" data-level="7.3" data-path="ulysses-compass.html"><a href="ulysses-compass.html#golem-taming-regularization"><i class="fa fa-check"></i><b>7.3</b> Golem taming: regularization</a></li>
<li class="chapter" data-level="7.4" data-path="ulysses-compass.html"><a href="ulysses-compass.html#predicting-predictive-accuracy"><i class="fa fa-check"></i><b>7.4</b> Predicting predictive accuracy</a>
<ul>
<li class="chapter" data-level="7.4.1" data-path="ulysses-compass.html"><a href="ulysses-compass.html#cross-validation"><i class="fa fa-check"></i><b>7.4.1</b> Cross validation</a></li>
<li class="chapter" data-level="7.4.2" data-path="ulysses-compass.html"><a href="ulysses-compass.html#information-criteria"><i class="fa fa-check"></i><b>7.4.2</b> Information criteria</a></li>
<li class="chapter" data-level="7.4.3" data-path="ulysses-compass.html"><a href="ulysses-compass.html#overthinking-waic-calculation"><i class="fa fa-check"></i><b>7.4.3</b> overthinking: WAIC calculation</a></li>
<li class="chapter" data-level="7.4.4" data-path="ulysses-compass.html"><a href="ulysses-compass.html#comparing-cv-psis-and-waic"><i class="fa fa-check"></i><b>7.4.4</b> Comparing CV, PSIS, and WAIC</a></li>
</ul></li>
<li class="chapter" data-level="7.5" data-path="ulysses-compass.html"><a href="ulysses-compass.html#model-comparison"><i class="fa fa-check"></i><b>7.5</b> Model comparison</a>
<ul>
<li class="chapter" data-level="7.5.1" data-path="ulysses-compass.html"><a href="ulysses-compass.html#model-mis-selection"><i class="fa fa-check"></i><b>7.5.1</b> Model mis-selection</a></li>
<li class="chapter" data-level="7.5.2" data-path="ulysses-compass.html"><a href="ulysses-compass.html#outlier-and-other-illusions"><i class="fa fa-check"></i><b>7.5.2</b> Outlier and other illusions</a></li>
</ul></li>
<li class="chapter" data-level="7.6" data-path="ulysses-compass.html"><a href="ulysses-compass.html#practice-5"><i class="fa fa-check"></i><b>7.6</b> Practice</a>
<ul>
<li class="chapter" data-level="7.6.1" data-path="ulysses-compass.html"><a href="ulysses-compass.html#e2"><i class="fa fa-check"></i><b>7.6.1</b> 7E2</a></li>
<li class="chapter" data-level="7.6.2" data-path="ulysses-compass.html"><a href="ulysses-compass.html#e3"><i class="fa fa-check"></i><b>7.6.2</b> 7E3</a></li>
<li class="chapter" data-level="7.6.3" data-path="ulysses-compass.html"><a href="ulysses-compass.html#e4"><i class="fa fa-check"></i><b>7.6.3</b> 7E4</a></li>
<li class="chapter" data-level="7.6.4" data-path="ulysses-compass.html"><a href="ulysses-compass.html#m4-4"><i class="fa fa-check"></i><b>7.6.4</b> 7M4</a></li>
<li class="chapter" data-level="7.6.5" data-path="ulysses-compass.html"><a href="ulysses-compass.html#h1-5"><i class="fa fa-check"></i><b>7.6.5</b> 7H1</a></li>
<li class="chapter" data-level="7.6.6" data-path="ulysses-compass.html"><a href="ulysses-compass.html#h2-5"><i class="fa fa-check"></i><b>7.6.6</b> 7H2</a></li>
<li class="chapter" data-level="7.6.7" data-path="ulysses-compass.html"><a href="ulysses-compass.html#h3-5"><i class="fa fa-check"></i><b>7.6.7</b> 7H3</a></li>
<li class="chapter" data-level="7.6.8" data-path="ulysses-compass.html"><a href="ulysses-compass.html#h4-5"><i class="fa fa-check"></i><b>7.6.8</b> 7H4</a></li>
<li class="chapter" data-level="7.6.9" data-path="ulysses-compass.html"><a href="ulysses-compass.html#h5-3"><i class="fa fa-check"></i><b>7.6.9</b> 7H5</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="8" data-path="conditional-manatees.html"><a href="conditional-manatees.html"><i class="fa fa-check"></i><b>8</b> Conditional Manatees</a>
<ul>
<li class="chapter" data-level="8.1" data-path="conditional-manatees.html"><a href="conditional-manatees.html#building-an-interaction"><i class="fa fa-check"></i><b>8.1</b> Building an interaction</a>
<ul>
<li class="chapter" data-level="8.1.1" data-path="conditional-manatees.html"><a href="conditional-manatees.html#making-a-rugged-model"><i class="fa fa-check"></i><b>8.1.1</b> Making a rugged model</a></li>
<li class="chapter" data-level="8.1.2" data-path="conditional-manatees.html"><a href="conditional-manatees.html#adding-an-indicator-variable-isnt-enough"><i class="fa fa-check"></i><b>8.1.2</b> Adding an indicator variable isn’t enough</a></li>
<li class="chapter" data-level="8.1.3" data-path="conditional-manatees.html"><a href="conditional-manatees.html#adding-interaction-does-work"><i class="fa fa-check"></i><b>8.1.3</b> Adding interaction does work</a></li>
<li class="chapter" data-level="8.1.4" data-path="conditional-manatees.html"><a href="conditional-manatees.html#plotting-the-interaction"><i class="fa fa-check"></i><b>8.1.4</b> Plotting the interaction</a></li>
</ul></li>
<li class="chapter" data-level="8.2" data-path="conditional-manatees.html"><a href="conditional-manatees.html#symmetry-of-interaction"><i class="fa fa-check"></i><b>8.2</b> Symmetry of interaction</a></li>
<li class="chapter" data-level="8.3" data-path="conditional-manatees.html"><a href="conditional-manatees.html#continuous-interaction"><i class="fa fa-check"></i><b>8.3</b> Continuous interaction</a>
<ul>
<li class="chapter" data-level="8.3.1" data-path="conditional-manatees.html"><a href="conditional-manatees.html#a-winter-flower"><i class="fa fa-check"></i><b>8.3.1</b> A winter flower</a></li>
<li class="chapter" data-level="8.3.2" data-path="conditional-manatees.html"><a href="conditional-manatees.html#the-models"><i class="fa fa-check"></i><b>8.3.2</b> The models</a></li>
<li class="chapter" data-level="8.3.3" data-path="conditional-manatees.html"><a href="conditional-manatees.html#plotting-posterior-predictions"><i class="fa fa-check"></i><b>8.3.3</b> Plotting posterior predictions</a></li>
<li class="chapter" data-level="8.3.4" data-path="conditional-manatees.html"><a href="conditional-manatees.html#plotting-prior-predictions"><i class="fa fa-check"></i><b>8.3.4</b> Plotting prior predictions</a></li>
</ul></li>
<li class="chapter" data-level="8.4" data-path="conditional-manatees.html"><a href="conditional-manatees.html#practice-6"><i class="fa fa-check"></i><b>8.4</b> Practice</a>
<ul>
<li class="chapter" data-level="8.4.1" data-path="conditional-manatees.html"><a href="conditional-manatees.html#m4-5"><i class="fa fa-check"></i><b>8.4.1</b> 8M4</a></li>
<li class="chapter" data-level="8.4.2" data-path="conditional-manatees.html"><a href="conditional-manatees.html#h1-6"><i class="fa fa-check"></i><b>8.4.2</b> 8H1</a></li>
<li class="chapter" data-level="8.4.3" data-path="conditional-manatees.html"><a href="conditional-manatees.html#h2-6"><i class="fa fa-check"></i><b>8.4.3</b> 8H2</a></li>
<li class="chapter" data-level="8.4.4" data-path="conditional-manatees.html"><a href="conditional-manatees.html#h3-6"><i class="fa fa-check"></i><b>8.4.4</b> 8H3</a></li>
<li class="chapter" data-level="8.4.5" data-path="conditional-manatees.html"><a href="conditional-manatees.html#h4-6"><i class="fa fa-check"></i><b>8.4.5</b> 8H4</a></li>
<li class="chapter" data-level="8.4.6" data-path="conditional-manatees.html"><a href="conditional-manatees.html#h5-4"><i class="fa fa-check"></i><b>8.4.6</b> 8H5</a></li>
<li class="chapter" data-level="8.4.7" data-path="conditional-manatees.html"><a href="conditional-manatees.html#h6-1"><i class="fa fa-check"></i><b>8.4.7</b> 8H6</a></li>
<li class="chapter" data-level="8.4.8" data-path="conditional-manatees.html"><a href="conditional-manatees.html#h7"><i class="fa fa-check"></i><b>8.4.8</b> 8H7</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="9" data-path="marcov-chain-monte-carlo.html"><a href="marcov-chain-monte-carlo.html"><i class="fa fa-check"></i><b>9</b> Marcov Chain Monte Carlo</a>
<ul>
<li class="chapter" data-level="9.1" data-path="marcov-chain-monte-carlo.html"><a href="marcov-chain-monte-carlo.html#good-king-marcov-and-his-island-kingdom"><i class="fa fa-check"></i><b>9.1</b> Good King Marcov and his island kingdom</a></li>
<li class="chapter" data-level="9.2" data-path="marcov-chain-monte-carlo.html"><a href="marcov-chain-monte-carlo.html#metropolis-algorythm"><i class="fa fa-check"></i><b>9.2</b> Metropolis algorythm</a>
<ul>
<li class="chapter" data-level="9.2.1" data-path="marcov-chain-monte-carlo.html"><a href="marcov-chain-monte-carlo.html#gibbs-sampling"><i class="fa fa-check"></i><b>9.2.1</b> Gibbs sampling</a></li>
<li class="chapter" data-level="9.2.2" data-path="marcov-chain-monte-carlo.html"><a href="marcov-chain-monte-carlo.html#high-dimentional-problem"><i class="fa fa-check"></i><b>9.2.2</b> High-dimentional problem</a></li>
</ul></li>
<li class="chapter" data-level="9.3" data-path="marcov-chain-monte-carlo.html"><a href="marcov-chain-monte-carlo.html#hamiltonian-monte-carlo"><i class="fa fa-check"></i><b>9.3</b> Hamiltonian Monte Carlo</a>
<ul>
<li class="chapter" data-level="9.3.1" data-path="marcov-chain-monte-carlo.html"><a href="marcov-chain-monte-carlo.html#another-probable"><i class="fa fa-check"></i><b>9.3.1</b> Another probable</a></li>
<li class="chapter" data-level="9.3.2" data-path="marcov-chain-monte-carlo.html"><a href="marcov-chain-monte-carlo.html#limitations"><i class="fa fa-check"></i><b>9.3.2</b> Limitations</a></li>
</ul></li>
<li class="chapter" data-level="9.4" data-path="marcov-chain-monte-carlo.html"><a href="marcov-chain-monte-carlo.html#easy-hmc-ulam-brm"><i class="fa fa-check"></i><b>9.4</b> Easy HMC: <del>ulam</del> <code>brm()</code></a>
<ul>
<li class="chapter" data-level="9.4.1" data-path="marcov-chain-monte-carlo.html"><a href="marcov-chain-monte-carlo.html#preparation"><i class="fa fa-check"></i><b>9.4.1</b> Preparation</a></li>
<li class="chapter" data-level="9.4.2" data-path="marcov-chain-monte-carlo.html"><a href="marcov-chain-monte-carlo.html#sampling-from-posterior"><i class="fa fa-check"></i><b>9.4.2</b> Sampling from posterior</a></li>
<li class="chapter" data-level="9.4.3" data-path="marcov-chain-monte-carlo.html"><a href="marcov-chain-monte-carlo.html#sampling-again-in-parallel"><i class="fa fa-check"></i><b>9.4.3</b> Sampling again in parallel</a></li>
<li class="chapter" data-level="9.4.4" data-path="marcov-chain-monte-carlo.html"><a href="marcov-chain-monte-carlo.html#visualization"><i class="fa fa-check"></i><b>9.4.4</b> Visualization</a></li>
<li class="chapter" data-level="9.4.5" data-path="marcov-chain-monte-carlo.html"><a href="marcov-chain-monte-carlo.html#checking-the-chain"><i class="fa fa-check"></i><b>9.4.5</b> Checking the chain</a></li>
</ul></li>
<li class="chapter" data-level="9.5" data-path="marcov-chain-monte-carlo.html"><a href="marcov-chain-monte-carlo.html#care-and-feeding-of-your-marcov-chain"><i class="fa fa-check"></i><b>9.5</b> Care and feeding of your Marcov chain</a>
<ul>
<li class="chapter" data-level="9.5.1" data-path="marcov-chain-monte-carlo.html"><a href="marcov-chain-monte-carlo.html#how-many-samples-do-you-need"><i class="fa fa-check"></i><b>9.5.1</b> How many samples do you need</a></li>
<li class="chapter" data-level="9.5.2" data-path="marcov-chain-monte-carlo.html"><a href="marcov-chain-monte-carlo.html#how-many-chains-do-we-need"><i class="fa fa-check"></i><b>9.5.2</b> How many chains do we need</a></li>
<li class="chapter" data-level="9.5.3" data-path="marcov-chain-monte-carlo.html"><a href="marcov-chain-monte-carlo.html#taming-and-wild-chain"><i class="fa fa-check"></i><b>9.5.3</b> Taming and wild chain</a></li>
<li class="chapter" data-level="9.5.4" data-path="marcov-chain-monte-carlo.html"><a href="marcov-chain-monte-carlo.html#non-identifiable-parameters"><i class="fa fa-check"></i><b>9.5.4</b> Non-identifiable parameters</a></li>
</ul></li>
<li class="chapter" data-level="9.6" data-path="marcov-chain-monte-carlo.html"><a href="marcov-chain-monte-carlo.html#practice-7"><i class="fa fa-check"></i><b>9.6</b> Practice</a>
<ul>
<li class="chapter" data-level="9.6.1" data-path="marcov-chain-monte-carlo.html"><a href="marcov-chain-monte-carlo.html#m1-5"><i class="fa fa-check"></i><b>9.6.1</b> 9M1</a></li>
<li class="chapter" data-level="9.6.2" data-path="marcov-chain-monte-carlo.html"><a href="marcov-chain-monte-carlo.html#m2-5"><i class="fa fa-check"></i><b>9.6.2</b> 9M2</a></li>
<li class="chapter" data-level="9.6.3" data-path="marcov-chain-monte-carlo.html"><a href="marcov-chain-monte-carlo.html#m3-2"><i class="fa fa-check"></i><b>9.6.3</b> 9M3</a></li>
<li class="chapter" data-level="9.6.4" data-path="marcov-chain-monte-carlo.html"><a href="marcov-chain-monte-carlo.html#h1-7"><i class="fa fa-check"></i><b>9.6.4</b> 9H1</a></li>
<li class="chapter" data-level="9.6.5" data-path="marcov-chain-monte-carlo.html"><a href="marcov-chain-monte-carlo.html#h2-7"><i class="fa fa-check"></i><b>9.6.5</b> 9H2</a></li>
<li class="chapter" data-level="9.6.6" data-path="marcov-chain-monte-carlo.html"><a href="marcov-chain-monte-carlo.html#h3-7"><i class="fa fa-check"></i><b>9.6.6</b> 9H3</a></li>
<li class="chapter" data-level="9.6.7" data-path="marcov-chain-monte-carlo.html"><a href="marcov-chain-monte-carlo.html#h4-7"><i class="fa fa-check"></i><b>9.6.7</b> 9H4</a></li>
<li class="chapter" data-level="9.6.8" data-path="marcov-chain-monte-carlo.html"><a href="marcov-chain-monte-carlo.html#h5-5"><i class="fa fa-check"></i><b>9.6.8</b> 9H5</a></li>
<li class="chapter" data-level="9.6.9" data-path="marcov-chain-monte-carlo.html"><a href="marcov-chain-monte-carlo.html#h6-2"><i class="fa fa-check"></i><b>9.6.9</b> 9H6</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="10" data-path="big-entropy-and-the-generalized-linear-model.html"><a href="big-entropy-and-the-generalized-linear-model.html"><i class="fa fa-check"></i><b>10</b> Big Entropy and the Generalized Linear Model</a>
<ul>
<li class="chapter" data-level="10.1" data-path="big-entropy-and-the-generalized-linear-model.html"><a href="big-entropy-and-the-generalized-linear-model.html#maximum-entropy"><i class="fa fa-check"></i><b>10.1</b> Maximum entropy</a>
<ul>
<li class="chapter" data-level="10.1.1" data-path="big-entropy-and-the-generalized-linear-model.html"><a href="big-entropy-and-the-generalized-linear-model.html#gaussian"><i class="fa fa-check"></i><b>10.1.1</b> Gaussian</a></li>
<li class="chapter" data-level="10.1.2" data-path="big-entropy-and-the-generalized-linear-model.html"><a href="big-entropy-and-the-generalized-linear-model.html#binomial"><i class="fa fa-check"></i><b>10.1.2</b> Binomial</a></li>
</ul></li>
<li class="chapter" data-level="10.2" data-path="big-entropy-and-the-generalized-linear-model.html"><a href="big-entropy-and-the-generalized-linear-model.html#generalized-linear-models"><i class="fa fa-check"></i><b>10.2</b> Generalized linear models</a>
<ul>
<li class="chapter" data-level="10.2.1" data-path="big-entropy-and-the-generalized-linear-model.html"><a href="big-entropy-and-the-generalized-linear-model.html#meet-the-family"><i class="fa fa-check"></i><b>10.2.1</b> Meet the family</a></li>
<li class="chapter" data-level="10.2.2" data-path="big-entropy-and-the-generalized-linear-model.html"><a href="big-entropy-and-the-generalized-linear-model.html#linking-linear-models-to-distributions"><i class="fa fa-check"></i><b>10.2.2</b> Linking linear models to distributions</a></li>
<li class="chapter" data-level="10.2.3" data-path="big-entropy-and-the-generalized-linear-model.html"><a href="big-entropy-and-the-generalized-linear-model.html#overthinking-2"><i class="fa fa-check"></i><b>10.2.3</b> Overthinking</a></li>
<li class="chapter" data-level="10.2.4" data-path="big-entropy-and-the-generalized-linear-model.html"><a href="big-entropy-and-the-generalized-linear-model.html#omitted-variable-bias-again"><i class="fa fa-check"></i><b>10.2.4</b> Omitted variable bias again</a></li>
<li class="chapter" data-level="10.2.5" data-path="big-entropy-and-the-generalized-linear-model.html"><a href="big-entropy-and-the-generalized-linear-model.html#absolute-and-relative-differences"><i class="fa fa-check"></i><b>10.2.5</b> Absolute and relative differences</a></li>
<li class="chapter" data-level="10.2.6" data-path="big-entropy-and-the-generalized-linear-model.html"><a href="big-entropy-and-the-generalized-linear-model.html#glms-and-information-criteria"><i class="fa fa-check"></i><b>10.2.6</b> GLMs and information criteria</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="11" data-path="god-spiked-the-integers.html"><a href="god-spiked-the-integers.html"><i class="fa fa-check"></i><b>11</b> God Spiked the Integers</a>
<ul>
<li class="chapter" data-level="11.1" data-path="god-spiked-the-integers.html"><a href="god-spiked-the-integers.html#binomial-regression"><i class="fa fa-check"></i><b>11.1</b> Binomial regression</a>
<ul>
<li class="chapter" data-level="11.1.1" data-path="god-spiked-the-integers.html"><a href="god-spiked-the-integers.html#logistic-regression"><i class="fa fa-check"></i><b>11.1.1</b> Logistic regression</a></li>
<li class="chapter" data-level="11.1.2" data-path="god-spiked-the-integers.html"><a href="god-spiked-the-integers.html#relative-shark-and-absolute-deer"><i class="fa fa-check"></i><b>11.1.2</b> Relative shark and absolute deer</a></li>
<li class="chapter" data-level="11.1.3" data-path="god-spiked-the-integers.html"><a href="god-spiked-the-integers.html#aggregated-binomial-chimpanzees-again-condensed"><i class="fa fa-check"></i><b>11.1.3</b> Aggregated binomial: Chimpanzees again, condensed</a></li>
</ul></li>
<li class="chapter" data-level="11.2" data-path="god-spiked-the-integers.html"><a href="god-spiked-the-integers.html#aggregated-binomial-graduate-school-admittions."><i class="fa fa-check"></i><b>11.2</b> Aggregated binomial: Graduate school admittions.</a></li>
<li class="chapter" data-level="11.3" data-path="god-spiked-the-integers.html"><a href="god-spiked-the-integers.html#poisson-regression"><i class="fa fa-check"></i><b>11.3</b> Poisson regression</a>
<ul>
<li class="chapter" data-level="11.3.1" data-path="god-spiked-the-integers.html"><a href="god-spiked-the-integers.html#oceanic-tool-complexity"><i class="fa fa-check"></i><b>11.3.1</b> Oceanic tool complexity</a></li>
<li class="chapter" data-level="11.3.2" data-path="god-spiked-the-integers.html"><a href="god-spiked-the-integers.html#negative-binomial-gamma-poisson-models."><i class="fa fa-check"></i><b>11.3.2</b> Negative binomial (Gamma-Poisson) models.</a></li>
<li class="chapter" data-level="11.3.3" data-path="god-spiked-the-integers.html"><a href="god-spiked-the-integers.html#example-exposure-and-the-offset"><i class="fa fa-check"></i><b>11.3.3</b> Example: Exposure and the offset</a></li>
</ul></li>
<li class="chapter" data-level="11.4" data-path="god-spiked-the-integers.html"><a href="god-spiked-the-integers.html#multinomial-and-categorical-models"><i class="fa fa-check"></i><b>11.4</b> Multinomial and categorical models</a>
<ul>
<li class="chapter" data-level="11.4.1" data-path="god-spiked-the-integers.html"><a href="god-spiked-the-integers.html#predictors-matched-to-outcomes"><i class="fa fa-check"></i><b>11.4.1</b> Predictors matched to outcomes</a></li>
<li class="chapter" data-level="11.4.2" data-path="god-spiked-the-integers.html"><a href="god-spiked-the-integers.html#predictor-matched-to-observations"><i class="fa fa-check"></i><b>11.4.2</b> Predictor matched to observations</a></li>
<li class="chapter" data-level="11.4.3" data-path="god-spiked-the-integers.html"><a href="god-spiked-the-integers.html#multinomial-in-disguise-as-poisson"><i class="fa fa-check"></i><b>11.4.3</b> Multinomial in disguise as Poisson</a></li>
</ul></li>
<li class="chapter" data-level="11.5" data-path="god-spiked-the-integers.html"><a href="god-spiked-the-integers.html#practice-8"><i class="fa fa-check"></i><b>11.5</b> Practice</a>
<ul>
<li class="chapter" data-level="11.5.1" data-path="god-spiked-the-integers.html"><a href="god-spiked-the-integers.html#e1"><i class="fa fa-check"></i><b>11.5.1</b> 11E1</a></li>
<li class="chapter" data-level="11.5.2" data-path="god-spiked-the-integers.html"><a href="god-spiked-the-integers.html#e2-1"><i class="fa fa-check"></i><b>11.5.2</b> 11E2</a></li>
<li class="chapter" data-level="11.5.3" data-path="god-spiked-the-integers.html"><a href="god-spiked-the-integers.html#e3-1"><i class="fa fa-check"></i><b>11.5.3</b> 11E3</a></li>
<li class="chapter" data-level="11.5.4" data-path="god-spiked-the-integers.html"><a href="god-spiked-the-integers.html#e4-1"><i class="fa fa-check"></i><b>11.5.4</b> 11E4</a></li>
<li class="chapter" data-level="11.5.5" data-path="god-spiked-the-integers.html"><a href="god-spiked-the-integers.html#m7-2"><i class="fa fa-check"></i><b>11.5.5</b> 11M7</a></li>
<li class="chapter" data-level="11.5.6" data-path="god-spiked-the-integers.html"><a href="god-spiked-the-integers.html#m8-1"><i class="fa fa-check"></i><b>11.5.6</b> 11M8</a></li>
<li class="chapter" data-level="11.5.7" data-path="god-spiked-the-integers.html"><a href="god-spiked-the-integers.html#h1-8"><i class="fa fa-check"></i><b>11.5.7</b> 11H1</a></li>
<li class="chapter" data-level="11.5.8" data-path="god-spiked-the-integers.html"><a href="god-spiked-the-integers.html#h2-8"><i class="fa fa-check"></i><b>11.5.8</b> 11H2</a></li>
<li class="chapter" data-level="11.5.9" data-path="god-spiked-the-integers.html"><a href="god-spiked-the-integers.html#h3-8"><i class="fa fa-check"></i><b>11.5.9</b> 11H3</a></li>
<li class="chapter" data-level="11.5.10" data-path="god-spiked-the-integers.html"><a href="god-spiked-the-integers.html#h4-8"><i class="fa fa-check"></i><b>11.5.10</b> 11H4</a></li>
<li class="chapter" data-level="11.5.11" data-path="god-spiked-the-integers.html"><a href="god-spiked-the-integers.html#h5-6"><i class="fa fa-check"></i><b>11.5.11</b> 11H5</a></li>
<li class="chapter" data-level="11.5.12" data-path="god-spiked-the-integers.html"><a href="god-spiked-the-integers.html#h6-3"><i class="fa fa-check"></i><b>11.5.12</b> 11H6</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="12" data-path="monsters-and-mixtures.html"><a href="monsters-and-mixtures.html"><i class="fa fa-check"></i><b>12</b> Monsters and Mixtures</a>
<ul>
<li class="chapter" data-level="12.1" data-path="monsters-and-mixtures.html"><a href="monsters-and-mixtures.html#over-dispersed-counts"><i class="fa fa-check"></i><b>12.1</b> Over-dispersed counts</a>
<ul>
<li class="chapter" data-level="12.1.1" data-path="monsters-and-mixtures.html"><a href="monsters-and-mixtures.html#beta-binomial."><i class="fa fa-check"></i><b>12.1.1</b> Beta binomial.</a></li>
<li class="chapter" data-level="12.1.2" data-path="monsters-and-mixtures.html"><a href="monsters-and-mixtures.html#negative-binomial-or-gamma-poisson."><i class="fa fa-check"></i><b>12.1.2</b> Negative binomial or gamma-Poisson.</a></li>
<li class="chapter" data-level="12.1.3" data-path="monsters-and-mixtures.html"><a href="monsters-and-mixtures.html#over-dispersion-entropy-and-information-criteria."><i class="fa fa-check"></i><b>12.1.3</b> Over-dispersion, entropy, and information criteria.</a></li>
</ul></li>
<li class="chapter" data-level="12.2" data-path="monsters-and-mixtures.html"><a href="monsters-and-mixtures.html#zero-inflated-outcomes"><i class="fa fa-check"></i><b>12.2</b> Zero-inflated outcomes</a>
<ul>
<li class="chapter" data-level="12.2.1" data-path="monsters-and-mixtures.html"><a href="monsters-and-mixtures.html#example-zero-inflated-poisson."><i class="fa fa-check"></i><b>12.2.1</b> Example: Zero-inflated Poisson.</a></li>
</ul></li>
<li class="chapter" data-level="12.3" data-path="monsters-and-mixtures.html"><a href="monsters-and-mixtures.html#ordered-categorical-outcomes"><i class="fa fa-check"></i><b>12.3</b> Ordered categorical outcomes</a>
<ul>
<li class="chapter" data-level="12.3.1" data-path="monsters-and-mixtures.html"><a href="monsters-and-mixtures.html#example-moral-intuition."><i class="fa fa-check"></i><b>12.3.1</b> Example: Moral intuition.</a></li>
<li class="chapter" data-level="12.3.2" data-path="monsters-and-mixtures.html"><a href="monsters-and-mixtures.html#adding-predictor-variables."><i class="fa fa-check"></i><b>12.3.2</b> Adding predictor variables.</a></li>
</ul></li>
<li class="chapter" data-level="12.4" data-path="monsters-and-mixtures.html"><a href="monsters-and-mixtures.html#ordered-categorical-predictors"><i class="fa fa-check"></i><b>12.4</b> Ordered categorical predictors</a></li>
<li class="chapter" data-level="12.5" data-path="monsters-and-mixtures.html"><a href="monsters-and-mixtures.html#practice-9"><i class="fa fa-check"></i><b>12.5</b> Practice</a>
<ul>
<li class="chapter" data-level="12.5.1" data-path="monsters-and-mixtures.html"><a href="monsters-and-mixtures.html#m1-6"><i class="fa fa-check"></i><b>12.5.1</b> 12M1</a></li>
<li class="chapter" data-level="12.5.2" data-path="monsters-and-mixtures.html"><a href="monsters-and-mixtures.html#m2-6"><i class="fa fa-check"></i><b>12.5.2</b> 12M2</a></li>
<li class="chapter" data-level="12.5.3" data-path="monsters-and-mixtures.html"><a href="monsters-and-mixtures.html#m3-3"><i class="fa fa-check"></i><b>12.5.3</b> 12M3</a></li>
<li class="chapter" data-level="12.5.4" data-path="monsters-and-mixtures.html"><a href="monsters-and-mixtures.html#h1-9"><i class="fa fa-check"></i><b>12.5.4</b> 12H1</a></li>
<li class="chapter" data-level="12.5.5" data-path="monsters-and-mixtures.html"><a href="monsters-and-mixtures.html#h2-9"><i class="fa fa-check"></i><b>12.5.5</b> 12H2</a></li>
<li class="chapter" data-level="12.5.6" data-path="monsters-and-mixtures.html"><a href="monsters-and-mixtures.html#h3-9"><i class="fa fa-check"></i><b>12.5.6</b> 12H3</a></li>
<li class="chapter" data-level="12.5.7" data-path="monsters-and-mixtures.html"><a href="monsters-and-mixtures.html#h4-9"><i class="fa fa-check"></i><b>12.5.7</b> 12H4</a></li>
<li class="chapter" data-level="12.5.8" data-path="monsters-and-mixtures.html"><a href="monsters-and-mixtures.html#h5-7"><i class="fa fa-check"></i><b>12.5.8</b> 12H5</a></li>
<li class="chapter" data-level="12.5.9" data-path="monsters-and-mixtures.html"><a href="monsters-and-mixtures.html#h6-4"><i class="fa fa-check"></i><b>12.5.9</b> 12H6</a></li>
<li class="chapter" data-level="12.5.10" data-path="monsters-and-mixtures.html"><a href="monsters-and-mixtures.html#h7-1"><i class="fa fa-check"></i><b>12.5.10</b> 12H7</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="13" data-path="models-with-memory.html"><a href="models-with-memory.html"><i class="fa fa-check"></i><b>13</b> Models with Memory</a>
<ul>
<li class="chapter" data-level="13.1" data-path="models-with-memory.html"><a href="models-with-memory.html#multilevel-tadpoles"><i class="fa fa-check"></i><b>13.1</b> Multilevel tadpoles</a></li>
<li class="chapter" data-level="13.2" data-path="models-with-memory.html"><a href="models-with-memory.html#varying-effects-and-the-underfittingoverfitting-trade-off"><i class="fa fa-check"></i><b>13.2</b> Varying effects and the underfitting/overfitting trade-off 　</a>
<ul>
<li class="chapter" data-level="13.2.1" data-path="models-with-memory.html"><a href="models-with-memory.html#the-model"><i class="fa fa-check"></i><b>13.2.1</b> The model</a></li>
<li class="chapter" data-level="13.2.2" data-path="models-with-memory.html"><a href="models-with-memory.html#simulate-survivors"><i class="fa fa-check"></i><b>13.2.2</b> Simulate survivors</a></li>
</ul></li>
<li class="chapter" data-level="13.3" data-path="models-with-memory.html"><a href="models-with-memory.html#more-than-one-type-of-cluster"><i class="fa fa-check"></i><b>13.3</b> More than one type of cluster</a>
<ul>
<li class="chapter" data-level="13.3.1" data-path="models-with-memory.html"><a href="models-with-memory.html#even-more-clusters"><i class="fa fa-check"></i><b>13.3.1</b> Even more clusters</a></li>
</ul></li>
<li class="chapter" data-level="13.4" data-path="models-with-memory.html"><a href="models-with-memory.html#divergent-transitions-and-non-centered-priors"><i class="fa fa-check"></i><b>13.4</b> Divergent transitions and non-centered priors</a>
<ul>
<li class="chapter" data-level="13.4.1" data-path="models-with-memory.html"><a href="models-with-memory.html#the-devils-funnel"><i class="fa fa-check"></i><b>13.4.1</b> The Devil’s Funnel</a></li>
<li class="chapter" data-level="13.4.2" data-path="models-with-memory.html"><a href="models-with-memory.html#non-centered-chimpanzees"><i class="fa fa-check"></i><b>13.4.2</b> Non-centered chimpanzees</a></li>
</ul></li>
<li class="chapter" data-level="13.5" data-path="models-with-memory.html"><a href="models-with-memory.html#multilevel-posterior-predictions"><i class="fa fa-check"></i><b>13.5</b> Multilevel posterior predictions</a>
<ul>
<li class="chapter" data-level="13.5.1" data-path="models-with-memory.html"><a href="models-with-memory.html#posterior-prediction-for-same-clusters"><i class="fa fa-check"></i><b>13.5.1</b> Posterior prediction for same clusters</a></li>
<li class="chapter" data-level="13.5.2" data-path="models-with-memory.html"><a href="models-with-memory.html#posterior-prediction-for-new-clusters"><i class="fa fa-check"></i><b>13.5.2</b> Posterior prediction for new clusters</a></li>
</ul></li>
<li class="chapter" data-level="13.6" data-path="models-with-memory.html"><a href="models-with-memory.html#post-stratification"><i class="fa fa-check"></i><b>13.6</b> Post stratification</a>
<ul>
<li class="chapter" data-level="13.6.1" data-path="models-with-memory.html"><a href="models-with-memory.html#meet-the-data"><i class="fa fa-check"></i><b>13.6.1</b> Meet the data</a></li>
<li class="chapter" data-level="13.6.2" data-path="models-with-memory.html"><a href="models-with-memory.html#settle-the-mr-part-of-mrp."><i class="fa fa-check"></i><b>13.6.2</b> Settle the MR part of MRP.</a></li>
<li class="chapter" data-level="13.6.3" data-path="models-with-memory.html"><a href="models-with-memory.html#post-stratify-to-put-the-p-in-mrp."><i class="fa fa-check"></i><b>13.6.3</b> Post-stratify to put the P in MRP.</a></li>
</ul></li>
<li class="chapter" data-level="13.7" data-path="models-with-memory.html"><a href="models-with-memory.html#practice-10"><i class="fa fa-check"></i><b>13.7</b> Practice</a>
<ul>
<li class="chapter" data-level="13.7.1" data-path="models-with-memory.html"><a href="models-with-memory.html#m1-7"><i class="fa fa-check"></i><b>13.7.1</b> 13M1</a></li>
<li class="chapter" data-level="13.7.2" data-path="models-with-memory.html"><a href="models-with-memory.html#m2-7"><i class="fa fa-check"></i><b>13.7.2</b> 13M2</a></li>
<li class="chapter" data-level="13.7.3" data-path="models-with-memory.html"><a href="models-with-memory.html#m3-4"><i class="fa fa-check"></i><b>13.7.3</b> 13M3</a></li>
<li class="chapter" data-level="13.7.4" data-path="models-with-memory.html"><a href="models-with-memory.html#m4-6"><i class="fa fa-check"></i><b>13.7.4</b> 13M4</a></li>
<li class="chapter" data-level="13.7.5" data-path="models-with-memory.html"><a href="models-with-memory.html#m5-3"><i class="fa fa-check"></i><b>13.7.5</b> 13M5</a></li>
<li class="chapter" data-level="13.7.6" data-path="models-with-memory.html"><a href="models-with-memory.html#m6-2"><i class="fa fa-check"></i><b>13.7.6</b> 13M6</a></li>
<li class="chapter" data-level="13.7.7" data-path="models-with-memory.html"><a href="models-with-memory.html#h1-10"><i class="fa fa-check"></i><b>13.7.7</b> 13H1</a></li>
<li class="chapter" data-level="13.7.8" data-path="models-with-memory.html"><a href="models-with-memory.html#h2-10"><i class="fa fa-check"></i><b>13.7.8</b> 13H2</a></li>
<li class="chapter" data-level="13.7.9" data-path="models-with-memory.html"><a href="models-with-memory.html#h3-10"><i class="fa fa-check"></i><b>13.7.9</b> 13H3</a></li>
<li class="chapter" data-level="13.7.10" data-path="models-with-memory.html"><a href="models-with-memory.html#h4-10"><i class="fa fa-check"></i><b>13.7.10</b> 13H4</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="14" data-path="adventures-in-covariance.html"><a href="adventures-in-covariance.html"><i class="fa fa-check"></i><b>14</b> Adventures in Covariance</a>
<ul>
<li class="chapter" data-level="14.1" data-path="adventures-in-covariance.html"><a href="adventures-in-covariance.html#varying-slopes-by-construction"><i class="fa fa-check"></i><b>14.1</b> Varying slopes by construction</a>
<ul>
<li class="chapter" data-level="14.1.1" data-path="adventures-in-covariance.html"><a href="adventures-in-covariance.html#simulate-and-population"><i class="fa fa-check"></i><b>14.1.1</b> Simulate and population</a></li>
<li class="chapter" data-level="14.1.2" data-path="adventures-in-covariance.html"><a href="adventures-in-covariance.html#simulate-observation"><i class="fa fa-check"></i><b>14.1.2</b> Simulate observation</a></li>
<li class="chapter" data-level="14.1.3" data-path="adventures-in-covariance.html"><a href="adventures-in-covariance.html#the-varying-slope-model"><i class="fa fa-check"></i><b>14.1.3</b> The varying slope model</a></li>
</ul></li>
<li class="chapter" data-level="14.2" data-path="adventures-in-covariance.html"><a href="adventures-in-covariance.html#advanced-varing-slopes"><i class="fa fa-check"></i><b>14.2</b> Advanced varing slopes</a></li>
<li class="chapter" data-level="14.3" data-path="adventures-in-covariance.html"><a href="adventures-in-covariance.html#instruments-and-causal-designs"><i class="fa fa-check"></i><b>14.3</b> Instruments and causal designs</a>
<ul>
<li class="chapter" data-level="14.3.1" data-path="adventures-in-covariance.html"><a href="adventures-in-covariance.html#instrumental-variables"><i class="fa fa-check"></i><b>14.3.1</b> Instrumental variables</a></li>
<li class="chapter" data-level="14.3.2" data-path="adventures-in-covariance.html"><a href="adventures-in-covariance.html#other-designs"><i class="fa fa-check"></i><b>14.3.2</b> Other designs</a></li>
</ul></li>
<li class="chapter" data-level="14.4" data-path="adventures-in-covariance.html"><a href="adventures-in-covariance.html#social-relations-as-correlated-varying-effects"><i class="fa fa-check"></i><b>14.4</b> Social relations as correlated varying effects</a></li>
<li class="chapter" data-level="14.5" data-path="adventures-in-covariance.html"><a href="adventures-in-covariance.html#continuous-categories-and-the-gaussian-process"><i class="fa fa-check"></i><b>14.5</b> Continuous categories and the Gaussian process</a>
<ul>
<li class="chapter" data-level="14.5.1" data-path="adventures-in-covariance.html"><a href="adventures-in-covariance.html#example-spatial-autocorrelation-in-oceanic-tools"><i class="fa fa-check"></i><b>14.5.1</b> Example: Spatial autocorrelation in Oceanic tools</a></li>
<li class="chapter" data-level="14.5.2" data-path="adventures-in-covariance.html"><a href="adventures-in-covariance.html#example-phylogenetic-distance"><i class="fa fa-check"></i><b>14.5.2</b> Example: Phylogenetic distance</a></li>
</ul></li>
<li class="chapter" data-level="14.6" data-path="adventures-in-covariance.html"><a href="adventures-in-covariance.html#practice-11"><i class="fa fa-check"></i><b>14.6</b> Practice</a>
<ul>
<li class="chapter" data-level="14.6.1" data-path="adventures-in-covariance.html"><a href="adventures-in-covariance.html#m1-8"><i class="fa fa-check"></i><b>14.6.1</b> 14M1</a></li>
<li class="chapter" data-level="14.6.2" data-path="adventures-in-covariance.html"><a href="adventures-in-covariance.html#m2-8"><i class="fa fa-check"></i><b>14.6.2</b> 14M2</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="" data-path="実行環境.html"><a href="実行環境.html"><i class="fa fa-check"></i>実行環境</a></li>
</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Statistical Rethinking Second Edition</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="sampling-the-imaginary" class="section level1 hasAnchor" number="3">
<h1><span class="header-section-number">3</span> Sampling the Imaginary<a href="sampling-the-imaginary.html#sampling-the-imaginary" class="anchor-section" aria-label="Anchor link to header"></a></h1>
<div id="sampling-from-a-grid-aproximate-posterior" class="section level2 hasAnchor" number="3.1">
<h2><span class="header-section-number">3.1</span> Sampling from a grid-aproximate posterior<a href="sampling-the-imaginary.html#sampling-from-a-grid-aproximate-posterior" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>地球儀の例について、事後確率を算出する。<br />
9回中6回地表にコインが落ちたときを考え、grid-approximationを行う。</p>
<div class="sourceCode" id="cb35"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb35-1"><a href="sampling-the-imaginary.html#cb35-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">100</span>)</span>
<span id="cb35-2"><a href="sampling-the-imaginary.html#cb35-2" aria-hidden="true" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="dv">1000</span></span>
<span id="cb35-3"><a href="sampling-the-imaginary.html#cb35-3" aria-hidden="true" tabindex="-1"></a>n_success <span class="ot">&lt;-</span> <span class="dv">6</span></span>
<span id="cb35-4"><a href="sampling-the-imaginary.html#cb35-4" aria-hidden="true" tabindex="-1"></a>n_trials <span class="ot">&lt;-</span> <span class="dv">9</span></span>
<span id="cb35-5"><a href="sampling-the-imaginary.html#cb35-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-6"><a href="sampling-the-imaginary.html#cb35-6" aria-hidden="true" tabindex="-1"></a>(d <span class="ot">&lt;-</span> <span class="fu">tibble</span>(<span class="at">p_grid =</span> <span class="fu">seq</span>(<span class="dv">0</span>,<span class="dv">1</span>,<span class="at">length.out =</span>n),</span>
<span id="cb35-7"><a href="sampling-the-imaginary.html#cb35-7" aria-hidden="true" tabindex="-1"></a>            <span class="at">prior =</span> <span class="dv">1</span>) <span class="sc">%&gt;%</span></span>
<span id="cb35-8"><a href="sampling-the-imaginary.html#cb35-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">likelihood =</span> <span class="fu">dbinom</span>(n_success,n_trials,<span class="at">prob=</span>p_grid),</span>
<span id="cb35-9"><a href="sampling-the-imaginary.html#cb35-9" aria-hidden="true" tabindex="-1"></a>         <span class="at">posterior =</span> likelihood<span class="sc">*</span>prior<span class="sc">/</span><span class="fu">sum</span>(likelihood<span class="sc">*</span>prior)))</span></code></pre></div>
<pre><code>## # A tibble: 1,000 × 4
##     p_grid prior likelihood posterior
##      &lt;dbl&gt; &lt;dbl&gt;      &lt;dbl&gt;     &lt;dbl&gt;
##  1 0           1   0         0       
##  2 0.00100     1   8.43e-17  8.43e-19
##  3 0.00200     1   5.38e-15  5.38e-17
##  4 0.00300     1   6.11e-14  6.11e-16
##  5 0.00400     1   3.42e-13  3.42e-15
##  6 0.00501     1   1.30e-12  1.30e-14
##  7 0.00601     1   3.87e-12  3.88e-14
##  8 0.00701     1   9.73e-12  9.74e-14
##  9 0.00801     1   2.16e-11  2.16e-13
## 10 0.00901     1   4.37e-11  4.38e-13
## # … with 990 more rows</code></pre>
<div class="sourceCode" id="cb37"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb37-1"><a href="sampling-the-imaginary.html#cb37-1" aria-hidden="true" tabindex="-1"></a>d <span class="sc">%&gt;%</span> </span>
<span id="cb37-2"><a href="sampling-the-imaginary.html#cb37-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x=</span>p_grid,<span class="at">y=</span>posterior))<span class="sc">+</span></span>
<span id="cb37-3"><a href="sampling-the-imaginary.html#cb37-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="at">size=</span><span class="fl">0.1</span>)<span class="sc">+</span></span>
<span id="cb37-4"><a href="sampling-the-imaginary.html#cb37-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">size=</span><span class="fl">0.1</span>)<span class="sc">+</span></span>
<span id="cb37-5"><a href="sampling-the-imaginary.html#cb37-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">panel.grid =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb37-6"><a href="sampling-the-imaginary.html#cb37-6" aria-hidden="true" tabindex="-1"></a>        <span class="at">text =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">12</span>))<span class="sc">+</span></span>
<span id="cb37-7"><a href="sampling-the-imaginary.html#cb37-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_bw</span>()<span class="sc">+</span></span>
<span id="cb37-8"><a href="sampling-the-imaginary.html#cb37-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">xlab</span>(<span class="st">&quot;proportion of water (p)&quot;</span>)</span></code></pre></div>
<p><img src="Rethinking_Bookdown_files/figure-html/unnamed-chunk-19-1.png" width="672" style="display: block; margin: auto;" />
<br /></p>
<p>事後分布からサンプルを取得する。<br />
確率密度で重みづけしたうえで、各確率（0&lt;p&lt;1）を事後分布から10000回サンプリングする。</p>
<div class="sourceCode" id="cb38"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb38-1"><a href="sampling-the-imaginary.html#cb38-1" aria-hidden="true" tabindex="-1"></a>n_samples <span class="ot">&lt;-</span> <span class="fl">1e4</span></span>
<span id="cb38-2"><a href="sampling-the-imaginary.html#cb38-2" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">100</span>)</span>
<span id="cb38-3"><a href="sampling-the-imaginary.html#cb38-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-4"><a href="sampling-the-imaginary.html#cb38-4" aria-hidden="true" tabindex="-1"></a>samples <span class="ot">&lt;-</span> </span>
<span id="cb38-5"><a href="sampling-the-imaginary.html#cb38-5" aria-hidden="true" tabindex="-1"></a>  d <span class="sc">%&gt;%</span> </span>
<span id="cb38-6"><a href="sampling-the-imaginary.html#cb38-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">slice_sample</span>(<span class="at">n=</span>n_samples, <span class="at">weight_by =</span> posterior, <span class="at">replace=</span> <span class="cn">TRUE</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb38-7"><a href="sampling-the-imaginary.html#cb38-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">sample_number =</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">n</span>())</span>
<span id="cb38-8"><a href="sampling-the-imaginary.html#cb38-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-9"><a href="sampling-the-imaginary.html#cb38-9" aria-hidden="true" tabindex="-1"></a><span class="fu">glimpse</span>(samples)</span></code></pre></div>
<pre><code>## Rows: 10,000
## Columns: 5
## $ p_grid        &lt;dbl&gt; 0.7137137, 0.3573574, 0.5985986, 0.7177177, 0.6296296, 0…
## $ prior         &lt;dbl&gt; 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,…
## $ likelihood    &lt;dbl&gt; 0.26051046, 0.04643060, 0.24993675, 0.25825703, 0.265888…
## $ posterior     &lt;dbl&gt; 0.0026077123, 0.0004647707, 0.0025018693, 0.0025851554, …
## $ sample_number &lt;int&gt; 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 1…</code></pre>
<p><br /></p>
<p>サンプルはp=0.6付近に集中していることが分かる。</p>
<div class="sourceCode" id="cb40"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb40-1"><a href="sampling-the-imaginary.html#cb40-1" aria-hidden="true" tabindex="-1"></a><span class="co"># figure3.1</span></span>
<span id="cb40-2"><a href="sampling-the-imaginary.html#cb40-2" aria-hidden="true" tabindex="-1"></a>samples <span class="sc">%&gt;%</span> </span>
<span id="cb40-3"><a href="sampling-the-imaginary.html#cb40-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> sample_number, <span class="at">y =</span> p_grid))<span class="sc">+</span></span>
<span id="cb40-4"><a href="sampling-the-imaginary.html#cb40-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">alpha=</span><span class="fl">0.1</span>, <span class="at">color =</span> <span class="st">&quot;blue&quot;</span>)<span class="sc">+</span></span>
<span id="cb40-5"><a href="sampling-the-imaginary.html#cb40-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="st">&quot;proportion of water (p)&quot;</span>)<span class="sc">+</span></span>
<span id="cb40-6"><a href="sampling-the-imaginary.html#cb40-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_classic</span>()</span></code></pre></div>
<p><img src="Rethinking_Bookdown_files/figure-html/unnamed-chunk-21-1.png" width="672" style="display: block; margin: auto;" />
<br /></p>
<div class="sourceCode" id="cb41"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb41-1"><a href="sampling-the-imaginary.html#cb41-1" aria-hidden="true" tabindex="-1"></a>samples <span class="sc">%&gt;%</span> </span>
<span id="cb41-2"><a href="sampling-the-imaginary.html#cb41-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x=</span>p_grid))<span class="sc">+</span></span>
<span id="cb41-3"><a href="sampling-the-imaginary.html#cb41-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_density</span>(<span class="at">color=</span><span class="st">&quot;blue&quot;</span>, <span class="at">size =</span> <span class="fl">0.7</span>)<span class="sc">+</span></span>
<span id="cb41-4"><a href="sampling-the-imaginary.html#cb41-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_classic</span>()<span class="sc">+</span></span>
<span id="cb41-5"><a href="sampling-the-imaginary.html#cb41-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="at">breaks =</span> <span class="fu">seq</span>(<span class="dv">0</span>,<span class="fl">2.5</span>,<span class="fl">0.5</span>))<span class="sc">+</span></span>
<span id="cb41-6"><a href="sampling-the-imaginary.html#cb41-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_continuous</span>(<span class="st">&quot;proportion of water (p)&quot;</span>,<span class="at">breaks =</span> <span class="fu">seq</span>(<span class="dv">0</span>,<span class="dv">1</span>,<span class="fl">0.2</span>))</span></code></pre></div>
<p><img src="Rethinking_Bookdown_files/figure-html/unnamed-chunk-22-1.png" width="672" style="display: block; margin: auto;" />
<br /></p>
</div>
<div id="sampling-to-summarize" class="section level2 hasAnchor" number="3.2">
<h2><span class="header-section-number">3.2</span> Sampling to summarize<a href="sampling-the-imaginary.html#sampling-to-summarize" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>事後分布からのサンプリングを用いることで、事後分布の区間推定や点推定を容易に行うことができる。</p>
<div class="sourceCode" id="cb42"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb42-1"><a href="sampling-the-imaginary.html#cb42-1" aria-hidden="true" tabindex="-1"></a><span class="co"># grid approximationから</span></span>
<span id="cb42-2"><a href="sampling-the-imaginary.html#cb42-2" aria-hidden="true" tabindex="-1"></a>d <span class="sc">%&gt;%</span> </span>
<span id="cb42-3"><a href="sampling-the-imaginary.html#cb42-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(p_grid <span class="sc">&lt;</span> .<span class="dv">5</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb42-4"><a href="sampling-the-imaginary.html#cb42-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">sum =</span> <span class="fu">sum</span>(posterior))</span></code></pre></div>
<pre><code>## # A tibble: 1 × 1
##     sum
##   &lt;dbl&gt;
## 1 0.172</code></pre>
<div class="sourceCode" id="cb44"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb44-1"><a href="sampling-the-imaginary.html#cb44-1" aria-hidden="true" tabindex="-1"></a><span class="co"># サンプリングから</span></span>
<span id="cb44-2"><a href="sampling-the-imaginary.html#cb44-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-3"><a href="sampling-the-imaginary.html#cb44-3" aria-hidden="true" tabindex="-1"></a><span class="co"># 0.5未満の確率</span></span>
<span id="cb44-4"><a href="sampling-the-imaginary.html#cb44-4" aria-hidden="true" tabindex="-1"></a>samples <span class="sc">%&gt;%</span> </span>
<span id="cb44-5"><a href="sampling-the-imaginary.html#cb44-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(p_grid <span class="sc">&lt;</span> <span class="fl">0.5</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb44-6"><a href="sampling-the-imaginary.html#cb44-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">sum =</span> <span class="fu">n</span>()<span class="sc">/</span>n_samples)</span></code></pre></div>
<pre><code>## # A tibble: 1 × 1
##     sum
##   &lt;dbl&gt;
## 1 0.167</code></pre>
<div class="sourceCode" id="cb46"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb46-1"><a href="sampling-the-imaginary.html#cb46-1" aria-hidden="true" tabindex="-1"></a><span class="co"># 0.5以上0.75未満の確率</span></span>
<span id="cb46-2"><a href="sampling-the-imaginary.html#cb46-2" aria-hidden="true" tabindex="-1"></a>samples <span class="sc">%&gt;%</span> </span>
<span id="cb46-3"><a href="sampling-the-imaginary.html#cb46-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(p_grid <span class="sc">&gt;</span> .<span class="dv">5</span> <span class="sc">&amp;</span> p_grid <span class="sc">&lt;</span> .<span class="dv">75</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb46-4"><a href="sampling-the-imaginary.html#cb46-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">sum =</span> <span class="fu">n</span>()<span class="sc">/</span>n_samples)</span></code></pre></div>
<pre><code>## # A tibble: 1 × 1
##     sum
##   &lt;dbl&gt;
## 1 0.621</code></pre>
<p><br /></p>
<div class="sourceCode" id="cb48"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb48-1"><a href="sampling-the-imaginary.html#cb48-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Figure3.2</span></span>
<span id="cb48-2"><a href="sampling-the-imaginary.html#cb48-2" aria-hidden="true" tabindex="-1"></a>p1 <span class="ot">&lt;-</span> </span>
<span id="cb48-3"><a href="sampling-the-imaginary.html#cb48-3" aria-hidden="true" tabindex="-1"></a>  d <span class="sc">%&gt;%</span> </span>
<span id="cb48-4"><a href="sampling-the-imaginary.html#cb48-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x=</span>p_grid, <span class="at">y=</span>posterior))<span class="sc">+</span></span>
<span id="cb48-5"><a href="sampling-the-imaginary.html#cb48-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>()<span class="sc">+</span></span>
<span id="cb48-6"><a href="sampling-the-imaginary.html#cb48-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_area</span>(<span class="at">data=</span> d <span class="sc">%&gt;%</span> <span class="fu">filter</span>(p_grid <span class="sc">&lt;</span> .<span class="dv">5</span>),</span>
<span id="cb48-7"><a href="sampling-the-imaginary.html#cb48-7" aria-hidden="true" tabindex="-1"></a>            <span class="at">fill =</span> <span class="st">&quot;blue&quot;</span>)<span class="sc">+</span></span>
<span id="cb48-8"><a href="sampling-the-imaginary.html#cb48-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x=</span><span class="st">&quot;proportion of water (p)&quot;</span>,</span>
<span id="cb48-9"><a href="sampling-the-imaginary.html#cb48-9" aria-hidden="true" tabindex="-1"></a>       <span class="at">y=</span> <span class="st">&quot;Density&quot;</span>)</span>
<span id="cb48-10"><a href="sampling-the-imaginary.html#cb48-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb48-11"><a href="sampling-the-imaginary.html#cb48-11" aria-hidden="true" tabindex="-1"></a>p2 <span class="ot">&lt;-</span> d <span class="sc">%&gt;%</span> </span>
<span id="cb48-12"><a href="sampling-the-imaginary.html#cb48-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x=</span>p_grid, <span class="at">y=</span>posterior))<span class="sc">+</span></span>
<span id="cb48-13"><a href="sampling-the-imaginary.html#cb48-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>()<span class="sc">+</span></span>
<span id="cb48-14"><a href="sampling-the-imaginary.html#cb48-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_area</span>(<span class="at">data=</span> d <span class="sc">%&gt;%</span> <span class="fu">filter</span>(p_grid <span class="sc">&gt;</span>.<span class="dv">5</span> <span class="sc">&amp;</span> p_grid <span class="sc">&lt;</span> .<span class="dv">75</span>), <span class="at">fill =</span> <span class="st">&quot;blue&quot;</span>)<span class="sc">+</span></span>
<span id="cb48-15"><a href="sampling-the-imaginary.html#cb48-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x=</span><span class="st">&quot;proportion of water (p)&quot;</span>,</span>
<span id="cb48-16"><a href="sampling-the-imaginary.html#cb48-16" aria-hidden="true" tabindex="-1"></a>       <span class="at">y=</span> <span class="st">&quot;Density&quot;</span>)</span>
<span id="cb48-17"><a href="sampling-the-imaginary.html#cb48-17" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb48-18"><a href="sampling-the-imaginary.html#cb48-18" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(patchwork)</span>
<span id="cb48-19"><a href="sampling-the-imaginary.html#cb48-19" aria-hidden="true" tabindex="-1"></a>p1<span class="sc">+</span>p2</span></code></pre></div>
<p><img src="Rethinking_Bookdown_files/figure-html/unnamed-chunk-24-1.png" width="672" style="display: block; margin: auto;" /></p>
<div id="intervals-of-defined-mass" class="section level3 hasAnchor" number="3.2.1">
<h3><span class="header-section-number">3.2.1</span> Intervals of defined mass<a href="sampling-the-imaginary.html#intervals-of-defined-mass" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>事後分布空のサンプルを用いて区間推定を行う。</p>
<div class="sourceCode" id="cb49"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb49-1"><a href="sampling-the-imaginary.html#cb49-1" aria-hidden="true" tabindex="-1"></a><span class="co"># 60%信用区間</span></span>
<span id="cb49-2"><a href="sampling-the-imaginary.html#cb49-2" aria-hidden="true" tabindex="-1"></a><span class="fu">quantile</span>(samples<span class="sc">$</span>p_grid, <span class="fu">c</span>(<span class="fl">0.2</span>,<span class="fl">0.8</span>))</span></code></pre></div>
<pre><code>##       20%       80% 
## 0.5185185 0.7557558</code></pre>
<p><br /></p>
<div class="sourceCode" id="cb51"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb51-1"><a href="sampling-the-imaginary.html#cb51-1" aria-hidden="true" tabindex="-1"></a><span class="co"># 60$信用区間の作図</span></span>
<span id="cb51-2"><a href="sampling-the-imaginary.html#cb51-2" aria-hidden="true" tabindex="-1"></a>q_80 <span class="ot">&lt;-</span> <span class="fu">quantile</span>(samples<span class="sc">$</span>p_grid, <span class="at">prob =</span> .<span class="dv">8</span>)</span>
<span id="cb51-3"><a href="sampling-the-imaginary.html#cb51-3" aria-hidden="true" tabindex="-1"></a>q_20 <span class="ot">&lt;-</span> <span class="fu">quantile</span>(samples<span class="sc">$</span>p_grid, <span class="at">prob =</span> .<span class="dv">2</span>)</span>
<span id="cb51-4"><a href="sampling-the-imaginary.html#cb51-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb51-5"><a href="sampling-the-imaginary.html#cb51-5" aria-hidden="true" tabindex="-1"></a>d <span class="sc">%&gt;%</span> </span>
<span id="cb51-6"><a href="sampling-the-imaginary.html#cb51-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x=</span>p_grid, <span class="at">y=</span>posterior))<span class="sc">+</span></span>
<span id="cb51-7"><a href="sampling-the-imaginary.html#cb51-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>()<span class="sc">+</span></span>
<span id="cb51-8"><a href="sampling-the-imaginary.html#cb51-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_area</span>(<span class="at">data=</span> d <span class="sc">%&gt;%</span> <span class="fu">filter</span>(p_grid <span class="sc">&gt;</span> q_20 <span class="sc">&amp;</span> p_grid <span class="sc">&lt;</span> q_80), <span class="at">fill =</span> <span class="st">&quot;blue&quot;</span>)<span class="sc">+</span></span>
<span id="cb51-9"><a href="sampling-the-imaginary.html#cb51-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x=</span><span class="st">&quot;proportion of water (p)&quot;</span>,</span>
<span id="cb51-10"><a href="sampling-the-imaginary.html#cb51-10" aria-hidden="true" tabindex="-1"></a>       <span class="at">y=</span> <span class="st">&quot;Density&quot;</span>)</span></code></pre></div>
<p><img src="Rethinking_Bookdown_files/figure-html/unnamed-chunk-26-1.png" width="672" style="display: block; margin: auto;" /></p>
</div>
<div id="highly-skewed-example" class="section level3 hasAnchor" number="3.2.2">
<h3><span class="header-section-number">3.2.2</span> highly skewed example<a href="sampling-the-imaginary.html#highly-skewed-example" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>分布が偏っているデータでは、単純に信用区間をとるとMAP推定値が含まれない。HPDIが信用区間の代わりに使われることがある。<br />
ここでは、3回中3回地表にコインが落ちた場合を考える。</p>
<div class="sourceCode" id="cb52"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb52-1"><a href="sampling-the-imaginary.html#cb52-1" aria-hidden="true" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="dv">1000</span></span>
<span id="cb52-2"><a href="sampling-the-imaginary.html#cb52-2" aria-hidden="true" tabindex="-1"></a>n_trials <span class="ot">&lt;-</span> <span class="dv">3</span></span>
<span id="cb52-3"><a href="sampling-the-imaginary.html#cb52-3" aria-hidden="true" tabindex="-1"></a>n_success <span class="ot">&lt;-</span> <span class="dv">3</span></span>
<span id="cb52-4"><a href="sampling-the-imaginary.html#cb52-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb52-5"><a href="sampling-the-imaginary.html#cb52-5" aria-hidden="true" tabindex="-1"></a>d2 <span class="ot">&lt;-</span> <span class="fu">tibble</span>(<span class="at">p_grid =</span> <span class="fu">seq</span>(<span class="dv">0</span>,<span class="dv">1</span>,<span class="at">length.out =</span>n),</span>
<span id="cb52-6"><a href="sampling-the-imaginary.html#cb52-6" aria-hidden="true" tabindex="-1"></a>            <span class="at">prior =</span> <span class="dv">1</span>) <span class="sc">%&gt;%</span></span>
<span id="cb52-7"><a href="sampling-the-imaginary.html#cb52-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">likelihood =</span> <span class="fu">dbinom</span>(n_success,n_trials,<span class="at">prob=</span>p_grid),</span>
<span id="cb52-8"><a href="sampling-the-imaginary.html#cb52-8" aria-hidden="true" tabindex="-1"></a>         <span class="at">posterior =</span> likelihood<span class="sc">*</span>prior<span class="sc">/</span><span class="fu">sum</span>(likelihood<span class="sc">*</span>prior))</span>
<span id="cb52-9"><a href="sampling-the-imaginary.html#cb52-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb52-10"><a href="sampling-the-imaginary.html#cb52-10" aria-hidden="true" tabindex="-1"></a>samples2 <span class="ot">&lt;-</span> </span>
<span id="cb52-11"><a href="sampling-the-imaginary.html#cb52-11" aria-hidden="true" tabindex="-1"></a>  d2 <span class="sc">%&gt;%</span> </span>
<span id="cb52-12"><a href="sampling-the-imaginary.html#cb52-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">slice_sample</span>(<span class="at">n=</span>n_samples, <span class="at">weight_by =</span> posterior, </span>
<span id="cb52-13"><a href="sampling-the-imaginary.html#cb52-13" aria-hidden="true" tabindex="-1"></a>               <span class="at">replace =</span> <span class="cn">TRUE</span>)</span></code></pre></div>
<p><br /></p>
<p>50%信用区間は以下の通り。<br />
最頻値（MAP推定値）が含まれない。</p>
<div class="sourceCode" id="cb53"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb53-1"><a href="sampling-the-imaginary.html#cb53-1" aria-hidden="true" tabindex="-1"></a>q2_25 <span class="ot">&lt;-</span> <span class="fu">quantile</span>(samples2<span class="sc">$</span>p_grid, <span class="at">prob =</span> .<span class="dv">25</span>)</span>
<span id="cb53-2"><a href="sampling-the-imaginary.html#cb53-2" aria-hidden="true" tabindex="-1"></a>q2_75 <span class="ot">&lt;-</span> <span class="fu">quantile</span>(samples2<span class="sc">$</span>p_grid, <span class="at">prob =</span> .<span class="dv">75</span>) </span>
<span id="cb53-3"><a href="sampling-the-imaginary.html#cb53-3" aria-hidden="true" tabindex="-1"></a><span class="fu">PI</span>(samples2<span class="sc">$</span>p_grid, <span class="at">prob=</span><span class="fl">0.5</span>)</span></code></pre></div>
<pre><code>##       25%       75% 
## 0.7047047 0.9309309</code></pre>
<div class="sourceCode" id="cb55"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb55-1"><a href="sampling-the-imaginary.html#cb55-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Figure3.3  </span></span>
<span id="cb55-2"><a href="sampling-the-imaginary.html#cb55-2" aria-hidden="true" tabindex="-1"></a>d2 <span class="sc">%&gt;%</span> </span>
<span id="cb55-3"><a href="sampling-the-imaginary.html#cb55-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x=</span>p_grid, <span class="at">y=</span>posterior))<span class="sc">+</span></span>
<span id="cb55-4"><a href="sampling-the-imaginary.html#cb55-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>()<span class="sc">+</span></span>
<span id="cb55-5"><a href="sampling-the-imaginary.html#cb55-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_area</span>(<span class="at">data=</span> d2 <span class="sc">%&gt;%</span> <span class="fu">filter</span>(p_grid <span class="sc">&gt;</span> q2_25 <span class="sc">&amp;</span> p_grid <span class="sc">&lt;</span> q2_75), <span class="at">fill =</span> <span class="st">&quot;blue&quot;</span>)<span class="sc">+</span></span>
<span id="cb55-6"><a href="sampling-the-imaginary.html#cb55-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x=</span><span class="st">&quot;proportion of water (p)&quot;</span>,</span>
<span id="cb55-7"><a href="sampling-the-imaginary.html#cb55-7" aria-hidden="true" tabindex="-1"></a>       <span class="at">y=</span> <span class="st">&quot;Density&quot;</span>)</span></code></pre></div>
<p><img src="Rethinking_Bookdown_files/figure-html/unnamed-chunk-28-1.png" width="672" style="display: block; margin: auto;" />
<br /></p>
<p>50%最高密度区間（HPDI）を求める。<br />
ある確率になる範囲の内、最も区間が狭くなるものをHPDIという。</p>
<div class="sourceCode" id="cb56"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb56-1"><a href="sampling-the-imaginary.html#cb56-1" aria-hidden="true" tabindex="-1"></a>hdpi50 <span class="ot">&lt;-</span> <span class="fu">HPDI</span>(samples2<span class="sc">$</span>p_grid, <span class="at">prob =</span> <span class="fu">c</span>(<span class="fl">0.5</span>))</span>
<span id="cb56-2"><a href="sampling-the-imaginary.html#cb56-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb56-3"><a href="sampling-the-imaginary.html#cb56-3" aria-hidden="true" tabindex="-1"></a>d2 <span class="sc">%&gt;%</span> </span>
<span id="cb56-4"><a href="sampling-the-imaginary.html#cb56-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x=</span>p_grid, <span class="at">y=</span>posterior))<span class="sc">+</span></span>
<span id="cb56-5"><a href="sampling-the-imaginary.html#cb56-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>()<span class="sc">+</span></span>
<span id="cb56-6"><a href="sampling-the-imaginary.html#cb56-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_area</span>(<span class="at">data=</span> d2 <span class="sc">%&gt;%</span> <span class="fu">filter</span>(p_grid <span class="sc">&gt;</span> hdpi50[[<span class="dv">1</span>]] <span class="sc">&amp;</span> p_grid <span class="sc">&lt;</span> hdpi50[[<span class="dv">2</span>]]), <span class="at">fill =</span> <span class="st">&quot;blue&quot;</span>)<span class="sc">+</span></span>
<span id="cb56-7"><a href="sampling-the-imaginary.html#cb56-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x=</span><span class="st">&quot;proportion of water (p)&quot;</span>,</span>
<span id="cb56-8"><a href="sampling-the-imaginary.html#cb56-8" aria-hidden="true" tabindex="-1"></a>       <span class="at">y=</span> <span class="st">&quot;Density&quot;</span>)</span></code></pre></div>
<p><img src="Rethinking_Bookdown_files/figure-html/unnamed-chunk-29-1.png" width="672" style="display: block; margin: auto;" /></p>
<p>tidybayesを用いて区間推定ができる。</p>
<div class="sourceCode" id="cb57"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb57-1"><a href="sampling-the-imaginary.html#cb57-1" aria-hidden="true" tabindex="-1"></a><span class="co"># using tidybayes</span></span>
<span id="cb57-2"><a href="sampling-the-imaginary.html#cb57-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidybayes)</span>
<span id="cb57-3"><a href="sampling-the-imaginary.html#cb57-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb57-4"><a href="sampling-the-imaginary.html#cb57-4" aria-hidden="true" tabindex="-1"></a><span class="fu">median_qi</span>(samples2<span class="sc">$</span>p_grid, <span class="at">.width =</span> <span class="fu">c</span>(.<span class="dv">5</span>, .<span class="dv">8</span>, .<span class="dv">99</span>))</span></code></pre></div>
<pre><code>##           y      ymin      ymax .width .point .interval
## 1 0.8398398 0.7047047 0.9309309   0.50 median        qi
## 2 0.8398398 0.5554555 0.9749750   0.80 median        qi
## 3 0.8398398 0.2522372 0.9989990   0.99 median        qi</code></pre>
<div class="sourceCode" id="cb59"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb59-1"><a href="sampling-the-imaginary.html#cb59-1" aria-hidden="true" tabindex="-1"></a><span class="fu">mode_hdi</span>(samples2<span class="sc">$</span>p_grid, <span class="at">.width=</span>.<span class="dv">5</span>)</span></code></pre></div>
<pre><code>##           y      ymin     ymax .width .point .interval
## 1 0.9554858 0.8388388 0.998999    0.5   mode       hdi</code></pre>
<div class="sourceCode" id="cb61"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb61-1"><a href="sampling-the-imaginary.html#cb61-1" aria-hidden="true" tabindex="-1"></a><span class="fu">HPDI</span>(samples2<span class="sc">$</span>p_grid, <span class="at">prob=</span>.<span class="dv">5</span>)</span></code></pre></div>
<pre><code>##      |0.5      0.5| 
## 0.8388388 0.9989990</code></pre>
<div class="sourceCode" id="cb63"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb63-1"><a href="sampling-the-imaginary.html#cb63-1" aria-hidden="true" tabindex="-1"></a><span class="fu">hdi</span>(samples2<span class="sc">$</span>p_grid, <span class="at">.width=</span>.<span class="dv">5</span>)</span></code></pre></div>
<pre><code>##           [,1]     [,2]
## [1,] 0.8388388 0.998999</code></pre>
<div class="sourceCode" id="cb65"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb65-1"><a href="sampling-the-imaginary.html#cb65-1" aria-hidden="true" tabindex="-1"></a><span class="co"># comparing HDPI with QI</span></span>
<span id="cb65-2"><a href="sampling-the-imaginary.html#cb65-2" aria-hidden="true" tabindex="-1"></a><span class="fu">bind_rows</span>(<span class="fu">mean_hdi</span>(samples<span class="sc">$</span>p_grid, <span class="at">.width =</span> <span class="fu">c</span>(.<span class="dv">8</span>,.<span class="dv">95</span>)),</span>
<span id="cb65-3"><a href="sampling-the-imaginary.html#cb65-3" aria-hidden="true" tabindex="-1"></a>         <span class="fu">mean_qi</span>(samples<span class="sc">$</span>p_grid, <span class="at">.width =</span> <span class="fu">c</span>(.<span class="dv">8</span>,.<span class="dv">95</span>))) <span class="sc">%&gt;%</span> </span>
<span id="cb65-4"><a href="sampling-the-imaginary.html#cb65-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(.width, .interval, ymin<span class="sc">:</span>ymax) <span class="sc">%&gt;%</span> </span>
<span id="cb65-5"><a href="sampling-the-imaginary.html#cb65-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(.width) <span class="sc">%&gt;%</span> </span>
<span id="cb65-6"><a href="sampling-the-imaginary.html#cb65-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate_if</span>(is.double, round, <span class="at">digits =</span> <span class="dv">2</span>)</span></code></pre></div>
<pre><code>##   .width .interval ymin ymax
## 1   0.80       hdi 0.46 0.82
## 2   0.80        qi 0.45 0.81
## 3   0.95       hdi 0.37 0.89
## 4   0.95        qi 0.35 0.88</code></pre>
</div>
<div id="point-estimate" class="section level3 hasAnchor" number="3.2.3">
<h3><span class="header-section-number">3.2.3</span> Point estimate　　<a href="sampling-the-imaginary.html#point-estimate" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>代表値としては、mean, median, modeなどがとれる。<br />
分布がゆがむとこれらの値は大きく違ってくる。</p>
<div class="sourceCode" id="cb67"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb67-1"><a href="sampling-the-imaginary.html#cb67-1" aria-hidden="true" tabindex="-1"></a><span class="co"># binomial(3,3)の例</span></span>
<span id="cb67-2"><a href="sampling-the-imaginary.html#cb67-2" aria-hidden="true" tabindex="-1"></a>samples2 <span class="sc">%&gt;%</span> </span>
<span id="cb67-3"><a href="sampling-the-imaginary.html#cb67-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">mean=</span><span class="fu">mean</span>(p_grid),</span>
<span id="cb67-4"><a href="sampling-the-imaginary.html#cb67-4" aria-hidden="true" tabindex="-1"></a>            <span class="at">median =</span> <span class="fu">median</span>(p_grid),</span>
<span id="cb67-5"><a href="sampling-the-imaginary.html#cb67-5" aria-hidden="true" tabindex="-1"></a>            <span class="at">mode =</span> <span class="fu">Mode</span>(p_grid))</span></code></pre></div>
<pre><code>## # A tibble: 1 × 3
##    mean median  mode
##   &lt;dbl&gt;  &lt;dbl&gt; &lt;dbl&gt;
## 1 0.798  0.840 0.955</code></pre>
<div class="sourceCode" id="cb69"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb69-1"><a href="sampling-the-imaginary.html#cb69-1" aria-hidden="true" tabindex="-1"></a>point_estimates <span class="ot">&lt;-</span></span>
<span id="cb69-2"><a href="sampling-the-imaginary.html#cb69-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">bind_rows</span>(samples2 <span class="sc">%&gt;%</span> <span class="fu">mean_qi</span>(p_grid),</span>
<span id="cb69-3"><a href="sampling-the-imaginary.html#cb69-3" aria-hidden="true" tabindex="-1"></a>            samples2 <span class="sc">%&gt;%</span> <span class="fu">median_qi</span>(p_grid),</span>
<span id="cb69-4"><a href="sampling-the-imaginary.html#cb69-4" aria-hidden="true" tabindex="-1"></a>            samples2 <span class="sc">%&gt;%</span> <span class="fu">mode_qi</span>(p_grid))<span class="sc">%&gt;%</span> </span>
<span id="cb69-5"><a href="sampling-the-imaginary.html#cb69-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(p_grid, .point) <span class="sc">%&gt;%</span>  </span>
<span id="cb69-6"><a href="sampling-the-imaginary.html#cb69-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">x =</span> p_grid <span class="sc">+</span> <span class="fu">c</span>(<span class="sc">-</span>.<span class="dv">03</span>, .<span class="dv">03</span>, <span class="sc">-</span>.<span class="dv">03</span>),</span>
<span id="cb69-7"><a href="sampling-the-imaginary.html#cb69-7" aria-hidden="true" tabindex="-1"></a>         <span class="at">y =</span> <span class="fu">c</span>(.<span class="dv">0005</span>, .<span class="dv">0012</span>, .<span class="dv">002</span>))</span>
<span id="cb69-8"><a href="sampling-the-imaginary.html#cb69-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb69-9"><a href="sampling-the-imaginary.html#cb69-9" aria-hidden="true" tabindex="-1"></a>d2 <span class="sc">%&gt;%</span> </span>
<span id="cb69-10"><a href="sampling-the-imaginary.html#cb69-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> p_grid)) <span class="sc">+</span></span>
<span id="cb69-11"><a href="sampling-the-imaginary.html#cb69-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_area</span>(<span class="fu">aes</span>(<span class="at">y =</span> posterior),</span>
<span id="cb69-12"><a href="sampling-the-imaginary.html#cb69-12" aria-hidden="true" tabindex="-1"></a>            <span class="at">fill =</span> <span class="st">&quot;grey75&quot;</span>) <span class="sc">+</span></span>
<span id="cb69-13"><a href="sampling-the-imaginary.html#cb69-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_vline</span>(<span class="at">xintercept =</span> point_estimates<span class="sc">$</span>p_grid) <span class="sc">+</span></span>
<span id="cb69-14"><a href="sampling-the-imaginary.html#cb69-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_text</span>(<span class="at">data =</span> point_estimates,</span>
<span id="cb69-15"><a href="sampling-the-imaginary.html#cb69-15" aria-hidden="true" tabindex="-1"></a>            <span class="fu">aes</span>(<span class="at">x =</span> x, <span class="at">y =</span> y, <span class="at">label =</span> .point),</span>
<span id="cb69-16"><a href="sampling-the-imaginary.html#cb69-16" aria-hidden="true" tabindex="-1"></a>            <span class="at">angle =</span> <span class="dv">90</span>)</span></code></pre></div>
<p><img src="Rethinking_Bookdown_files/figure-html/unnamed-chunk-31-1.png" width="672" style="display: block; margin: auto;" /></p>
<p>代表値を求める手法として、損失関数を最も小さくするような値を考えるとよい。<br />
損失関数を最小にする代表値を選ぶとき、偏差平方和を最小にするのは<strong>平均値</strong>で、絶対偏差和を最小にするのが<strong>中央値</strong>である。</p>
<div class="sourceCode" id="cb70"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb70-1"><a href="sampling-the-imaginary.html#cb70-1" aria-hidden="true" tabindex="-1"></a><span class="co"># 絶対偏差和の合計</span></span>
<span id="cb70-2"><a href="sampling-the-imaginary.html#cb70-2" aria-hidden="true" tabindex="-1"></a>make_loss <span class="ot">&lt;-</span> <span class="cf">function</span>(our_d) {</span>
<span id="cb70-3"><a href="sampling-the-imaginary.html#cb70-3" aria-hidden="true" tabindex="-1"></a>  d2 <span class="sc">%&gt;%</span> </span>
<span id="cb70-4"><a href="sampling-the-imaginary.html#cb70-4" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(<span class="at">loss =</span> posterior <span class="sc">*</span> <span class="fu">abs</span>(our_d <span class="sc">-</span> p_grid)) <span class="sc">%&gt;%</span> </span>
<span id="cb70-5"><a href="sampling-the-imaginary.html#cb70-5" aria-hidden="true" tabindex="-1"></a>    <span class="fu">summarise</span>(<span class="at">weighted_average_loss =</span> <span class="fu">sum</span>(loss))</span>
<span id="cb70-6"><a href="sampling-the-imaginary.html#cb70-6" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb70-7"><a href="sampling-the-imaginary.html#cb70-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb70-8"><a href="sampling-the-imaginary.html#cb70-8" aria-hidden="true" tabindex="-1"></a>l <span class="ot">&lt;-</span> </span>
<span id="cb70-9"><a href="sampling-the-imaginary.html#cb70-9" aria-hidden="true" tabindex="-1"></a>  d2 <span class="sc">%&gt;%</span> </span>
<span id="cb70-10"><a href="sampling-the-imaginary.html#cb70-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(p_grid) <span class="sc">%&gt;%</span> </span>
<span id="cb70-11"><a href="sampling-the-imaginary.html#cb70-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rename</span>(<span class="at">decision =</span> p_grid) <span class="sc">%&gt;%</span> </span>
<span id="cb70-12"><a href="sampling-the-imaginary.html#cb70-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">weighted_average_loss =</span> purrr<span class="sc">::</span><span class="fu">map</span>(decision, make_loss)) <span class="sc">%&gt;%</span> </span>
<span id="cb70-13"><a href="sampling-the-imaginary.html#cb70-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">unnest</span>(weighted_average_loss)</span>
<span id="cb70-14"><a href="sampling-the-imaginary.html#cb70-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb70-15"><a href="sampling-the-imaginary.html#cb70-15" aria-hidden="true" tabindex="-1"></a>min_loss <span class="ot">&lt;-</span></span>
<span id="cb70-16"><a href="sampling-the-imaginary.html#cb70-16" aria-hidden="true" tabindex="-1"></a>  l <span class="sc">%&gt;%</span> </span>
<span id="cb70-17"><a href="sampling-the-imaginary.html#cb70-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(weighted_average_loss <span class="sc">==</span> <span class="fu">min</span>(weighted_average_loss)) <span class="sc">%&gt;%</span> </span>
<span id="cb70-18"><a href="sampling-the-imaginary.html#cb70-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">as.numeric</span>()</span>
<span id="cb70-19"><a href="sampling-the-imaginary.html#cb70-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb70-20"><a href="sampling-the-imaginary.html#cb70-20" aria-hidden="true" tabindex="-1"></a>l <span class="sc">%&gt;%</span>   </span>
<span id="cb70-21"><a href="sampling-the-imaginary.html#cb70-21" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> decision, <span class="at">y =</span> weighted_average_loss)) <span class="sc">+</span></span>
<span id="cb70-22"><a href="sampling-the-imaginary.html#cb70-22" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_area</span>(<span class="at">fill =</span> <span class="st">&quot;grey75&quot;</span>) <span class="sc">+</span></span>
<span id="cb70-23"><a href="sampling-the-imaginary.html#cb70-23" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_vline</span>(<span class="at">xintercept =</span> min_loss[<span class="dv">1</span>], <span class="at">color =</span> <span class="st">&quot;white&quot;</span>, <span class="at">linetype =</span> <span class="dv">3</span>) <span class="sc">+</span></span>
<span id="cb70-24"><a href="sampling-the-imaginary.html#cb70-24" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_hline</span>(<span class="at">yintercept =</span> min_loss[<span class="dv">2</span>], <span class="at">color =</span> <span class="st">&quot;white&quot;</span>, <span class="at">linetype =</span> <span class="dv">3</span>) <span class="sc">+</span></span>
<span id="cb70-25"><a href="sampling-the-imaginary.html#cb70-25" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylab</span>(<span class="st">&quot;expected proportional loss&quot;</span>) <span class="sc">+</span></span>
<span id="cb70-26"><a href="sampling-the-imaginary.html#cb70-26" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">panel.grid =</span> <span class="fu">element_blank</span>())</span></code></pre></div>
<p><img src="Rethinking_Bookdown_files/figure-html/unnamed-chunk-32-1.png" width="672" style="display: block; margin: auto;" /></p>
<p><br /></p>
</div>
</div>
<div id="sampling-to-simulate-prediction" class="section level2 hasAnchor" number="3.3">
<h2><span class="header-section-number">3.3</span> Sampling to simulate prediction<a href="sampling-the-imaginary.html#sampling-to-simulate-prediction" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>事後分布からのサンプリングを用いてシミュレーションを行う。<br />
まずは、rbinomの使い方をマスターする。</p>
<div class="sourceCode" id="cb71"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb71-1"><a href="sampling-the-imaginary.html#cb71-1" aria-hidden="true" tabindex="-1"></a>dummy <span class="ot">&lt;-</span> <span class="fu">rbinom</span>(<span class="fl">1e5</span>,<span class="at">size =</span><span class="dv">2</span>,<span class="at">prob=</span><span class="fl">0.7</span>)</span>
<span id="cb71-2"><a href="sampling-the-imaginary.html#cb71-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb71-3"><a href="sampling-the-imaginary.html#cb71-3" aria-hidden="true" tabindex="-1"></a><span class="fu">tibble</span>(<span class="at">n_W =</span> dummy) <span class="sc">%&gt;%</span> </span>
<span id="cb71-4"><a href="sampling-the-imaginary.html#cb71-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(n_W) <span class="sc">%&gt;%</span> </span>
<span id="cb71-5"><a href="sampling-the-imaginary.html#cb71-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">count</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb71-6"><a href="sampling-the-imaginary.html#cb71-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">prop =</span> n<span class="sc">/</span><span class="fl">1e5</span>)</span></code></pre></div>
<pre><code>## # A tibble: 3 × 3
## # Groups:   n_W [3]
##     n_W     n   prop
##   &lt;int&gt; &lt;int&gt;  &lt;dbl&gt;
## 1     0  9006 0.0901
## 2     1 41696 0.417 
## 3     2 49298 0.493</code></pre>
<div class="sourceCode" id="cb73"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb73-1"><a href="sampling-the-imaginary.html#cb73-1" aria-hidden="true" tabindex="-1"></a><span class="co"># size = 9</span></span>
<span id="cb73-2"><a href="sampling-the-imaginary.html#cb73-2" aria-hidden="true" tabindex="-1"></a>dummy <span class="ot">&lt;-</span> <span class="fu">rbinom</span>(<span class="fl">1e5</span>, <span class="at">size =</span><span class="dv">9</span>, <span class="at">prob =</span> <span class="fl">0.7</span>)</span>
<span id="cb73-3"><a href="sampling-the-imaginary.html#cb73-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb73-4"><a href="sampling-the-imaginary.html#cb73-4" aria-hidden="true" tabindex="-1"></a>d_3 <span class="ot">&lt;-</span>  <span class="fu">tibble</span>(<span class="at">draws =</span> dummy) </span>
<span id="cb73-5"><a href="sampling-the-imaginary.html#cb73-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb73-6"><a href="sampling-the-imaginary.html#cb73-6" aria-hidden="true" tabindex="-1"></a>d_3 <span class="sc">%&gt;%</span> </span>
<span id="cb73-7"><a href="sampling-the-imaginary.html#cb73-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x=</span>draws))<span class="sc">+</span></span>
<span id="cb73-8"><a href="sampling-the-imaginary.html#cb73-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_histogram</span>(<span class="at">binwidth =</span><span class="fl">0.2</span>, <span class="at">center =</span> <span class="dv">0</span>,</span>
<span id="cb73-9"><a href="sampling-the-imaginary.html#cb73-9" aria-hidden="true" tabindex="-1"></a>                 <span class="at">color =</span> <span class="st">&quot;grey92&quot;</span>, <span class="at">size =</span> <span class="dv">1</span><span class="sc">/</span><span class="dv">10</span>)<span class="sc">+</span></span>
<span id="cb73-10"><a href="sampling-the-imaginary.html#cb73-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="st">&quot;frequency&quot;</span>,</span>
<span id="cb73-11"><a href="sampling-the-imaginary.html#cb73-11" aria-hidden="true" tabindex="-1"></a>                     <span class="at">breaks =</span> <span class="fu">seq</span>(<span class="dv">0</span>,<span class="dv">25000</span>,<span class="dv">5000</span>))<span class="sc">+</span></span>
<span id="cb73-12"><a href="sampling-the-imaginary.html#cb73-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_continuous</span>(<span class="st">&quot;dummy water count&quot;</span>,</span>
<span id="cb73-13"><a href="sampling-the-imaginary.html#cb73-13" aria-hidden="true" tabindex="-1"></a>                     <span class="at">breaks =</span> <span class="fu">seq</span>(<span class="dv">0</span>,<span class="dv">9</span>,<span class="dv">2</span>))<span class="sc">+</span></span>
<span id="cb73-14"><a href="sampling-the-imaginary.html#cb73-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">text=</span><span class="fu">element_text</span>(<span class="at">size=</span><span class="dv">15</span>))<span class="sc">+</span></span>
<span id="cb73-15"><a href="sampling-the-imaginary.html#cb73-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">coord_cartesian</span>(<span class="at">xlim=</span><span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">9</span>))<span class="sc">+</span></span>
<span id="cb73-16"><a href="sampling-the-imaginary.html#cb73-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_classic</span>()</span></code></pre></div>
<p><img src="Rethinking_Bookdown_files/figure-html/unnamed-chunk-33-1.png" width="672" style="display: block; margin: auto;" /></p>
<div class="sourceCode" id="cb74"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb74-1"><a href="sampling-the-imaginary.html#cb74-1" aria-hidden="true" tabindex="-1"></a><span class="co"># 色々試してみる</span></span>
<span id="cb74-2"><a href="sampling-the-imaginary.html#cb74-2" aria-hidden="true" tabindex="-1"></a>n_draws <span class="ot">&lt;-</span> <span class="fl">1e5</span></span>
<span id="cb74-3"><a href="sampling-the-imaginary.html#cb74-3" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb74-4"><a href="sampling-the-imaginary.html#cb74-4" aria-hidden="true" tabindex="-1"></a>simulate_binom <span class="ot">&lt;-</span> <span class="cf">function</span>(n, probability){</span>
<span id="cb74-5"><a href="sampling-the-imaginary.html#cb74-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">set.seed</span>(<span class="dv">3</span>)</span>
<span id="cb74-6"><a href="sampling-the-imaginary.html#cb74-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rbinom</span>(n_draws, <span class="at">size =</span>n, <span class="at">prob =</span> probability)</span>
<span id="cb74-7"><a href="sampling-the-imaginary.html#cb74-7" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb74-8"><a href="sampling-the-imaginary.html#cb74-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb74-9"><a href="sampling-the-imaginary.html#cb74-9" aria-hidden="true" tabindex="-1"></a>d_4 <span class="ot">&lt;-</span> </span>
<span id="cb74-10"><a href="sampling-the-imaginary.html#cb74-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">crossing</span>(<span class="at">n =</span> <span class="fu">c</span>(<span class="dv">3</span>,<span class="dv">6</span>,<span class="dv">9</span>),</span>
<span id="cb74-11"><a href="sampling-the-imaginary.html#cb74-11" aria-hidden="true" tabindex="-1"></a>          <span class="at">probability =</span> <span class="fu">c</span>(.<span class="dv">3</span>,.<span class="dv">6</span>,.<span class="dv">9</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb74-12"><a href="sampling-the-imaginary.html#cb74-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">draws =</span> <span class="fu">map2</span>(n, probability, simulate_binom)) <span class="sc">%&gt;%</span> </span>
<span id="cb74-13"><a href="sampling-the-imaginary.html#cb74-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ungroup</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb74-14"><a href="sampling-the-imaginary.html#cb74-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">n=</span> <span class="fu">str_c</span>(<span class="st">&quot;n = &quot;</span>, n),</span>
<span id="cb74-15"><a href="sampling-the-imaginary.html#cb74-15" aria-hidden="true" tabindex="-1"></a>         <span class="at">probability =</span> <span class="fu">str_c</span>(<span class="st">&quot;p = &quot;</span>, probability)) <span class="sc">%&gt;%</span> </span>
<span id="cb74-16"><a href="sampling-the-imaginary.html#cb74-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">unnest</span>(draws)</span>
<span id="cb74-17"><a href="sampling-the-imaginary.html#cb74-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb74-18"><a href="sampling-the-imaginary.html#cb74-18" aria-hidden="true" tabindex="-1"></a>d_4 <span class="sc">%&gt;%</span> </span>
<span id="cb74-19"><a href="sampling-the-imaginary.html#cb74-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x=</span>draws))<span class="sc">+</span></span>
<span id="cb74-20"><a href="sampling-the-imaginary.html#cb74-20" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_histogram</span>(<span class="at">binwidth =</span> <span class="dv">1</span>, <span class="at">color=</span><span class="st">&quot;grey92&quot;</span>,</span>
<span id="cb74-21"><a href="sampling-the-imaginary.html#cb74-21" aria-hidden="true" tabindex="-1"></a>                 <span class="at">size =</span> <span class="dv">1</span><span class="sc">/</span><span class="dv">10</span>, <span class="at">center =</span><span class="dv">0</span>)<span class="sc">+</span></span>
<span id="cb74-22"><a href="sampling-the-imaginary.html#cb74-22" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_continuous</span>(<span class="st">&quot;dummy water count&quot;</span>,</span>
<span id="cb74-23"><a href="sampling-the-imaginary.html#cb74-23" aria-hidden="true" tabindex="-1"></a>                     <span class="at">breaks =</span> <span class="fu">seq</span>(<span class="at">from =</span> <span class="dv">0</span>, <span class="at">to =</span> <span class="dv">9</span>, <span class="at">by =</span> <span class="dv">1</span>))<span class="sc">+</span></span>
<span id="cb74-24"><a href="sampling-the-imaginary.html#cb74-24" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylab</span>(<span class="st">&quot;frequency&quot;</span>)<span class="sc">+</span></span>
<span id="cb74-25"><a href="sampling-the-imaginary.html#cb74-25" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">panel.grid =</span> <span class="fu">element_blank</span>())<span class="sc">+</span></span>
<span id="cb74-26"><a href="sampling-the-imaginary.html#cb74-26" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_grid</span>(n<span class="sc">~</span>probability)</span></code></pre></div>
<p><img src="Rethinking_Bookdown_files/figure-html/unnamed-chunk-33-2.png" width="672" style="display: block; margin: auto;" /></p>
<div id="model-checking" class="section level3 hasAnchor" number="3.3.1">
<h3><span class="header-section-number">3.3.1</span> Model checking<a href="sampling-the-imaginary.html#model-checking" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>試行間の相関などがシミュレーションと比較して大きくないかなどを見ることで、モデルチェックを行うことができる。</p>
<div class="sourceCode" id="cb75"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb75-1"><a href="sampling-the-imaginary.html#cb75-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">123</span>)</span>
<span id="cb75-2"><a href="sampling-the-imaginary.html#cb75-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb75-3"><a href="sampling-the-imaginary.html#cb75-3" aria-hidden="true" tabindex="-1"></a>samples <span class="ot">&lt;-</span> </span>
<span id="cb75-4"><a href="sampling-the-imaginary.html#cb75-4" aria-hidden="true" tabindex="-1"></a>  d <span class="sc">%&gt;%</span> </span>
<span id="cb75-5"><a href="sampling-the-imaginary.html#cb75-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">slice_sample</span>(<span class="at">n=</span>n_samples, <span class="at">weight_by =</span> posterior,</span>
<span id="cb75-6"><a href="sampling-the-imaginary.html#cb75-6" aria-hidden="true" tabindex="-1"></a>               <span class="at">replace=</span><span class="cn">TRUE</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb75-7"><a href="sampling-the-imaginary.html#cb75-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">W =</span> <span class="fu">map_dbl</span>(p_grid, rbinom, <span class="at">n =</span><span class="dv">1</span>, <span class="at">size=</span><span class="dv">9</span>))</span>
<span id="cb75-8"><a href="sampling-the-imaginary.html#cb75-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb75-9"><a href="sampling-the-imaginary.html#cb75-9" aria-hidden="true" tabindex="-1"></a>samples <span class="sc">%&gt;%</span> </span>
<span id="cb75-10"><a href="sampling-the-imaginary.html#cb75-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x=</span>W))<span class="sc">+</span></span>
<span id="cb75-11"><a href="sampling-the-imaginary.html#cb75-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_histogram</span>(<span class="at">binwidth =</span><span class="fl">0.2</span>, <span class="at">size=</span><span class="dv">1</span><span class="sc">/</span><span class="dv">10</span>,</span>
<span id="cb75-12"><a href="sampling-the-imaginary.html#cb75-12" aria-hidden="true" tabindex="-1"></a>                 <span class="at">color =</span> <span class="st">&quot;grey92&quot;</span>,<span class="at">center=</span><span class="dv">0</span>)<span class="sc">+</span></span>
<span id="cb75-13"><a href="sampling-the-imaginary.html#cb75-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_continuous</span>(<span class="st">&quot;number of water samples&quot;</span>,</span>
<span id="cb75-14"><a href="sampling-the-imaginary.html#cb75-14" aria-hidden="true" tabindex="-1"></a>                     <span class="at">breaks =</span> <span class="fu">seq</span>(<span class="dv">0</span>,<span class="dv">9</span>,<span class="dv">3</span>))<span class="sc">+</span></span>
<span id="cb75-15"><a href="sampling-the-imaginary.html#cb75-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">text =</span> <span class="fu">element_text</span>(<span class="at">size=</span><span class="dv">18</span>))<span class="sc">+</span></span>
<span id="cb75-16"><a href="sampling-the-imaginary.html#cb75-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="cn">NULL</span>, <span class="at">breaks=</span><span class="cn">NULL</span>)<span class="sc">+</span></span>
<span id="cb75-17"><a href="sampling-the-imaginary.html#cb75-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_bw</span>()</span></code></pre></div>
<p><img src="Rethinking_Bookdown_files/figure-html/unnamed-chunk-34-1.png" width="672" style="display: block; margin: auto;" /></p>
<div class="sourceCode" id="cb76"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb76-1"><a href="sampling-the-imaginary.html#cb76-1" aria-hidden="true" tabindex="-1"></a><span class="do">## 試行間の相関を確認</span></span>
<span id="cb76-2"><a href="sampling-the-imaginary.html#cb76-2" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">123</span>)</span>
<span id="cb76-3"><a href="sampling-the-imaginary.html#cb76-3" aria-hidden="true" tabindex="-1"></a>samples_2 <span class="ot">&lt;-</span> </span>
<span id="cb76-4"><a href="sampling-the-imaginary.html#cb76-4" aria-hidden="true" tabindex="-1"></a>  samples <span class="sc">%&gt;%</span> </span>
<span id="cb76-5"><a href="sampling-the-imaginary.html#cb76-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">iter =</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">n</span>(),</span>
<span id="cb76-6"><a href="sampling-the-imaginary.html#cb76-6" aria-hidden="true" tabindex="-1"></a>         <span class="at">draws =</span> purrr<span class="sc">::</span><span class="fu">map</span>(p_grid, rbinom,<span class="at">n=</span><span class="dv">9</span>,<span class="at">size=</span><span class="dv">1</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb76-7"><a href="sampling-the-imaginary.html#cb76-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">unnest</span>(draws)</span>
<span id="cb76-8"><a href="sampling-the-imaginary.html#cb76-8" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb76-9"><a href="sampling-the-imaginary.html#cb76-9" aria-hidden="true" tabindex="-1"></a><span class="do">## 連続回数</span></span>
<span id="cb76-10"><a href="sampling-the-imaginary.html#cb76-10" aria-hidden="true" tabindex="-1"></a>samples_2 <span class="sc">%&gt;%</span> </span>
<span id="cb76-11"><a href="sampling-the-imaginary.html#cb76-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(iter) <span class="sc">%&gt;%</span> </span>
<span id="cb76-12"><a href="sampling-the-imaginary.html#cb76-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">longest =</span> <span class="fu">rle</span>(draws)<span class="sc">$</span>length <span class="sc">%&gt;%</span> <span class="fu">max</span>()) <span class="sc">%&gt;%</span> </span>
<span id="cb76-13"><a href="sampling-the-imaginary.html#cb76-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x=</span>longest))<span class="sc">+</span></span>
<span id="cb76-14"><a href="sampling-the-imaginary.html#cb76-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_histogram</span>(<span class="fu">aes</span>(<span class="at">fill =</span> longest <span class="sc">==</span><span class="dv">3</span>),</span>
<span id="cb76-15"><a href="sampling-the-imaginary.html#cb76-15" aria-hidden="true" tabindex="-1"></a>                 <span class="at">binwidth =</span> <span class="fl">0.2</span>, <span class="at">center=</span><span class="dv">0</span>,</span>
<span id="cb76-16"><a href="sampling-the-imaginary.html#cb76-16" aria-hidden="true" tabindex="-1"></a>                 <span class="at">color=</span><span class="st">&quot;grey92&quot;</span>)<span class="sc">+</span></span>
<span id="cb76-17"><a href="sampling-the-imaginary.html#cb76-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_bw</span>()<span class="sc">+</span></span>
<span id="cb76-18"><a href="sampling-the-imaginary.html#cb76-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">&quot;none&quot;</span>,)<span class="sc">+</span></span>
<span id="cb76-19"><a href="sampling-the-imaginary.html#cb76-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="cn">NULL</span>, <span class="at">breaks =</span> <span class="cn">NULL</span>)</span></code></pre></div>
<p><img src="Rethinking_Bookdown_files/figure-html/unnamed-chunk-34-2.png" width="672" style="display: block; margin: auto;" /></p>
<div class="sourceCode" id="cb77"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb77-1"><a href="sampling-the-imaginary.html#cb77-1" aria-hidden="true" tabindex="-1"></a>samples_2 <span class="sc">%&gt;%</span> </span>
<span id="cb77-2"><a href="sampling-the-imaginary.html#cb77-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(iter) <span class="sc">%&gt;%</span> </span>
<span id="cb77-3"><a href="sampling-the-imaginary.html#cb77-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">longest =</span> <span class="fu">rle</span>(draws)<span class="sc">$</span>lengths <span class="sc">%&gt;%</span> <span class="fu">length</span>()) <span class="sc">%&gt;%</span> </span>
<span id="cb77-4"><a href="sampling-the-imaginary.html#cb77-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x=</span>longest))<span class="sc">+</span></span>
<span id="cb77-5"><a href="sampling-the-imaginary.html#cb77-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_histogram</span>(<span class="fu">aes</span>(<span class="at">fill =</span> longest <span class="sc">==</span><span class="dv">7</span>),</span>
<span id="cb77-6"><a href="sampling-the-imaginary.html#cb77-6" aria-hidden="true" tabindex="-1"></a>                 <span class="at">binwidth =</span> <span class="fl">0.2</span>, <span class="at">center=</span><span class="dv">0</span>,</span>
<span id="cb77-7"><a href="sampling-the-imaginary.html#cb77-7" aria-hidden="true" tabindex="-1"></a>                 <span class="at">color=</span><span class="st">&quot;grey92&quot;</span>)<span class="sc">+</span></span>
<span id="cb77-8"><a href="sampling-the-imaginary.html#cb77-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_bw</span>()<span class="sc">+</span></span>
<span id="cb77-9"><a href="sampling-the-imaginary.html#cb77-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">&quot;none&quot;</span>,)<span class="sc">+</span></span>
<span id="cb77-10"><a href="sampling-the-imaginary.html#cb77-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="cn">NULL</span>, <span class="at">breaks =</span> <span class="cn">NULL</span>)</span></code></pre></div>
<p><img src="Rethinking_Bookdown_files/figure-html/unnamed-chunk-34-3.png" width="672" style="display: block; margin: auto;" /></p>
</div>
<div id="practice-with-brms" class="section level3 hasAnchor" number="3.3.2">
<h3><span class="header-section-number">3.3.2</span> Practice with brms<a href="sampling-the-imaginary.html#practice-with-brms" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<div class="sourceCode" id="cb78"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb78-1"><a href="sampling-the-imaginary.html#cb78-1" aria-hidden="true" tabindex="-1"></a>b3<span class="fl">.1</span> <span class="ot">&lt;-</span></span>
<span id="cb78-2"><a href="sampling-the-imaginary.html#cb78-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">brm</span>(<span class="at">data=</span><span class="fu">list</span>(<span class="at">W=</span><span class="dv">6</span>),</span>
<span id="cb78-3"><a href="sampling-the-imaginary.html#cb78-3" aria-hidden="true" tabindex="-1"></a>      <span class="at">family =</span> <span class="fu">binomial</span>(<span class="at">link=</span><span class="st">&quot;identity&quot;</span>),</span>
<span id="cb78-4"><a href="sampling-the-imaginary.html#cb78-4" aria-hidden="true" tabindex="-1"></a>      <span class="at">formula =</span> W<span class="sc">|</span><span class="fu">trials</span>(<span class="dv">9</span>) <span class="sc">~</span> <span class="dv">0</span><span class="sc">+</span>Intercept,</span>
<span id="cb78-5"><a href="sampling-the-imaginary.html#cb78-5" aria-hidden="true" tabindex="-1"></a>      <span class="fu">prior</span>(<span class="st">&quot;&quot;</span>, <span class="at">class=</span>b, <span class="at">lb =</span> <span class="dv">0</span>, <span class="at">ub=</span><span class="dv">1</span>),</span>
<span id="cb78-6"><a href="sampling-the-imaginary.html#cb78-6" aria-hidden="true" tabindex="-1"></a>      <span class="at">iter =</span> <span class="dv">5000</span>, <span class="at">warmup=</span><span class="dv">1000</span>,</span>
<span id="cb78-7"><a href="sampling-the-imaginary.html#cb78-7" aria-hidden="true" tabindex="-1"></a>      <span class="at">chains =</span> <span class="dv">4</span>,</span>
<span id="cb78-8"><a href="sampling-the-imaginary.html#cb78-8" aria-hidden="true" tabindex="-1"></a>      <span class="at">backend =</span> <span class="st">&quot;cmdstanr&quot;</span>,</span>
<span id="cb78-9"><a href="sampling-the-imaginary.html#cb78-9" aria-hidden="true" tabindex="-1"></a>      <span class="at">file =</span> <span class="st">&quot;output/Chapter3/b3.1&quot;</span>,</span>
<span id="cb78-10"><a href="sampling-the-imaginary.html#cb78-10" aria-hidden="true" tabindex="-1"></a>      <span class="at">seed =</span> <span class="dv">123</span>)</span>
<span id="cb78-11"><a href="sampling-the-imaginary.html#cb78-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb78-12"><a href="sampling-the-imaginary.html#cb78-12" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(b3<span class="fl">.1</span>)</span></code></pre></div>
<pre><code>##  Family: binomial 
##   Links: mu = identity 
## Formula: W | trials(9) ~ 0 + Intercept 
##    Data: list(W = 6) (Number of observations: 1) 
##   Draws: 4 chains, each with iter = 5000; warmup = 1000; thin = 1;
##          total post-warmup draws = 16000
## 
## Population-Level Effects: 
##           Estimate Est.Error l-95% CI u-95% CI Rhat Bulk_ESS Tail_ESS
## Intercept     0.64      0.14     0.34     0.88 1.00     6091     6584
## 
## Draws were sampled using sample(hmc). For each parameter, Bulk_ESS
## and Tail_ESS are effective sample size measures, and Rhat is the potential
## scale reduction factor on split chains (at convergence, Rhat = 1).</code></pre>
<div class="sourceCode" id="cb80"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb80-1"><a href="sampling-the-imaginary.html#cb80-1" aria-hidden="true" tabindex="-1"></a>p <span class="ot">&lt;-</span> <span class="fu">posterior_samples</span>(b3<span class="fl">.1</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb80-2"><a href="sampling-the-imaginary.html#cb80-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">as_tibble</span>()</span>
<span id="cb80-3"><a href="sampling-the-imaginary.html#cb80-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb80-4"><a href="sampling-the-imaginary.html#cb80-4" aria-hidden="true" tabindex="-1"></a>p <span class="sc">%&gt;%</span> </span>
<span id="cb80-5"><a href="sampling-the-imaginary.html#cb80-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x=</span>b_Intercept))<span class="sc">+</span></span>
<span id="cb80-6"><a href="sampling-the-imaginary.html#cb80-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_density</span>()</span></code></pre></div>
<p><img src="Rethinking_Bookdown_files/figure-html/unnamed-chunk-35-1.png" width="672" style="display: block; margin: auto;" /></p>
<div class="sourceCode" id="cb81"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb81-1"><a href="sampling-the-imaginary.html#cb81-1" aria-hidden="true" tabindex="-1"></a>p <span class="ot">&lt;-</span></span>
<span id="cb81-2"><a href="sampling-the-imaginary.html#cb81-2" aria-hidden="true" tabindex="-1"></a>  p <span class="sc">%&gt;%</span> </span>
<span id="cb81-3"><a href="sampling-the-imaginary.html#cb81-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">W =</span> <span class="fu">rbinom</span>(<span class="fu">n</span>(),<span class="at">size=</span>n_trials, <span class="at">prob=</span>b_Intercept)) </span>
<span id="cb81-4"><a href="sampling-the-imaginary.html#cb81-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb81-5"><a href="sampling-the-imaginary.html#cb81-5" aria-hidden="true" tabindex="-1"></a>p <span class="sc">%&gt;%</span> </span>
<span id="cb81-6"><a href="sampling-the-imaginary.html#cb81-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x=</span>W))<span class="sc">+</span></span>
<span id="cb81-7"><a href="sampling-the-imaginary.html#cb81-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_histogram</span>(<span class="at">binwidth=</span><span class="fl">0.2</span>)</span></code></pre></div>
<p><img src="Rethinking_Bookdown_files/figure-html/unnamed-chunk-35-2.png" width="672" style="display: block; margin: auto;" /></p>
</div>
</div>
<div id="practice-1" class="section level2 hasAnchor" number="3.4">
<h2><span class="header-section-number">3.4</span> Practice<a href="sampling-the-imaginary.html#practice-1" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<div id="e" class="section level3 hasAnchor" number="3.4.1">
<h3><span class="header-section-number">3.4.1</span> 3E<a href="sampling-the-imaginary.html#e" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<blockquote>
<p>he Easy problems use the sample from the posterior distribution for the globe tossing example. The code will give you a specific set of samples, so that you can check your answers exactly.</p>
</blockquote>
<div class="sourceCode" id="cb82"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb82-1"><a href="sampling-the-imaginary.html#cb82-1" aria-hidden="true" tabindex="-1"></a>p_grid <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="at">from =</span> <span class="dv">0</span>, <span class="at">to =</span> <span class="dv">1</span>, <span class="at">length.out =</span> <span class="dv">1000</span>)</span>
<span id="cb82-2"><a href="sampling-the-imaginary.html#cb82-2" aria-hidden="true" tabindex="-1"></a>prior <span class="ot">&lt;-</span> <span class="fu">rep</span>(<span class="dv">1</span>, <span class="dv">1000</span>)</span>
<span id="cb82-3"><a href="sampling-the-imaginary.html#cb82-3" aria-hidden="true" tabindex="-1"></a>likelihood <span class="ot">&lt;-</span> <span class="fu">dbinom</span>(<span class="dv">6</span>, <span class="at">size =</span> <span class="dv">9</span>, <span class="at">prob =</span> p_grid)</span>
<span id="cb82-4"><a href="sampling-the-imaginary.html#cb82-4" aria-hidden="true" tabindex="-1"></a>posterior <span class="ot">&lt;-</span> likelihood <span class="sc">*</span> prior</span>
<span id="cb82-5"><a href="sampling-the-imaginary.html#cb82-5" aria-hidden="true" tabindex="-1"></a>posterior <span class="ot">&lt;-</span> posterior <span class="sc">/</span> <span class="fu">sum</span>(posterior)</span>
<span id="cb82-6"><a href="sampling-the-imaginary.html#cb82-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb82-7"><a href="sampling-the-imaginary.html#cb82-7" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">100</span>)</span>
<span id="cb82-8"><a href="sampling-the-imaginary.html#cb82-8" aria-hidden="true" tabindex="-1"></a>samples <span class="ot">&lt;-</span> <span class="fu">sample</span>(p_grid, <span class="at">prob =</span> posterior, <span class="at">size =</span> <span class="fl">1e4</span>, <span class="at">replace =</span> <span class="cn">TRUE</span>)</span></code></pre></div>
<blockquote>
<p>Use the values in samples to answer the questions that follow.</p>
</blockquote>
<div class="sourceCode" id="cb83"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb83-1"><a href="sampling-the-imaginary.html#cb83-1" aria-hidden="true" tabindex="-1"></a><span class="co"># 1</span></span>
<span id="cb83-2"><a href="sampling-the-imaginary.html#cb83-2" aria-hidden="true" tabindex="-1"></a><span class="fu">mean</span>(samples <span class="sc">&lt;</span> <span class="fl">0.2</span>)</span></code></pre></div>
<pre><code>## [1] 4e-04</code></pre>
<div class="sourceCode" id="cb85"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb85-1"><a href="sampling-the-imaginary.html#cb85-1" aria-hidden="true" tabindex="-1"></a><span class="co"># 2</span></span>
<span id="cb85-2"><a href="sampling-the-imaginary.html#cb85-2" aria-hidden="true" tabindex="-1"></a><span class="fu">mean</span>(samples <span class="sc">&gt;</span> <span class="fl">0.8</span>)</span></code></pre></div>
<pre><code>## [1] 0.1116</code></pre>
<div class="sourceCode" id="cb87"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb87-1"><a href="sampling-the-imaginary.html#cb87-1" aria-hidden="true" tabindex="-1"></a><span class="co"># 3</span></span>
<span id="cb87-2"><a href="sampling-the-imaginary.html#cb87-2" aria-hidden="true" tabindex="-1"></a><span class="fu">mean</span>(<span class="fu">between</span>(samples,<span class="fl">0.2</span>,<span class="fl">0.8</span>))</span></code></pre></div>
<pre><code>## [1] 0.888</code></pre>
<div class="sourceCode" id="cb89"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb89-1"><a href="sampling-the-imaginary.html#cb89-1" aria-hidden="true" tabindex="-1"></a><span class="co"># 4</span></span>
<span id="cb89-2"><a href="sampling-the-imaginary.html#cb89-2" aria-hidden="true" tabindex="-1"></a><span class="fu">quantile</span>(samples,<span class="at">prob=</span><span class="fl">0.2</span>)</span></code></pre></div>
<pre><code>##       20% 
## 0.5185185</code></pre>
<div class="sourceCode" id="cb91"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb91-1"><a href="sampling-the-imaginary.html#cb91-1" aria-hidden="true" tabindex="-1"></a><span class="co"># 5</span></span>
<span id="cb91-2"><a href="sampling-the-imaginary.html#cb91-2" aria-hidden="true" tabindex="-1"></a><span class="fu">quantile</span>(samples,<span class="at">prob=</span><span class="fl">0.8</span>)</span></code></pre></div>
<pre><code>##       80% 
## 0.7557558</code></pre>
<div class="sourceCode" id="cb93"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb93-1"><a href="sampling-the-imaginary.html#cb93-1" aria-hidden="true" tabindex="-1"></a><span class="co"># 6</span></span>
<span id="cb93-2"><a href="sampling-the-imaginary.html#cb93-2" aria-hidden="true" tabindex="-1"></a><span class="fu">hdi</span>(samples, <span class="fl">0.66</span>)</span></code></pre></div>
<pre><code>##           [,1]      [,2]
## [1,] 0.5085085 0.7737738</code></pre>
<div class="sourceCode" id="cb95"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb95-1"><a href="sampling-the-imaginary.html#cb95-1" aria-hidden="true" tabindex="-1"></a><span class="co"># 7</span></span>
<span id="cb95-2"><a href="sampling-the-imaginary.html#cb95-2" aria-hidden="true" tabindex="-1"></a><span class="fu">qi</span>(samples, <span class="fl">0.66</span>)</span></code></pre></div>
<pre><code>##           [,1]      [,2]
## [1,] 0.5025025 0.7697698</code></pre>
</div>
<div id="m" class="section level3 hasAnchor" number="3.4.2">
<h3><span class="header-section-number">3.4.2</span> 3M<a href="sampling-the-imaginary.html#m" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<div id="m1-1" class="section level4 hasAnchor" number="3.4.2.1">
<h4><span class="header-section-number">3.4.2.1</span> 3M1<a href="sampling-the-imaginary.html#m1-1" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<blockquote>
<p>Suppose the globe tossing data had turned out to be 8 water in 15 tosses. Constructe the posterior distribution, using grid approximation. Use the same flat prior as before.</p>
</blockquote>
<div class="sourceCode" id="cb97"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb97-1"><a href="sampling-the-imaginary.html#cb97-1" aria-hidden="true" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="dv">1000</span></span>
<span id="cb97-2"><a href="sampling-the-imaginary.html#cb97-2" aria-hidden="true" tabindex="-1"></a>n_trials <span class="ot">&lt;-</span> <span class="dv">15</span></span>
<span id="cb97-3"><a href="sampling-the-imaginary.html#cb97-3" aria-hidden="true" tabindex="-1"></a>n_success <span class="ot">&lt;-</span> <span class="dv">8</span></span>
<span id="cb97-4"><a href="sampling-the-imaginary.html#cb97-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb97-5"><a href="sampling-the-imaginary.html#cb97-5" aria-hidden="true" tabindex="-1"></a>e <span class="ot">&lt;-</span> <span class="fu">tibble</span>(<span class="at">p_grid =</span> <span class="fu">seq</span>(<span class="dv">0</span>,<span class="dv">1</span>,<span class="at">length.out=</span>n),</span>
<span id="cb97-6"><a href="sampling-the-imaginary.html#cb97-6" aria-hidden="true" tabindex="-1"></a>            <span class="at">prior =</span> <span class="dv">1</span><span class="sc">/</span><span class="dv">1000</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb97-7"><a href="sampling-the-imaginary.html#cb97-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">likelihood =</span> <span class="fu">dbinom</span>(n_success, </span>
<span id="cb97-8"><a href="sampling-the-imaginary.html#cb97-8" aria-hidden="true" tabindex="-1"></a>                             n_trials,</span>
<span id="cb97-9"><a href="sampling-the-imaginary.html#cb97-9" aria-hidden="true" tabindex="-1"></a>                             <span class="at">prob =</span> p_grid),</span>
<span id="cb97-10"><a href="sampling-the-imaginary.html#cb97-10" aria-hidden="true" tabindex="-1"></a>         <span class="at">posterior =</span> prior<span class="sc">*</span>likelihood,</span>
<span id="cb97-11"><a href="sampling-the-imaginary.html#cb97-11" aria-hidden="true" tabindex="-1"></a>         <span class="at">posterior =</span> posterior<span class="sc">/</span><span class="fu">sum</span>(posterior))</span>
<span id="cb97-12"><a href="sampling-the-imaginary.html#cb97-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb97-13"><a href="sampling-the-imaginary.html#cb97-13" aria-hidden="true" tabindex="-1"></a>e <span class="sc">%&gt;%</span> </span>
<span id="cb97-14"><a href="sampling-the-imaginary.html#cb97-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x=</span>p_grid,<span class="at">y=</span>posterior))<span class="sc">+</span></span>
<span id="cb97-15"><a href="sampling-the-imaginary.html#cb97-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>()</span></code></pre></div>
<p><img src="Rethinking_Bookdown_files/figure-html/unnamed-chunk-38-1.png" width="672" style="display: block; margin: auto;" /></p>
</div>
<div id="m2-1" class="section level4 hasAnchor" number="3.4.2.2">
<h4><span class="header-section-number">3.4.2.2</span> 3M2<a href="sampling-the-imaginary.html#m2-1" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<blockquote>
<p>Draw 10,000 samples from the grid approximation from above. Then use the sample to calculate the 90% HPDI for p. </p>
</blockquote>
<div class="sourceCode" id="cb98"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb98-1"><a href="sampling-the-imaginary.html#cb98-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">123</span>)</span>
<span id="cb98-2"><a href="sampling-the-imaginary.html#cb98-2" aria-hidden="true" tabindex="-1"></a>e_samples <span class="ot">&lt;-</span> </span>
<span id="cb98-3"><a href="sampling-the-imaginary.html#cb98-3" aria-hidden="true" tabindex="-1"></a>  e <span class="sc">%&gt;%</span> </span>
<span id="cb98-4"><a href="sampling-the-imaginary.html#cb98-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">slice_sample</span>(<span class="at">n=</span><span class="fl">1e4</span>, <span class="at">weight_by=</span> posterior,</span>
<span id="cb98-5"><a href="sampling-the-imaginary.html#cb98-5" aria-hidden="true" tabindex="-1"></a>               <span class="at">replace=</span><span class="cn">TRUE</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb98-6"><a href="sampling-the-imaginary.html#cb98-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">sample_number =</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">n</span>())</span>
<span id="cb98-7"><a href="sampling-the-imaginary.html#cb98-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb98-8"><a href="sampling-the-imaginary.html#cb98-8" aria-hidden="true" tabindex="-1"></a><span class="fu">hdi</span>(e_samples<span class="sc">$</span>p_grid, <span class="at">.width=</span><span class="fl">0.9</span>)</span></code></pre></div>
<pre><code>##           [,1]      [,2]
## [1,] 0.3343343 0.7217217</code></pre>
</div>
<div id="m3-1" class="section level4 hasAnchor" number="3.4.2.3">
<h4><span class="header-section-number">3.4.2.3</span> 3M3<a href="sampling-the-imaginary.html#m3-1" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<blockquote>
<p>Construct a posterior predictive check for this model and data. The means simulate the distribution of samples, averaging over the posterior uncertainty in p. What is the probability of observing 8 water in 15 tosses?</p>
</blockquote>
<div class="sourceCode" id="cb100"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb100-1"><a href="sampling-the-imaginary.html#cb100-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">101</span>)</span>
<span id="cb100-2"><a href="sampling-the-imaginary.html#cb100-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb100-3"><a href="sampling-the-imaginary.html#cb100-3" aria-hidden="true" tabindex="-1"></a>e_samples <span class="ot">&lt;-</span> </span>
<span id="cb100-4"><a href="sampling-the-imaginary.html#cb100-4" aria-hidden="true" tabindex="-1"></a>e_samples <span class="sc">%&gt;%</span> </span>
<span id="cb100-5"><a href="sampling-the-imaginary.html#cb100-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">W =</span> <span class="fu">map_dbl</span>(p_grid, rbinom, <span class="at">n=</span><span class="dv">1</span>,<span class="at">size=</span><span class="dv">15</span>))</span>
<span id="cb100-6"><a href="sampling-the-imaginary.html#cb100-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb100-7"><a href="sampling-the-imaginary.html#cb100-7" aria-hidden="true" tabindex="-1"></a><span class="fu">mean</span>(e_samples<span class="sc">$</span>W <span class="sc">==</span> <span class="dv">8</span>)</span></code></pre></div>
<pre><code>## [1] 0.1469</code></pre>
</div>
<div id="m4-1" class="section level4 hasAnchor" number="3.4.2.4">
<h4><span class="header-section-number">3.4.2.4</span> 3M4<a href="sampling-the-imaginary.html#m4-1" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<blockquote>
<p>Using the posterior distribution constructed from the new (8/15) data, now calculate the probability of observing 6 water in 9 tosses.</p>
</blockquote>
<div class="sourceCode" id="cb102"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb102-1"><a href="sampling-the-imaginary.html#cb102-1" aria-hidden="true" tabindex="-1"></a>e_samples <span class="ot">&lt;-</span> </span>
<span id="cb102-2"><a href="sampling-the-imaginary.html#cb102-2" aria-hidden="true" tabindex="-1"></a>e_samples <span class="sc">%&gt;%</span> </span>
<span id="cb102-3"><a href="sampling-the-imaginary.html#cb102-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">W2 =</span> <span class="fu">map_dbl</span>(p_grid, rbinom, <span class="at">n=</span><span class="dv">1</span>, <span class="at">size=</span><span class="dv">9</span>))</span>
<span id="cb102-4"><a href="sampling-the-imaginary.html#cb102-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-5"><a href="sampling-the-imaginary.html#cb102-5" aria-hidden="true" tabindex="-1"></a><span class="fu">mean</span>(e_samples<span class="sc">$</span>W2 <span class="sc">==</span> <span class="dv">6</span>)</span></code></pre></div>
<pre><code>## [1] 0.181</code></pre>
</div>
<div id="m5-1" class="section level4 hasAnchor" number="3.4.2.5">
<h4><span class="header-section-number">3.4.2.5</span> 3M5<a href="sampling-the-imaginary.html#m5-1" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<blockquote>
<p>Start over at 3M1, but now use a prior that is zero below p = 0.5 and a constant above p = 0.5. This corresponds to prior information that a majority of the Earth’s surface is water. Repeat each problem above and compare the inferences (using both priors) to the true value p = 0.7.</p>
</blockquote>
<div class="sourceCode" id="cb104"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb104-1"><a href="sampling-the-imaginary.html#cb104-1" aria-hidden="true" tabindex="-1"></a>e2 <span class="ot">&lt;-</span> <span class="fu">tibble</span>(<span class="at">p_grid =</span> <span class="fu">seq</span>(<span class="dv">0</span>,<span class="dv">1</span>,<span class="at">length.out=</span>n),</span>
<span id="cb104-2"><a href="sampling-the-imaginary.html#cb104-2" aria-hidden="true" tabindex="-1"></a>            <span class="at">prior =</span> <span class="fu">case_when</span>(p_grid <span class="sc">&lt;</span><span class="fl">0.5</span> <span class="sc">~</span> 0L,</span>
<span id="cb104-3"><a href="sampling-the-imaginary.html#cb104-3" aria-hidden="true" tabindex="-1"></a>                              <span class="cn">TRUE</span> <span class="sc">~</span> 1L)) <span class="sc">%&gt;%</span> </span>
<span id="cb104-4"><a href="sampling-the-imaginary.html#cb104-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">likelihood =</span> <span class="fu">dbinom</span>(n_success, </span>
<span id="cb104-5"><a href="sampling-the-imaginary.html#cb104-5" aria-hidden="true" tabindex="-1"></a>                             n_trials,</span>
<span id="cb104-6"><a href="sampling-the-imaginary.html#cb104-6" aria-hidden="true" tabindex="-1"></a>                             <span class="at">prob =</span> p_grid),</span>
<span id="cb104-7"><a href="sampling-the-imaginary.html#cb104-7" aria-hidden="true" tabindex="-1"></a>         <span class="at">posterior =</span> prior<span class="sc">*</span>likelihood,</span>
<span id="cb104-8"><a href="sampling-the-imaginary.html#cb104-8" aria-hidden="true" tabindex="-1"></a>         <span class="at">posterior =</span> posterior<span class="sc">/</span><span class="fu">sum</span>(posterior))</span>
<span id="cb104-9"><a href="sampling-the-imaginary.html#cb104-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb104-10"><a href="sampling-the-imaginary.html#cb104-10" aria-hidden="true" tabindex="-1"></a>e_samples2 <span class="ot">&lt;-</span> </span>
<span id="cb104-11"><a href="sampling-the-imaginary.html#cb104-11" aria-hidden="true" tabindex="-1"></a>  e2 <span class="sc">%&gt;%</span> </span>
<span id="cb104-12"><a href="sampling-the-imaginary.html#cb104-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">slice_sample</span>(<span class="at">n=</span><span class="fl">1e4</span>, <span class="at">weight_by=</span> posterior,</span>
<span id="cb104-13"><a href="sampling-the-imaginary.html#cb104-13" aria-hidden="true" tabindex="-1"></a>               <span class="at">replace=</span><span class="cn">TRUE</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb104-14"><a href="sampling-the-imaginary.html#cb104-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">sample_number =</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">n</span>())</span>
<span id="cb104-15"><a href="sampling-the-imaginary.html#cb104-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb104-16"><a href="sampling-the-imaginary.html#cb104-16" aria-hidden="true" tabindex="-1"></a><span class="co"># 事後分布</span></span>
<span id="cb104-17"><a href="sampling-the-imaginary.html#cb104-17" aria-hidden="true" tabindex="-1"></a>e2 <span class="sc">%&gt;%</span> </span>
<span id="cb104-18"><a href="sampling-the-imaginary.html#cb104-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x=</span>p_grid, <span class="at">y=</span>posterior))<span class="sc">+</span></span>
<span id="cb104-19"><a href="sampling-the-imaginary.html#cb104-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="at">size=</span><span class="fl">1.5</span>)</span></code></pre></div>
<p><img src="Rethinking_Bookdown_files/figure-html/unnamed-chunk-42-1.png" width="672" style="display: block; margin: auto;" /></p>
<div class="sourceCode" id="cb105"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb105-1"><a href="sampling-the-imaginary.html#cb105-1" aria-hidden="true" tabindex="-1"></a><span class="co"># 90$HPDI</span></span>
<span id="cb105-2"><a href="sampling-the-imaginary.html#cb105-2" aria-hidden="true" tabindex="-1"></a><span class="fu">hdi</span>(e_samples2<span class="sc">$</span>p_grid, <span class="at">.width=</span><span class="fl">0.9</span>)</span></code></pre></div>
<pre><code>##           [,1]      [,2]
## [1,] 0.5005005 0.7137137</code></pre>
<div class="sourceCode" id="cb107"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb107-1"><a href="sampling-the-imaginary.html#cb107-1" aria-hidden="true" tabindex="-1"></a><span class="co"># サンプリング</span></span>
<span id="cb107-2"><a href="sampling-the-imaginary.html#cb107-2" aria-hidden="true" tabindex="-1"></a>e_samples2 <span class="ot">&lt;-</span> </span>
<span id="cb107-3"><a href="sampling-the-imaginary.html#cb107-3" aria-hidden="true" tabindex="-1"></a>e_samples2 <span class="sc">%&gt;%</span> </span>
<span id="cb107-4"><a href="sampling-the-imaginary.html#cb107-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">W =</span> <span class="fu">map_dbl</span>(p_grid, rbinom, <span class="at">n=</span><span class="dv">1</span>, <span class="at">size=</span><span class="dv">9</span>))</span>
<span id="cb107-5"><a href="sampling-the-imaginary.html#cb107-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb107-6"><a href="sampling-the-imaginary.html#cb107-6" aria-hidden="true" tabindex="-1"></a><span class="fu">mean</span>(e_samples2<span class="sc">$</span>W<span class="sc">==</span><span class="dv">6</span>)</span></code></pre></div>
<pre><code>## [1] 0.2411</code></pre>
<div class="sourceCode" id="cb109"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb109-1"><a href="sampling-the-imaginary.html#cb109-1" aria-hidden="true" tabindex="-1"></a>e_samples2 <span class="sc">%&gt;%</span> </span>
<span id="cb109-2"><a href="sampling-the-imaginary.html#cb109-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x=</span>W))<span class="sc">+</span></span>
<span id="cb109-3"><a href="sampling-the-imaginary.html#cb109-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_histogram</span>(<span class="at">binwidth=</span><span class="fl">0.5</span>,<span class="at">size=</span><span class="dv">1</span><span class="sc">/</span><span class="dv">10</span>)</span></code></pre></div>
<p><img src="Rethinking_Bookdown_files/figure-html/unnamed-chunk-42-2.png" width="672" style="display: block; margin: auto;" /></p>
</div>
<div id="m6" class="section level4 hasAnchor" number="3.4.2.6">
<h4><span class="header-section-number">3.4.2.6</span> 3M6<a href="sampling-the-imaginary.html#m6" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<blockquote>
<p>Suppose you want to estimate the Earth’s proportion of water very precisely. Specifically, you want the 99% percentile interval of the posterior distribution of p to be only 0.05 wide. This means the distance between the upper and lower bound of the interval should be 0.05. How many times will you have to toss the globe to do this?</p>
</blockquote>
<div class="sourceCode" id="cb110"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb110-1"><a href="sampling-the-imaginary.html#cb110-1" aria-hidden="true" tabindex="-1"></a>single_sim <span class="ot">&lt;-</span> <span class="cf">function</span>(tosses, <span class="at">prior_type =</span> <span class="fu">c</span>(<span class="st">&quot;uniform&quot;</span>, <span class="st">&quot;step&quot;</span>)) {</span>
<span id="cb110-2"><a href="sampling-the-imaginary.html#cb110-2" aria-hidden="true" tabindex="-1"></a>  prior_type <span class="ot">&lt;-</span> <span class="fu">match.arg</span>(prior_type)</span>
<span id="cb110-3"><a href="sampling-the-imaginary.html#cb110-3" aria-hidden="true" tabindex="-1"></a>  n_success <span class="ot">&lt;-</span> <span class="fu">rbinom</span>(<span class="dv">1</span>, <span class="at">size =</span> tosses, <span class="at">prob =</span> <span class="fl">0.7</span>)</span>
<span id="cb110-4"><a href="sampling-the-imaginary.html#cb110-4" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb110-5"><a href="sampling-the-imaginary.html#cb110-5" aria-hidden="true" tabindex="-1"></a>  e3 <span class="ot">&lt;-</span> <span class="fu">tibble</span>(<span class="at">p_grid =</span><span class="fu">seq</span>(<span class="at">from =</span> <span class="dv">0</span>, <span class="at">to =</span> <span class="dv">1</span>, </span>
<span id="cb110-6"><a href="sampling-the-imaginary.html#cb110-6" aria-hidden="true" tabindex="-1"></a>                          <span class="at">length.out =</span> <span class="dv">1000</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb110-7"><a href="sampling-the-imaginary.html#cb110-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">likelihood =</span> <span class="fu">dbinom</span>(n_success,</span>
<span id="cb110-8"><a href="sampling-the-imaginary.html#cb110-8" aria-hidden="true" tabindex="-1"></a>                             <span class="at">size=</span>tosses,</span>
<span id="cb110-9"><a href="sampling-the-imaginary.html#cb110-9" aria-hidden="true" tabindex="-1"></a>                             <span class="at">prob =</span> p_grid))</span>
<span id="cb110-10"><a href="sampling-the-imaginary.html#cb110-10" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb110-11"><a href="sampling-the-imaginary.html#cb110-11" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span>(prior_type <span class="sc">==</span> <span class="st">&quot;uniform&quot;</span>){</span>
<span id="cb110-12"><a href="sampling-the-imaginary.html#cb110-12" aria-hidden="true" tabindex="-1"></a>    e3 <span class="ot">&lt;-</span> <span class="fu">mutate</span>(e3, <span class="at">prior =</span><span class="fu">rep</span>(<span class="dv">1</span>,<span class="dv">1000</span>))</span>
<span id="cb110-13"><a href="sampling-the-imaginary.html#cb110-13" aria-hidden="true" tabindex="-1"></a>  } <span class="cf">else</span> <span class="cf">if</span>(prior_type <span class="sc">==</span> <span class="st">&quot;step&quot;</span>){</span>
<span id="cb110-14"><a href="sampling-the-imaginary.html#cb110-14" aria-hidden="true" tabindex="-1"></a>    e3 <span class="ot">&lt;-</span> <span class="fu">mutate</span>(e3, <span class="at">prior =</span><span class="fu">case_when</span>(p_grid <span class="sc">&gt;</span>.<span class="dv">5</span> <span class="sc">~</span>1L,</span>
<span id="cb110-15"><a href="sampling-the-imaginary.html#cb110-15" aria-hidden="true" tabindex="-1"></a>                               <span class="cn">TRUE</span> <span class="sc">~</span>0L))</span>
<span id="cb110-16"><a href="sampling-the-imaginary.html#cb110-16" aria-hidden="true" tabindex="-1"></a>  } <span class="cf">else</span> {</span>
<span id="cb110-17"><a href="sampling-the-imaginary.html#cb110-17" aria-hidden="true" tabindex="-1"></a>   <span class="fu">print</span>(<span class="st">&quot;error&quot;</span>) </span>
<span id="cb110-18"><a href="sampling-the-imaginary.html#cb110-18" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb110-19"><a href="sampling-the-imaginary.html#cb110-19" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb110-20"><a href="sampling-the-imaginary.html#cb110-20" aria-hidden="true" tabindex="-1"></a>  e3 <span class="ot">&lt;-</span> </span>
<span id="cb110-21"><a href="sampling-the-imaginary.html#cb110-21" aria-hidden="true" tabindex="-1"></a>    e3 <span class="sc">%&gt;%</span> </span>
<span id="cb110-22"><a href="sampling-the-imaginary.html#cb110-22" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(<span class="at">posterior =</span> prior<span class="sc">*</span>likelihood,</span>
<span id="cb110-23"><a href="sampling-the-imaginary.html#cb110-23" aria-hidden="true" tabindex="-1"></a>           <span class="at">posterior =</span> posterior<span class="sc">/</span><span class="fu">sum</span>(posterior))</span>
<span id="cb110-24"><a href="sampling-the-imaginary.html#cb110-24" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb110-25"><a href="sampling-the-imaginary.html#cb110-25" aria-hidden="true" tabindex="-1"></a>  samples3 <span class="ot">&lt;-</span> <span class="fu">slice_sample</span>(e3,<span class="at">n=</span><span class="fl">1e4</span>, </span>
<span id="cb110-26"><a href="sampling-the-imaginary.html#cb110-26" aria-hidden="true" tabindex="-1"></a>                          <span class="at">weight_by=</span> posterior,</span>
<span id="cb110-27"><a href="sampling-the-imaginary.html#cb110-27" aria-hidden="true" tabindex="-1"></a>                          <span class="at">replace=</span><span class="cn">TRUE</span>)</span>
<span id="cb110-28"><a href="sampling-the-imaginary.html#cb110-28" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb110-29"><a href="sampling-the-imaginary.html#cb110-29" aria-hidden="true" tabindex="-1"></a>  interval <span class="ot">&lt;-</span> <span class="fu">PI</span>(samples3<span class="sc">$</span>p_grid, <span class="at">prob =</span> <span class="fl">0.99</span>)</span>
<span id="cb110-30"><a href="sampling-the-imaginary.html#cb110-30" aria-hidden="true" tabindex="-1"></a>  width <span class="ot">&lt;-</span> interval[<span class="dv">2</span>] <span class="sc">-</span> interval[<span class="dv">1</span>]</span>
<span id="cb110-31"><a href="sampling-the-imaginary.html#cb110-31" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb110-32"><a href="sampling-the-imaginary.html#cb110-32" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb110-33"><a href="sampling-the-imaginary.html#cb110-33" aria-hidden="true" tabindex="-1"></a>single_cond <span class="ot">&lt;-</span> <span class="cf">function</span>(tosses, prior_type, <span class="at">reps =</span> <span class="dv">100</span>) {</span>
<span id="cb110-34"><a href="sampling-the-imaginary.html#cb110-34" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tibble</span>(<span class="at">tosses =</span> tosses,</span>
<span id="cb110-35"><a href="sampling-the-imaginary.html#cb110-35" aria-hidden="true" tabindex="-1"></a>         <span class="at">prior_type =</span> prior_type,</span>
<span id="cb110-36"><a href="sampling-the-imaginary.html#cb110-36" aria-hidden="true" tabindex="-1"></a>         <span class="at">width =</span> <span class="fu">map_dbl</span>(<span class="fu">seq_len</span>(reps),</span>
<span id="cb110-37"><a href="sampling-the-imaginary.html#cb110-37" aria-hidden="true" tabindex="-1"></a>                         <span class="sc">~</span><span class="fu">single_sim</span>(<span class="at">tosses =</span> tosses,</span>
<span id="cb110-38"><a href="sampling-the-imaginary.html#cb110-38" aria-hidden="true" tabindex="-1"></a>                                     <span class="at">prior_type =</span></span>
<span id="cb110-39"><a href="sampling-the-imaginary.html#cb110-39" aria-hidden="true" tabindex="-1"></a>                                       prior_type)))</span>
<span id="cb110-40"><a href="sampling-the-imaginary.html#cb110-40" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb110-41"><a href="sampling-the-imaginary.html#cb110-41" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb110-42"><a href="sampling-the-imaginary.html#cb110-42" aria-hidden="true" tabindex="-1"></a>simulation <span class="ot">&lt;-</span> <span class="fu">crossing</span>(<span class="at">tosses =</span> <span class="fu">seq</span>(<span class="dv">1500</span>, <span class="dv">3000</span>, </span>
<span id="cb110-43"><a href="sampling-the-imaginary.html#cb110-43" aria-hidden="true" tabindex="-1"></a>                                    <span class="at">by =</span> <span class="dv">100</span>),</span>
<span id="cb110-44"><a href="sampling-the-imaginary.html#cb110-44" aria-hidden="true" tabindex="-1"></a>                       <span class="at">prior_type =</span> <span class="fu">c</span>(<span class="st">&quot;uniform&quot;</span>,</span>
<span id="cb110-45"><a href="sampling-the-imaginary.html#cb110-45" aria-hidden="true" tabindex="-1"></a>                                      <span class="st">&quot;step&quot;</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb110-46"><a href="sampling-the-imaginary.html#cb110-46" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pmap_dfr</span>(single_cond, <span class="at">reps =</span> <span class="dv">100</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb110-47"><a href="sampling-the-imaginary.html#cb110-47" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(tosses, prior_type) <span class="sc">%&gt;%</span> </span>
<span id="cb110-48"><a href="sampling-the-imaginary.html#cb110-48" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">avg =</span> <span class="fu">mean</span>(width), <span class="at">.groups =</span> <span class="st">&quot;drop&quot;</span>)</span>
<span id="cb110-49"><a href="sampling-the-imaginary.html#cb110-49" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb110-50"><a href="sampling-the-imaginary.html#cb110-50" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(simulation, <span class="fu">aes</span>(<span class="at">x=</span>tosses,<span class="at">y=</span>avg))<span class="sc">+</span></span>
<span id="cb110-51"><a href="sampling-the-imaginary.html#cb110-51" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>()<span class="sc">+</span></span>
<span id="cb110-52"><a href="sampling-the-imaginary.html#cb110-52" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>()<span class="sc">+</span></span>
<span id="cb110-53"><a href="sampling-the-imaginary.html#cb110-53" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span>prior_type)</span></code></pre></div>
<p><img src="Rethinking_Bookdown_files/figure-html/unnamed-chunk-43-1.png" width="672" style="display: block; margin: auto;" /></p>
</div>
</div>
<div id="h" class="section level3 hasAnchor" number="3.4.3">
<h3><span class="header-section-number">3.4.3</span> 3H<a href="sampling-the-imaginary.html#h" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<blockquote>
<p>The Hard problems here all use the data below. These data indicate the gender (male = 1, female = 0) of officially reported first and second born children in 100 two-child families. So for example, the first family in the data reported a boy (1) and then a girl (0). The second family reported a girl (0) and then a boy (1). The third family reported two girls. You can load these tow vectors into R’s memory by typing:</p>
</blockquote>
<div class="sourceCode" id="cb111"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb111-1"><a href="sampling-the-imaginary.html#cb111-1" aria-hidden="true" tabindex="-1"></a><span class="fu">data</span>(homeworkch3)</span>
<span id="cb111-2"><a href="sampling-the-imaginary.html#cb111-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb111-3"><a href="sampling-the-imaginary.html#cb111-3" aria-hidden="true" tabindex="-1"></a>birth1</span></code></pre></div>
<pre><code>##   [1] 1 0 0 0 1 1 0 1 0 1 0 0 1 1 0 1 1 0 0 0 1 0 0 0 1 0 0 0 0 1 1 1 0 1 0 1 1
##  [38] 1 0 1 0 1 1 0 1 0 0 1 1 0 1 0 0 0 0 0 0 0 1 1 0 1 0 0 1 0 0 0 1 0 0 1 1 1
##  [75] 1 0 1 0 1 1 1 1 1 0 0 1 0 1 1 0 1 0 1 1 1 0 1 1 1 1</code></pre>
<div class="sourceCode" id="cb113"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb113-1"><a href="sampling-the-imaginary.html#cb113-1" aria-hidden="true" tabindex="-1"></a>birth2</span></code></pre></div>
<pre><code>##   [1] 0 1 0 1 0 1 1 1 0 0 1 1 1 1 1 0 0 1 1 1 0 0 1 1 1 0 1 1 1 0 1 1 1 0 1 0 0
##  [38] 1 1 1 1 0 0 1 0 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 0 1 1 0 1 1 0 1 1 1 0 0 0
##  [75] 0 0 0 1 0 0 0 1 1 0 0 1 0 0 1 1 0 0 0 1 1 1 0 0 0 0</code></pre>
<blockquote>
<p>Use these vectors as data. So for example to compute the total number of boys born across all of these births, you could use:</p>
</blockquote>
<div class="sourceCode" id="cb115"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb115-1"><a href="sampling-the-imaginary.html#cb115-1" aria-hidden="true" tabindex="-1"></a><span class="fu">sum</span>(birth1) <span class="sc">+</span> <span class="fu">sum</span>(birth2)</span></code></pre></div>
<pre><code>## [1] 111</code></pre>
<div id="h1-1" class="section level4 hasAnchor" number="3.4.3.1">
<h4><span class="header-section-number">3.4.3.1</span> 3H1<a href="sampling-the-imaginary.html#h1-1" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<blockquote>
<p>Using grid approximation, compute the posterior distribution for the probability of a birth being a boy. Assume a uniform prior probability. Which parameter value maximizes the posterior probability?</p>
</blockquote>
<div class="sourceCode" id="cb117"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb117-1"><a href="sampling-the-imaginary.html#cb117-1" aria-hidden="true" tabindex="-1"></a><span class="fu">data</span>(<span class="st">&quot;homeworkch3&quot;</span>)</span>
<span id="cb117-2"><a href="sampling-the-imaginary.html#cb117-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb117-3"><a href="sampling-the-imaginary.html#cb117-3" aria-hidden="true" tabindex="-1"></a>n_boy <span class="ot">&lt;-</span> <span class="fu">sum</span>(birth1)<span class="sc">+</span><span class="fu">sum</span>(birth2)</span>
<span id="cb117-4"><a href="sampling-the-imaginary.html#cb117-4" aria-hidden="true" tabindex="-1"></a>n_birth <span class="ot">&lt;-</span> <span class="fu">length</span>(birth1)<span class="sc">+</span><span class="fu">length</span>(birth2)</span>
<span id="cb117-5"><a href="sampling-the-imaginary.html#cb117-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb117-6"><a href="sampling-the-imaginary.html#cb117-6" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">100</span>)</span>
<span id="cb117-7"><a href="sampling-the-imaginary.html#cb117-7" aria-hidden="true" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="dv">1000</span></span>
<span id="cb117-8"><a href="sampling-the-imaginary.html#cb117-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb117-9"><a href="sampling-the-imaginary.html#cb117-9" aria-hidden="true" tabindex="-1"></a>baby <span class="ot">&lt;-</span> <span class="fu">tibble</span>(<span class="at">p_grid =</span> <span class="fu">seq</span>(<span class="dv">0</span>,<span class="dv">1</span>,<span class="at">length.out =</span>n),</span>
<span id="cb117-10"><a href="sampling-the-imaginary.html#cb117-10" aria-hidden="true" tabindex="-1"></a>            <span class="at">prior =</span> <span class="dv">1</span>) <span class="sc">%&gt;%</span></span>
<span id="cb117-11"><a href="sampling-the-imaginary.html#cb117-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">likelihood =</span> <span class="fu">dbinom</span>(n_boy,n_birth,</span>
<span id="cb117-12"><a href="sampling-the-imaginary.html#cb117-12" aria-hidden="true" tabindex="-1"></a>                             <span class="at">prob=</span>p_grid),</span>
<span id="cb117-13"><a href="sampling-the-imaginary.html#cb117-13" aria-hidden="true" tabindex="-1"></a>         <span class="at">posterior =</span> likelihood<span class="sc">*</span>prior<span class="sc">/</span><span class="fu">sum</span>(likelihood<span class="sc">*</span>prior))</span>
<span id="cb117-14"><a href="sampling-the-imaginary.html#cb117-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb117-15"><a href="sampling-the-imaginary.html#cb117-15" aria-hidden="true" tabindex="-1"></a>baby<span class="sc">$</span>p_grid[<span class="fu">which.max</span>(baby<span class="sc">$</span>posterior)]</span></code></pre></div>
<pre><code>## [1] 0.5545546</code></pre>
</div>
<div id="h2-1" class="section level4 hasAnchor" number="3.4.3.2">
<h4><span class="header-section-number">3.4.3.2</span> 3H2<a href="sampling-the-imaginary.html#h2-1" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<blockquote>
<p>Using the sample function, draw 10,000 random parameter values from the posterior distribution you calculated above. Use these sample to estimate the 50%, 89%, and 97% highest posterior density intervals.</p>
</blockquote>
<div class="sourceCode" id="cb119"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb119-1"><a href="sampling-the-imaginary.html#cb119-1" aria-hidden="true" tabindex="-1"></a>b_samples <span class="ot">&lt;-</span> <span class="fu">slice_sample</span>(baby, <span class="at">n=</span><span class="fl">1e4</span>, <span class="at">weight_by =</span> posterior, <span class="at">replace=</span><span class="cn">TRUE</span>)</span>
<span id="cb119-2"><a href="sampling-the-imaginary.html#cb119-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb119-3"><a href="sampling-the-imaginary.html#cb119-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidybayes)</span>
<span id="cb119-4"><a href="sampling-the-imaginary.html#cb119-4" aria-hidden="true" tabindex="-1"></a><span class="fu">HPDI</span>(b_samples<span class="sc">$</span>p_grid,<span class="at">prob =</span> <span class="fu">c</span>(<span class="fl">0.5</span>,<span class="fl">0.89</span>,<span class="fl">0.97</span>))</span></code></pre></div>
<pre><code>##     |0.97     |0.89      |0.5      0.5|     0.89|     0.97| 
## 0.4824825 0.4994995 0.5265265 0.5725726 0.6076076 0.6296296</code></pre>
</div>
<div id="h3-1" class="section level4 hasAnchor" number="3.4.3.3">
<h4><span class="header-section-number">3.4.3.3</span> 3H3<a href="sampling-the-imaginary.html#h3-1" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<blockquote>
<p>Use rbinom to simulate 10,000 replicates of 200 births. You should end up with 10,000 numbers, each one a count of boys out of 200 births. Compare the distribution of predicted numbers of boys to the actual count in the data (111 boys out of 200 births). There are many good ways to visualize the simulations, but the dens command (part of the rethinking package) is prbably the easiest way in this case. Does it look like the model fits the data well? That is, does the distribution of predictions include the actual observation as a central, likely outcome?</p>
</blockquote>
<div class="sourceCode" id="cb121"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb121-1"><a href="sampling-the-imaginary.html#cb121-1" aria-hidden="true" tabindex="-1"></a>b_samples <span class="sc">%&gt;%</span> </span>
<span id="cb121-2"><a href="sampling-the-imaginary.html#cb121-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">boys =</span> <span class="fu">rbinom</span>(<span class="fl">1e4</span>,<span class="dv">200</span>,<span class="at">prob=</span>p_grid)) <span class="ot">-&gt;</span> b_samples</span>
<span id="cb121-3"><a href="sampling-the-imaginary.html#cb121-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb121-4"><a href="sampling-the-imaginary.html#cb121-4" aria-hidden="true" tabindex="-1"></a>b_samples <span class="sc">%&gt;%</span> </span>
<span id="cb121-5"><a href="sampling-the-imaginary.html#cb121-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x=</span>boys))<span class="sc">+</span></span>
<span id="cb121-6"><a href="sampling-the-imaginary.html#cb121-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_histinterval</span>(<span class="at">color =</span><span class="st">&quot;black&quot;</span>,</span>
<span id="cb121-7"><a href="sampling-the-imaginary.html#cb121-7" aria-hidden="true" tabindex="-1"></a>                    <span class="at">.width =</span> <span class="fu">c</span>(<span class="fl">0.66</span>, <span class="fl">0.89</span>),</span>
<span id="cb121-8"><a href="sampling-the-imaginary.html#cb121-8" aria-hidden="true" tabindex="-1"></a>                    <span class="at">breaks =</span> <span class="dv">100</span>)<span class="sc">+</span></span>
<span id="cb121-9"><a href="sampling-the-imaginary.html#cb121-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_vline</span>(<span class="fu">aes</span>(<span class="at">xintercept =</span> n_boy), <span class="at">linetype =</span> <span class="st">&quot;dashed&quot;</span>, <span class="at">color =</span> <span class="st">&quot;red&quot;</span>)</span></code></pre></div>
<p><img src="Rethinking_Bookdown_files/figure-html/unnamed-chunk-48-1.png" width="672" style="display: block; margin: auto;" /></p>
</div>
<div id="h4-1" class="section level4 hasAnchor" number="3.4.3.4">
<h4><span class="header-section-number">3.4.3.4</span> 3H4<a href="sampling-the-imaginary.html#h4-1" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<blockquote>
<p>Now compare 10,000 counts of boys from 100 simulated first borns only the number of boys in the first births, birth1. How does the model look in this light?</p>
</blockquote>
<div class="sourceCode" id="cb122"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb122-1"><a href="sampling-the-imaginary.html#cb122-1" aria-hidden="true" tabindex="-1"></a>b_samples <span class="sc">%&gt;%</span> </span>
<span id="cb122-2"><a href="sampling-the-imaginary.html#cb122-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">boys =</span> <span class="fu">rbinom</span>(<span class="fl">1e4</span>,<span class="dv">100</span>,<span class="at">prob=</span>p_grid)) <span class="ot">-&gt;</span> b_samples2</span>
<span id="cb122-3"><a href="sampling-the-imaginary.html#cb122-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb122-4"><a href="sampling-the-imaginary.html#cb122-4" aria-hidden="true" tabindex="-1"></a>b_samples2 <span class="sc">%&gt;%</span> </span>
<span id="cb122-5"><a href="sampling-the-imaginary.html#cb122-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x=</span>boys))<span class="sc">+</span></span>
<span id="cb122-6"><a href="sampling-the-imaginary.html#cb122-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_histinterval</span>(<span class="at">color =</span><span class="st">&quot;black&quot;</span>,</span>
<span id="cb122-7"><a href="sampling-the-imaginary.html#cb122-7" aria-hidden="true" tabindex="-1"></a>                    <span class="at">.width =</span> <span class="fu">c</span>(<span class="fl">0.66</span>, <span class="fl">0.89</span>),</span>
<span id="cb122-8"><a href="sampling-the-imaginary.html#cb122-8" aria-hidden="true" tabindex="-1"></a>                    <span class="at">breaks =</span> <span class="dv">50</span>)<span class="sc">+</span></span>
<span id="cb122-9"><a href="sampling-the-imaginary.html#cb122-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_vline</span>(<span class="fu">aes</span>(<span class="at">xintercept =</span> <span class="fu">sum</span>(birth1)), <span class="at">linetype =</span> <span class="st">&quot;dashed&quot;</span>, <span class="at">color =</span> <span class="st">&quot;red&quot;</span>)</span></code></pre></div>
<p><img src="Rethinking_Bookdown_files/figure-html/unnamed-chunk-49-1.png" width="672" style="display: block; margin: auto;" /></p>
</div>
<div id="h5" class="section level4 hasAnchor" number="3.4.3.5">
<h4><span class="header-section-number">3.4.3.5</span> 3H5<a href="sampling-the-imaginary.html#h5" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<blockquote>
<p>The model assumes that sex of first and second births are independent. To check this assumption, focus now on second births that followed female first borns. Compare 10,000 simulated conts of boys to only those second births that followed girls. To do this correctly, you need to count the number of first borns who were girls and simulate that many births, 10,000 times. Compare the counts of boys in your simulations to the actual observed count of boys following girls. How does the model look in this light? Any guesses what is going on in these data?</p>
</blockquote>
<div class="sourceCode" id="cb123"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb123-1"><a href="sampling-the-imaginary.html#cb123-1" aria-hidden="true" tabindex="-1"></a>birth <span class="ot">&lt;-</span> <span class="fu">as_tibble</span>(<span class="fu">cbind</span>(birth1,birth2))</span>
<span id="cb123-2"><a href="sampling-the-imaginary.html#cb123-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb123-3"><a href="sampling-the-imaginary.html#cb123-3" aria-hidden="true" tabindex="-1"></a>birth <span class="sc">%&gt;%</span> </span>
<span id="cb123-4"><a href="sampling-the-imaginary.html#cb123-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(birth1 <span class="sc">==</span> <span class="st">&quot;0&quot;</span>) <span class="ot">-&gt;</span>birth</span>
<span id="cb123-5"><a href="sampling-the-imaginary.html#cb123-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb123-6"><a href="sampling-the-imaginary.html#cb123-6" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">100</span>)</span>
<span id="cb123-7"><a href="sampling-the-imaginary.html#cb123-7" aria-hidden="true" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="dv">1000</span></span>
<span id="cb123-8"><a href="sampling-the-imaginary.html#cb123-8" aria-hidden="true" tabindex="-1"></a>n_boy2 <span class="ot">&lt;-</span> <span class="fu">sum</span>(birth)</span>
<span id="cb123-9"><a href="sampling-the-imaginary.html#cb123-9" aria-hidden="true" tabindex="-1"></a>n_birth2 <span class="ot">&lt;-</span> <span class="fu">nrow</span>(birth)</span>
<span id="cb123-10"><a href="sampling-the-imaginary.html#cb123-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb123-11"><a href="sampling-the-imaginary.html#cb123-11" aria-hidden="true" tabindex="-1"></a>b_samples3 <span class="ot">&lt;-</span> b_samples <span class="sc">%&gt;%</span> </span>
<span id="cb123-12"><a href="sampling-the-imaginary.html#cb123-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">boys =</span> <span class="fu">rbinom</span>(<span class="fl">1e4</span>, <span class="at">size=</span><span class="dv">49</span>,<span class="at">prob=</span>p_grid))</span>
<span id="cb123-13"><a href="sampling-the-imaginary.html#cb123-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb123-14"><a href="sampling-the-imaginary.html#cb123-14" aria-hidden="true" tabindex="-1"></a>b_samples3 <span class="sc">%&gt;%</span> </span>
<span id="cb123-15"><a href="sampling-the-imaginary.html#cb123-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x=</span>boys))<span class="sc">+</span></span>
<span id="cb123-16"><a href="sampling-the-imaginary.html#cb123-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_histinterval</span>(<span class="at">color =</span><span class="st">&quot;black&quot;</span>,</span>
<span id="cb123-17"><a href="sampling-the-imaginary.html#cb123-17" aria-hidden="true" tabindex="-1"></a>                    <span class="at">.width =</span> <span class="fu">c</span>(<span class="fl">0.66</span>, <span class="fl">0.89</span>),</span>
<span id="cb123-18"><a href="sampling-the-imaginary.html#cb123-18" aria-hidden="true" tabindex="-1"></a>                    <span class="at">breaks =</span> <span class="dv">50</span>)<span class="sc">+</span></span>
<span id="cb123-19"><a href="sampling-the-imaginary.html#cb123-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_vline</span>(<span class="fu">aes</span>(<span class="at">xintercept =</span> <span class="fu">sum</span>(birth)), <span class="at">linetype =</span> <span class="st">&quot;dashed&quot;</span>, <span class="at">color =</span> <span class="st">&quot;red&quot;</span>)</span></code></pre></div>
<p><img src="Rethinking_Bookdown_files/figure-html/unnamed-chunk-50-1.png" width="672" style="display: block; margin: auto;" /></p>
<p>女の子が生まれた後には、男の子が生まれやすい。</p>

</div>
</div>
</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="small-worlds-and-large-worlds.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="geocentric-model.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"whatsapp": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": null,
"text": null
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": null,
"search": {
"engine": "fuse",
"options": null
},
"toc": {
"collapse": "subsection"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.9/latest.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
