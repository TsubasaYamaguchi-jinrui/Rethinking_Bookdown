<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>8 Conditional Manatees | Statistical Rethinking Second Edition</title>
  <meta name="description" content="8 Conditional Manatees | Statistical Rethinking Second Edition" />
  <meta name="generator" content="bookdown 0.31 and GitBook 2.6.7" />

  <meta property="og:title" content="8 Conditional Manatees | Statistical Rethinking Second Edition" />
  <meta property="og:type" content="book" />
  
  
  

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="8 Conditional Manatees | Statistical Rethinking Second Edition" />
  
  
  

<meta name="author" content="Tsubasa Yamaguchi" />


<meta name="date" content="2023-02-01" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="ulysses-compass.html"/>
<link rel="next" href="marcov-chain-monte-carlo.html"/>
<script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/fuse.js@6.4.6/dist/fuse.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />








<link href="libs/anchor-sections-1.1.0/anchor-sections.css" rel="stylesheet" />
<link href="libs/anchor-sections-1.1.0/anchor-sections-hash.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.1.0/anchor-sections.js"></script>
<script src="libs/htmlwidgets-1.6.1/htmlwidgets.js"></script>
<link href="libs/datatables-css-0.0.0/datatables-crosstalk.css" rel="stylesheet" />
<script src="libs/datatables-binding-0.27/datatables.js"></script>
<link href="libs/dt-core-1.12.1/css/jquery.dataTables.min.css" rel="stylesheet" />
<link href="libs/dt-core-1.12.1/css/jquery.dataTables.extra.css" rel="stylesheet" />
<script src="libs/dt-core-1.12.1/js/jquery.dataTables.min.js"></script>
<link href="libs/crosstalk-1.2.0/css/crosstalk.min.css" rel="stylesheet" />
<script src="libs/crosstalk-1.2.0/js/crosstalk.min.js"></script>
<link href="libs/tabwid-1.1.2/tabwid.css" rel="stylesheet" />
<script src="libs/kePrint-0.0.1/kePrint.js"></script>
<link href="libs/lightable-0.0.1/lightable.css" rel="stylesheet" />


<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { color: #008000; } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { color: #008000; font-weight: bold; } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<style type="text/css">
/* Used with Pandoc 2.11+ new --citeproc when CSL is used */
div.csl-bib-body { }
div.csl-entry {
  clear: both;
}
.hanging div.csl-entry {
  margin-left:2em;
  text-indent:-2em;
}
div.csl-left-margin {
  min-width:2em;
  float:left;
}
div.csl-right-inline {
  margin-left:2em;
  padding-left:1em;
}
div.csl-indent {
  margin-left: 2em;
}
</style>

<link rel="stylesheet" href="custom_style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li class="chapter" data-level="" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i>本稿の目的</a></li>
<li class="chapter" data-level="" data-path="パッケージの読み込み.html"><a href="パッケージの読み込み.html"><i class="fa fa-check"></i>パッケージの読み込み</a></li>
<li class="chapter" data-level="1" data-path="the-golem-of-prague.html"><a href="the-golem-of-prague.html"><i class="fa fa-check"></i><b>1</b> The Golem of Prague 　</a></li>
<li class="chapter" data-level="2" data-path="small-worlds-and-large-worlds.html"><a href="small-worlds-and-large-worlds.html"><i class="fa fa-check"></i><b>2</b> Small Worlds and Large Worlds</a>
<ul>
<li class="chapter" data-level="2.1" data-path="small-worlds-and-large-worlds.html"><a href="small-worlds-and-large-worlds.html#byesian-updating"><i class="fa fa-check"></i><b>2.1</b> Byesian Updating</a></li>
<li class="chapter" data-level="2.2" data-path="small-worlds-and-large-worlds.html"><a href="small-worlds-and-large-worlds.html#making-th-model"><i class="fa fa-check"></i><b>2.2</b> Making th model</a>
<ul>
<li class="chapter" data-level="2.2.1" data-path="small-worlds-and-large-worlds.html"><a href="small-worlds-and-large-worlds.html#grid-approximation"><i class="fa fa-check"></i><b>2.2.1</b> Grid approximation</a></li>
<li class="chapter" data-level="2.2.2" data-path="small-worlds-and-large-worlds.html"><a href="small-worlds-and-large-worlds.html#quadratic-approximation"><i class="fa fa-check"></i><b>2.2.2</b> Quadratic approximation</a></li>
<li class="chapter" data-level="2.2.3" data-path="small-worlds-and-large-worlds.html"><a href="small-worlds-and-large-worlds.html#mcmc"><i class="fa fa-check"></i><b>2.2.3</b> MCMC</a></li>
</ul></li>
<li class="chapter" data-level="2.3" data-path="small-worlds-and-large-worlds.html"><a href="small-worlds-and-large-worlds.html#practice"><i class="fa fa-check"></i><b>2.3</b> Practice</a>
<ul>
<li class="chapter" data-level="2.3.1" data-path="small-worlds-and-large-worlds.html"><a href="small-worlds-and-large-worlds.html#m1"><i class="fa fa-check"></i><b>2.3.1</b> 2M1</a></li>
<li class="chapter" data-level="2.3.2" data-path="small-worlds-and-large-worlds.html"><a href="small-worlds-and-large-worlds.html#m2"><i class="fa fa-check"></i><b>2.3.2</b> 2M2</a></li>
<li class="chapter" data-level="2.3.3" data-path="small-worlds-and-large-worlds.html"><a href="small-worlds-and-large-worlds.html#m3"><i class="fa fa-check"></i><b>2.3.3</b> 2M3</a></li>
<li class="chapter" data-level="2.3.4" data-path="small-worlds-and-large-worlds.html"><a href="small-worlds-and-large-worlds.html#m4"><i class="fa fa-check"></i><b>2.3.4</b> 2M4</a></li>
<li class="chapter" data-level="2.3.5" data-path="small-worlds-and-large-worlds.html"><a href="small-worlds-and-large-worlds.html#m5"><i class="fa fa-check"></i><b>2.3.5</b> 2M5</a></li>
<li class="chapter" data-level="2.3.6" data-path="small-worlds-and-large-worlds.html"><a href="small-worlds-and-large-worlds.html#m7"><i class="fa fa-check"></i><b>2.3.6</b> 2M7</a></li>
<li class="chapter" data-level="2.3.7" data-path="small-worlds-and-large-worlds.html"><a href="small-worlds-and-large-worlds.html#h1"><i class="fa fa-check"></i><b>2.3.7</b> 2H1</a></li>
<li class="chapter" data-level="2.3.8" data-path="small-worlds-and-large-worlds.html"><a href="small-worlds-and-large-worlds.html#h2"><i class="fa fa-check"></i><b>2.3.8</b> 2H2</a></li>
<li class="chapter" data-level="2.3.9" data-path="small-worlds-and-large-worlds.html"><a href="small-worlds-and-large-worlds.html#h3"><i class="fa fa-check"></i><b>2.3.9</b> 2H3</a></li>
<li class="chapter" data-level="2.3.10" data-path="small-worlds-and-large-worlds.html"><a href="small-worlds-and-large-worlds.html#h4"><i class="fa fa-check"></i><b>2.3.10</b> 2H4</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="3" data-path="sampling-the-imaginary.html"><a href="sampling-the-imaginary.html"><i class="fa fa-check"></i><b>3</b> Sampling the Imaginary</a>
<ul>
<li class="chapter" data-level="3.1" data-path="sampling-the-imaginary.html"><a href="sampling-the-imaginary.html#sampling-from-a-grid-aproximate-posterior"><i class="fa fa-check"></i><b>3.1</b> Sampling from a grid-aproximate posterior</a></li>
<li class="chapter" data-level="3.2" data-path="sampling-the-imaginary.html"><a href="sampling-the-imaginary.html#sampling-to-summarize"><i class="fa fa-check"></i><b>3.2</b> Sampling to summarize</a>
<ul>
<li class="chapter" data-level="3.2.1" data-path="sampling-the-imaginary.html"><a href="sampling-the-imaginary.html#intervals-of-defined-mass"><i class="fa fa-check"></i><b>3.2.1</b> Intervals of defined mass</a></li>
<li class="chapter" data-level="3.2.2" data-path="sampling-the-imaginary.html"><a href="sampling-the-imaginary.html#highly-skewed-example"><i class="fa fa-check"></i><b>3.2.2</b> highly skewed example</a></li>
<li class="chapter" data-level="3.2.3" data-path="sampling-the-imaginary.html"><a href="sampling-the-imaginary.html#point-estimate"><i class="fa fa-check"></i><b>3.2.3</b> Point estimate　　</a></li>
</ul></li>
<li class="chapter" data-level="3.3" data-path="sampling-the-imaginary.html"><a href="sampling-the-imaginary.html#sampling-to-simulate-prediction"><i class="fa fa-check"></i><b>3.3</b> Sampling to simulate prediction</a>
<ul>
<li class="chapter" data-level="3.3.1" data-path="sampling-the-imaginary.html"><a href="sampling-the-imaginary.html#model-checking"><i class="fa fa-check"></i><b>3.3.1</b> Model checking</a></li>
<li class="chapter" data-level="3.3.2" data-path="sampling-the-imaginary.html"><a href="sampling-the-imaginary.html#practice-with-brms"><i class="fa fa-check"></i><b>3.3.2</b> Practice with brms</a></li>
</ul></li>
<li class="chapter" data-level="3.4" data-path="sampling-the-imaginary.html"><a href="sampling-the-imaginary.html#practice-1"><i class="fa fa-check"></i><b>3.4</b> Practice</a>
<ul>
<li class="chapter" data-level="3.4.1" data-path="sampling-the-imaginary.html"><a href="sampling-the-imaginary.html#e"><i class="fa fa-check"></i><b>3.4.1</b> 3E</a></li>
<li class="chapter" data-level="3.4.2" data-path="sampling-the-imaginary.html"><a href="sampling-the-imaginary.html#m"><i class="fa fa-check"></i><b>3.4.2</b> 3M</a></li>
<li class="chapter" data-level="3.4.3" data-path="sampling-the-imaginary.html"><a href="sampling-the-imaginary.html#h"><i class="fa fa-check"></i><b>3.4.3</b> 3H</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="4" data-path="geocentric-model.html"><a href="geocentric-model.html"><i class="fa fa-check"></i><b>4</b> Geocentric Model</a>
<ul>
<li class="chapter" data-level="4.1" data-path="geocentric-model.html"><a href="geocentric-model.html#why-normal-distributions-are-normal"><i class="fa fa-check"></i><b>4.1</b> Why normal distributions are normal</a></li>
<li class="chapter" data-level="4.2" data-path="geocentric-model.html"><a href="geocentric-model.html#normal-by-multiplication"><i class="fa fa-check"></i><b>4.2</b> Normal by multiplication</a></li>
<li class="chapter" data-level="4.3" data-path="geocentric-model.html"><a href="geocentric-model.html#gaussian-model-of-height"><i class="fa fa-check"></i><b>4.3</b> Gaussian model of height</a></li>
<li class="chapter" data-level="4.4" data-path="geocentric-model.html"><a href="geocentric-model.html#grid-approximationで事後分布を描く"><i class="fa fa-check"></i><b>4.4</b> Grid approximationで事後分布を描く</a>
<ul>
<li class="chapter" data-level="4.4.1" data-path="geocentric-model.html"><a href="geocentric-model.html#事後分布からサンプリングする"><i class="fa fa-check"></i><b>4.4.1</b> 事後分布からサンプリングする</a></li>
<li class="chapter" data-level="4.4.2" data-path="geocentric-model.html"><a href="geocentric-model.html#rethinking"><i class="fa fa-check"></i><b>4.4.2</b> rethinking</a></li>
<li class="chapter" data-level="4.4.3" data-path="geocentric-model.html"><a href="geocentric-model.html#finding-posterior-with-brms"><i class="fa fa-check"></i><b>4.4.3</b> Finding posterior with brms</a></li>
<li class="chapter" data-level="4.4.4" data-path="geocentric-model.html"><a href="geocentric-model.html#事後分布からのサンプリング"><i class="fa fa-check"></i><b>4.4.4</b> 事後分布からのサンプリング</a></li>
</ul></li>
<li class="chapter" data-level="4.5" data-path="geocentric-model.html"><a href="geocentric-model.html#linear-prediction"><i class="fa fa-check"></i><b>4.5</b> Linear prediction</a>
<ul>
<li class="chapter" data-level="4.5.1" data-path="geocentric-model.html"><a href="geocentric-model.html#finding-the-posterior-distribution"><i class="fa fa-check"></i><b>4.5.1</b> Finding the posterior distribution</a></li>
<li class="chapter" data-level="4.5.2" data-path="geocentric-model.html"><a href="geocentric-model.html#plotting-posterior-inference-agaist-the-data"><i class="fa fa-check"></i><b>4.5.2</b> Plotting posterior inference agaist the data</a></li>
<li class="chapter" data-level="4.5.3" data-path="geocentric-model.html"><a href="geocentric-model.html#plotting-regression-intervals-and-contours"><i class="fa fa-check"></i><b>4.5.3</b> Plotting regression intervals and contours</a></li>
<li class="chapter" data-level="4.5.4" data-path="geocentric-model.html"><a href="geocentric-model.html#prediction-intervals"><i class="fa fa-check"></i><b>4.5.4</b> Prediction intervals</a></li>
</ul></li>
<li class="chapter" data-level="4.6" data-path="geocentric-model.html"><a href="geocentric-model.html#curves-from-lines"><i class="fa fa-check"></i><b>4.6</b> Curves from lines</a>
<ul>
<li class="chapter" data-level="4.6.1" data-path="geocentric-model.html"><a href="geocentric-model.html#polynomial-regression"><i class="fa fa-check"></i><b>4.6.1</b> Polynomial regression</a></li>
<li class="chapter" data-level="4.6.2" data-path="geocentric-model.html"><a href="geocentric-model.html#overthinking"><i class="fa fa-check"></i><b>4.6.2</b> overthinking</a></li>
<li class="chapter" data-level="4.6.3" data-path="geocentric-model.html"><a href="geocentric-model.html#splines"><i class="fa fa-check"></i><b>4.6.3</b> Splines</a></li>
</ul></li>
<li class="chapter" data-level="4.7" data-path="geocentric-model.html"><a href="geocentric-model.html#practice-2"><i class="fa fa-check"></i><b>4.7</b> Practice</a>
<ul>
<li class="chapter" data-level="4.7.1" data-path="geocentric-model.html"><a href="geocentric-model.html#m1-2"><i class="fa fa-check"></i><b>4.7.1</b> 4M1</a></li>
<li class="chapter" data-level="4.7.2" data-path="geocentric-model.html"><a href="geocentric-model.html#m2-2"><i class="fa fa-check"></i><b>4.7.2</b> 4M2</a></li>
<li class="chapter" data-level="4.7.3" data-path="geocentric-model.html"><a href="geocentric-model.html#m4-2"><i class="fa fa-check"></i><b>4.7.3</b> 4M4</a></li>
<li class="chapter" data-level="4.7.4" data-path="geocentric-model.html"><a href="geocentric-model.html#m5-2"><i class="fa fa-check"></i><b>4.7.4</b> 4M5</a></li>
<li class="chapter" data-level="4.7.5" data-path="geocentric-model.html"><a href="geocentric-model.html#m6-1"><i class="fa fa-check"></i><b>4.7.5</b> 4M6</a></li>
<li class="chapter" data-level="4.7.6" data-path="geocentric-model.html"><a href="geocentric-model.html#m7-1"><i class="fa fa-check"></i><b>4.7.6</b> 4M7</a></li>
<li class="chapter" data-level="4.7.7" data-path="geocentric-model.html"><a href="geocentric-model.html#m8"><i class="fa fa-check"></i><b>4.7.7</b> 4M8</a></li>
<li class="chapter" data-level="4.7.8" data-path="geocentric-model.html"><a href="geocentric-model.html#h1-2"><i class="fa fa-check"></i><b>4.7.8</b> 4H1</a></li>
<li class="chapter" data-level="4.7.9" data-path="geocentric-model.html"><a href="geocentric-model.html#h2-2"><i class="fa fa-check"></i><b>4.7.9</b> 4H2</a></li>
<li class="chapter" data-level="4.7.10" data-path="geocentric-model.html"><a href="geocentric-model.html#h3-2"><i class="fa fa-check"></i><b>4.7.10</b> 4H3</a></li>
<li class="chapter" data-level="4.7.11" data-path="geocentric-model.html"><a href="geocentric-model.html#h4-2"><i class="fa fa-check"></i><b>4.7.11</b> 4H4</a></li>
<li class="chapter" data-level="4.7.12" data-path="geocentric-model.html"><a href="geocentric-model.html#h5-1"><i class="fa fa-check"></i><b>4.7.12</b> 4H5</a></li>
<li class="chapter" data-level="4.7.13" data-path="geocentric-model.html"><a href="geocentric-model.html#h6"><i class="fa fa-check"></i><b>4.7.13</b> 4H6</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="5" data-path="the-many-variables-the-spurious-waffles.html"><a href="the-many-variables-the-spurious-waffles.html"><i class="fa fa-check"></i><b>5</b> The many variables &amp; the spurious waffles</a>
<ul>
<li class="chapter" data-level="5.1" data-path="the-many-variables-the-spurious-waffles.html"><a href="the-many-variables-the-spurious-waffles.html#spurious-association"><i class="fa fa-check"></i><b>5.1</b> Spurious association</a>
<ul>
<li class="chapter" data-level="5.1.1" data-path="the-many-variables-the-spurious-waffles.html"><a href="the-many-variables-the-spurious-waffles.html#グラフを用いて因果モデルを考える"><i class="fa fa-check"></i><b>5.1.1</b> グラフを用いて因果モデルを考える</a></li>
<li class="chapter" data-level="5.1.2" data-path="the-many-variables-the-spurious-waffles.html"><a href="the-many-variables-the-spurious-waffles.html#predictor-residual-plots"><i class="fa fa-check"></i><b>5.1.2</b> Predictor residual plots</a></li>
<li class="chapter" data-level="5.1.3" data-path="the-many-variables-the-spurious-waffles.html"><a href="the-many-variables-the-spurious-waffles.html#posterior-prediction-plots"><i class="fa fa-check"></i><b>5.1.3</b> Posterior prediction plots</a></li>
<li class="chapter" data-level="5.1.4" data-path="the-many-variables-the-spurious-waffles.html"><a href="the-many-variables-the-spurious-waffles.html#counterfactual-plot"><i class="fa fa-check"></i><b>5.1.4</b> Counterfactual plot</a></li>
</ul></li>
<li class="chapter" data-level="5.2" data-path="the-many-variables-the-spurious-waffles.html"><a href="the-many-variables-the-spurious-waffles.html#masked-relationship"><i class="fa fa-check"></i><b>5.2</b> Masked relationship</a>
<ul>
<li class="chapter" data-level="5.2.1" data-path="the-many-variables-the-spurious-waffles.html"><a href="the-many-variables-the-spurious-waffles.html#k-nモデル"><i class="fa fa-check"></i><b>5.2.1</b> K ~ Nモデル</a></li>
<li class="chapter" data-level="5.2.2" data-path="the-many-variables-the-spurious-waffles.html"><a href="the-many-variables-the-spurious-waffles.html#k-mモデル"><i class="fa fa-check"></i><b>5.2.2</b> K ~ Mモデル</a></li>
<li class="chapter" data-level="5.2.3" data-path="the-many-variables-the-spurious-waffles.html"><a href="the-many-variables-the-spurious-waffles.html#k-n-mモデル"><i class="fa fa-check"></i><b>5.2.3</b> K ~ N + Mモデル</a></li>
<li class="chapter" data-level="5.2.4" data-path="the-many-variables-the-spurious-waffles.html"><a href="the-many-variables-the-spurious-waffles.html#counterfactual-plot-を描く"><i class="fa fa-check"></i><b>5.2.4</b> Counterfactual plot を描く</a></li>
<li class="chapter" data-level="5.2.5" data-path="the-many-variables-the-spurious-waffles.html"><a href="the-many-variables-the-spurious-waffles.html#overthinking-1"><i class="fa fa-check"></i><b>5.2.5</b> Overthinking</a></li>
</ul></li>
<li class="chapter" data-level="5.3" data-path="the-many-variables-the-spurious-waffles.html"><a href="the-many-variables-the-spurious-waffles.html#categorical-variables"><i class="fa fa-check"></i><b>5.3</b> Categorical variables</a>
<ul>
<li class="chapter" data-level="5.3.1" data-path="the-many-variables-the-spurious-waffles.html"><a href="the-many-variables-the-spurious-waffles.html#two-categories"><i class="fa fa-check"></i><b>5.3.1</b> Two categories</a></li>
<li class="chapter" data-level="5.3.2" data-path="the-many-variables-the-spurious-waffles.html"><a href="the-many-variables-the-spurious-waffles.html#many-categories"><i class="fa fa-check"></i><b>5.3.2</b> Many Categories</a></li>
</ul></li>
<li class="chapter" data-level="5.4" data-path="the-many-variables-the-spurious-waffles.html"><a href="the-many-variables-the-spurious-waffles.html#practice-3"><i class="fa fa-check"></i><b>5.4</b> Practice</a>
<ul>
<li class="chapter" data-level="5.4.1" data-path="the-many-variables-the-spurious-waffles.html"><a href="the-many-variables-the-spurious-waffles.html#m1-3"><i class="fa fa-check"></i><b>5.4.1</b> 5M1</a></li>
<li class="chapter" data-level="5.4.2" data-path="the-many-variables-the-spurious-waffles.html"><a href="the-many-variables-the-spurious-waffles.html#m2-3"><i class="fa fa-check"></i><b>5.4.2</b> 5M2</a></li>
<li class="chapter" data-level="5.4.3" data-path="the-many-variables-the-spurious-waffles.html"><a href="the-many-variables-the-spurious-waffles.html#m4-3"><i class="fa fa-check"></i><b>5.4.3</b> 5M4</a></li>
<li class="chapter" data-level="5.4.4" data-path="the-many-variables-the-spurious-waffles.html"><a href="the-many-variables-the-spurious-waffles.html#h1-3"><i class="fa fa-check"></i><b>5.4.4</b> 5H1</a></li>
<li class="chapter" data-level="5.4.5" data-path="the-many-variables-the-spurious-waffles.html"><a href="the-many-variables-the-spurious-waffles.html#h2-3"><i class="fa fa-check"></i><b>5.4.5</b> 5H2</a></li>
<li class="chapter" data-level="5.4.6" data-path="the-many-variables-the-spurious-waffles.html"><a href="the-many-variables-the-spurious-waffles.html#h3-3"><i class="fa fa-check"></i><b>5.4.6</b> 5H3</a></li>
<li class="chapter" data-level="5.4.7" data-path="the-many-variables-the-spurious-waffles.html"><a href="the-many-variables-the-spurious-waffles.html#h4-3"><i class="fa fa-check"></i><b>5.4.7</b> 5H4</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="6" data-path="the-haunted-dag-the-causal-terror.html"><a href="the-haunted-dag-the-causal-terror.html"><i class="fa fa-check"></i><b>6</b> The Haunted DAG &amp; the Causal Terror</a>
<ul>
<li class="chapter" data-level="6.1" data-path="the-haunted-dag-the-causal-terror.html"><a href="the-haunted-dag-the-causal-terror.html#multicollinearity"><i class="fa fa-check"></i><b>6.1</b> Multicollinearity</a>
<ul>
<li class="chapter" data-level="6.1.1" data-path="the-haunted-dag-the-causal-terror.html"><a href="the-haunted-dag-the-causal-terror.html#multicollinear-milk"><i class="fa fa-check"></i><b>6.1.1</b> Multicollinear milk</a></li>
</ul></li>
<li class="chapter" data-level="6.2" data-path="the-haunted-dag-the-causal-terror.html"><a href="the-haunted-dag-the-causal-terror.html#post-treatment-bias"><i class="fa fa-check"></i><b>6.2</b> Post-treatment bias</a>
<ul>
<li class="chapter" data-level="6.2.1" data-path="the-haunted-dag-the-causal-terror.html"><a href="the-haunted-dag-the-causal-terror.html#blocked-by-consequence"><i class="fa fa-check"></i><b>6.2.1</b> Blocked by consequence</a></li>
<li class="chapter" data-level="6.2.2" data-path="the-haunted-dag-the-causal-terror.html"><a href="the-haunted-dag-the-causal-terror.html#fungus-and-d-separation"><i class="fa fa-check"></i><b>6.2.2</b> Fungus and d-separation</a></li>
</ul></li>
<li class="chapter" data-level="6.3" data-path="the-haunted-dag-the-causal-terror.html"><a href="the-haunted-dag-the-causal-terror.html#collider-bias"><i class="fa fa-check"></i><b>6.3</b> Collider bias</a>
<ul>
<li class="chapter" data-level="6.3.1" data-path="the-haunted-dag-the-causal-terror.html"><a href="the-haunted-dag-the-causal-terror.html#collider-of-false-sorrow"><i class="fa fa-check"></i><b>6.3.1</b> Collider of false sorrow</a></li>
<li class="chapter" data-level="6.3.2" data-path="the-haunted-dag-the-causal-terror.html"><a href="the-haunted-dag-the-causal-terror.html#the-haunted-dag"><i class="fa fa-check"></i><b>6.3.2</b> The haunted DAG</a></li>
</ul></li>
<li class="chapter" data-level="6.4" data-path="the-haunted-dag-the-causal-terror.html"><a href="the-haunted-dag-the-causal-terror.html#confronting-confoundings"><i class="fa fa-check"></i><b>6.4</b> Confronting confoundings</a>
<ul>
<li class="chapter" data-level="6.4.1" data-path="the-haunted-dag-the-causal-terror.html"><a href="the-haunted-dag-the-causal-terror.html#two-roads"><i class="fa fa-check"></i><b>6.4.1</b> Two roads</a></li>
<li class="chapter" data-level="6.4.2" data-path="the-haunted-dag-the-causal-terror.html"><a href="the-haunted-dag-the-causal-terror.html#backdoor-waffles"><i class="fa fa-check"></i><b>6.4.2</b> Backdoor Waffles</a></li>
</ul></li>
<li class="chapter" data-level="6.5" data-path="the-haunted-dag-the-causal-terror.html"><a href="the-haunted-dag-the-causal-terror.html#practice-4"><i class="fa fa-check"></i><b>6.5</b> Practice</a>
<ul>
<li class="chapter" data-level="6.5.1" data-path="the-haunted-dag-the-causal-terror.html"><a href="the-haunted-dag-the-causal-terror.html#m1-4"><i class="fa fa-check"></i><b>6.5.1</b> 6M1</a></li>
<li class="chapter" data-level="6.5.2" data-path="the-haunted-dag-the-causal-terror.html"><a href="the-haunted-dag-the-causal-terror.html#m2-4"><i class="fa fa-check"></i><b>6.5.2</b> 6M2</a></li>
<li class="chapter" data-level="6.5.3" data-path="the-haunted-dag-the-causal-terror.html"><a href="the-haunted-dag-the-causal-terror.html#h1-4"><i class="fa fa-check"></i><b>6.5.3</b> 6H1</a></li>
<li class="chapter" data-level="6.5.4" data-path="the-haunted-dag-the-causal-terror.html"><a href="the-haunted-dag-the-causal-terror.html#h2-4"><i class="fa fa-check"></i><b>6.5.4</b> 6H2</a></li>
<li class="chapter" data-level="6.5.5" data-path="the-haunted-dag-the-causal-terror.html"><a href="the-haunted-dag-the-causal-terror.html#h3-4"><i class="fa fa-check"></i><b>6.5.5</b> 6H3</a></li>
<li class="chapter" data-level="6.5.6" data-path="the-haunted-dag-the-causal-terror.html"><a href="the-haunted-dag-the-causal-terror.html#h4-4"><i class="fa fa-check"></i><b>6.5.6</b> 6H4</a></li>
<li class="chapter" data-level="6.5.7" data-path="the-haunted-dag-the-causal-terror.html"><a href="the-haunted-dag-the-causal-terror.html#h5-2"><i class="fa fa-check"></i><b>6.5.7</b> 6H5</a></li>
</ul></li>
<li class="chapter" data-level="6.6" data-path="the-haunted-dag-the-causal-terror.html"><a href="the-haunted-dag-the-causal-terror.html#おまけ-ランダム効果を入れてみる"><i class="fa fa-check"></i><b>6.6</b> おまけ　ランダム効果を入れてみる</a></li>
</ul></li>
<li class="chapter" data-level="7" data-path="ulysses-compass.html"><a href="ulysses-compass.html"><i class="fa fa-check"></i><b>7</b> Ulysses’ Compass</a>
<ul>
<li class="chapter" data-level="7.1" data-path="ulysses-compass.html"><a href="ulysses-compass.html#the-problems-with-parameters"><i class="fa fa-check"></i><b>7.1</b> The problems with parameters</a>
<ul>
<li class="chapter" data-level="7.1.1" data-path="ulysses-compass.html"><a href="ulysses-compass.html#more-parameters-always-improve-fit"><i class="fa fa-check"></i><b>7.1.1</b> More parameters always improve fit</a></li>
<li class="chapter" data-level="7.1.2" data-path="ulysses-compass.html"><a href="ulysses-compass.html#too-few-parameters-hurts-too"><i class="fa fa-check"></i><b>7.1.2</b> Too few parameters hurts too</a></li>
</ul></li>
<li class="chapter" data-level="7.2" data-path="ulysses-compass.html"><a href="ulysses-compass.html#entropy-and-accuracy"><i class="fa fa-check"></i><b>7.2</b> Entropy and accuracy</a>
<ul>
<li class="chapter" data-level="7.2.1" data-path="ulysses-compass.html"><a href="ulysses-compass.html#information-and-uncertainty"><i class="fa fa-check"></i><b>7.2.1</b> Information and uncertainty</a></li>
<li class="chapter" data-level="7.2.2" data-path="ulysses-compass.html"><a href="ulysses-compass.html#from-entropy-to-acculacy"><i class="fa fa-check"></i><b>7.2.2</b> From entropy to acculacy</a></li>
<li class="chapter" data-level="7.2.3" data-path="ulysses-compass.html"><a href="ulysses-compass.html#estimating-divergence"><i class="fa fa-check"></i><b>7.2.3</b> Estimating divergence</a></li>
<li class="chapter" data-level="7.2.4" data-path="ulysses-compass.html"><a href="ulysses-compass.html#scoring-the-right-data"><i class="fa fa-check"></i><b>7.2.4</b> Scoring the right data</a></li>
</ul></li>
<li class="chapter" data-level="7.3" data-path="ulysses-compass.html"><a href="ulysses-compass.html#golem-taming-regularization"><i class="fa fa-check"></i><b>7.3</b> Golem taming: regularization</a></li>
<li class="chapter" data-level="7.4" data-path="ulysses-compass.html"><a href="ulysses-compass.html#predicting-predictive-accuracy"><i class="fa fa-check"></i><b>7.4</b> Predicting predictive accuracy</a>
<ul>
<li class="chapter" data-level="7.4.1" data-path="ulysses-compass.html"><a href="ulysses-compass.html#cross-validation"><i class="fa fa-check"></i><b>7.4.1</b> Cross validation</a></li>
<li class="chapter" data-level="7.4.2" data-path="ulysses-compass.html"><a href="ulysses-compass.html#information-criteria"><i class="fa fa-check"></i><b>7.4.2</b> Information criteria</a></li>
<li class="chapter" data-level="7.4.3" data-path="ulysses-compass.html"><a href="ulysses-compass.html#overthinking-waic-calculation"><i class="fa fa-check"></i><b>7.4.3</b> overthinking: WAIC calculation</a></li>
<li class="chapter" data-level="7.4.4" data-path="ulysses-compass.html"><a href="ulysses-compass.html#comparing-cv-psis-and-waic"><i class="fa fa-check"></i><b>7.4.4</b> Comparing CV, PSIS, and WAIC</a></li>
</ul></li>
<li class="chapter" data-level="7.5" data-path="ulysses-compass.html"><a href="ulysses-compass.html#model-comparison"><i class="fa fa-check"></i><b>7.5</b> Model comparison</a>
<ul>
<li class="chapter" data-level="7.5.1" data-path="ulysses-compass.html"><a href="ulysses-compass.html#model-mis-selection"><i class="fa fa-check"></i><b>7.5.1</b> Model mis-selection</a></li>
<li class="chapter" data-level="7.5.2" data-path="ulysses-compass.html"><a href="ulysses-compass.html#outlier-and-other-illusions"><i class="fa fa-check"></i><b>7.5.2</b> Outlier and other illusions</a></li>
</ul></li>
<li class="chapter" data-level="7.6" data-path="ulysses-compass.html"><a href="ulysses-compass.html#practice-5"><i class="fa fa-check"></i><b>7.6</b> Practice</a>
<ul>
<li class="chapter" data-level="7.6.1" data-path="ulysses-compass.html"><a href="ulysses-compass.html#e2"><i class="fa fa-check"></i><b>7.6.1</b> 7E2</a></li>
<li class="chapter" data-level="7.6.2" data-path="ulysses-compass.html"><a href="ulysses-compass.html#e3"><i class="fa fa-check"></i><b>7.6.2</b> 7E3</a></li>
<li class="chapter" data-level="7.6.3" data-path="ulysses-compass.html"><a href="ulysses-compass.html#e4"><i class="fa fa-check"></i><b>7.6.3</b> 7E4</a></li>
<li class="chapter" data-level="7.6.4" data-path="ulysses-compass.html"><a href="ulysses-compass.html#m4-4"><i class="fa fa-check"></i><b>7.6.4</b> 7M4</a></li>
<li class="chapter" data-level="7.6.5" data-path="ulysses-compass.html"><a href="ulysses-compass.html#h1-5"><i class="fa fa-check"></i><b>7.6.5</b> 7H1</a></li>
<li class="chapter" data-level="7.6.6" data-path="ulysses-compass.html"><a href="ulysses-compass.html#h2-5"><i class="fa fa-check"></i><b>7.6.6</b> 7H2</a></li>
<li class="chapter" data-level="7.6.7" data-path="ulysses-compass.html"><a href="ulysses-compass.html#h3-5"><i class="fa fa-check"></i><b>7.6.7</b> 7H3</a></li>
<li class="chapter" data-level="7.6.8" data-path="ulysses-compass.html"><a href="ulysses-compass.html#h4-5"><i class="fa fa-check"></i><b>7.6.8</b> 7H4</a></li>
<li class="chapter" data-level="7.6.9" data-path="ulysses-compass.html"><a href="ulysses-compass.html#h5-3"><i class="fa fa-check"></i><b>7.6.9</b> 7H5</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="8" data-path="conditional-manatees.html"><a href="conditional-manatees.html"><i class="fa fa-check"></i><b>8</b> Conditional Manatees</a>
<ul>
<li class="chapter" data-level="8.1" data-path="conditional-manatees.html"><a href="conditional-manatees.html#building-an-interaction"><i class="fa fa-check"></i><b>8.1</b> Building an interaction</a>
<ul>
<li class="chapter" data-level="8.1.1" data-path="conditional-manatees.html"><a href="conditional-manatees.html#making-a-rugged-model"><i class="fa fa-check"></i><b>8.1.1</b> Making a rugged model</a></li>
<li class="chapter" data-level="8.1.2" data-path="conditional-manatees.html"><a href="conditional-manatees.html#adding-an-indicator-variable-isnt-enough"><i class="fa fa-check"></i><b>8.1.2</b> Adding an indicator variable isn’t enough</a></li>
<li class="chapter" data-level="8.1.3" data-path="conditional-manatees.html"><a href="conditional-manatees.html#adding-interaction-does-work"><i class="fa fa-check"></i><b>8.1.3</b> Adding interaction does work</a></li>
<li class="chapter" data-level="8.1.4" data-path="conditional-manatees.html"><a href="conditional-manatees.html#plotting-the-interaction"><i class="fa fa-check"></i><b>8.1.4</b> Plotting the interaction</a></li>
</ul></li>
<li class="chapter" data-level="8.2" data-path="conditional-manatees.html"><a href="conditional-manatees.html#symmetry-of-interaction"><i class="fa fa-check"></i><b>8.2</b> Symmetry of interaction</a></li>
<li class="chapter" data-level="8.3" data-path="conditional-manatees.html"><a href="conditional-manatees.html#continuous-interaction"><i class="fa fa-check"></i><b>8.3</b> Continuous interaction</a>
<ul>
<li class="chapter" data-level="8.3.1" data-path="conditional-manatees.html"><a href="conditional-manatees.html#a-winter-flower"><i class="fa fa-check"></i><b>8.3.1</b> A winter flower</a></li>
<li class="chapter" data-level="8.3.2" data-path="conditional-manatees.html"><a href="conditional-manatees.html#the-models"><i class="fa fa-check"></i><b>8.3.2</b> The models</a></li>
<li class="chapter" data-level="8.3.3" data-path="conditional-manatees.html"><a href="conditional-manatees.html#plotting-posterior-predictions"><i class="fa fa-check"></i><b>8.3.3</b> Plotting posterior predictions</a></li>
<li class="chapter" data-level="8.3.4" data-path="conditional-manatees.html"><a href="conditional-manatees.html#plotting-prior-predictions"><i class="fa fa-check"></i><b>8.3.4</b> Plotting prior predictions</a></li>
</ul></li>
<li class="chapter" data-level="8.4" data-path="conditional-manatees.html"><a href="conditional-manatees.html#practice-6"><i class="fa fa-check"></i><b>8.4</b> Practice</a>
<ul>
<li class="chapter" data-level="8.4.1" data-path="conditional-manatees.html"><a href="conditional-manatees.html#m4-5"><i class="fa fa-check"></i><b>8.4.1</b> 8M4</a></li>
<li class="chapter" data-level="8.4.2" data-path="conditional-manatees.html"><a href="conditional-manatees.html#h1-6"><i class="fa fa-check"></i><b>8.4.2</b> 8H1</a></li>
<li class="chapter" data-level="8.4.3" data-path="conditional-manatees.html"><a href="conditional-manatees.html#h2-6"><i class="fa fa-check"></i><b>8.4.3</b> 8H2</a></li>
<li class="chapter" data-level="8.4.4" data-path="conditional-manatees.html"><a href="conditional-manatees.html#h3-6"><i class="fa fa-check"></i><b>8.4.4</b> 8H3</a></li>
<li class="chapter" data-level="8.4.5" data-path="conditional-manatees.html"><a href="conditional-manatees.html#h4-6"><i class="fa fa-check"></i><b>8.4.5</b> 8H4</a></li>
<li class="chapter" data-level="8.4.6" data-path="conditional-manatees.html"><a href="conditional-manatees.html#h5-4"><i class="fa fa-check"></i><b>8.4.6</b> 8H5</a></li>
<li class="chapter" data-level="8.4.7" data-path="conditional-manatees.html"><a href="conditional-manatees.html#h6-1"><i class="fa fa-check"></i><b>8.4.7</b> 8H6</a></li>
<li class="chapter" data-level="8.4.8" data-path="conditional-manatees.html"><a href="conditional-manatees.html#h7"><i class="fa fa-check"></i><b>8.4.8</b> 8H7</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="9" data-path="marcov-chain-monte-carlo.html"><a href="marcov-chain-monte-carlo.html"><i class="fa fa-check"></i><b>9</b> Marcov Chain Monte Carlo</a>
<ul>
<li class="chapter" data-level="9.1" data-path="marcov-chain-monte-carlo.html"><a href="marcov-chain-monte-carlo.html#good-king-marcov-and-his-island-kingdom"><i class="fa fa-check"></i><b>9.1</b> Good King Marcov and his island kingdom</a></li>
<li class="chapter" data-level="9.2" data-path="marcov-chain-monte-carlo.html"><a href="marcov-chain-monte-carlo.html#metropolis-algorythm"><i class="fa fa-check"></i><b>9.2</b> Metropolis algorythm</a>
<ul>
<li class="chapter" data-level="9.2.1" data-path="marcov-chain-monte-carlo.html"><a href="marcov-chain-monte-carlo.html#gibbs-sampling"><i class="fa fa-check"></i><b>9.2.1</b> Gibbs sampling</a></li>
<li class="chapter" data-level="9.2.2" data-path="marcov-chain-monte-carlo.html"><a href="marcov-chain-monte-carlo.html#high-dimentional-problem"><i class="fa fa-check"></i><b>9.2.2</b> High-dimentional problem</a></li>
</ul></li>
<li class="chapter" data-level="9.3" data-path="marcov-chain-monte-carlo.html"><a href="marcov-chain-monte-carlo.html#hamiltonian-monte-carlo"><i class="fa fa-check"></i><b>9.3</b> Hamiltonian Monte Carlo</a>
<ul>
<li class="chapter" data-level="9.3.1" data-path="marcov-chain-monte-carlo.html"><a href="marcov-chain-monte-carlo.html#another-probable"><i class="fa fa-check"></i><b>9.3.1</b> Another probable</a></li>
<li class="chapter" data-level="9.3.2" data-path="marcov-chain-monte-carlo.html"><a href="marcov-chain-monte-carlo.html#limitations"><i class="fa fa-check"></i><b>9.3.2</b> Limitations</a></li>
</ul></li>
<li class="chapter" data-level="9.4" data-path="marcov-chain-monte-carlo.html"><a href="marcov-chain-monte-carlo.html#easy-hmc-ulam-brm"><i class="fa fa-check"></i><b>9.4</b> Easy HMC: <del>ulam</del> <code>brm()</code></a>
<ul>
<li class="chapter" data-level="9.4.1" data-path="marcov-chain-monte-carlo.html"><a href="marcov-chain-monte-carlo.html#preparation"><i class="fa fa-check"></i><b>9.4.1</b> Preparation</a></li>
<li class="chapter" data-level="9.4.2" data-path="marcov-chain-monte-carlo.html"><a href="marcov-chain-monte-carlo.html#sampling-from-posterior"><i class="fa fa-check"></i><b>9.4.2</b> Sampling from posterior</a></li>
<li class="chapter" data-level="9.4.3" data-path="marcov-chain-monte-carlo.html"><a href="marcov-chain-monte-carlo.html#sampling-again-in-parallel"><i class="fa fa-check"></i><b>9.4.3</b> Sampling again in parallel</a></li>
<li class="chapter" data-level="9.4.4" data-path="marcov-chain-monte-carlo.html"><a href="marcov-chain-monte-carlo.html#visualization"><i class="fa fa-check"></i><b>9.4.4</b> Visualization</a></li>
<li class="chapter" data-level="9.4.5" data-path="marcov-chain-monte-carlo.html"><a href="marcov-chain-monte-carlo.html#checking-the-chain"><i class="fa fa-check"></i><b>9.4.5</b> Checking the chain</a></li>
</ul></li>
<li class="chapter" data-level="9.5" data-path="marcov-chain-monte-carlo.html"><a href="marcov-chain-monte-carlo.html#care-and-feeding-of-your-marcov-chain"><i class="fa fa-check"></i><b>9.5</b> Care and feeding of your Marcov chain</a>
<ul>
<li class="chapter" data-level="9.5.1" data-path="marcov-chain-monte-carlo.html"><a href="marcov-chain-monte-carlo.html#how-many-samples-do-you-need"><i class="fa fa-check"></i><b>9.5.1</b> How many samples do you need</a></li>
<li class="chapter" data-level="9.5.2" data-path="marcov-chain-monte-carlo.html"><a href="marcov-chain-monte-carlo.html#how-many-chains-do-we-need"><i class="fa fa-check"></i><b>9.5.2</b> How many chains do we need</a></li>
<li class="chapter" data-level="9.5.3" data-path="marcov-chain-monte-carlo.html"><a href="marcov-chain-monte-carlo.html#taming-and-wild-chain"><i class="fa fa-check"></i><b>9.5.3</b> Taming and wild chain</a></li>
<li class="chapter" data-level="9.5.4" data-path="marcov-chain-monte-carlo.html"><a href="marcov-chain-monte-carlo.html#non-identifiable-parameters"><i class="fa fa-check"></i><b>9.5.4</b> Non-identifiable parameters</a></li>
</ul></li>
<li class="chapter" data-level="9.6" data-path="marcov-chain-monte-carlo.html"><a href="marcov-chain-monte-carlo.html#practice-7"><i class="fa fa-check"></i><b>9.6</b> Practice</a>
<ul>
<li class="chapter" data-level="9.6.1" data-path="marcov-chain-monte-carlo.html"><a href="marcov-chain-monte-carlo.html#m1-5"><i class="fa fa-check"></i><b>9.6.1</b> 9M1</a></li>
<li class="chapter" data-level="9.6.2" data-path="marcov-chain-monte-carlo.html"><a href="marcov-chain-monte-carlo.html#m2-5"><i class="fa fa-check"></i><b>9.6.2</b> 9M2</a></li>
<li class="chapter" data-level="9.6.3" data-path="marcov-chain-monte-carlo.html"><a href="marcov-chain-monte-carlo.html#m3-2"><i class="fa fa-check"></i><b>9.6.3</b> 9M3</a></li>
<li class="chapter" data-level="9.6.4" data-path="marcov-chain-monte-carlo.html"><a href="marcov-chain-monte-carlo.html#h1-7"><i class="fa fa-check"></i><b>9.6.4</b> 9H1</a></li>
<li class="chapter" data-level="9.6.5" data-path="marcov-chain-monte-carlo.html"><a href="marcov-chain-monte-carlo.html#h2-7"><i class="fa fa-check"></i><b>9.6.5</b> 9H2</a></li>
<li class="chapter" data-level="9.6.6" data-path="marcov-chain-monte-carlo.html"><a href="marcov-chain-monte-carlo.html#h3-7"><i class="fa fa-check"></i><b>9.6.6</b> 9H3</a></li>
<li class="chapter" data-level="9.6.7" data-path="marcov-chain-monte-carlo.html"><a href="marcov-chain-monte-carlo.html#h4-7"><i class="fa fa-check"></i><b>9.6.7</b> 9H4</a></li>
<li class="chapter" data-level="9.6.8" data-path="marcov-chain-monte-carlo.html"><a href="marcov-chain-monte-carlo.html#h5-5"><i class="fa fa-check"></i><b>9.6.8</b> 9H5</a></li>
<li class="chapter" data-level="9.6.9" data-path="marcov-chain-monte-carlo.html"><a href="marcov-chain-monte-carlo.html#h6-2"><i class="fa fa-check"></i><b>9.6.9</b> 9H6</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="10" data-path="big-entropy-and-the-generalized-linear-model.html"><a href="big-entropy-and-the-generalized-linear-model.html"><i class="fa fa-check"></i><b>10</b> Big Entropy and the Generalized Linear Model</a>
<ul>
<li class="chapter" data-level="10.1" data-path="big-entropy-and-the-generalized-linear-model.html"><a href="big-entropy-and-the-generalized-linear-model.html#maximum-entropy"><i class="fa fa-check"></i><b>10.1</b> Maximum entropy</a>
<ul>
<li class="chapter" data-level="10.1.1" data-path="big-entropy-and-the-generalized-linear-model.html"><a href="big-entropy-and-the-generalized-linear-model.html#gaussian"><i class="fa fa-check"></i><b>10.1.1</b> Gaussian</a></li>
<li class="chapter" data-level="10.1.2" data-path="big-entropy-and-the-generalized-linear-model.html"><a href="big-entropy-and-the-generalized-linear-model.html#binomial"><i class="fa fa-check"></i><b>10.1.2</b> Binomial</a></li>
</ul></li>
<li class="chapter" data-level="10.2" data-path="big-entropy-and-the-generalized-linear-model.html"><a href="big-entropy-and-the-generalized-linear-model.html#generalized-linear-models"><i class="fa fa-check"></i><b>10.2</b> Generalized linear models</a>
<ul>
<li class="chapter" data-level="10.2.1" data-path="big-entropy-and-the-generalized-linear-model.html"><a href="big-entropy-and-the-generalized-linear-model.html#meet-the-family"><i class="fa fa-check"></i><b>10.2.1</b> Meet the family</a></li>
<li class="chapter" data-level="10.2.2" data-path="big-entropy-and-the-generalized-linear-model.html"><a href="big-entropy-and-the-generalized-linear-model.html#linking-linear-models-to-distributions"><i class="fa fa-check"></i><b>10.2.2</b> Linking linear models to distributions</a></li>
<li class="chapter" data-level="10.2.3" data-path="big-entropy-and-the-generalized-linear-model.html"><a href="big-entropy-and-the-generalized-linear-model.html#overthinking-2"><i class="fa fa-check"></i><b>10.2.3</b> Overthinking</a></li>
<li class="chapter" data-level="10.2.4" data-path="big-entropy-and-the-generalized-linear-model.html"><a href="big-entropy-and-the-generalized-linear-model.html#omitted-variable-bias-again"><i class="fa fa-check"></i><b>10.2.4</b> Omitted variable bias again</a></li>
<li class="chapter" data-level="10.2.5" data-path="big-entropy-and-the-generalized-linear-model.html"><a href="big-entropy-and-the-generalized-linear-model.html#absolute-and-relative-differences"><i class="fa fa-check"></i><b>10.2.5</b> Absolute and relative differences</a></li>
<li class="chapter" data-level="10.2.6" data-path="big-entropy-and-the-generalized-linear-model.html"><a href="big-entropy-and-the-generalized-linear-model.html#glms-and-information-criteria"><i class="fa fa-check"></i><b>10.2.6</b> GLMs and information criteria</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="11" data-path="god-spiked-the-integers.html"><a href="god-spiked-the-integers.html"><i class="fa fa-check"></i><b>11</b> God Spiked the Integers</a>
<ul>
<li class="chapter" data-level="11.1" data-path="god-spiked-the-integers.html"><a href="god-spiked-the-integers.html#binomial-regression"><i class="fa fa-check"></i><b>11.1</b> Binomial regression</a>
<ul>
<li class="chapter" data-level="11.1.1" data-path="god-spiked-the-integers.html"><a href="god-spiked-the-integers.html#logistic-regression"><i class="fa fa-check"></i><b>11.1.1</b> Logistic regression</a></li>
<li class="chapter" data-level="11.1.2" data-path="god-spiked-the-integers.html"><a href="god-spiked-the-integers.html#relative-shark-and-absolute-deer"><i class="fa fa-check"></i><b>11.1.2</b> Relative shark and absolute deer</a></li>
<li class="chapter" data-level="11.1.3" data-path="god-spiked-the-integers.html"><a href="god-spiked-the-integers.html#aggregated-binomial-chimpanzees-again-condensed"><i class="fa fa-check"></i><b>11.1.3</b> Aggregated binomial: Chimpanzees again, condensed</a></li>
</ul></li>
<li class="chapter" data-level="11.2" data-path="god-spiked-the-integers.html"><a href="god-spiked-the-integers.html#aggregated-binomial-graduate-school-admittions."><i class="fa fa-check"></i><b>11.2</b> Aggregated binomial: Graduate school admittions.</a></li>
<li class="chapter" data-level="11.3" data-path="god-spiked-the-integers.html"><a href="god-spiked-the-integers.html#poisson-regression"><i class="fa fa-check"></i><b>11.3</b> Poisson regression</a>
<ul>
<li class="chapter" data-level="11.3.1" data-path="god-spiked-the-integers.html"><a href="god-spiked-the-integers.html#oceanic-tool-complexity"><i class="fa fa-check"></i><b>11.3.1</b> Oceanic tool complexity</a></li>
<li class="chapter" data-level="11.3.2" data-path="god-spiked-the-integers.html"><a href="god-spiked-the-integers.html#negative-binomial-gamma-poisson-models."><i class="fa fa-check"></i><b>11.3.2</b> Negative binomial (Gamma-Poisson) models.</a></li>
<li class="chapter" data-level="11.3.3" data-path="god-spiked-the-integers.html"><a href="god-spiked-the-integers.html#example-exposure-and-the-offset"><i class="fa fa-check"></i><b>11.3.3</b> Example: Exposure and the offset</a></li>
</ul></li>
<li class="chapter" data-level="11.4" data-path="god-spiked-the-integers.html"><a href="god-spiked-the-integers.html#multinomial-and-categorical-models"><i class="fa fa-check"></i><b>11.4</b> Multinomial and categorical models</a>
<ul>
<li class="chapter" data-level="11.4.1" data-path="god-spiked-the-integers.html"><a href="god-spiked-the-integers.html#predictors-matched-to-outcomes"><i class="fa fa-check"></i><b>11.4.1</b> Predictors matched to outcomes</a></li>
<li class="chapter" data-level="11.4.2" data-path="god-spiked-the-integers.html"><a href="god-spiked-the-integers.html#predictor-matched-to-observations"><i class="fa fa-check"></i><b>11.4.2</b> Predictor matched to observations</a></li>
<li class="chapter" data-level="11.4.3" data-path="god-spiked-the-integers.html"><a href="god-spiked-the-integers.html#multinomial-in-disguise-as-poisson"><i class="fa fa-check"></i><b>11.4.3</b> Multinomial in disguise as Poisson</a></li>
</ul></li>
<li class="chapter" data-level="11.5" data-path="god-spiked-the-integers.html"><a href="god-spiked-the-integers.html#practice-8"><i class="fa fa-check"></i><b>11.5</b> Practice</a>
<ul>
<li class="chapter" data-level="11.5.1" data-path="god-spiked-the-integers.html"><a href="god-spiked-the-integers.html#e1"><i class="fa fa-check"></i><b>11.5.1</b> 11E1</a></li>
<li class="chapter" data-level="11.5.2" data-path="god-spiked-the-integers.html"><a href="god-spiked-the-integers.html#e2-1"><i class="fa fa-check"></i><b>11.5.2</b> 11E2</a></li>
<li class="chapter" data-level="11.5.3" data-path="god-spiked-the-integers.html"><a href="god-spiked-the-integers.html#e3-1"><i class="fa fa-check"></i><b>11.5.3</b> 11E3</a></li>
<li class="chapter" data-level="11.5.4" data-path="god-spiked-the-integers.html"><a href="god-spiked-the-integers.html#e4-1"><i class="fa fa-check"></i><b>11.5.4</b> 11E4</a></li>
<li class="chapter" data-level="11.5.5" data-path="god-spiked-the-integers.html"><a href="god-spiked-the-integers.html#m7-2"><i class="fa fa-check"></i><b>11.5.5</b> 11M7</a></li>
<li class="chapter" data-level="11.5.6" data-path="god-spiked-the-integers.html"><a href="god-spiked-the-integers.html#m8-1"><i class="fa fa-check"></i><b>11.5.6</b> 11M8</a></li>
<li class="chapter" data-level="11.5.7" data-path="god-spiked-the-integers.html"><a href="god-spiked-the-integers.html#h1-8"><i class="fa fa-check"></i><b>11.5.7</b> 11H1</a></li>
<li class="chapter" data-level="11.5.8" data-path="god-spiked-the-integers.html"><a href="god-spiked-the-integers.html#h2-8"><i class="fa fa-check"></i><b>11.5.8</b> 11H2</a></li>
<li class="chapter" data-level="11.5.9" data-path="god-spiked-the-integers.html"><a href="god-spiked-the-integers.html#h3-8"><i class="fa fa-check"></i><b>11.5.9</b> 11H3</a></li>
<li class="chapter" data-level="11.5.10" data-path="god-spiked-the-integers.html"><a href="god-spiked-the-integers.html#h4-8"><i class="fa fa-check"></i><b>11.5.10</b> 11H4</a></li>
<li class="chapter" data-level="11.5.11" data-path="god-spiked-the-integers.html"><a href="god-spiked-the-integers.html#h5-6"><i class="fa fa-check"></i><b>11.5.11</b> 11H5</a></li>
<li class="chapter" data-level="11.5.12" data-path="god-spiked-the-integers.html"><a href="god-spiked-the-integers.html#h6-3"><i class="fa fa-check"></i><b>11.5.12</b> 11H6</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="12" data-path="monsters-and-mixtures.html"><a href="monsters-and-mixtures.html"><i class="fa fa-check"></i><b>12</b> Monsters and Mixtures</a>
<ul>
<li class="chapter" data-level="12.1" data-path="monsters-and-mixtures.html"><a href="monsters-and-mixtures.html#over-dispersed-counts"><i class="fa fa-check"></i><b>12.1</b> Over-dispersed counts</a>
<ul>
<li class="chapter" data-level="12.1.1" data-path="monsters-and-mixtures.html"><a href="monsters-and-mixtures.html#beta-binomial."><i class="fa fa-check"></i><b>12.1.1</b> Beta binomial.</a></li>
<li class="chapter" data-level="12.1.2" data-path="monsters-and-mixtures.html"><a href="monsters-and-mixtures.html#negative-binomial-or-gamma-poisson."><i class="fa fa-check"></i><b>12.1.2</b> Negative binomial or gamma-Poisson.</a></li>
<li class="chapter" data-level="12.1.3" data-path="monsters-and-mixtures.html"><a href="monsters-and-mixtures.html#over-dispersion-entropy-and-information-criteria."><i class="fa fa-check"></i><b>12.1.3</b> Over-dispersion, entropy, and information criteria.</a></li>
</ul></li>
<li class="chapter" data-level="12.2" data-path="monsters-and-mixtures.html"><a href="monsters-and-mixtures.html#zero-inflated-outcomes"><i class="fa fa-check"></i><b>12.2</b> Zero-inflated outcomes</a>
<ul>
<li class="chapter" data-level="12.2.1" data-path="monsters-and-mixtures.html"><a href="monsters-and-mixtures.html#example-zero-inflated-poisson."><i class="fa fa-check"></i><b>12.2.1</b> Example: Zero-inflated Poisson.</a></li>
</ul></li>
<li class="chapter" data-level="12.3" data-path="monsters-and-mixtures.html"><a href="monsters-and-mixtures.html#ordered-categorical-outcomes"><i class="fa fa-check"></i><b>12.3</b> Ordered categorical outcomes</a>
<ul>
<li class="chapter" data-level="12.3.1" data-path="monsters-and-mixtures.html"><a href="monsters-and-mixtures.html#example-moral-intuition."><i class="fa fa-check"></i><b>12.3.1</b> Example: Moral intuition.</a></li>
<li class="chapter" data-level="12.3.2" data-path="monsters-and-mixtures.html"><a href="monsters-and-mixtures.html#adding-predictor-variables."><i class="fa fa-check"></i><b>12.3.2</b> Adding predictor variables.</a></li>
</ul></li>
<li class="chapter" data-level="12.4" data-path="monsters-and-mixtures.html"><a href="monsters-and-mixtures.html#ordered-categorical-predictors"><i class="fa fa-check"></i><b>12.4</b> Ordered categorical predictors</a></li>
<li class="chapter" data-level="12.5" data-path="monsters-and-mixtures.html"><a href="monsters-and-mixtures.html#practice-9"><i class="fa fa-check"></i><b>12.5</b> Practice</a>
<ul>
<li class="chapter" data-level="12.5.1" data-path="monsters-and-mixtures.html"><a href="monsters-and-mixtures.html#m1-6"><i class="fa fa-check"></i><b>12.5.1</b> 12M1</a></li>
<li class="chapter" data-level="12.5.2" data-path="monsters-and-mixtures.html"><a href="monsters-and-mixtures.html#m2-6"><i class="fa fa-check"></i><b>12.5.2</b> 12M2</a></li>
<li class="chapter" data-level="12.5.3" data-path="monsters-and-mixtures.html"><a href="monsters-and-mixtures.html#m3-3"><i class="fa fa-check"></i><b>12.5.3</b> 12M3</a></li>
<li class="chapter" data-level="12.5.4" data-path="monsters-and-mixtures.html"><a href="monsters-and-mixtures.html#h1-9"><i class="fa fa-check"></i><b>12.5.4</b> 12H1</a></li>
<li class="chapter" data-level="12.5.5" data-path="monsters-and-mixtures.html"><a href="monsters-and-mixtures.html#h2-9"><i class="fa fa-check"></i><b>12.5.5</b> 12H2</a></li>
<li class="chapter" data-level="12.5.6" data-path="monsters-and-mixtures.html"><a href="monsters-and-mixtures.html#h3-9"><i class="fa fa-check"></i><b>12.5.6</b> 12H3</a></li>
<li class="chapter" data-level="12.5.7" data-path="monsters-and-mixtures.html"><a href="monsters-and-mixtures.html#h4-9"><i class="fa fa-check"></i><b>12.5.7</b> 12H4</a></li>
<li class="chapter" data-level="12.5.8" data-path="monsters-and-mixtures.html"><a href="monsters-and-mixtures.html#h5-7"><i class="fa fa-check"></i><b>12.5.8</b> 12H5</a></li>
<li class="chapter" data-level="12.5.9" data-path="monsters-and-mixtures.html"><a href="monsters-and-mixtures.html#h6-4"><i class="fa fa-check"></i><b>12.5.9</b> 12H6</a></li>
<li class="chapter" data-level="12.5.10" data-path="monsters-and-mixtures.html"><a href="monsters-and-mixtures.html#h7-1"><i class="fa fa-check"></i><b>12.5.10</b> 12H7</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="13" data-path="models-with-memory.html"><a href="models-with-memory.html"><i class="fa fa-check"></i><b>13</b> Models with Memory</a>
<ul>
<li class="chapter" data-level="13.1" data-path="models-with-memory.html"><a href="models-with-memory.html#multilevel-tadpoles"><i class="fa fa-check"></i><b>13.1</b> Multilevel tadpoles</a></li>
<li class="chapter" data-level="13.2" data-path="models-with-memory.html"><a href="models-with-memory.html#varying-effects-and-the-underfittingoverfitting-trade-off"><i class="fa fa-check"></i><b>13.2</b> Varying effects and the underfitting/overfitting trade-off 　</a>
<ul>
<li class="chapter" data-level="13.2.1" data-path="models-with-memory.html"><a href="models-with-memory.html#the-model"><i class="fa fa-check"></i><b>13.2.1</b> The model</a></li>
<li class="chapter" data-level="13.2.2" data-path="models-with-memory.html"><a href="models-with-memory.html#simulate-survivors"><i class="fa fa-check"></i><b>13.2.2</b> Simulate survivors</a></li>
</ul></li>
<li class="chapter" data-level="13.3" data-path="models-with-memory.html"><a href="models-with-memory.html#more-than-one-type-of-cluster"><i class="fa fa-check"></i><b>13.3</b> More than one type of cluster</a>
<ul>
<li class="chapter" data-level="13.3.1" data-path="models-with-memory.html"><a href="models-with-memory.html#even-more-clusters"><i class="fa fa-check"></i><b>13.3.1</b> Even more clusters</a></li>
</ul></li>
<li class="chapter" data-level="13.4" data-path="models-with-memory.html"><a href="models-with-memory.html#divergent-transitions-and-non-centered-priors"><i class="fa fa-check"></i><b>13.4</b> Divergent transitions and non-centered priors</a>
<ul>
<li class="chapter" data-level="13.4.1" data-path="models-with-memory.html"><a href="models-with-memory.html#the-devils-funnel"><i class="fa fa-check"></i><b>13.4.1</b> The Devil’s Funnel</a></li>
<li class="chapter" data-level="13.4.2" data-path="models-with-memory.html"><a href="models-with-memory.html#non-centered-chimpanzees"><i class="fa fa-check"></i><b>13.4.2</b> Non-centered chimpanzees</a></li>
</ul></li>
<li class="chapter" data-level="13.5" data-path="models-with-memory.html"><a href="models-with-memory.html#multilevel-posterior-predictions"><i class="fa fa-check"></i><b>13.5</b> Multilevel posterior predictions</a>
<ul>
<li class="chapter" data-level="13.5.1" data-path="models-with-memory.html"><a href="models-with-memory.html#posterior-prediction-for-same-clusters"><i class="fa fa-check"></i><b>13.5.1</b> Posterior prediction for same clusters</a></li>
<li class="chapter" data-level="13.5.2" data-path="models-with-memory.html"><a href="models-with-memory.html#posterior-prediction-for-new-clusters"><i class="fa fa-check"></i><b>13.5.2</b> Posterior prediction for new clusters</a></li>
</ul></li>
<li class="chapter" data-level="13.6" data-path="models-with-memory.html"><a href="models-with-memory.html#post-stratification"><i class="fa fa-check"></i><b>13.6</b> Post stratification</a>
<ul>
<li class="chapter" data-level="13.6.1" data-path="models-with-memory.html"><a href="models-with-memory.html#meet-the-data"><i class="fa fa-check"></i><b>13.6.1</b> Meet the data</a></li>
<li class="chapter" data-level="13.6.2" data-path="models-with-memory.html"><a href="models-with-memory.html#settle-the-mr-part-of-mrp."><i class="fa fa-check"></i><b>13.6.2</b> Settle the MR part of MRP.</a></li>
<li class="chapter" data-level="13.6.3" data-path="models-with-memory.html"><a href="models-with-memory.html#post-stratify-to-put-the-p-in-mrp."><i class="fa fa-check"></i><b>13.6.3</b> Post-stratify to put the P in MRP.</a></li>
</ul></li>
<li class="chapter" data-level="13.7" data-path="models-with-memory.html"><a href="models-with-memory.html#practice-10"><i class="fa fa-check"></i><b>13.7</b> Practice</a>
<ul>
<li class="chapter" data-level="13.7.1" data-path="models-with-memory.html"><a href="models-with-memory.html#m1-7"><i class="fa fa-check"></i><b>13.7.1</b> 13M1</a></li>
<li class="chapter" data-level="13.7.2" data-path="models-with-memory.html"><a href="models-with-memory.html#m2-7"><i class="fa fa-check"></i><b>13.7.2</b> 13M2</a></li>
<li class="chapter" data-level="13.7.3" data-path="models-with-memory.html"><a href="models-with-memory.html#m3-4"><i class="fa fa-check"></i><b>13.7.3</b> 13M3</a></li>
<li class="chapter" data-level="13.7.4" data-path="models-with-memory.html"><a href="models-with-memory.html#m4-6"><i class="fa fa-check"></i><b>13.7.4</b> 13M4</a></li>
<li class="chapter" data-level="13.7.5" data-path="models-with-memory.html"><a href="models-with-memory.html#m5-3"><i class="fa fa-check"></i><b>13.7.5</b> 13M5</a></li>
<li class="chapter" data-level="13.7.6" data-path="models-with-memory.html"><a href="models-with-memory.html#m6-2"><i class="fa fa-check"></i><b>13.7.6</b> 13M6</a></li>
<li class="chapter" data-level="13.7.7" data-path="models-with-memory.html"><a href="models-with-memory.html#h1-10"><i class="fa fa-check"></i><b>13.7.7</b> 13H1</a></li>
<li class="chapter" data-level="13.7.8" data-path="models-with-memory.html"><a href="models-with-memory.html#h2-10"><i class="fa fa-check"></i><b>13.7.8</b> 13H2</a></li>
<li class="chapter" data-level="13.7.9" data-path="models-with-memory.html"><a href="models-with-memory.html#h3-10"><i class="fa fa-check"></i><b>13.7.9</b> 13H3</a></li>
<li class="chapter" data-level="13.7.10" data-path="models-with-memory.html"><a href="models-with-memory.html#h4-10"><i class="fa fa-check"></i><b>13.7.10</b> 13H4</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="14" data-path="adventures-in-covariance.html"><a href="adventures-in-covariance.html"><i class="fa fa-check"></i><b>14</b> Adventures in Covariance</a>
<ul>
<li class="chapter" data-level="14.1" data-path="adventures-in-covariance.html"><a href="adventures-in-covariance.html#varying-slopes-by-construction"><i class="fa fa-check"></i><b>14.1</b> Varying slopes by construction</a>
<ul>
<li class="chapter" data-level="14.1.1" data-path="adventures-in-covariance.html"><a href="adventures-in-covariance.html#simulate-and-population"><i class="fa fa-check"></i><b>14.1.1</b> Simulate and population</a></li>
<li class="chapter" data-level="14.1.2" data-path="adventures-in-covariance.html"><a href="adventures-in-covariance.html#simulate-observation"><i class="fa fa-check"></i><b>14.1.2</b> Simulate observation</a></li>
<li class="chapter" data-level="14.1.3" data-path="adventures-in-covariance.html"><a href="adventures-in-covariance.html#the-varying-slope-model"><i class="fa fa-check"></i><b>14.1.3</b> The varying slope model</a></li>
</ul></li>
<li class="chapter" data-level="14.2" data-path="adventures-in-covariance.html"><a href="adventures-in-covariance.html#advanced-varing-slopes"><i class="fa fa-check"></i><b>14.2</b> Advanced varing slopes</a></li>
<li class="chapter" data-level="14.3" data-path="adventures-in-covariance.html"><a href="adventures-in-covariance.html#instruments-and-causal-designs"><i class="fa fa-check"></i><b>14.3</b> Instruments and causal designs</a>
<ul>
<li class="chapter" data-level="14.3.1" data-path="adventures-in-covariance.html"><a href="adventures-in-covariance.html#instrumental-variables"><i class="fa fa-check"></i><b>14.3.1</b> Instrumental variables</a></li>
<li class="chapter" data-level="14.3.2" data-path="adventures-in-covariance.html"><a href="adventures-in-covariance.html#other-designs"><i class="fa fa-check"></i><b>14.3.2</b> Other designs</a></li>
</ul></li>
<li class="chapter" data-level="14.4" data-path="adventures-in-covariance.html"><a href="adventures-in-covariance.html#social-relations-as-correlated-varying-effects"><i class="fa fa-check"></i><b>14.4</b> Social relations as correlated varying effects</a></li>
<li class="chapter" data-level="14.5" data-path="adventures-in-covariance.html"><a href="adventures-in-covariance.html#continuous-categories-and-the-gaussian-process"><i class="fa fa-check"></i><b>14.5</b> Continuous categories and the Gaussian process</a>
<ul>
<li class="chapter" data-level="14.5.1" data-path="adventures-in-covariance.html"><a href="adventures-in-covariance.html#example-spatial-autocorrelation-in-oceanic-tools"><i class="fa fa-check"></i><b>14.5.1</b> Example: Spatial autocorrelation in Oceanic tools</a></li>
<li class="chapter" data-level="14.5.2" data-path="adventures-in-covariance.html"><a href="adventures-in-covariance.html#example-phylogenetic-distance"><i class="fa fa-check"></i><b>14.5.2</b> Example: Phylogenetic distance</a></li>
</ul></li>
<li class="chapter" data-level="14.6" data-path="adventures-in-covariance.html"><a href="adventures-in-covariance.html#practice-11"><i class="fa fa-check"></i><b>14.6</b> Practice</a>
<ul>
<li class="chapter" data-level="14.6.1" data-path="adventures-in-covariance.html"><a href="adventures-in-covariance.html#m1-8"><i class="fa fa-check"></i><b>14.6.1</b> 14M1</a></li>
<li class="chapter" data-level="14.6.2" data-path="adventures-in-covariance.html"><a href="adventures-in-covariance.html#m2-8"><i class="fa fa-check"></i><b>14.6.2</b> 14M2</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="" data-path="実行環境.html"><a href="実行環境.html"><i class="fa fa-check"></i>実行環境</a></li>
</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Statistical Rethinking Second Edition</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="conditional-manatees" class="section level1 hasAnchor" number="8">
<h1><span class="header-section-number">8</span> Conditional Manatees<a href="conditional-manatees.html#conditional-manatees" class="anchor-section" aria-label="Anchor link to header"></a></h1>
<div id="building-an-interaction" class="section level2 hasAnchor" number="8.1">
<h2><span class="header-section-number">8.1</span> Building an interaction<a href="conditional-manatees.html#building-an-interaction" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>アフリカとそれ以外の地域で地形の悪さ(terrain ruggedness)とGDPの関係を調べる。地形が悪いほど経済活動が阻害され、GDPも小さくなると予想されるが、アフリカではむしろ逆の関係がみられる。</p>
<div class="sourceCode" id="cb673"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb673-1"><a href="conditional-manatees.html#cb673-1" aria-hidden="true" tabindex="-1"></a><span class="do">## データ読み込み  </span></span>
<span id="cb673-2"><a href="conditional-manatees.html#cb673-2" aria-hidden="true" tabindex="-1"></a><span class="fu">data</span>(rugged)</span>
<span id="cb673-3"><a href="conditional-manatees.html#cb673-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb673-4"><a href="conditional-manatees.html#cb673-4" aria-hidden="true" tabindex="-1"></a>d <span class="ot">&lt;-</span> rugged</span>
<span id="cb673-5"><a href="conditional-manatees.html#cb673-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb673-6"><a href="conditional-manatees.html#cb673-6" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(rugged)</span></code></pre></div>
<pre><code>##   isocode isonum     country rugged rugged_popw rugged_slope rugged_lsd
## 1     ABW    533       Aruba  0.462       0.380        1.226      0.144
## 2     AFG      4 Afghanistan  2.518       1.469        7.414      0.720
## 3     AGO     24      Angola  0.858       0.714        2.274      0.228
## 4     AIA    660    Anguilla  0.013       0.010        0.026      0.006
## 5     ALB      8     Albania  3.427       1.597       10.451      1.006
## 6     AND     20     Andorra  5.717       6.722       17.774      1.616
##   rugged_pc land_area     lat     lon    soil desert tropical dist_coast
## 1     0.000        18  12.508 -69.970  21.324  0.000  100.000      0.001
## 2    39.004     65209  33.833  66.026  27.849  4.356    0.000      0.922
## 3     4.906    124670 -12.299  17.551  26.676  0.425   44.346      0.428
## 4     0.000         9  18.231 -63.064 100.000  0.000  100.000      0.000
## 5    62.133      2740  41.143  20.070  68.088  0.000    0.000      0.048
## 6    99.064        47  42.551   1.576   0.000  0.000    0.000      0.134
##   near_coast gemstones rgdppc_2000 rgdppc_1950_m rgdppc_1975_m rgdppc_2000_m
## 1   100.0000         0          NA            NA            NA            NA
## 2     0.0000         0          NA       644.756       720.633       565.231
## 3    13.1587     47756    1794.729      1051.822      1073.036       765.215
## 4   100.0000         0          NA            NA            NA            NA
## 5    94.6919         0    3703.113      1001.339      2289.472      2741.420
## 6     0.0000         0          NA            NA            NA            NA
##   rgdppc_1950_2000_m q_rule_law cont_africa cont_asia cont_europe cont_oceania
## 1                 NA         NA           0         0           0            0
## 2            679.791     -1.687           0         1           0            0
## 3           1106.763     -1.567           1         0           0            0
## 4                 NA         NA           0         0           0            0
## 5           1931.784     -0.820           0         0           1            0
## 6                 NA      1.515           0         0           1            0
##   cont_north_america cont_south_america legor_gbr legor_fra legor_soc legor_deu
## 1                  1                  0         0         1         0         0
## 2                  0                  0         0         1         0         0
## 3                  0                  0         0         1         0         0
## 4                  1                  0        NA        NA        NA        NA
## 5                  0                  0         0         0         1         0
## 6                  0                  0         0         1         0         0
##   legor_sca colony_esp colony_gbr colony_fra colony_prt colony_oeu
## 1         0          0          0          0          0          0
## 2         0          0          0          0          0          0
## 3         0          0          0          0          1          0
## 4        NA          0          0          0          0          0
## 5         0          0          0          0          0          0
## 6         0          0          0          0          0          0
##   africa_region_n africa_region_s africa_region_w africa_region_e
## 1               0               0               0               0
## 2               0               0               0               0
## 3               0               0               0               0
## 4               0               0               0               0
## 5               0               0               0               0
## 6               0               0               0               0
##   africa_region_c slave_exports dist_slavemkt_atlantic dist_slavemkt_indian
## 1               0             0                     NA                   NA
## 2               0             0                     NA                   NA
## 3               1       3610000                  5.669                6.981
## 4               0             0                     NA                   NA
## 5               0             0                     NA                   NA
## 6               0             0                     NA                   NA
##   dist_slavemkt_saharan dist_slavemkt_redsea pop_1400 european_descent
## 1                    NA                   NA      614               NA
## 2                    NA                   NA  1870829                0
## 3                 4.926                3.872  1223208                2
## 4                    NA                   NA       NA               NA
## 5                    NA                   NA   200000              100
## 6                    NA                   NA       NA               NA</code></pre>
<div class="sourceCode" id="cb675"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb675-1"><a href="conditional-manatees.html#cb675-1" aria-hidden="true" tabindex="-1"></a><span class="do">## 標準化(GDPは対数をとる)</span></span>
<span id="cb675-2"><a href="conditional-manatees.html#cb675-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(lemon)</span>
<span id="cb675-3"><a href="conditional-manatees.html#cb675-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb675-4"><a href="conditional-manatees.html#cb675-4" aria-hidden="true" tabindex="-1"></a>d <span class="sc">%&gt;%</span> </span>
<span id="cb675-5"><a href="conditional-manatees.html#cb675-5" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">select</span>(country,cont_africa,rugged,rgdppc_2000) <span class="sc">%&gt;%</span> </span>
<span id="cb675-6"><a href="conditional-manatees.html#cb675-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">na.omit</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb675-7"><a href="conditional-manatees.html#cb675-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">G =</span> <span class="fu">log</span>(rgdppc_2000)<span class="sc">/</span><span class="fu">mean</span>(<span class="fu">log</span>(rgdppc_2000)),</span>
<span id="cb675-8"><a href="conditional-manatees.html#cb675-8" aria-hidden="true" tabindex="-1"></a>         <span class="at">C =</span> <span class="fu">as.factor</span>(cont_africa)) <span class="sc">%&gt;%</span>   </span>
<span id="cb675-9"><a href="conditional-manatees.html#cb675-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">C =</span> <span class="fu">fct_relevel</span>(C, <span class="st">&quot;1&quot;</span>,<span class="st">&quot;0&quot;</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb675-10"><a href="conditional-manatees.html#cb675-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">C =</span> dplyr<span class="sc">::</span><span class="fu">recode</span>(C,<span class="st">&quot;1&quot;</span><span class="ot">=</span><span class="st">&quot;African nations&quot;</span>,<span class="st">&quot;0&quot;</span><span class="ot">=</span><span class="st">&quot;Non-African nations&quot;</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb675-11"><a href="conditional-manatees.html#cb675-11" aria-hidden="true" tabindex="-1"></a>  stats<span class="sc">::</span><span class="fu">na.omit</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb675-12"><a href="conditional-manatees.html#cb675-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">R =</span> rugged<span class="sc">/</span><span class="fu">max</span>(rugged)) <span class="ot">-&gt;</span> d2</span>
<span id="cb675-13"><a href="conditional-manatees.html#cb675-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb675-14"><a href="conditional-manatees.html#cb675-14" aria-hidden="true" tabindex="-1"></a><span class="do">## プロットする</span></span>
<span id="cb675-15"><a href="conditional-manatees.html#cb675-15" aria-hidden="true" tabindex="-1"></a>d2 <span class="sc">%&gt;%</span> </span>
<span id="cb675-16"><a href="conditional-manatees.html#cb675-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> R, <span class="at">y =</span> G))<span class="sc">+</span></span>
<span id="cb675-17"><a href="conditional-manatees.html#cb675-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="fu">aes</span>(<span class="at">color =</span> C, </span>
<span id="cb675-18"><a href="conditional-manatees.html#cb675-18" aria-hidden="true" tabindex="-1"></a>                 <span class="at">shape =</span> C),</span>
<span id="cb675-19"><a href="conditional-manatees.html#cb675-19" aria-hidden="true" tabindex="-1"></a>             <span class="at">size =</span> <span class="fl">2.5</span>)<span class="sc">+</span></span>
<span id="cb675-20"><a href="conditional-manatees.html#cb675-20" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(<span class="at">method=</span><span class="st">&quot;lm&quot;</span>,<span class="at">color=</span><span class="st">&quot;black&quot;</span>)<span class="sc">+</span></span>
<span id="cb675-21"><a href="conditional-manatees.html#cb675-21" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="st">&quot;navy&quot;</span>,<span class="st">&quot;black&quot;</span>))<span class="sc">+</span></span>
<span id="cb675-22"><a href="conditional-manatees.html#cb675-22" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_shape_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="dv">16</span>,<span class="dv">1</span>))<span class="sc">+</span></span>
<span id="cb675-23"><a href="conditional-manatees.html#cb675-23" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_text_repel</span>(<span class="at">data =</span> d2 <span class="sc">%&gt;%</span> </span>
<span id="cb675-24"><a href="conditional-manatees.html#cb675-24" aria-hidden="true" tabindex="-1"></a>                    <span class="fu">filter</span>(country <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">&quot;Seychelles&quot;</span>,<span class="st">&quot;Lesotho&quot;</span>,<span class="st">&quot;Switzerland&quot;</span>,<span class="st">&quot;Tajikistan&quot;</span>)),</span>
<span id="cb675-25"><a href="conditional-manatees.html#cb675-25" aria-hidden="true" tabindex="-1"></a>                  <span class="fu">aes</span>(<span class="at">label =</span> country))<span class="sc">+</span></span>
<span id="cb675-26"><a href="conditional-manatees.html#cb675-26" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_rep_wrap</span>(<span class="sc">~</span> C, <span class="at">scales =</span> <span class="st">&quot;free_y&quot;</span>)<span class="sc">+</span></span>
<span id="cb675-27"><a href="conditional-manatees.html#cb675-27" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">&quot;ruggedness(std)&quot;</span>, </span>
<span id="cb675-28"><a href="conditional-manatees.html#cb675-28" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">&quot;log GDP (as proportion of mean)&quot;</span>)<span class="sc">+</span></span>
<span id="cb675-29"><a href="conditional-manatees.html#cb675-29" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">&quot;none&quot;</span>,</span>
<span id="cb675-30"><a href="conditional-manatees.html#cb675-30" aria-hidden="true" tabindex="-1"></a>        <span class="at">strip.background =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb675-31"><a href="conditional-manatees.html#cb675-31" aria-hidden="true" tabindex="-1"></a>        <span class="at">aspect.ratio=</span><span class="dv">1</span>,</span>
<span id="cb675-32"><a href="conditional-manatees.html#cb675-32" aria-hidden="true" tabindex="-1"></a>        <span class="at">strip.text =</span> <span class="fu">element_text</span>(<span class="at">size=</span><span class="dv">12</span>))</span></code></pre></div>
<p><img src="Rethinking_Bookdown_files/figure-html/unnamed-chunk-309-1.png" width="672" style="display: block; margin: auto;" />
<br/></p>
<p>これはなぜだろうか？おそらく、RもGもともに未知の変数(ex. 他の地理的特徴、奴隷制による被害の大きさ)によって影響を受けているからだと思われる。<br />
これについては最後のPracticeで考える。</p>
<p><img src="Rethinking_Bookdown_files/figure-html/unnamed-chunk-310-1.png" width="672" style="display: block; margin: auto;" />
<br/></p>
<div id="making-a-rugged-model" class="section level3 hasAnchor" number="8.1.1">
<h3><span class="header-section-number">8.1.1</span> Making a rugged model<a href="conditional-manatees.html#making-a-rugged-model" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>まずは交互作用のないシンプルなモデルを考える。<br />
<span class="math inline">\(\alpha\)</span>は<span class="math inline">\(r_{i}-\bar{r}\)</span>が0、すなわち<span class="math inline">\(r_{i}\)</span>が平均のときのGの値(平均1)なので、およそ1くらいになるはず。よって、<span class="math inline">\(\alpha\)</span>の事前分布は平均1、標準偏差1の正規分布とする。<br />
<br/></p>
<p><span class="math display">\[
\begin{aligned}
log(y_{i}) &amp;\sim Normal(\mu_{i},\sigma)\\
\mu_{i} &amp;= \alpha + \beta(r_{i} - \bar{r})\\
\alpha &amp;\sim Normal(1,1)\\
\beta &amp;\sim Normal(0,1)
\end{aligned}
\]</span>
<br/></p>
<div class="sourceCode" id="cb676"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb676-1"><a href="conditional-manatees.html#cb676-1" aria-hidden="true" tabindex="-1"></a>d2 <span class="sc">%&gt;%</span> </span>
<span id="cb676-2"><a href="conditional-manatees.html#cb676-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">R_c =</span> R <span class="sc">-</span> <span class="fu">mean</span>(R)) <span class="ot">-&gt;</span> d2</span>
<span id="cb676-3"><a href="conditional-manatees.html#cb676-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb676-4"><a href="conditional-manatees.html#cb676-4" aria-hidden="true" tabindex="-1"></a>b8<span class="fl">.1</span>_pre <span class="ot">&lt;-</span> <span class="fu">brm</span>(</span>
<span id="cb676-5"><a href="conditional-manatees.html#cb676-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">data =</span> d2,</span>
<span id="cb676-6"><a href="conditional-manatees.html#cb676-6" aria-hidden="true" tabindex="-1"></a>  <span class="at">family =</span> gaussian,</span>
<span id="cb676-7"><a href="conditional-manatees.html#cb676-7" aria-hidden="true" tabindex="-1"></a>  <span class="at">formula =</span> G <span class="sc">~</span> <span class="dv">1</span> <span class="sc">+</span> R_c,</span>
<span id="cb676-8"><a href="conditional-manatees.html#cb676-8" aria-hidden="true" tabindex="-1"></a>  <span class="at">prior =</span> <span class="fu">c</span>(<span class="fu">prior</span>(<span class="fu">normal</span>(<span class="dv">1</span>, <span class="dv">1</span>), <span class="at">class =</span> Intercept),</span>
<span id="cb676-9"><a href="conditional-manatees.html#cb676-9" aria-hidden="true" tabindex="-1"></a>            <span class="fu">prior</span>(<span class="fu">normal</span>(<span class="dv">0</span>, <span class="dv">1</span>), <span class="at">class =</span> b),</span>
<span id="cb676-10"><a href="conditional-manatees.html#cb676-10" aria-hidden="true" tabindex="-1"></a>            <span class="fu">prior</span>(<span class="fu">exponential</span>(<span class="dv">1</span>), <span class="at">class =</span> sigma)),</span>
<span id="cb676-11"><a href="conditional-manatees.html#cb676-11" aria-hidden="true" tabindex="-1"></a>  <span class="at">seed=</span><span class="dv">8</span>, <span class="at">sample_prior=</span><span class="cn">TRUE</span>,</span>
<span id="cb676-12"><a href="conditional-manatees.html#cb676-12" aria-hidden="true" tabindex="-1"></a>  <span class="at">backend =</span> <span class="st">&quot;cmdstanr&quot;</span>,</span>
<span id="cb676-13"><a href="conditional-manatees.html#cb676-13" aria-hidden="true" tabindex="-1"></a>  <span class="at">file =</span> <span class="st">&quot;output/Chapter8/b8.1_pre&quot;</span></span>
<span id="cb676-14"><a href="conditional-manatees.html#cb676-14" aria-hidden="true" tabindex="-1"></a>)</span></code></pre></div>
<p><br /></p>
<p>まずは事前分布を確認してみる。<br />
(0.22, 1)の近くを通るはずなのに、ほとんどの線が通っていない。また、傾きは極端でも-0.6~0.6くらいの範囲(青い線)の間に入るはずなのに、それよりも極端な傾きがかなりある。</p>
<div class="sourceCode" id="cb677"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb677-1"><a href="conditional-manatees.html#cb677-1" aria-hidden="true" tabindex="-1"></a>prior_pre <span class="ot">&lt;-</span> <span class="fu">prior_samples</span>(b8<span class="fl">.1</span>_pre)</span>
<span id="cb677-2"><a href="conditional-manatees.html#cb677-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb677-3"><a href="conditional-manatees.html#cb677-3" aria-hidden="true" tabindex="-1"></a>p1 <span class="ot">&lt;-</span> prior_pre <span class="sc">%&gt;%</span> </span>
<span id="cb677-4"><a href="conditional-manatees.html#cb677-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">slice_sample</span>(<span class="at">n=</span><span class="dv">50</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb677-5"><a href="conditional-manatees.html#cb677-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rownames_to_column</span>(<span class="at">var =</span> <span class="st">&quot;iter&quot;</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb677-6"><a href="conditional-manatees.html#cb677-6" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">select</span>(<span class="sc">-</span>sigma) <span class="sc">%&gt;%</span> </span>
<span id="cb677-7"><a href="conditional-manatees.html#cb677-7" aria-hidden="true" tabindex="-1"></a>  tidyr<span class="sc">::</span><span class="fu">expand</span>(<span class="fu">nesting</span>(iter,Intercept,b),</span>
<span id="cb677-8"><a href="conditional-manatees.html#cb677-8" aria-hidden="true" tabindex="-1"></a>         <span class="at">R_c =</span> <span class="fu">c</span>(<span class="sc">-</span><span class="dv">2</span>,<span class="dv">2</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb677-9"><a href="conditional-manatees.html#cb677-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">R =</span> R_c <span class="sc">+</span> <span class="fu">mean</span>(d2<span class="sc">$</span>R)) <span class="sc">%&gt;%</span> </span>
<span id="cb677-10"><a href="conditional-manatees.html#cb677-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x=</span>R, <span class="at">y =</span> Intercept <span class="sc">+</span> b<span class="sc">*</span>R_c, <span class="at">group=</span>iter))<span class="sc">+</span></span>
<span id="cb677-11"><a href="conditional-manatees.html#cb677-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="at">alpha =</span> <span class="dv">1</span><span class="sc">/</span><span class="dv">2</span>)<span class="sc">+</span></span>
<span id="cb677-12"><a href="conditional-manatees.html#cb677-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_hline</span>(<span class="at">yintercept =</span> <span class="fu">range</span>(d2<span class="sc">$</span>G), <span class="at">linetype=</span><span class="dv">2</span>)<span class="sc">+</span></span>
<span id="cb677-13"><a href="conditional-manatees.html#cb677-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_abline</span>(<span class="at">intercept =</span> <span class="fu">c</span>(<span class="fl">1.3</span>,<span class="fl">0.7</span>),</span>
<span id="cb677-14"><a href="conditional-manatees.html#cb677-14" aria-hidden="true" tabindex="-1"></a>              <span class="at">slope=</span><span class="fu">c</span>(<span class="sc">-</span><span class="fl">0.6</span>,<span class="fl">0.6</span>),</span>
<span id="cb677-15"><a href="conditional-manatees.html#cb677-15" aria-hidden="true" tabindex="-1"></a>              <span class="at">color =</span> <span class="st">&quot;blue&quot;</span>, <span class="at">size=</span><span class="dv">1</span>)<span class="sc">+</span></span>
<span id="cb677-16"><a href="conditional-manatees.html#cb677-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">coord_cartesian</span>(<span class="at">ylim =</span> <span class="fu">c</span>(<span class="fl">0.5</span>,<span class="fl">1.5</span>), <span class="at">xlim =</span> <span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">1</span>))<span class="sc">+</span></span>
<span id="cb677-17"><a href="conditional-manatees.html#cb677-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">y =</span> <span class="st">&quot;log GDP (prop of mean)&quot;</span>, <span class="at">x =</span> <span class="st">&quot;ruggedness&quot;</span>)<span class="sc">+</span></span>
<span id="cb677-18"><a href="conditional-manatees.html#cb677-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">subtitle =</span> <span class="st">&quot;Intercept ~ dnorm(1, 1)</span><span class="sc">\n</span><span class="st">b ~ dnorm(0, 1)&quot;</span>) <span class="sc">+</span></span>
<span id="cb677-19"><a href="conditional-manatees.html#cb677-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">aspect.ratio=</span><span class="dv">1</span>)</span>
<span id="cb677-20"><a href="conditional-manatees.html#cb677-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb677-21"><a href="conditional-manatees.html#cb677-21" aria-hidden="true" tabindex="-1"></a>p1</span></code></pre></div>
<p><img src="Rethinking_Bookdown_files/figure-html/unnamed-chunk-312-1.png" width="672" style="display: block; margin: auto;" />
<br /></p>
<p>よって、<span class="math inline">\(\alpha\)</span>と<span class="math inline">\(\beta\)</span>の事前分布の標準偏差をそれぞれ0.1と0.3にする。</p>
<div class="sourceCode" id="cb678"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb678-1"><a href="conditional-manatees.html#cb678-1" aria-hidden="true" tabindex="-1"></a>b8<span class="fl">.1</span> <span class="ot">&lt;-</span> <span class="fu">brm</span>(</span>
<span id="cb678-2"><a href="conditional-manatees.html#cb678-2" aria-hidden="true" tabindex="-1"></a>  <span class="at">data =</span> d2,</span>
<span id="cb678-3"><a href="conditional-manatees.html#cb678-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">family =</span> gaussian,</span>
<span id="cb678-4"><a href="conditional-manatees.html#cb678-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">formula =</span> G <span class="sc">~</span> <span class="dv">1</span> <span class="sc">+</span> R_c,</span>
<span id="cb678-5"><a href="conditional-manatees.html#cb678-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">prior =</span> <span class="fu">c</span>(<span class="fu">prior</span>(<span class="fu">normal</span>(<span class="dv">1</span>, <span class="fl">0.1</span>), <span class="at">class =</span> Intercept),</span>
<span id="cb678-6"><a href="conditional-manatees.html#cb678-6" aria-hidden="true" tabindex="-1"></a>            <span class="fu">prior</span>(<span class="fu">normal</span>(<span class="dv">0</span>, <span class="fl">0.3</span>), <span class="at">class =</span> b),</span>
<span id="cb678-7"><a href="conditional-manatees.html#cb678-7" aria-hidden="true" tabindex="-1"></a>            <span class="fu">prior</span>(<span class="fu">exponential</span>(<span class="dv">1</span>), <span class="at">class =</span> sigma)),</span>
<span id="cb678-8"><a href="conditional-manatees.html#cb678-8" aria-hidden="true" tabindex="-1"></a>  <span class="at">seed=</span><span class="dv">8</span>, <span class="at">sample_prior=</span><span class="cn">TRUE</span>,</span>
<span id="cb678-9"><a href="conditional-manatees.html#cb678-9" aria-hidden="true" tabindex="-1"></a>  <span class="at">backend =</span> <span class="st">&quot;cmdstanr&quot;</span>,</span>
<span id="cb678-10"><a href="conditional-manatees.html#cb678-10" aria-hidden="true" tabindex="-1"></a>  <span class="at">file =</span> <span class="st">&quot;output/Chapter8/b8.1&quot;</span></span>
<span id="cb678-11"><a href="conditional-manatees.html#cb678-11" aria-hidden="true" tabindex="-1"></a>)</span></code></pre></div>
<p><br/></p>
<p>今度は事前分布はもっともらしい範囲に収まっている。</p>
<div class="sourceCode" id="cb679"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb679-1"><a href="conditional-manatees.html#cb679-1" aria-hidden="true" tabindex="-1"></a>prior <span class="ot">&lt;-</span> <span class="fu">prior_samples</span>(b8<span class="fl">.1</span>)</span>
<span id="cb679-2"><a href="conditional-manatees.html#cb679-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb679-3"><a href="conditional-manatees.html#cb679-3" aria-hidden="true" tabindex="-1"></a>p2 <span class="ot">&lt;-</span> prior <span class="sc">%&gt;%</span> </span>
<span id="cb679-4"><a href="conditional-manatees.html#cb679-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">slice_sample</span>(<span class="at">n=</span><span class="dv">50</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb679-5"><a href="conditional-manatees.html#cb679-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rownames_to_column</span>(<span class="at">var =</span> <span class="st">&quot;iter&quot;</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb679-6"><a href="conditional-manatees.html#cb679-6" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">select</span>(<span class="sc">-</span>sigma) <span class="sc">%&gt;%</span> </span>
<span id="cb679-7"><a href="conditional-manatees.html#cb679-7" aria-hidden="true" tabindex="-1"></a>  tidyr<span class="sc">::</span><span class="fu">expand</span>(<span class="fu">nesting</span>(iter,Intercept,b),</span>
<span id="cb679-8"><a href="conditional-manatees.html#cb679-8" aria-hidden="true" tabindex="-1"></a>         <span class="at">R_c =</span> <span class="fu">c</span>(<span class="sc">-</span><span class="dv">2</span>,<span class="dv">2</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb679-9"><a href="conditional-manatees.html#cb679-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">R =</span> R_c <span class="sc">+</span> <span class="fu">mean</span>(d2<span class="sc">$</span>R)) <span class="sc">%&gt;%</span> </span>
<span id="cb679-10"><a href="conditional-manatees.html#cb679-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x=</span>R, <span class="at">y =</span> Intercept <span class="sc">+</span> b<span class="sc">*</span>R_c, <span class="at">group=</span>iter))<span class="sc">+</span></span>
<span id="cb679-11"><a href="conditional-manatees.html#cb679-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="at">alpha =</span> <span class="dv">1</span><span class="sc">/</span><span class="dv">2</span>)<span class="sc">+</span></span>
<span id="cb679-12"><a href="conditional-manatees.html#cb679-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_hline</span>(<span class="at">yintercept =</span> <span class="fu">range</span>(d2<span class="sc">$</span>G), <span class="at">linetype=</span><span class="dv">2</span>)<span class="sc">+</span></span>
<span id="cb679-13"><a href="conditional-manatees.html#cb679-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">coord_cartesian</span>(<span class="at">ylim =</span> <span class="fu">c</span>(<span class="fl">0.5</span>,<span class="fl">1.5</span>), <span class="at">xlim =</span> <span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">1</span>))<span class="sc">+</span></span>
<span id="cb679-14"><a href="conditional-manatees.html#cb679-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">y =</span> <span class="st">&quot;log GDP (prop of mean)&quot;</span>, <span class="at">x =</span> <span class="st">&quot;ruggedness&quot;</span>)<span class="sc">+</span></span>
<span id="cb679-15"><a href="conditional-manatees.html#cb679-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">subtitle =</span> <span class="st">&quot;Intercept ~ dnorm(1, 0.1)</span><span class="sc">\n</span><span class="st">b ~ dnorm(0, 0.3)&quot;</span>) </span>
<span id="cb679-16"><a href="conditional-manatees.html#cb679-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">aspect.ratio=</span><span class="dv">1</span>)</span></code></pre></div>
<pre><code>## List of 1
##  $ aspect.ratio: num 1
##  - attr(*, &quot;class&quot;)= chr [1:2] &quot;theme&quot; &quot;gg&quot;
##  - attr(*, &quot;complete&quot;)= logi FALSE
##  - attr(*, &quot;validate&quot;)= logi TRUE</code></pre>
<div class="sourceCode" id="cb681"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb681-1"><a href="conditional-manatees.html#cb681-1" aria-hidden="true" tabindex="-1"></a>p1<span class="sc">+</span>p2<span class="sc">+</span></span>
<span id="cb681-2"><a href="conditional-manatees.html#cb681-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">plot_annotation</span>(<span class="at">title =</span> <span class="st">&quot;Simulating in search of reasonable priors for the terrain ruggedness example.&quot;</span>,</span>
<span id="cb681-3"><a href="conditional-manatees.html#cb681-3" aria-hidden="true" tabindex="-1"></a>                  <span class="at">theme =</span> <span class="fu">theme</span>(<span class="at">plot.title =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">12</span>)))</span></code></pre></div>
<p><img src="Rethinking_Bookdown_files/figure-html/unnamed-chunk-314-1.png" width="672" style="display: block; margin: auto;" />
<br /></p>
<p>結果を見ると、RとGの間には全く関係がないことになる。</p>
<div class="sourceCode" id="cb682"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb682-1"><a href="conditional-manatees.html#cb682-1" aria-hidden="true" tabindex="-1"></a><span class="fu">posterior_summary</span>(b8<span class="fl">.1</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb682-2"><a href="conditional-manatees.html#cb682-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">data.frame</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb682-3"><a href="conditional-manatees.html#cb682-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">round</span>(<span class="dv">2</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb682-4"><a href="conditional-manatees.html#cb682-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rownames_to_column</span>(<span class="at">var =</span> <span class="st">&quot;parameters&quot;</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb682-5"><a href="conditional-manatees.html#cb682-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(parameters <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">&quot;sigma&quot;</span>)<span class="sc">|</span></span>
<span id="cb682-6"><a href="conditional-manatees.html#cb682-6" aria-hidden="true" tabindex="-1"></a>           <span class="fu">str_detect</span>(parameters,<span class="st">&quot;b_&quot;</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb682-7"><a href="conditional-manatees.html#cb682-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">gt</span>()</span></code></pre></div>
<div id="rwutdqwjoq" style="padding-left:0px;padding-right:0px;padding-top:10px;padding-bottom:10px;overflow-x:auto;overflow-y:auto;width:auto;height:auto;">
<style>html {
  font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, Cantarell, 'Helvetica Neue', 'Fira Sans', 'Droid Sans', Arial, sans-serif;
}

#rwutdqwjoq .gt_table {
  display: table;
  border-collapse: collapse;
  margin-left: auto;
  margin-right: auto;
  color: #333333;
  font-size: 16px;
  font-weight: normal;
  font-style: normal;
  background-color: #FFFFFF;
  width: auto;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #A8A8A8;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #A8A8A8;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
}

#rwutdqwjoq .gt_heading {
  background-color: #FFFFFF;
  text-align: center;
  border-bottom-color: #FFFFFF;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#rwutdqwjoq .gt_caption {
  padding-top: 4px;
  padding-bottom: 4px;
}

#rwutdqwjoq .gt_title {
  color: #333333;
  font-size: 125%;
  font-weight: initial;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-color: #FFFFFF;
  border-bottom-width: 0;
}

#rwutdqwjoq .gt_subtitle {
  color: #333333;
  font-size: 85%;
  font-weight: initial;
  padding-top: 0;
  padding-bottom: 6px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-color: #FFFFFF;
  border-top-width: 0;
}

#rwutdqwjoq .gt_bottom_border {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#rwutdqwjoq .gt_col_headings {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#rwutdqwjoq .gt_col_heading {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 6px;
  padding-left: 5px;
  padding-right: 5px;
  overflow-x: hidden;
}

#rwutdqwjoq .gt_column_spanner_outer {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  padding-top: 0;
  padding-bottom: 0;
  padding-left: 4px;
  padding-right: 4px;
}

#rwutdqwjoq .gt_column_spanner_outer:first-child {
  padding-left: 0;
}

#rwutdqwjoq .gt_column_spanner_outer:last-child {
  padding-right: 0;
}

#rwutdqwjoq .gt_column_spanner {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 5px;
  overflow-x: hidden;
  display: inline-block;
  width: 100%;
}

#rwutdqwjoq .gt_group_heading {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  text-align: left;
}

#rwutdqwjoq .gt_empty_group_heading {
  padding: 0.5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: middle;
}

#rwutdqwjoq .gt_from_md > :first-child {
  margin-top: 0;
}

#rwutdqwjoq .gt_from_md > :last-child {
  margin-bottom: 0;
}

#rwutdqwjoq .gt_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  margin: 10px;
  border-top-style: solid;
  border-top-width: 1px;
  border-top-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  overflow-x: hidden;
}

#rwutdqwjoq .gt_stub {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
}

#rwutdqwjoq .gt_stub_row_group {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
  vertical-align: top;
}

#rwutdqwjoq .gt_row_group_first td {
  border-top-width: 2px;
}

#rwutdqwjoq .gt_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#rwutdqwjoq .gt_first_summary_row {
  border-top-style: solid;
  border-top-color: #D3D3D3;
}

#rwutdqwjoq .gt_first_summary_row.thick {
  border-top-width: 2px;
}

#rwutdqwjoq .gt_last_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#rwutdqwjoq .gt_grand_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#rwutdqwjoq .gt_first_grand_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-style: double;
  border-top-width: 6px;
  border-top-color: #D3D3D3;
}

#rwutdqwjoq .gt_striped {
  background-color: rgba(128, 128, 128, 0.05);
}

#rwutdqwjoq .gt_table_body {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#rwutdqwjoq .gt_footnotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#rwutdqwjoq .gt_footnote {
  margin: 0px;
  font-size: 90%;
  padding-left: 4px;
  padding-right: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#rwutdqwjoq .gt_sourcenotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#rwutdqwjoq .gt_sourcenote {
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#rwutdqwjoq .gt_left {
  text-align: left;
}

#rwutdqwjoq .gt_center {
  text-align: center;
}

#rwutdqwjoq .gt_right {
  text-align: right;
  font-variant-numeric: tabular-nums;
}

#rwutdqwjoq .gt_font_normal {
  font-weight: normal;
}

#rwutdqwjoq .gt_font_bold {
  font-weight: bold;
}

#rwutdqwjoq .gt_font_italic {
  font-style: italic;
}

#rwutdqwjoq .gt_super {
  font-size: 65%;
}

#rwutdqwjoq .gt_footnote_marks {
  font-style: italic;
  font-weight: normal;
  font-size: 75%;
  vertical-align: 0.4em;
}

#rwutdqwjoq .gt_asterisk {
  font-size: 100%;
  vertical-align: 0;
}

#rwutdqwjoq .gt_indent_1 {
  text-indent: 5px;
}

#rwutdqwjoq .gt_indent_2 {
  text-indent: 10px;
}

#rwutdqwjoq .gt_indent_3 {
  text-indent: 15px;
}

#rwutdqwjoq .gt_indent_4 {
  text-indent: 20px;
}

#rwutdqwjoq .gt_indent_5 {
  text-indent: 25px;
}
</style>
<table class="gt_table">
  
  <thead class="gt_col_headings">
    <tr>
      <th class="gt_col_heading gt_columns_bottom_border gt_left" rowspan="1" colspan="1" scope="col" id="parameters">parameters</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1" scope="col" id="Estimate">Estimate</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1" scope="col" id="Est.Error">Est.Error</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1" scope="col" id="Q2.5">Q2.5</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1" scope="col" id="Q97.5">Q97.5</th>
    </tr>
  </thead>
  <tbody class="gt_table_body">
    <tr><td headers="parameters" class="gt_row gt_left">b_Intercept</td>
<td headers="Estimate" class="gt_row gt_right">1.00</td>
<td headers="Est.Error" class="gt_row gt_right">0.01</td>
<td headers="Q2.5" class="gt_row gt_right">0.98</td>
<td headers="Q97.5" class="gt_row gt_right">1.02</td></tr>
    <tr><td headers="parameters" class="gt_row gt_left">b_R_c</td>
<td headers="Estimate" class="gt_row gt_right">0.00</td>
<td headers="Est.Error" class="gt_row gt_right">0.06</td>
<td headers="Q2.5" class="gt_row gt_right">-0.11</td>
<td headers="Q97.5" class="gt_row gt_right">0.11</td></tr>
    <tr><td headers="parameters" class="gt_row gt_left">sigma</td>
<td headers="Estimate" class="gt_row gt_right">0.14</td>
<td headers="Est.Error" class="gt_row gt_right">0.01</td>
<td headers="Q2.5" class="gt_row gt_right">0.12</td>
<td headers="Q97.5" class="gt_row gt_right">0.15</td></tr>
  </tbody>
  
  
</table>
</div>
<p><br /></p>
</div>
<div id="adding-an-indicator-variable-isnt-enough" class="section level3 hasAnchor" number="8.1.2">
<h3><span class="header-section-number">8.1.2</span> Adding an indicator variable isn’t enough<a href="conditional-manatees.html#adding-an-indicator-variable-isnt-enough" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>続いて、Aをindicator variableとしてモデルに加える。<br />
<br/></p>
<p><span class="math display">\[
\mu_{i} = \alpha_{CID[i]} + \beta(r_{i} - \bar{r})
\]</span><br />
<br /></p>
<div class="sourceCode" id="cb683"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb683-1"><a href="conditional-manatees.html#cb683-1" aria-hidden="true" tabindex="-1"></a>d2 <span class="sc">%&gt;%</span> </span>
<span id="cb683-2"><a href="conditional-manatees.html#cb683-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">A_ind =</span> <span class="fu">ifelse</span>(cont_africa <span class="sc">==</span><span class="dv">1</span>,<span class="st">&quot;1&quot;</span>,<span class="st">&quot;2&quot;</span>)) <span class="ot">-&gt;</span>d2</span>
<span id="cb683-3"><a href="conditional-manatees.html#cb683-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb683-4"><a href="conditional-manatees.html#cb683-4" aria-hidden="true" tabindex="-1"></a>b8<span class="fl">.2</span> <span class="ot">&lt;-</span> <span class="fu">brm</span>(</span>
<span id="cb683-5"><a href="conditional-manatees.html#cb683-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">data =</span> d2,</span>
<span id="cb683-6"><a href="conditional-manatees.html#cb683-6" aria-hidden="true" tabindex="-1"></a>  <span class="at">family =</span> gaussian,</span>
<span id="cb683-7"><a href="conditional-manatees.html#cb683-7" aria-hidden="true" tabindex="-1"></a>  <span class="at">formula =</span> G <span class="sc">~</span> <span class="dv">0</span> <span class="sc">+</span> A_ind <span class="sc">+</span> R_c,</span>
<span id="cb683-8"><a href="conditional-manatees.html#cb683-8" aria-hidden="true" tabindex="-1"></a>  <span class="at">prior =</span> <span class="fu">c</span>(<span class="fu">prior</span>(<span class="fu">normal</span>(<span class="dv">1</span>, <span class="fl">0.1</span>), <span class="at">class =</span> b,</span>
<span id="cb683-9"><a href="conditional-manatees.html#cb683-9" aria-hidden="true" tabindex="-1"></a>                  <span class="at">coef=</span><span class="st">&quot;A_ind1&quot;</span>),</span>
<span id="cb683-10"><a href="conditional-manatees.html#cb683-10" aria-hidden="true" tabindex="-1"></a>            <span class="fu">prior</span>(<span class="fu">normal</span>(<span class="dv">1</span>, <span class="fl">0.1</span>), <span class="at">class =</span> b,</span>
<span id="cb683-11"><a href="conditional-manatees.html#cb683-11" aria-hidden="true" tabindex="-1"></a>                  <span class="at">coef=</span><span class="st">&quot;A_ind2&quot;</span>),</span>
<span id="cb683-12"><a href="conditional-manatees.html#cb683-12" aria-hidden="true" tabindex="-1"></a>            <span class="fu">prior</span>(<span class="fu">normal</span>(<span class="dv">0</span>, <span class="fl">0.3</span>), <span class="at">class =</span> b,</span>
<span id="cb683-13"><a href="conditional-manatees.html#cb683-13" aria-hidden="true" tabindex="-1"></a>                  <span class="at">coef =</span> <span class="st">&quot;R_c&quot;</span>),</span>
<span id="cb683-14"><a href="conditional-manatees.html#cb683-14" aria-hidden="true" tabindex="-1"></a>            <span class="fu">prior</span>(<span class="fu">exponential</span>(<span class="dv">1</span>), <span class="at">class =</span> sigma)),</span>
<span id="cb683-15"><a href="conditional-manatees.html#cb683-15" aria-hidden="true" tabindex="-1"></a>  <span class="at">seed=</span><span class="dv">8</span>, <span class="at">sample_prior=</span><span class="cn">TRUE</span>,</span>
<span id="cb683-16"><a href="conditional-manatees.html#cb683-16" aria-hidden="true" tabindex="-1"></a>  <span class="at">backend =</span> <span class="st">&quot;cmdstanr&quot;</span>,</span>
<span id="cb683-17"><a href="conditional-manatees.html#cb683-17" aria-hidden="true" tabindex="-1"></a>  <span class="at">file =</span> <span class="st">&quot;output/Chapter8/b8.2&quot;</span></span>
<span id="cb683-18"><a href="conditional-manatees.html#cb683-18" aria-hidden="true" tabindex="-1"></a>)</span></code></pre></div>
<p><br/></p>
<p>WAICを比較すると、2番目のモデルの方がかなり小さい。</p>
<div class="sourceCode" id="cb684"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb684-1"><a href="conditional-manatees.html#cb684-1" aria-hidden="true" tabindex="-1"></a>b8<span class="fl">.1</span> <span class="ot">&lt;-</span> <span class="fu">add_criterion</span>(b8<span class="fl">.1</span>,<span class="fu">c</span>(<span class="st">&quot;waic&quot;</span>,<span class="st">&quot;loo&quot;</span>))</span>
<span id="cb684-2"><a href="conditional-manatees.html#cb684-2" aria-hidden="true" tabindex="-1"></a>b8<span class="fl">.2</span> <span class="ot">&lt;-</span> <span class="fu">add_criterion</span>(b8<span class="fl">.2</span>,<span class="fu">c</span>(<span class="st">&quot;waic&quot;</span>,<span class="st">&quot;loo&quot;</span>))</span>
<span id="cb684-3"><a href="conditional-manatees.html#cb684-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb684-4"><a href="conditional-manatees.html#cb684-4" aria-hidden="true" tabindex="-1"></a><span class="fu">loo_compare</span>(b8<span class="fl">.1</span>,b8<span class="fl">.2</span>,<span class="at">criterion=</span><span class="st">&quot;waic&quot;</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb684-5"><a href="conditional-manatees.html#cb684-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">print</span>(<span class="at">simplify =</span> F)</span></code></pre></div>
<pre><code>##      elpd_diff se_diff elpd_waic se_elpd_waic p_waic se_p_waic waic   se_waic
## b8.2    0.0       0.0   126.1       7.4          4.1    0.8    -252.3   14.8 
## b8.1  -31.8       7.3    94.4       6.5          2.6    0.3    -188.7   13.0</code></pre>
<p>結果を見ると、アフリカとそれ以外の国で違いがあることが分かったが、傾きはほとんど0。</p>
<div class="sourceCode" id="cb686"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb686-1"><a href="conditional-manatees.html#cb686-1" aria-hidden="true" tabindex="-1"></a><span class="fu">posterior_summary</span>(b8<span class="fl">.2</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb686-2"><a href="conditional-manatees.html#cb686-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">data.frame</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb686-3"><a href="conditional-manatees.html#cb686-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">round</span>(<span class="dv">2</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb686-4"><a href="conditional-manatees.html#cb686-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rownames_to_column</span>(<span class="at">var =</span> <span class="st">&quot;parameters&quot;</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb686-5"><a href="conditional-manatees.html#cb686-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(parameters <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">&quot;sigma&quot;</span>)<span class="sc">|</span></span>
<span id="cb686-6"><a href="conditional-manatees.html#cb686-6" aria-hidden="true" tabindex="-1"></a>           <span class="fu">str_detect</span>(parameters,<span class="st">&quot;^b_&quot;</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb686-7"><a href="conditional-manatees.html#cb686-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">gt</span>()</span></code></pre></div>
<div id="vkyltspiqf" style="padding-left:0px;padding-right:0px;padding-top:10px;padding-bottom:10px;overflow-x:auto;overflow-y:auto;width:auto;height:auto;">
<style>html {
  font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, Cantarell, 'Helvetica Neue', 'Fira Sans', 'Droid Sans', Arial, sans-serif;
}

#vkyltspiqf .gt_table {
  display: table;
  border-collapse: collapse;
  margin-left: auto;
  margin-right: auto;
  color: #333333;
  font-size: 16px;
  font-weight: normal;
  font-style: normal;
  background-color: #FFFFFF;
  width: auto;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #A8A8A8;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #A8A8A8;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
}

#vkyltspiqf .gt_heading {
  background-color: #FFFFFF;
  text-align: center;
  border-bottom-color: #FFFFFF;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#vkyltspiqf .gt_caption {
  padding-top: 4px;
  padding-bottom: 4px;
}

#vkyltspiqf .gt_title {
  color: #333333;
  font-size: 125%;
  font-weight: initial;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-color: #FFFFFF;
  border-bottom-width: 0;
}

#vkyltspiqf .gt_subtitle {
  color: #333333;
  font-size: 85%;
  font-weight: initial;
  padding-top: 0;
  padding-bottom: 6px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-color: #FFFFFF;
  border-top-width: 0;
}

#vkyltspiqf .gt_bottom_border {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#vkyltspiqf .gt_col_headings {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#vkyltspiqf .gt_col_heading {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 6px;
  padding-left: 5px;
  padding-right: 5px;
  overflow-x: hidden;
}

#vkyltspiqf .gt_column_spanner_outer {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  padding-top: 0;
  padding-bottom: 0;
  padding-left: 4px;
  padding-right: 4px;
}

#vkyltspiqf .gt_column_spanner_outer:first-child {
  padding-left: 0;
}

#vkyltspiqf .gt_column_spanner_outer:last-child {
  padding-right: 0;
}

#vkyltspiqf .gt_column_spanner {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 5px;
  overflow-x: hidden;
  display: inline-block;
  width: 100%;
}

#vkyltspiqf .gt_group_heading {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  text-align: left;
}

#vkyltspiqf .gt_empty_group_heading {
  padding: 0.5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: middle;
}

#vkyltspiqf .gt_from_md > :first-child {
  margin-top: 0;
}

#vkyltspiqf .gt_from_md > :last-child {
  margin-bottom: 0;
}

#vkyltspiqf .gt_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  margin: 10px;
  border-top-style: solid;
  border-top-width: 1px;
  border-top-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  overflow-x: hidden;
}

#vkyltspiqf .gt_stub {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
}

#vkyltspiqf .gt_stub_row_group {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
  vertical-align: top;
}

#vkyltspiqf .gt_row_group_first td {
  border-top-width: 2px;
}

#vkyltspiqf .gt_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#vkyltspiqf .gt_first_summary_row {
  border-top-style: solid;
  border-top-color: #D3D3D3;
}

#vkyltspiqf .gt_first_summary_row.thick {
  border-top-width: 2px;
}

#vkyltspiqf .gt_last_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#vkyltspiqf .gt_grand_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#vkyltspiqf .gt_first_grand_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-style: double;
  border-top-width: 6px;
  border-top-color: #D3D3D3;
}

#vkyltspiqf .gt_striped {
  background-color: rgba(128, 128, 128, 0.05);
}

#vkyltspiqf .gt_table_body {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#vkyltspiqf .gt_footnotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#vkyltspiqf .gt_footnote {
  margin: 0px;
  font-size: 90%;
  padding-left: 4px;
  padding-right: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#vkyltspiqf .gt_sourcenotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#vkyltspiqf .gt_sourcenote {
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#vkyltspiqf .gt_left {
  text-align: left;
}

#vkyltspiqf .gt_center {
  text-align: center;
}

#vkyltspiqf .gt_right {
  text-align: right;
  font-variant-numeric: tabular-nums;
}

#vkyltspiqf .gt_font_normal {
  font-weight: normal;
}

#vkyltspiqf .gt_font_bold {
  font-weight: bold;
}

#vkyltspiqf .gt_font_italic {
  font-style: italic;
}

#vkyltspiqf .gt_super {
  font-size: 65%;
}

#vkyltspiqf .gt_footnote_marks {
  font-style: italic;
  font-weight: normal;
  font-size: 75%;
  vertical-align: 0.4em;
}

#vkyltspiqf .gt_asterisk {
  font-size: 100%;
  vertical-align: 0;
}

#vkyltspiqf .gt_indent_1 {
  text-indent: 5px;
}

#vkyltspiqf .gt_indent_2 {
  text-indent: 10px;
}

#vkyltspiqf .gt_indent_3 {
  text-indent: 15px;
}

#vkyltspiqf .gt_indent_4 {
  text-indent: 20px;
}

#vkyltspiqf .gt_indent_5 {
  text-indent: 25px;
}
</style>
<table class="gt_table">
  
  <thead class="gt_col_headings">
    <tr>
      <th class="gt_col_heading gt_columns_bottom_border gt_left" rowspan="1" colspan="1" scope="col" id="parameters">parameters</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1" scope="col" id="Estimate">Estimate</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1" scope="col" id="Est.Error">Est.Error</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1" scope="col" id="Q2.5">Q2.5</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1" scope="col" id="Q97.5">Q97.5</th>
    </tr>
  </thead>
  <tbody class="gt_table_body">
    <tr><td headers="parameters" class="gt_row gt_left">b_A_ind1</td>
<td headers="Estimate" class="gt_row gt_right">0.88</td>
<td headers="Est.Error" class="gt_row gt_right">0.02</td>
<td headers="Q2.5" class="gt_row gt_right">0.85</td>
<td headers="Q97.5" class="gt_row gt_right">0.91</td></tr>
    <tr><td headers="parameters" class="gt_row gt_left">b_A_ind2</td>
<td headers="Estimate" class="gt_row gt_right">1.05</td>
<td headers="Est.Error" class="gt_row gt_right">0.01</td>
<td headers="Q2.5" class="gt_row gt_right">1.03</td>
<td headers="Q97.5" class="gt_row gt_right">1.07</td></tr>
    <tr><td headers="parameters" class="gt_row gt_left">b_R_c</td>
<td headers="Estimate" class="gt_row gt_right">-0.05</td>
<td headers="Est.Error" class="gt_row gt_right">0.05</td>
<td headers="Q2.5" class="gt_row gt_right">-0.14</td>
<td headers="Q97.5" class="gt_row gt_right">0.04</td></tr>
    <tr><td headers="parameters" class="gt_row gt_left">sigma</td>
<td headers="Estimate" class="gt_row gt_right">0.11</td>
<td headers="Est.Error" class="gt_row gt_right">0.01</td>
<td headers="Q2.5" class="gt_row gt_right">0.10</td>
<td headers="Q97.5" class="gt_row gt_right">0.13</td></tr>
  </tbody>
  
  
</table>
</div>
<div class="sourceCode" id="cb687"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb687-1"><a href="conditional-manatees.html#cb687-1" aria-hidden="true" tabindex="-1"></a><span class="fu">posterior_samples</span>(b8<span class="fl">.2</span>, <span class="at">summary =</span> F) <span class="sc">%&gt;%</span> </span>
<span id="cb687-2"><a href="conditional-manatees.html#cb687-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">diff_A =</span> b_A_ind2 <span class="sc">-</span> b_A_ind1) <span class="sc">%&gt;%</span> </span>
<span id="cb687-3"><a href="conditional-manatees.html#cb687-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mean_qi</span>(diff_A) <span class="sc">%&gt;%</span> </span>
<span id="cb687-4"><a href="conditional-manatees.html#cb687-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">gt</span>()</span></code></pre></div>
<div id="oibmxuuqgd" style="padding-left:0px;padding-right:0px;padding-top:10px;padding-bottom:10px;overflow-x:auto;overflow-y:auto;width:auto;height:auto;">
<style>html {
  font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, Cantarell, 'Helvetica Neue', 'Fira Sans', 'Droid Sans', Arial, sans-serif;
}

#oibmxuuqgd .gt_table {
  display: table;
  border-collapse: collapse;
  margin-left: auto;
  margin-right: auto;
  color: #333333;
  font-size: 16px;
  font-weight: normal;
  font-style: normal;
  background-color: #FFFFFF;
  width: auto;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #A8A8A8;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #A8A8A8;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
}

#oibmxuuqgd .gt_heading {
  background-color: #FFFFFF;
  text-align: center;
  border-bottom-color: #FFFFFF;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#oibmxuuqgd .gt_caption {
  padding-top: 4px;
  padding-bottom: 4px;
}

#oibmxuuqgd .gt_title {
  color: #333333;
  font-size: 125%;
  font-weight: initial;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-color: #FFFFFF;
  border-bottom-width: 0;
}

#oibmxuuqgd .gt_subtitle {
  color: #333333;
  font-size: 85%;
  font-weight: initial;
  padding-top: 0;
  padding-bottom: 6px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-color: #FFFFFF;
  border-top-width: 0;
}

#oibmxuuqgd .gt_bottom_border {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#oibmxuuqgd .gt_col_headings {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#oibmxuuqgd .gt_col_heading {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 6px;
  padding-left: 5px;
  padding-right: 5px;
  overflow-x: hidden;
}

#oibmxuuqgd .gt_column_spanner_outer {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  padding-top: 0;
  padding-bottom: 0;
  padding-left: 4px;
  padding-right: 4px;
}

#oibmxuuqgd .gt_column_spanner_outer:first-child {
  padding-left: 0;
}

#oibmxuuqgd .gt_column_spanner_outer:last-child {
  padding-right: 0;
}

#oibmxuuqgd .gt_column_spanner {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 5px;
  overflow-x: hidden;
  display: inline-block;
  width: 100%;
}

#oibmxuuqgd .gt_group_heading {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  text-align: left;
}

#oibmxuuqgd .gt_empty_group_heading {
  padding: 0.5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: middle;
}

#oibmxuuqgd .gt_from_md > :first-child {
  margin-top: 0;
}

#oibmxuuqgd .gt_from_md > :last-child {
  margin-bottom: 0;
}

#oibmxuuqgd .gt_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  margin: 10px;
  border-top-style: solid;
  border-top-width: 1px;
  border-top-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  overflow-x: hidden;
}

#oibmxuuqgd .gt_stub {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
}

#oibmxuuqgd .gt_stub_row_group {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
  vertical-align: top;
}

#oibmxuuqgd .gt_row_group_first td {
  border-top-width: 2px;
}

#oibmxuuqgd .gt_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#oibmxuuqgd .gt_first_summary_row {
  border-top-style: solid;
  border-top-color: #D3D3D3;
}

#oibmxuuqgd .gt_first_summary_row.thick {
  border-top-width: 2px;
}

#oibmxuuqgd .gt_last_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#oibmxuuqgd .gt_grand_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#oibmxuuqgd .gt_first_grand_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-style: double;
  border-top-width: 6px;
  border-top-color: #D3D3D3;
}

#oibmxuuqgd .gt_striped {
  background-color: rgba(128, 128, 128, 0.05);
}

#oibmxuuqgd .gt_table_body {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#oibmxuuqgd .gt_footnotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#oibmxuuqgd .gt_footnote {
  margin: 0px;
  font-size: 90%;
  padding-left: 4px;
  padding-right: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#oibmxuuqgd .gt_sourcenotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#oibmxuuqgd .gt_sourcenote {
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#oibmxuuqgd .gt_left {
  text-align: left;
}

#oibmxuuqgd .gt_center {
  text-align: center;
}

#oibmxuuqgd .gt_right {
  text-align: right;
  font-variant-numeric: tabular-nums;
}

#oibmxuuqgd .gt_font_normal {
  font-weight: normal;
}

#oibmxuuqgd .gt_font_bold {
  font-weight: bold;
}

#oibmxuuqgd .gt_font_italic {
  font-style: italic;
}

#oibmxuuqgd .gt_super {
  font-size: 65%;
}

#oibmxuuqgd .gt_footnote_marks {
  font-style: italic;
  font-weight: normal;
  font-size: 75%;
  vertical-align: 0.4em;
}

#oibmxuuqgd .gt_asterisk {
  font-size: 100%;
  vertical-align: 0;
}

#oibmxuuqgd .gt_indent_1 {
  text-indent: 5px;
}

#oibmxuuqgd .gt_indent_2 {
  text-indent: 10px;
}

#oibmxuuqgd .gt_indent_3 {
  text-indent: 15px;
}

#oibmxuuqgd .gt_indent_4 {
  text-indent: 20px;
}

#oibmxuuqgd .gt_indent_5 {
  text-indent: 25px;
}
</style>
<table class="gt_table">
  
  <thead class="gt_col_headings">
    <tr>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1" scope="col" id="diff_A">diff_A</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1" scope="col" id=".lower">.lower</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1" scope="col" id=".upper">.upper</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1" scope="col" id=".width">.width</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_left" rowspan="1" colspan="1" scope="col" id=".point">.point</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_left" rowspan="1" colspan="1" scope="col" id=".interval">.interval</th>
    </tr>
  </thead>
  <tbody class="gt_table_body">
    <tr><td headers="diff_A" class="gt_row gt_right">0.1685071</td>
<td headers=".lower" class="gt_row gt_right">0.1300103</td>
<td headers=".upper" class="gt_row gt_right">0.2057698</td>
<td headers=".width" class="gt_row gt_right">0.95</td>
<td headers=".point" class="gt_row gt_left">mean</td>
<td headers=".interval" class="gt_row gt_left">qi</td></tr>
  </tbody>
  
  
</table>
</div>
<p><br /></p>
<p>プロットすると以下のようになる。</p>
<div class="sourceCode" id="cb688"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb688-1"><a href="conditional-manatees.html#cb688-1" aria-hidden="true" tabindex="-1"></a><span class="fu">conditional_effects</span>(b8<span class="fl">.2</span>,<span class="at">method=</span><span class="st">&quot;fitted&quot;</span>,</span>
<span id="cb688-2"><a href="conditional-manatees.html#cb688-2" aria-hidden="true" tabindex="-1"></a>                    <span class="at">effects =</span> <span class="st">&quot;R_c:A_ind&quot;</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb688-3"><a href="conditional-manatees.html#cb688-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">plot</span>(<span class="at">points =</span> T,<span class="at">theme =</span> <span class="fu">theme</span>(<span class="at">aspect.ratio=</span><span class="dv">1</span>))</span></code></pre></div>
<p><img src="Rethinking_Bookdown_files/figure-html/unnamed-chunk-319-1.png" width="672" style="display: block; margin: auto;" />
<br /></p>
</div>
<div id="adding-interaction-does-work" class="section level3 hasAnchor" number="8.1.3">
<h3><span class="header-section-number">8.1.3</span> Adding interaction does work<a href="conditional-manatees.html#adding-interaction-does-work" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>最後に、交互作用を入れてみる。<br />
<br /></p>
<p><span class="math inline">\(\mu_{i} = \alpha_{CID[i]} + \beta_{CID[i]}(r_{i} - \bar{r})\)</span><br />
<br /></p>
<p>brmで記述する際には、nl = TRUEにして非線形モデルを作る。</p>
<div class="sourceCode" id="cb689"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb689-1"><a href="conditional-manatees.html#cb689-1" aria-hidden="true" tabindex="-1"></a>b8<span class="fl">.3</span> <span class="ot">&lt;-</span> <span class="fu">brm</span>(</span>
<span id="cb689-2"><a href="conditional-manatees.html#cb689-2" aria-hidden="true" tabindex="-1"></a>  <span class="at">data =</span> d2,</span>
<span id="cb689-3"><a href="conditional-manatees.html#cb689-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">family =</span> gaussian,</span>
<span id="cb689-4"><a href="conditional-manatees.html#cb689-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">formula =</span> <span class="fu">bf</span>(G <span class="sc">~</span> <span class="dv">0</span> <span class="sc">+</span> a <span class="sc">+</span> b <span class="sc">*</span> R_c, </span>
<span id="cb689-5"><a href="conditional-manatees.html#cb689-5" aria-hidden="true" tabindex="-1"></a>         a <span class="sc">~</span> <span class="dv">0</span> <span class="sc">+</span> A_ind, </span>
<span id="cb689-6"><a href="conditional-manatees.html#cb689-6" aria-hidden="true" tabindex="-1"></a>         b <span class="sc">~</span> <span class="dv">0</span> <span class="sc">+</span> A_ind,</span>
<span id="cb689-7"><a href="conditional-manatees.html#cb689-7" aria-hidden="true" tabindex="-1"></a>         <span class="at">nl =</span> <span class="cn">TRUE</span>),</span>
<span id="cb689-8"><a href="conditional-manatees.html#cb689-8" aria-hidden="true" tabindex="-1"></a>  <span class="at">prior =</span> <span class="fu">c</span>(<span class="fu">prior</span>(<span class="fu">normal</span>(<span class="dv">1</span>, <span class="fl">0.1</span>), <span class="at">class =</span> b,</span>
<span id="cb689-9"><a href="conditional-manatees.html#cb689-9" aria-hidden="true" tabindex="-1"></a>                  <span class="at">coef=</span><span class="st">&quot;A_ind1&quot;</span>, <span class="at">nlpar=</span>a),</span>
<span id="cb689-10"><a href="conditional-manatees.html#cb689-10" aria-hidden="true" tabindex="-1"></a>            <span class="fu">prior</span>(<span class="fu">normal</span>(<span class="dv">1</span>, <span class="fl">0.1</span>), <span class="at">class =</span> b,</span>
<span id="cb689-11"><a href="conditional-manatees.html#cb689-11" aria-hidden="true" tabindex="-1"></a>                  <span class="at">coef=</span><span class="st">&quot;A_ind2&quot;</span>,<span class="at">nlpar=</span>a),</span>
<span id="cb689-12"><a href="conditional-manatees.html#cb689-12" aria-hidden="true" tabindex="-1"></a>            <span class="fu">prior</span>(<span class="fu">normal</span>(<span class="dv">1</span>, <span class="fl">0.3</span>), <span class="at">class =</span> b,</span>
<span id="cb689-13"><a href="conditional-manatees.html#cb689-13" aria-hidden="true" tabindex="-1"></a>                  <span class="at">coef=</span><span class="st">&quot;A_ind1&quot;</span>, <span class="at">nlpar=</span>b),</span>
<span id="cb689-14"><a href="conditional-manatees.html#cb689-14" aria-hidden="true" tabindex="-1"></a>            <span class="fu">prior</span>(<span class="fu">normal</span>(<span class="dv">1</span>, <span class="fl">0.3</span>), <span class="at">class =</span> b,</span>
<span id="cb689-15"><a href="conditional-manatees.html#cb689-15" aria-hidden="true" tabindex="-1"></a>                  <span class="at">coef=</span><span class="st">&quot;A_ind2&quot;</span>,<span class="at">nlpar=</span>b),</span>
<span id="cb689-16"><a href="conditional-manatees.html#cb689-16" aria-hidden="true" tabindex="-1"></a>            <span class="fu">prior</span>(<span class="fu">exponential</span>(<span class="dv">1</span>), <span class="at">class =</span> sigma)),</span>
<span id="cb689-17"><a href="conditional-manatees.html#cb689-17" aria-hidden="true" tabindex="-1"></a>  <span class="at">seed=</span><span class="dv">8</span>, <span class="at">sample_prior=</span><span class="cn">TRUE</span>,</span>
<span id="cb689-18"><a href="conditional-manatees.html#cb689-18" aria-hidden="true" tabindex="-1"></a>  <span class="at">backend =</span> <span class="st">&quot;cmdstanr&quot;</span>,</span>
<span id="cb689-19"><a href="conditional-manatees.html#cb689-19" aria-hidden="true" tabindex="-1"></a>  <span class="at">file =</span> <span class="st">&quot;output/Chapter8/b8.3&quot;</span></span>
<span id="cb689-20"><a href="conditional-manatees.html#cb689-20" aria-hidden="true" tabindex="-1"></a>)</span></code></pre></div>
<p><br /></p>
<p>WAICを比較するとb8.3がb8.2よりもよい。<br />
重みづけをすると、b8.3がかなりのウェイトを占める。</p>
<div class="sourceCode" id="cb690"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb690-1"><a href="conditional-manatees.html#cb690-1" aria-hidden="true" tabindex="-1"></a>b8<span class="fl">.3</span> <span class="ot">&lt;-</span> <span class="fu">add_criterion</span>(b8<span class="fl">.3</span>, <span class="fu">c</span>(<span class="st">&quot;waic&quot;</span>,<span class="st">&quot;loo&quot;</span>))</span>
<span id="cb690-2"><a href="conditional-manatees.html#cb690-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb690-3"><a href="conditional-manatees.html#cb690-3" aria-hidden="true" tabindex="-1"></a><span class="fu">loo_compare</span>(b8<span class="fl">.1</span>,b8<span class="fl">.2</span>,b8<span class="fl">.3</span>, <span class="at">criterion=</span><span class="st">&quot;loo&quot;</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb690-4"><a href="conditional-manatees.html#cb690-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">print</span>(<span class="at">simplify =</span> F)</span></code></pre></div>
<pre><code>##      elpd_diff se_diff elpd_loo se_elpd_loo p_loo  se_p_loo looic  se_looic
## b8.3    0.0       0.0   128.9      7.3         5.3    1.0   -257.7   14.6  
## b8.2   -2.7       3.7   126.1      7.4         4.2    0.8   -252.3   14.9  
## b8.1  -34.5       7.5    94.4      6.5         2.6    0.3   -188.7   13.0</code></pre>
<div class="sourceCode" id="cb692"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb692-1"><a href="conditional-manatees.html#cb692-1" aria-hidden="true" tabindex="-1"></a><span class="fu">model_weights</span>(b8<span class="fl">.1</span>, b8<span class="fl">.2</span>, b8<span class="fl">.3</span>, <span class="at">weights =</span> <span class="st">&quot;loo&quot;</span>) <span class="sc">%&gt;%</span> <span class="fu">round</span>(<span class="at">digits =</span> <span class="dv">2</span>) </span></code></pre></div>
<pre><code>## b8.1 b8.2 b8.3 
## 0.00 0.06 0.94</code></pre>
<p><br /></p>
<p>pareto_kもすべて0.7以下である。</p>
<div class="sourceCode" id="cb694"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb694-1"><a href="conditional-manatees.html#cb694-1" aria-hidden="true" tabindex="-1"></a><span class="fu">loo</span>(b8<span class="fl">.3</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb694-2"><a href="conditional-manatees.html#cb694-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">plot</span>()</span></code></pre></div>
<p><img src="Rethinking_Bookdown_files/figure-html/unnamed-chunk-322-1.png" width="672" style="display: block; margin: auto;" /></p>
<p>傾きはアフリカとそれ以外で逆向きになっている。</p>
<div class="sourceCode" id="cb695"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb695-1"><a href="conditional-manatees.html#cb695-1" aria-hidden="true" tabindex="-1"></a><span class="fu">posterior_summary</span>(b8<span class="fl">.3</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb695-2"><a href="conditional-manatees.html#cb695-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">data.frame</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb695-3"><a href="conditional-manatees.html#cb695-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">round</span>(<span class="dv">2</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb695-4"><a href="conditional-manatees.html#cb695-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rownames_to_column</span>(<span class="at">var =</span> <span class="st">&quot;parameters&quot;</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb695-5"><a href="conditional-manatees.html#cb695-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(parameters <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">&quot;sigma&quot;</span>)<span class="sc">|</span></span>
<span id="cb695-6"><a href="conditional-manatees.html#cb695-6" aria-hidden="true" tabindex="-1"></a>           <span class="fu">str_detect</span>(parameters,<span class="st">&quot;^b_&quot;</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb695-7"><a href="conditional-manatees.html#cb695-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">as_tibble</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb695-8"><a href="conditional-manatees.html#cb695-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">print</span>()</span></code></pre></div>
<pre><code>## # A tibble: 5 × 5
##   parameters Estimate Est.Error  Q2.5 Q97.5
##   &lt;chr&gt;         &lt;dbl&gt;     &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;
## 1 b_a_A_ind1     0.89      0.02  0.86  0.92
## 2 b_a_A_ind2     1.05      0.01  1.03  1.07
## 3 b_b_A_ind1     0.2       0.08  0.05  0.35
## 4 b_b_A_ind2    -0.11      0.06 -0.22  0.01
## 5 sigma          0.11      0.01  0.1   0.12</code></pre>
<div class="sourceCode" id="cb697"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb697-1"><a href="conditional-manatees.html#cb697-1" aria-hidden="true" tabindex="-1"></a><span class="fu">conditional_effects</span>(b8<span class="fl">.3</span>,<span class="at">method=</span><span class="st">&quot;fitted&quot;</span>,</span>
<span id="cb697-2"><a href="conditional-manatees.html#cb697-2" aria-hidden="true" tabindex="-1"></a>                    <span class="at">effects =</span> <span class="st">&quot;R_c:A_ind&quot;</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb697-3"><a href="conditional-manatees.html#cb697-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">plot</span>(<span class="at">points =</span> T,<span class="at">theme =</span> <span class="fu">theme</span>(<span class="at">aspect.ratio=</span><span class="dv">1</span>))</span></code></pre></div>
<p><img src="Rethinking_Bookdown_files/figure-html/unnamed-chunk-324-1.png" width="672" style="display: block; margin: auto;" />
<br /></p>
</div>
<div id="plotting-the-interaction" class="section level3 hasAnchor" number="8.1.4">
<h3><span class="header-section-number">8.1.4</span> Plotting the interaction<a href="conditional-manatees.html#plotting-the-interaction" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>手で書くと…</p>
<div class="sourceCode" id="cb698"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb698-1"><a href="conditional-manatees.html#cb698-1" aria-hidden="true" tabindex="-1"></a>sample <span class="ot">&lt;-</span> <span class="fu">crossing</span>(<span class="at">R_c =</span> <span class="fu">seq</span>(<span class="sc">-</span><span class="fl">0.3</span>,<span class="fl">0.8</span>, <span class="at">length.out=</span><span class="dv">50</span>),</span>
<span id="cb698-2"><a href="conditional-manatees.html#cb698-2" aria-hidden="true" tabindex="-1"></a>                   <span class="at">A_ind =</span> <span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">2</span>))</span>
<span id="cb698-3"><a href="conditional-manatees.html#cb698-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb698-4"><a href="conditional-manatees.html#cb698-4" aria-hidden="true" tabindex="-1"></a><span class="fu">fitted</span>(b8<span class="fl">.3</span>, <span class="at">newdata =</span> sample, <span class="at">probs =</span> <span class="fu">c</span>(<span class="fl">0.015</span>,<span class="fl">0.985</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb698-5"><a href="conditional-manatees.html#cb698-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">data.frame</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb698-6"><a href="conditional-manatees.html#cb698-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">bind_cols</span>(sample) <span class="sc">%&gt;%</span> </span>
<span id="cb698-7"><a href="conditional-manatees.html#cb698-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">R =</span> R_c<span class="sc">+</span><span class="fu">mean</span>(d2<span class="sc">$</span>R),</span>
<span id="cb698-8"><a href="conditional-manatees.html#cb698-8" aria-hidden="true" tabindex="-1"></a>         <span class="at">A_ind =</span> <span class="fu">as.factor</span>(A_ind)) <span class="sc">%&gt;%</span></span>
<span id="cb698-9"><a href="conditional-manatees.html#cb698-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">A_ind =</span> <span class="fu">fct_relevel</span>(A_ind, <span class="st">&quot;1&quot;</span>,<span class="st">&quot;2&quot;</span>)) <span class="ot">-&gt;</span> fitted</span>
<span id="cb698-10"><a href="conditional-manatees.html#cb698-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb698-11"><a href="conditional-manatees.html#cb698-11" aria-hidden="true" tabindex="-1"></a>labeli <span class="ot">&lt;-</span> <span class="fu">as_labeller</span>(<span class="fu">c</span>(<span class="st">&quot;1&quot;</span> <span class="ot">=</span> <span class="st">&quot;African nations&quot;</span>,</span>
<span id="cb698-12"><a href="conditional-manatees.html#cb698-12" aria-hidden="true" tabindex="-1"></a>                         <span class="st">&quot;2&quot;</span> <span class="ot">=</span> <span class="st">&quot;Non african nations&quot;</span>))</span>
<span id="cb698-13"><a href="conditional-manatees.html#cb698-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb698-14"><a href="conditional-manatees.html#cb698-14" aria-hidden="true" tabindex="-1"></a>countries <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;Equatorial Guinea&quot;</span>, <span class="st">&quot;South Africa&quot;</span>, <span class="st">&quot;Seychelles&quot;</span>, <span class="st">&quot;Swaziland&quot;</span>, <span class="st">&quot;Lesotho&quot;</span>, <span class="st">&quot;Rwanda&quot;</span>, <span class="st">&quot;Burundi&quot;</span>, <span class="st">&quot;Luxembourg&quot;</span>, <span class="st">&quot;Greece&quot;</span>, <span class="st">&quot;Switzerland&quot;</span>, <span class="st">&quot;Lebanon&quot;</span>, <span class="st">&quot;Yemen&quot;</span>, <span class="st">&quot;Tajikistan&quot;</span>, <span class="st">&quot;Nepal&quot;</span>)</span>
<span id="cb698-15"><a href="conditional-manatees.html#cb698-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb698-16"><a href="conditional-manatees.html#cb698-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb698-17"><a href="conditional-manatees.html#cb698-17" aria-hidden="true" tabindex="-1"></a>d2 <span class="sc">%&gt;%</span> </span>
<span id="cb698-18"><a href="conditional-manatees.html#cb698-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">A_ind =</span> <span class="fu">as.factor</span>(A_ind)) <span class="sc">%&gt;%</span> </span>
<span id="cb698-19"><a href="conditional-manatees.html#cb698-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">A_ind =</span> <span class="fu">fct_relevel</span>(A_ind, <span class="st">&quot;1&quot;</span>,<span class="st">&quot;2&quot;</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb698-20"><a href="conditional-manatees.html#cb698-20" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> R,<span class="at">color =</span> A_ind))<span class="sc">+</span></span>
<span id="cb698-21"><a href="conditional-manatees.html#cb698-21" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="fu">aes</span>(<span class="at">y =</span> G, <span class="at">shape =</span> A_ind), <span class="at">size =</span> <span class="fl">2.5</span>)<span class="sc">+</span></span>
<span id="cb698-22"><a href="conditional-manatees.html#cb698-22" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(<span class="at">data=</span>fitted,</span>
<span id="cb698-23"><a href="conditional-manatees.html#cb698-23" aria-hidden="true" tabindex="-1"></a>              <span class="fu">aes</span>(<span class="at">y =</span> Estimate,</span>
<span id="cb698-24"><a href="conditional-manatees.html#cb698-24" aria-hidden="true" tabindex="-1"></a>                  <span class="at">ymax =</span> Q98<span class="fl">.5</span>, <span class="at">ymin =</span> Q1<span class="fl">.5</span>,</span>
<span id="cb698-25"><a href="conditional-manatees.html#cb698-25" aria-hidden="true" tabindex="-1"></a>                  <span class="at">fill =</span> A_ind),</span>
<span id="cb698-26"><a href="conditional-manatees.html#cb698-26" aria-hidden="true" tabindex="-1"></a>              <span class="at">stat =</span> <span class="st">&quot;identity&quot;</span>,</span>
<span id="cb698-27"><a href="conditional-manatees.html#cb698-27" aria-hidden="true" tabindex="-1"></a>              <span class="at">alpha =</span> <span class="dv">1</span><span class="sc">/</span><span class="dv">4</span>, <span class="at">size =</span> <span class="dv">1</span><span class="sc">/</span><span class="dv">2</span>)<span class="sc">+</span></span>
<span id="cb698-28"><a href="conditional-manatees.html#cb698-28" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_shape_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="dv">16</span>,<span class="dv">1</span>))<span class="sc">+</span></span>
<span id="cb698-29"><a href="conditional-manatees.html#cb698-29" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="st">&quot;navy&quot;</span>,<span class="st">&quot;black&quot;</span>))<span class="sc">+</span></span>
<span id="cb698-30"><a href="conditional-manatees.html#cb698-30" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="st">&quot;navy&quot;</span>,<span class="st">&quot;black&quot;</span>))<span class="sc">+</span></span>
<span id="cb698-31"><a href="conditional-manatees.html#cb698-31" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">aspect.ratio=</span><span class="dv">1</span>, </span>
<span id="cb698-32"><a href="conditional-manatees.html#cb698-32" aria-hidden="true" tabindex="-1"></a>        <span class="at">legend.position =</span> <span class="st">&quot;none&quot;</span>,</span>
<span id="cb698-33"><a href="conditional-manatees.html#cb698-33" aria-hidden="true" tabindex="-1"></a>        <span class="at">strip.background =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb698-34"><a href="conditional-manatees.html#cb698-34" aria-hidden="true" tabindex="-1"></a>        <span class="at">strip.text =</span> <span class="fu">element_text</span>(<span class="at">size=</span><span class="dv">15</span>))<span class="sc">+</span></span>
<span id="cb698-35"><a href="conditional-manatees.html#cb698-35" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_text_repel</span>(<span class="at">data =</span>d2 <span class="sc">%&gt;%</span> </span>
<span id="cb698-36"><a href="conditional-manatees.html#cb698-36" aria-hidden="true" tabindex="-1"></a>                    <span class="fu">filter</span>(country <span class="sc">%in%</span> countries),</span>
<span id="cb698-37"><a href="conditional-manatees.html#cb698-37" aria-hidden="true" tabindex="-1"></a>                           <span class="fu">aes</span>(<span class="at">y=</span>G, <span class="at">label=</span>country),</span>
<span id="cb698-38"><a href="conditional-manatees.html#cb698-38" aria-hidden="true" tabindex="-1"></a>                  <span class="at">size=</span><span class="fl">2.3</span>)<span class="sc">+</span></span>
<span id="cb698-39"><a href="conditional-manatees.html#cb698-39" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span>A_ind, <span class="at">labeller =</span> labeli)<span class="sc">+</span></span>
<span id="cb698-40"><a href="conditional-manatees.html#cb698-40" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">&quot;ruggedness (std)&quot;</span>,</span>
<span id="cb698-41"><a href="conditional-manatees.html#cb698-41" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">&quot;log GDP (as proportion of mean)&quot;</span>)</span></code></pre></div>
<p><img src="Rethinking_Bookdown_files/figure-html/unnamed-chunk-325-1.png" width="672" style="display: block; margin: auto;" />
<br /></p>
</div>
</div>
<div id="symmetry-of-interaction" class="section level2 hasAnchor" number="8.2">
<h2><span class="header-section-number">8.2</span> Symmetry of interaction<a href="conditional-manatees.html#symmetry-of-interaction" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>交互作用は2通りに解釈できる。<br />
1. アフリカの国かそれ以外かによってRがGに与える影響が変わる。<br />
2. Rの値によって、アフリカとそれ以外の国のGDPの大小関係が変わる。<br />
<br /></p>
<p>先ほどは1に着目していたが、今度は2に着目してみよう。<br />
ruggednessが高くなるほど、GDPの差が徐々に小さくなっていき、Rが0.75あたりで大小関係が逆転していることが分かる。</p>
<div class="sourceCode" id="cb699"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb699-1"><a href="conditional-manatees.html#cb699-1" aria-hidden="true" tabindex="-1"></a><span class="fu">fitted</span>(b8<span class="fl">.3</span>, <span class="at">newdata =</span> sample, <span class="at">probs =</span> <span class="fu">c</span>(<span class="fl">0.015</span>,<span class="fl">0.985</span>),</span>
<span id="cb699-2"><a href="conditional-manatees.html#cb699-2" aria-hidden="true" tabindex="-1"></a>       <span class="at">summary =</span> F) <span class="sc">%&gt;%</span> </span>
<span id="cb699-3"><a href="conditional-manatees.html#cb699-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">data.frame</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb699-4"><a href="conditional-manatees.html#cb699-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_longer</span>(<span class="fu">everything</span>(),</span>
<span id="cb699-5"><a href="conditional-manatees.html#cb699-5" aria-hidden="true" tabindex="-1"></a>               <span class="at">values_to =</span> <span class="st">&quot;Estimate&quot;</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb699-6"><a href="conditional-manatees.html#cb699-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">bind_cols</span>(tidyr<span class="sc">::</span><span class="fu">expand</span>(sample,</span>
<span id="cb699-7"><a href="conditional-manatees.html#cb699-7" aria-hidden="true" tabindex="-1"></a>                   <span class="at">iter =</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">4000</span>,</span>
<span id="cb699-8"><a href="conditional-manatees.html#cb699-8" aria-hidden="true" tabindex="-1"></a>            <span class="fu">nesting</span>(R_c, A_ind))) <span class="sc">%&gt;%</span> </span>
<span id="cb699-9"><a href="conditional-manatees.html#cb699-9" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">select</span>(<span class="sc">-</span>name) <span class="sc">%&gt;%</span> </span>
<span id="cb699-10"><a href="conditional-manatees.html#cb699-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_wider</span>(<span class="at">names_from =</span> A_ind, <span class="at">values_from =</span> Estimate) <span class="sc">%&gt;%</span> </span>
<span id="cb699-11"><a href="conditional-manatees.html#cb699-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">delta =</span> <span class="st">`</span><span class="at">1</span><span class="st">`</span> <span class="sc">-</span> <span class="st">`</span><span class="at">2</span><span class="st">`</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb699-12"><a href="conditional-manatees.html#cb699-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(R_c) <span class="sc">%&gt;%</span> </span>
<span id="cb699-13"><a href="conditional-manatees.html#cb699-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="fu">mean_qi</span>(delta)) <span class="sc">%&gt;%</span> </span>
<span id="cb699-14"><a href="conditional-manatees.html#cb699-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">data.frame</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb699-15"><a href="conditional-manatees.html#cb699-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">R =</span> R_c <span class="sc">+</span> <span class="fu">mean</span>(d2<span class="sc">$</span>R)) <span class="sc">%&gt;%</span> </span>
<span id="cb699-16"><a href="conditional-manatees.html#cb699-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x=</span>R, <span class="at">y =</span> y, <span class="at">ymin =</span> ymin, <span class="at">ymax =</span> ymax))<span class="sc">+</span></span>
<span id="cb699-17"><a href="conditional-manatees.html#cb699-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(<span class="at">color=</span><span class="st">&quot;black&quot;</span>, <span class="at">alpha =</span> <span class="dv">1</span><span class="sc">/</span><span class="dv">3</span>, </span>
<span id="cb699-18"><a href="conditional-manatees.html#cb699-18" aria-hidden="true" tabindex="-1"></a>              <span class="at">size=</span><span class="dv">1</span><span class="sc">/</span><span class="dv">2</span>, <span class="at">stat =</span> <span class="st">&quot;identity&quot;</span>)<span class="sc">+</span></span>
<span id="cb699-19"><a href="conditional-manatees.html#cb699-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x=</span><span class="st">&quot;ruggedness&quot;</span>, <span class="at">y =</span> <span class="st">&quot;expected difference log GDP&quot;</span>)<span class="sc">+</span></span>
<span id="cb699-20"><a href="conditional-manatees.html#cb699-20" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_hline</span>(<span class="at">yintercept =</span> <span class="dv">0</span>, <span class="at">linetype=</span><span class="dv">2</span>)<span class="sc">+</span></span>
<span id="cb699-21"><a href="conditional-manatees.html#cb699-21" aria-hidden="true" tabindex="-1"></a>  <span class="fu">annotate</span>(<span class="at">geom =</span> <span class="st">&quot;text&quot;</span>, <span class="at">x=</span><span class="fl">0.1</span>,<span class="at">y=</span><span class="fl">0.03</span>, <span class="at">label=</span><span class="st">&quot;Africa &gt; Non Africa&quot;</span>, <span class="at">size=</span><span class="dv">3</span>)<span class="sc">+</span></span>
<span id="cb699-22"><a href="conditional-manatees.html#cb699-22" aria-hidden="true" tabindex="-1"></a>  <span class="fu">annotate</span>(<span class="at">geom =</span> <span class="st">&quot;text&quot;</span>, <span class="at">x=</span><span class="fl">0.1</span>,<span class="at">y=</span><span class="sc">-</span><span class="fl">0.03</span>, <span class="at">label=</span><span class="st">&quot;Non Africa &gt; Africa&quot;</span>,<span class="at">size=</span><span class="dv">3</span>)<span class="sc">+</span></span>
<span id="cb699-23"><a href="conditional-manatees.html#cb699-23" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">aspect.ratio=</span><span class="dv">1</span>)</span></code></pre></div>
<p><img src="Rethinking_Bookdown_files/figure-html/unnamed-chunk-326-1.png" width="672" style="display: block; margin: auto;" />
<br /></p>
</div>
<div id="continuous-interaction" class="section level2 hasAnchor" number="8.3">
<h2><span class="header-section-number">8.3</span> Continuous interaction<a href="conditional-manatees.html#continuous-interaction" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>連続変数の交互作用は解釈が一層難しい。</p>
<div id="a-winter-flower" class="section level3 hasAnchor" number="8.3.1">
<h3><span class="header-section-number">8.3.1</span> A winter flower<a href="conditional-manatees.html#a-winter-flower" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>異なる日照条件と与える水の量によってチューリップの花のサイズを説明するモデルを考える。</p>
<div class="sourceCode" id="cb700"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb700-1"><a href="conditional-manatees.html#cb700-1" aria-hidden="true" tabindex="-1"></a><span class="do">## データ読み込み</span></span>
<span id="cb700-2"><a href="conditional-manatees.html#cb700-2" aria-hidden="true" tabindex="-1"></a><span class="fu">data</span>(tulips)</span>
<span id="cb700-3"><a href="conditional-manatees.html#cb700-3" aria-hidden="true" tabindex="-1"></a>d3 <span class="ot">&lt;-</span> tulips</span>
<span id="cb700-4"><a href="conditional-manatees.html#cb700-4" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(d3)</span></code></pre></div>
<pre><code>##   bed water shade blooms
## 1   a     1     1   0.00
## 2   a     1     2   0.00
## 3   a     1     3 111.04
## 4   a     2     1 183.47
## 5   a     2     2  59.16
## 6   a     2     3  76.75</code></pre>
<div class="sourceCode" id="cb702"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb702-1"><a href="conditional-manatees.html#cb702-1" aria-hidden="true" tabindex="-1"></a>d3 <span class="sc">%&gt;%</span> </span>
<span id="cb702-2"><a href="conditional-manatees.html#cb702-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x=</span>water,<span class="at">y=</span>blooms,<span class="at">color=</span><span class="fu">as.factor</span>(shade)))<span class="sc">+</span></span>
<span id="cb702-3"><a href="conditional-manatees.html#cb702-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">size =</span><span class="dv">2</span>, <span class="at">shape=</span><span class="dv">1</span>)<span class="sc">+</span></span>
<span id="cb702-4"><a href="conditional-manatees.html#cb702-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">aspect.ratio=</span><span class="dv">1</span>)</span></code></pre></div>
<p><img src="Rethinking_Bookdown_files/figure-html/unnamed-chunk-327-1.png" width="672" style="display: block; margin: auto;" /></p>
<div class="sourceCode" id="cb703"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb703-1"><a href="conditional-manatees.html#cb703-1" aria-hidden="true" tabindex="-1"></a>d3 <span class="sc">%&gt;%</span> </span>
<span id="cb703-2"><a href="conditional-manatees.html#cb703-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x=</span>shade,<span class="at">y=</span>blooms,<span class="at">color=</span><span class="fu">as.factor</span>(water)))<span class="sc">+</span></span>
<span id="cb703-3"><a href="conditional-manatees.html#cb703-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">size =</span><span class="dv">2</span>, <span class="at">shape=</span><span class="dv">1</span>)<span class="sc">+</span></span>
<span id="cb703-4"><a href="conditional-manatees.html#cb703-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">aspect.ratio=</span><span class="dv">1</span>)</span></code></pre></div>
<p><img src="Rethinking_Bookdown_files/figure-html/unnamed-chunk-327-2.png" width="672" style="display: block; margin: auto;" />
<br /></p>
</div>
<div id="the-models" class="section level3 hasAnchor" number="8.3.2">
<h3><span class="header-section-number">8.3.2</span> The models<a href="conditional-manatees.html#the-models" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>まずは交互作用なしのモデルを考える。
切片は0<sub>1の範囲に、傾きは-0.5</sub>0.5の範囲に収まると考えられるので、事前分布の標準偏差は0.25とする。<br />
<br /></p>
<p><span class="math display">\[
\begin{aligned}
B_{i} &amp;\sim Normal(\mu_{i}, \sigma)\\
\mu_{i} &amp;= \alpha + \beta_{W}(W_{i} - \bar{W}) + \beta_{S}(S_{i} - \bar{S})\\
\alpha &amp;\sim Normal(0.5,0.25)\\
\beta_{j} &amp;\sim Normal(0, 0.25)
\end{aligned}
\]</span></p>
<div class="sourceCode" id="cb704"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb704-1"><a href="conditional-manatees.html#cb704-1" aria-hidden="true" tabindex="-1"></a>d3 <span class="sc">%&gt;%</span> </span>
<span id="cb704-2"><a href="conditional-manatees.html#cb704-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">B =</span> blooms<span class="sc">/</span><span class="fu">max</span>(blooms),</span>
<span id="cb704-3"><a href="conditional-manatees.html#cb704-3" aria-hidden="true" tabindex="-1"></a>         <span class="at">W =</span> water <span class="sc">-</span> <span class="fu">mean</span>(water),</span>
<span id="cb704-4"><a href="conditional-manatees.html#cb704-4" aria-hidden="true" tabindex="-1"></a>         <span class="at">S =</span> shade <span class="sc">-</span> <span class="fu">mean</span>(shade)) <span class="ot">-&gt;</span> d3</span>
<span id="cb704-5"><a href="conditional-manatees.html#cb704-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb704-6"><a href="conditional-manatees.html#cb704-6" aria-hidden="true" tabindex="-1"></a>b8<span class="fl">.4</span> <span class="ot">&lt;-</span> <span class="fu">brm</span>(</span>
<span id="cb704-7"><a href="conditional-manatees.html#cb704-7" aria-hidden="true" tabindex="-1"></a>  <span class="at">data =</span> d3,</span>
<span id="cb704-8"><a href="conditional-manatees.html#cb704-8" aria-hidden="true" tabindex="-1"></a>  <span class="at">family =</span> gaussian,</span>
<span id="cb704-9"><a href="conditional-manatees.html#cb704-9" aria-hidden="true" tabindex="-1"></a>  <span class="at">formula =</span> B <span class="sc">~</span> <span class="dv">1</span> <span class="sc">+</span> W <span class="sc">+</span> S,</span>
<span id="cb704-10"><a href="conditional-manatees.html#cb704-10" aria-hidden="true" tabindex="-1"></a>  <span class="at">prior =</span> <span class="fu">c</span>(<span class="fu">prior</span>(<span class="fu">normal</span>(<span class="fl">0.5</span>, <span class="fl">0.25</span>), <span class="at">class =</span> Intercept),</span>
<span id="cb704-11"><a href="conditional-manatees.html#cb704-11" aria-hidden="true" tabindex="-1"></a>            <span class="fu">prior</span>(<span class="fu">normal</span>(<span class="dv">0</span>, <span class="fl">0.25</span>), <span class="at">class =</span> b),</span>
<span id="cb704-12"><a href="conditional-manatees.html#cb704-12" aria-hidden="true" tabindex="-1"></a>            <span class="fu">prior</span>(<span class="fu">exponential</span>(<span class="dv">1</span>), <span class="at">class =</span> sigma)),</span>
<span id="cb704-13"><a href="conditional-manatees.html#cb704-13" aria-hidden="true" tabindex="-1"></a>  <span class="at">seed=</span><span class="dv">8</span>, <span class="at">sample_prior=</span><span class="cn">TRUE</span>,</span>
<span id="cb704-14"><a href="conditional-manatees.html#cb704-14" aria-hidden="true" tabindex="-1"></a>  <span class="at">backend =</span> <span class="st">&quot;cmdstanr&quot;</span>,</span>
<span id="cb704-15"><a href="conditional-manatees.html#cb704-15" aria-hidden="true" tabindex="-1"></a>  <span class="at">file =</span> <span class="st">&quot;output/Chapter8/b8.4&quot;</span></span>
<span id="cb704-16"><a href="conditional-manatees.html#cb704-16" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb704-17"><a href="conditional-manatees.html#cb704-17" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb704-18"><a href="conditional-manatees.html#cb704-18" aria-hidden="true" tabindex="-1"></a><span class="fu">posterior_summary</span>(b8<span class="fl">.4</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb704-19"><a href="conditional-manatees.html#cb704-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">data.frame</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb704-20"><a href="conditional-manatees.html#cb704-20" aria-hidden="true" tabindex="-1"></a>  <span class="fu">round</span>(<span class="dv">2</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb704-21"><a href="conditional-manatees.html#cb704-21" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rownames_to_column</span>(<span class="at">var =</span> <span class="st">&quot;parameters&quot;</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb704-22"><a href="conditional-manatees.html#cb704-22" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(parameters <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">&quot;sigma&quot;</span>)<span class="sc">|</span></span>
<span id="cb704-23"><a href="conditional-manatees.html#cb704-23" aria-hidden="true" tabindex="-1"></a>           <span class="fu">str_detect</span>(parameters,<span class="st">&quot;^b_&quot;</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb704-24"><a href="conditional-manatees.html#cb704-24" aria-hidden="true" tabindex="-1"></a>  <span class="fu">gt</span>()</span></code></pre></div>
<div id="xkomdyqblz" style="padding-left:0px;padding-right:0px;padding-top:10px;padding-bottom:10px;overflow-x:auto;overflow-y:auto;width:auto;height:auto;">
<style>html {
  font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, Cantarell, 'Helvetica Neue', 'Fira Sans', 'Droid Sans', Arial, sans-serif;
}

#xkomdyqblz .gt_table {
  display: table;
  border-collapse: collapse;
  margin-left: auto;
  margin-right: auto;
  color: #333333;
  font-size: 16px;
  font-weight: normal;
  font-style: normal;
  background-color: #FFFFFF;
  width: auto;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #A8A8A8;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #A8A8A8;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
}

#xkomdyqblz .gt_heading {
  background-color: #FFFFFF;
  text-align: center;
  border-bottom-color: #FFFFFF;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#xkomdyqblz .gt_caption {
  padding-top: 4px;
  padding-bottom: 4px;
}

#xkomdyqblz .gt_title {
  color: #333333;
  font-size: 125%;
  font-weight: initial;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-color: #FFFFFF;
  border-bottom-width: 0;
}

#xkomdyqblz .gt_subtitle {
  color: #333333;
  font-size: 85%;
  font-weight: initial;
  padding-top: 0;
  padding-bottom: 6px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-color: #FFFFFF;
  border-top-width: 0;
}

#xkomdyqblz .gt_bottom_border {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#xkomdyqblz .gt_col_headings {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#xkomdyqblz .gt_col_heading {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 6px;
  padding-left: 5px;
  padding-right: 5px;
  overflow-x: hidden;
}

#xkomdyqblz .gt_column_spanner_outer {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  padding-top: 0;
  padding-bottom: 0;
  padding-left: 4px;
  padding-right: 4px;
}

#xkomdyqblz .gt_column_spanner_outer:first-child {
  padding-left: 0;
}

#xkomdyqblz .gt_column_spanner_outer:last-child {
  padding-right: 0;
}

#xkomdyqblz .gt_column_spanner {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 5px;
  overflow-x: hidden;
  display: inline-block;
  width: 100%;
}

#xkomdyqblz .gt_group_heading {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  text-align: left;
}

#xkomdyqblz .gt_empty_group_heading {
  padding: 0.5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: middle;
}

#xkomdyqblz .gt_from_md > :first-child {
  margin-top: 0;
}

#xkomdyqblz .gt_from_md > :last-child {
  margin-bottom: 0;
}

#xkomdyqblz .gt_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  margin: 10px;
  border-top-style: solid;
  border-top-width: 1px;
  border-top-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  overflow-x: hidden;
}

#xkomdyqblz .gt_stub {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
}

#xkomdyqblz .gt_stub_row_group {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
  vertical-align: top;
}

#xkomdyqblz .gt_row_group_first td {
  border-top-width: 2px;
}

#xkomdyqblz .gt_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#xkomdyqblz .gt_first_summary_row {
  border-top-style: solid;
  border-top-color: #D3D3D3;
}

#xkomdyqblz .gt_first_summary_row.thick {
  border-top-width: 2px;
}

#xkomdyqblz .gt_last_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#xkomdyqblz .gt_grand_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#xkomdyqblz .gt_first_grand_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-style: double;
  border-top-width: 6px;
  border-top-color: #D3D3D3;
}

#xkomdyqblz .gt_striped {
  background-color: rgba(128, 128, 128, 0.05);
}

#xkomdyqblz .gt_table_body {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#xkomdyqblz .gt_footnotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#xkomdyqblz .gt_footnote {
  margin: 0px;
  font-size: 90%;
  padding-left: 4px;
  padding-right: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#xkomdyqblz .gt_sourcenotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#xkomdyqblz .gt_sourcenote {
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#xkomdyqblz .gt_left {
  text-align: left;
}

#xkomdyqblz .gt_center {
  text-align: center;
}

#xkomdyqblz .gt_right {
  text-align: right;
  font-variant-numeric: tabular-nums;
}

#xkomdyqblz .gt_font_normal {
  font-weight: normal;
}

#xkomdyqblz .gt_font_bold {
  font-weight: bold;
}

#xkomdyqblz .gt_font_italic {
  font-style: italic;
}

#xkomdyqblz .gt_super {
  font-size: 65%;
}

#xkomdyqblz .gt_footnote_marks {
  font-style: italic;
  font-weight: normal;
  font-size: 75%;
  vertical-align: 0.4em;
}

#xkomdyqblz .gt_asterisk {
  font-size: 100%;
  vertical-align: 0;
}

#xkomdyqblz .gt_indent_1 {
  text-indent: 5px;
}

#xkomdyqblz .gt_indent_2 {
  text-indent: 10px;
}

#xkomdyqblz .gt_indent_3 {
  text-indent: 15px;
}

#xkomdyqblz .gt_indent_4 {
  text-indent: 20px;
}

#xkomdyqblz .gt_indent_5 {
  text-indent: 25px;
}
</style>
<table class="gt_table">
  
  <thead class="gt_col_headings">
    <tr>
      <th class="gt_col_heading gt_columns_bottom_border gt_left" rowspan="1" colspan="1" scope="col" id="parameters">parameters</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1" scope="col" id="Estimate">Estimate</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1" scope="col" id="Est.Error">Est.Error</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1" scope="col" id="Q2.5">Q2.5</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1" scope="col" id="Q97.5">Q97.5</th>
    </tr>
  </thead>
  <tbody class="gt_table_body">
    <tr><td headers="parameters" class="gt_row gt_left">b_Intercept</td>
<td headers="Estimate" class="gt_row gt_right">0.36</td>
<td headers="Est.Error" class="gt_row gt_right">0.03</td>
<td headers="Q2.5" class="gt_row gt_right">0.29</td>
<td headers="Q97.5" class="gt_row gt_right">0.43</td></tr>
    <tr><td headers="parameters" class="gt_row gt_left">b_W</td>
<td headers="Estimate" class="gt_row gt_right">0.20</td>
<td headers="Est.Error" class="gt_row gt_right">0.04</td>
<td headers="Q2.5" class="gt_row gt_right">0.12</td>
<td headers="Q97.5" class="gt_row gt_right">0.29</td></tr>
    <tr><td headers="parameters" class="gt_row gt_left">b_S</td>
<td headers="Estimate" class="gt_row gt_right">-0.11</td>
<td headers="Est.Error" class="gt_row gt_right">0.04</td>
<td headers="Q2.5" class="gt_row gt_right">-0.19</td>
<td headers="Q97.5" class="gt_row gt_right">-0.03</td></tr>
    <tr><td headers="parameters" class="gt_row gt_left">sigma</td>
<td headers="Estimate" class="gt_row gt_right">0.18</td>
<td headers="Est.Error" class="gt_row gt_right">0.03</td>
<td headers="Q2.5" class="gt_row gt_right">0.13</td>
<td headers="Q97.5" class="gt_row gt_right">0.24</td></tr>
  </tbody>
  
  
</table>
</div>
<p><br /></p>
<p>次に、交互作用ありのモデルを考える。<br />
以下では<span class="math inline">\(W_{i}\)</span>と<span class="math inline">\(S_{i}\)</span>は既に中心化されているとする。<br />
<br /></p>
<p><span class="math display">\[
\begin{aligned}  
B_{i} &amp;\sim Normal(\mu_{i}, \sigma)\\
\mu_{i} &amp;= \alpha + \beta_{W}W_{i} + \beta_{S}S_{i} + \beta_{WS} W_{i}S_{i}\\
\alpha &amp;\sim Normal(0.5,0.25)\\
\beta_{j} &amp;\sim Normal(0, 0.25)  
\end{aligned}
\]</span>
<br /></p>
<p>交互作用も強く働いていることが分かった。</p>
<div class="sourceCode" id="cb705"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb705-1"><a href="conditional-manatees.html#cb705-1" aria-hidden="true" tabindex="-1"></a>b8<span class="fl">.5</span> <span class="ot">&lt;-</span> <span class="fu">brm</span>(</span>
<span id="cb705-2"><a href="conditional-manatees.html#cb705-2" aria-hidden="true" tabindex="-1"></a>  <span class="at">data =</span> d3,</span>
<span id="cb705-3"><a href="conditional-manatees.html#cb705-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">family =</span> gaussian,</span>
<span id="cb705-4"><a href="conditional-manatees.html#cb705-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">formula =</span> B <span class="sc">~</span> <span class="dv">1</span> <span class="sc">+</span> W<span class="sc">+</span>S<span class="sc">+</span>W<span class="sc">:</span>S,</span>
<span id="cb705-5"><a href="conditional-manatees.html#cb705-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">prior =</span> <span class="fu">c</span>(<span class="fu">prior</span>(<span class="fu">normal</span>(<span class="fl">0.5</span>, <span class="fl">0.25</span>), <span class="at">class =</span> Intercept),</span>
<span id="cb705-6"><a href="conditional-manatees.html#cb705-6" aria-hidden="true" tabindex="-1"></a>            <span class="fu">prior</span>(<span class="fu">normal</span>(<span class="dv">0</span>, <span class="fl">0.25</span>), <span class="at">class =</span> b),</span>
<span id="cb705-7"><a href="conditional-manatees.html#cb705-7" aria-hidden="true" tabindex="-1"></a>            <span class="fu">prior</span>(<span class="fu">exponential</span>(<span class="dv">1</span>), <span class="at">class =</span> sigma)),</span>
<span id="cb705-8"><a href="conditional-manatees.html#cb705-8" aria-hidden="true" tabindex="-1"></a>  <span class="at">seed=</span><span class="dv">8</span>, <span class="at">sample_prior=</span><span class="cn">TRUE</span>,</span>
<span id="cb705-9"><a href="conditional-manatees.html#cb705-9" aria-hidden="true" tabindex="-1"></a>  <span class="at">backend =</span> <span class="st">&quot;cmdstanr&quot;</span>,</span>
<span id="cb705-10"><a href="conditional-manatees.html#cb705-10" aria-hidden="true" tabindex="-1"></a>  <span class="at">file =</span> <span class="st">&quot;output/Chapter8/b8.5&quot;</span></span>
<span id="cb705-11"><a href="conditional-manatees.html#cb705-11" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb705-12"><a href="conditional-manatees.html#cb705-12" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb705-13"><a href="conditional-manatees.html#cb705-13" aria-hidden="true" tabindex="-1"></a><span class="fu">posterior_summary</span>(b8<span class="fl">.5</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb705-14"><a href="conditional-manatees.html#cb705-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">data.frame</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb705-15"><a href="conditional-manatees.html#cb705-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">round</span>(<span class="dv">2</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb705-16"><a href="conditional-manatees.html#cb705-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rownames_to_column</span>(<span class="at">var =</span> <span class="st">&quot;parameters&quot;</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb705-17"><a href="conditional-manatees.html#cb705-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(parameters <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">&quot;sigma&quot;</span>)<span class="sc">|</span></span>
<span id="cb705-18"><a href="conditional-manatees.html#cb705-18" aria-hidden="true" tabindex="-1"></a>           <span class="fu">str_detect</span>(parameters,<span class="st">&quot;^b_&quot;</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb705-19"><a href="conditional-manatees.html#cb705-19" aria-hidden="true" tabindex="-1"></a> <span class="fu">gt</span>()</span></code></pre></div>
<div id="tsswbockrq" style="padding-left:0px;padding-right:0px;padding-top:10px;padding-bottom:10px;overflow-x:auto;overflow-y:auto;width:auto;height:auto;">
<style>html {
  font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, Cantarell, 'Helvetica Neue', 'Fira Sans', 'Droid Sans', Arial, sans-serif;
}

#tsswbockrq .gt_table {
  display: table;
  border-collapse: collapse;
  margin-left: auto;
  margin-right: auto;
  color: #333333;
  font-size: 16px;
  font-weight: normal;
  font-style: normal;
  background-color: #FFFFFF;
  width: auto;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #A8A8A8;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #A8A8A8;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
}

#tsswbockrq .gt_heading {
  background-color: #FFFFFF;
  text-align: center;
  border-bottom-color: #FFFFFF;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#tsswbockrq .gt_caption {
  padding-top: 4px;
  padding-bottom: 4px;
}

#tsswbockrq .gt_title {
  color: #333333;
  font-size: 125%;
  font-weight: initial;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-color: #FFFFFF;
  border-bottom-width: 0;
}

#tsswbockrq .gt_subtitle {
  color: #333333;
  font-size: 85%;
  font-weight: initial;
  padding-top: 0;
  padding-bottom: 6px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-color: #FFFFFF;
  border-top-width: 0;
}

#tsswbockrq .gt_bottom_border {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#tsswbockrq .gt_col_headings {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#tsswbockrq .gt_col_heading {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 6px;
  padding-left: 5px;
  padding-right: 5px;
  overflow-x: hidden;
}

#tsswbockrq .gt_column_spanner_outer {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  padding-top: 0;
  padding-bottom: 0;
  padding-left: 4px;
  padding-right: 4px;
}

#tsswbockrq .gt_column_spanner_outer:first-child {
  padding-left: 0;
}

#tsswbockrq .gt_column_spanner_outer:last-child {
  padding-right: 0;
}

#tsswbockrq .gt_column_spanner {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 5px;
  overflow-x: hidden;
  display: inline-block;
  width: 100%;
}

#tsswbockrq .gt_group_heading {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  text-align: left;
}

#tsswbockrq .gt_empty_group_heading {
  padding: 0.5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: middle;
}

#tsswbockrq .gt_from_md > :first-child {
  margin-top: 0;
}

#tsswbockrq .gt_from_md > :last-child {
  margin-bottom: 0;
}

#tsswbockrq .gt_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  margin: 10px;
  border-top-style: solid;
  border-top-width: 1px;
  border-top-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  overflow-x: hidden;
}

#tsswbockrq .gt_stub {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
}

#tsswbockrq .gt_stub_row_group {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
  vertical-align: top;
}

#tsswbockrq .gt_row_group_first td {
  border-top-width: 2px;
}

#tsswbockrq .gt_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#tsswbockrq .gt_first_summary_row {
  border-top-style: solid;
  border-top-color: #D3D3D3;
}

#tsswbockrq .gt_first_summary_row.thick {
  border-top-width: 2px;
}

#tsswbockrq .gt_last_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#tsswbockrq .gt_grand_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#tsswbockrq .gt_first_grand_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-style: double;
  border-top-width: 6px;
  border-top-color: #D3D3D3;
}

#tsswbockrq .gt_striped {
  background-color: rgba(128, 128, 128, 0.05);
}

#tsswbockrq .gt_table_body {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#tsswbockrq .gt_footnotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#tsswbockrq .gt_footnote {
  margin: 0px;
  font-size: 90%;
  padding-left: 4px;
  padding-right: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#tsswbockrq .gt_sourcenotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#tsswbockrq .gt_sourcenote {
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#tsswbockrq .gt_left {
  text-align: left;
}

#tsswbockrq .gt_center {
  text-align: center;
}

#tsswbockrq .gt_right {
  text-align: right;
  font-variant-numeric: tabular-nums;
}

#tsswbockrq .gt_font_normal {
  font-weight: normal;
}

#tsswbockrq .gt_font_bold {
  font-weight: bold;
}

#tsswbockrq .gt_font_italic {
  font-style: italic;
}

#tsswbockrq .gt_super {
  font-size: 65%;
}

#tsswbockrq .gt_footnote_marks {
  font-style: italic;
  font-weight: normal;
  font-size: 75%;
  vertical-align: 0.4em;
}

#tsswbockrq .gt_asterisk {
  font-size: 100%;
  vertical-align: 0;
}

#tsswbockrq .gt_indent_1 {
  text-indent: 5px;
}

#tsswbockrq .gt_indent_2 {
  text-indent: 10px;
}

#tsswbockrq .gt_indent_3 {
  text-indent: 15px;
}

#tsswbockrq .gt_indent_4 {
  text-indent: 20px;
}

#tsswbockrq .gt_indent_5 {
  text-indent: 25px;
}
</style>
<table class="gt_table">
  
  <thead class="gt_col_headings">
    <tr>
      <th class="gt_col_heading gt_columns_bottom_border gt_left" rowspan="1" colspan="1" scope="col" id="parameters">parameters</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1" scope="col" id="Estimate">Estimate</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1" scope="col" id="Est.Error">Est.Error</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1" scope="col" id="Q2.5">Q2.5</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1" scope="col" id="Q97.5">Q97.5</th>
    </tr>
  </thead>
  <tbody class="gt_table_body">
    <tr><td headers="parameters" class="gt_row gt_left">b_Intercept</td>
<td headers="Estimate" class="gt_row gt_right">0.36</td>
<td headers="Est.Error" class="gt_row gt_right">0.03</td>
<td headers="Q2.5" class="gt_row gt_right">0.30</td>
<td headers="Q97.5" class="gt_row gt_right">0.41</td></tr>
    <tr><td headers="parameters" class="gt_row gt_left">b_W</td>
<td headers="Estimate" class="gt_row gt_right">0.21</td>
<td headers="Est.Error" class="gt_row gt_right">0.03</td>
<td headers="Q2.5" class="gt_row gt_right">0.14</td>
<td headers="Q97.5" class="gt_row gt_right">0.27</td></tr>
    <tr><td headers="parameters" class="gt_row gt_left">b_S</td>
<td headers="Estimate" class="gt_row gt_right">-0.11</td>
<td headers="Est.Error" class="gt_row gt_right">0.03</td>
<td headers="Q2.5" class="gt_row gt_right">-0.18</td>
<td headers="Q97.5" class="gt_row gt_right">-0.05</td></tr>
    <tr><td headers="parameters" class="gt_row gt_left">b_W:S</td>
<td headers="Estimate" class="gt_row gt_right">-0.14</td>
<td headers="Est.Error" class="gt_row gt_right">0.04</td>
<td headers="Q2.5" class="gt_row gt_right">-0.22</td>
<td headers="Q97.5" class="gt_row gt_right">-0.06</td></tr>
    <tr><td headers="parameters" class="gt_row gt_left">sigma</td>
<td headers="Estimate" class="gt_row gt_right">0.14</td>
<td headers="Est.Error" class="gt_row gt_right">0.02</td>
<td headers="Q2.5" class="gt_row gt_right">0.11</td>
<td headers="Q97.5" class="gt_row gt_right">0.20</td></tr>
  </tbody>
  
  
</table>
</div>
<p><br /></p>
</div>
<div id="plotting-posterior-predictions" class="section level3 hasAnchor" number="8.3.3">
<h3><span class="header-section-number">8.3.3</span> Plotting posterior predictions<a href="conditional-manatees.html#plotting-posterior-predictions" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>まずは、事後分布についてプロットする。<br />
交互作用項を入れたモデルでは、日照条件に応じて傾きが変わっていることが分かる。</p>
<div class="sourceCode" id="cb706"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb706-1"><a href="conditional-manatees.html#cb706-1" aria-hidden="true" tabindex="-1"></a>seq <span class="ot">&lt;-</span> <span class="fu">crossing</span>(<span class="at">W =</span> <span class="fu">c</span>(<span class="sc">-</span><span class="dv">1</span>,<span class="dv">1</span>),</span>
<span id="cb706-2"><a href="conditional-manatees.html#cb706-2" aria-hidden="true" tabindex="-1"></a>                <span class="at">S =</span> <span class="fu">c</span>(<span class="sc">-</span><span class="dv">1</span>,<span class="dv">0</span>,<span class="dv">1</span>))</span>
<span id="cb706-3"><a href="conditional-manatees.html#cb706-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb706-4"><a href="conditional-manatees.html#cb706-4" aria-hidden="true" tabindex="-1"></a><span class="do">## fitする</span></span>
<span id="cb706-5"><a href="conditional-manatees.html#cb706-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb706-6"><a href="conditional-manatees.html#cb706-6" aria-hidden="true" tabindex="-1"></a><span class="fu">fitted</span>(b8<span class="fl">.4</span>, <span class="at">newdata =</span> seq, <span class="at">summary=</span> F) <span class="sc">%&gt;%</span> </span>
<span id="cb706-7"><a href="conditional-manatees.html#cb706-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">data.frame</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb706-8"><a href="conditional-manatees.html#cb706-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">slice_sample</span>(<span class="at">n=</span><span class="dv">20</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb706-9"><a href="conditional-manatees.html#cb706-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_longer</span>(<span class="fu">everything</span>()) <span class="sc">%&gt;%</span> </span>
<span id="cb706-10"><a href="conditional-manatees.html#cb706-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">bind_cols</span>(tidyr<span class="sc">::</span><span class="fu">expand</span>(seq,</span>
<span id="cb706-11"><a href="conditional-manatees.html#cb706-11" aria-hidden="true" tabindex="-1"></a>                   <span class="at">n=</span><span class="dv">1</span><span class="sc">:</span><span class="dv">20</span>,</span>
<span id="cb706-12"><a href="conditional-manatees.html#cb706-12" aria-hidden="true" tabindex="-1"></a>                   <span class="fu">nesting</span>(W,S))) <span class="ot">-&gt;</span> fitted8<span class="fl">.4</span></span>
<span id="cb706-13"><a href="conditional-manatees.html#cb706-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb706-14"><a href="conditional-manatees.html#cb706-14" aria-hidden="true" tabindex="-1"></a><span class="fu">fitted</span>(b8<span class="fl">.5</span>, <span class="at">newdata =</span> seq, <span class="at">summary=</span> F) <span class="sc">%&gt;%</span> </span>
<span id="cb706-15"><a href="conditional-manatees.html#cb706-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">data.frame</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb706-16"><a href="conditional-manatees.html#cb706-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">slice_sample</span>(<span class="at">n=</span><span class="dv">20</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb706-17"><a href="conditional-manatees.html#cb706-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_longer</span>(<span class="fu">everything</span>()) <span class="sc">%&gt;%</span> </span>
<span id="cb706-18"><a href="conditional-manatees.html#cb706-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">bind_cols</span>(tidyr<span class="sc">::</span><span class="fu">expand</span>(seq,</span>
<span id="cb706-19"><a href="conditional-manatees.html#cb706-19" aria-hidden="true" tabindex="-1"></a>                   <span class="at">n=</span><span class="dv">1</span><span class="sc">:</span><span class="dv">20</span>,</span>
<span id="cb706-20"><a href="conditional-manatees.html#cb706-20" aria-hidden="true" tabindex="-1"></a>                   <span class="fu">nesting</span>(W,S))) <span class="ot">-&gt;</span> fitted8<span class="fl">.5</span></span>
<span id="cb706-21"><a href="conditional-manatees.html#cb706-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb706-22"><a href="conditional-manatees.html#cb706-22" aria-hidden="true" tabindex="-1"></a>labeli8<span class="fl">.4</span> <span class="ot">&lt;-</span> </span>
<span id="cb706-23"><a href="conditional-manatees.html#cb706-23" aria-hidden="true" tabindex="-1"></a>  <span class="fu">as_labeller</span>(<span class="fu">c</span>(<span class="st">&quot;-1&quot;</span> <span class="ot">=</span> <span class="st">&quot;m8.4 post: shade = -1&quot;</span>,</span>
<span id="cb706-24"><a href="conditional-manatees.html#cb706-24" aria-hidden="true" tabindex="-1"></a>                <span class="st">&quot;0&quot;</span> <span class="ot">=</span> <span class="st">&quot;m8.4 post: shade = 0&quot;</span>,</span>
<span id="cb706-25"><a href="conditional-manatees.html#cb706-25" aria-hidden="true" tabindex="-1"></a>                 <span class="st">&quot;1&quot;</span> <span class="ot">=</span> <span class="st">&quot;m8.4 post: shade = 1&quot;</span>))</span>
<span id="cb706-26"><a href="conditional-manatees.html#cb706-26" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb706-27"><a href="conditional-manatees.html#cb706-27" aria-hidden="true" tabindex="-1"></a>labeli8<span class="fl">.5</span> <span class="ot">&lt;-</span> </span>
<span id="cb706-28"><a href="conditional-manatees.html#cb706-28" aria-hidden="true" tabindex="-1"></a>  <span class="fu">as_labeller</span>(<span class="fu">c</span>(<span class="st">&quot;-1&quot;</span> <span class="ot">=</span> <span class="st">&quot;m8.5 post: shade = -1&quot;</span>,</span>
<span id="cb706-29"><a href="conditional-manatees.html#cb706-29" aria-hidden="true" tabindex="-1"></a>                <span class="st">&quot;0&quot;</span> <span class="ot">=</span> <span class="st">&quot;m8.5 post: shade = 0&quot;</span>,</span>
<span id="cb706-30"><a href="conditional-manatees.html#cb706-30" aria-hidden="true" tabindex="-1"></a>                 <span class="st">&quot;1&quot;</span> <span class="ot">=</span> <span class="st">&quot;m8.5 post: shade = 1&quot;</span>))</span>
<span id="cb706-31"><a href="conditional-manatees.html#cb706-31" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb706-32"><a href="conditional-manatees.html#cb706-32" aria-hidden="true" tabindex="-1"></a><span class="do">## b8.4 </span></span>
<span id="cb706-33"><a href="conditional-manatees.html#cb706-33" aria-hidden="true" tabindex="-1"></a>p1 <span class="ot">&lt;-</span> </span>
<span id="cb706-34"><a href="conditional-manatees.html#cb706-34" aria-hidden="true" tabindex="-1"></a>  d3 <span class="sc">%&gt;%</span> </span>
<span id="cb706-35"><a href="conditional-manatees.html#cb706-35" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x=</span>W))<span class="sc">+</span></span>
<span id="cb706-36"><a href="conditional-manatees.html#cb706-36" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="fu">aes</span>(<span class="at">y=</span>B), <span class="at">color =</span> <span class="st">&quot;navy&quot;</span>, <span class="at">size=</span><span class="fl">2.5</span>)<span class="sc">+</span></span>
<span id="cb706-37"><a href="conditional-manatees.html#cb706-37" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="at">data =</span> fitted8<span class="fl">.4</span>, </span>
<span id="cb706-38"><a href="conditional-manatees.html#cb706-38" aria-hidden="true" tabindex="-1"></a>              <span class="fu">aes</span>(<span class="at">y =</span> value, <span class="at">group =</span> n),</span>
<span id="cb706-39"><a href="conditional-manatees.html#cb706-39" aria-hidden="true" tabindex="-1"></a>            <span class="at">alpha =</span> <span class="dv">1</span><span class="sc">/</span><span class="dv">2</span>)<span class="sc">+</span></span>
<span id="cb706-40"><a href="conditional-manatees.html#cb706-40" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x=</span><span class="st">&quot;water (centered)&quot;</span>, <span class="at">y =</span> <span class="st">&quot;blooms (std)&quot;</span>)<span class="sc">+</span></span>
<span id="cb706-41"><a href="conditional-manatees.html#cb706-41" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">aspect.ratio=</span><span class="dv">1</span>,</span>
<span id="cb706-42"><a href="conditional-manatees.html#cb706-42" aria-hidden="true" tabindex="-1"></a>        <span class="at">strip.background =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb706-43"><a href="conditional-manatees.html#cb706-43" aria-hidden="true" tabindex="-1"></a>        <span class="at">strip.text =</span> <span class="fu">element_text</span>(<span class="at">size=</span><span class="dv">10</span>))<span class="sc">+</span></span>
<span id="cb706-44"><a href="conditional-manatees.html#cb706-44" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_continuous</span>(<span class="at">breaks =</span> <span class="fu">c</span>(<span class="sc">-</span><span class="dv">1</span>,<span class="dv">0</span>,<span class="dv">1</span>))<span class="sc">+</span></span>
<span id="cb706-45"><a href="conditional-manatees.html#cb706-45" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span>S, <span class="at">labeller =</span> labeli8<span class="fl">.4</span>)</span>
<span id="cb706-46"><a href="conditional-manatees.html#cb706-46" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb706-47"><a href="conditional-manatees.html#cb706-47" aria-hidden="true" tabindex="-1"></a><span class="do">## b8.5</span></span>
<span id="cb706-48"><a href="conditional-manatees.html#cb706-48" aria-hidden="true" tabindex="-1"></a>p2 <span class="ot">&lt;-</span> </span>
<span id="cb706-49"><a href="conditional-manatees.html#cb706-49" aria-hidden="true" tabindex="-1"></a>  d3 <span class="sc">%&gt;%</span> </span>
<span id="cb706-50"><a href="conditional-manatees.html#cb706-50" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x=</span>W))<span class="sc">+</span></span>
<span id="cb706-51"><a href="conditional-manatees.html#cb706-51" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="fu">aes</span>(<span class="at">y=</span>B), <span class="at">color =</span> <span class="st">&quot;navy&quot;</span>, <span class="at">size=</span><span class="fl">2.5</span>)<span class="sc">+</span></span>
<span id="cb706-52"><a href="conditional-manatees.html#cb706-52" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="at">data =</span> fitted8<span class="fl">.5</span>, </span>
<span id="cb706-53"><a href="conditional-manatees.html#cb706-53" aria-hidden="true" tabindex="-1"></a>              <span class="fu">aes</span>(<span class="at">y =</span> value, <span class="at">group =</span> n),</span>
<span id="cb706-54"><a href="conditional-manatees.html#cb706-54" aria-hidden="true" tabindex="-1"></a>            <span class="at">alpha =</span> <span class="dv">1</span><span class="sc">/</span><span class="dv">2</span>)<span class="sc">+</span></span>
<span id="cb706-55"><a href="conditional-manatees.html#cb706-55" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x=</span><span class="st">&quot;water (centered)&quot;</span>, <span class="at">y =</span> <span class="st">&quot;blooms (std)&quot;</span>)<span class="sc">+</span></span>
<span id="cb706-56"><a href="conditional-manatees.html#cb706-56" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">aspect.ratio=</span><span class="dv">1</span>,</span>
<span id="cb706-57"><a href="conditional-manatees.html#cb706-57" aria-hidden="true" tabindex="-1"></a>        <span class="at">strip.background =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb706-58"><a href="conditional-manatees.html#cb706-58" aria-hidden="true" tabindex="-1"></a>        <span class="at">strip.text =</span> <span class="fu">element_text</span>(<span class="at">size=</span><span class="dv">10</span>))<span class="sc">+</span></span>
<span id="cb706-59"><a href="conditional-manatees.html#cb706-59" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_continuous</span>(<span class="at">breaks =</span> <span class="fu">c</span>(<span class="sc">-</span><span class="dv">1</span>,<span class="dv">0</span>,<span class="dv">1</span>))<span class="sc">+</span></span>
<span id="cb706-60"><a href="conditional-manatees.html#cb706-60" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span>S, <span class="at">labeller =</span> labeli8<span class="fl">.5</span>)</span>
<span id="cb706-61"><a href="conditional-manatees.html#cb706-61" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb706-62"><a href="conditional-manatees.html#cb706-62" aria-hidden="true" tabindex="-1"></a>(p1)<span class="sc">/</span>(p2)</span></code></pre></div>
<p><img src="Rethinking_Bookdown_files/figure-html/unnamed-chunk-330-1.png" width="672" style="display: block; margin: auto;" />
<br /></p>
</div>
<div id="plotting-prior-predictions" class="section level3 hasAnchor" number="8.3.4">
<h3><span class="header-section-number">8.3.4</span> Plotting prior predictions<a href="conditional-manatees.html#plotting-prior-predictions" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>続いて、事前分布も確認する。</p>
<div class="sourceCode" id="cb707"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb707-1"><a href="conditional-manatees.html#cb707-1" aria-hidden="true" tabindex="-1"></a>b8<span class="fl">.4</span>p <span class="ot">&lt;-</span></span>
<span id="cb707-2"><a href="conditional-manatees.html#cb707-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">update</span>(b8<span class="fl">.4</span>,</span>
<span id="cb707-3"><a href="conditional-manatees.html#cb707-3" aria-hidden="true" tabindex="-1"></a>         <span class="at">sample_prior =</span> <span class="st">&quot;only&quot;</span>,</span>
<span id="cb707-4"><a href="conditional-manatees.html#cb707-4" aria-hidden="true" tabindex="-1"></a>         <span class="at">iter =</span> <span class="dv">2000</span>, <span class="at">warmup =</span> <span class="dv">1000</span>, <span class="at">chains =</span> <span class="dv">4</span>, <span class="at">cores =</span> <span class="dv">4</span>,</span>
<span id="cb707-5"><a href="conditional-manatees.html#cb707-5" aria-hidden="true" tabindex="-1"></a>         <span class="at">seed =</span> <span class="dv">8</span>,</span>
<span id="cb707-6"><a href="conditional-manatees.html#cb707-6" aria-hidden="true" tabindex="-1"></a>         <span class="at">file =</span> <span class="st">&quot;output/Chapter8/b8.4p&quot;</span>)</span>
<span id="cb707-7"><a href="conditional-manatees.html#cb707-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb707-8"><a href="conditional-manatees.html#cb707-8" aria-hidden="true" tabindex="-1"></a>b8<span class="fl">.5</span>p <span class="ot">&lt;-</span></span>
<span id="cb707-9"><a href="conditional-manatees.html#cb707-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">update</span>(b8<span class="fl">.5</span>,</span>
<span id="cb707-10"><a href="conditional-manatees.html#cb707-10" aria-hidden="true" tabindex="-1"></a>         <span class="at">sample_prior =</span> <span class="st">&quot;only&quot;</span>,</span>
<span id="cb707-11"><a href="conditional-manatees.html#cb707-11" aria-hidden="true" tabindex="-1"></a>         <span class="at">iter =</span> <span class="dv">2000</span>, <span class="at">warmup =</span> <span class="dv">1000</span>, <span class="at">chains =</span> <span class="dv">4</span>, <span class="at">cores =</span> <span class="dv">4</span>,</span>
<span id="cb707-12"><a href="conditional-manatees.html#cb707-12" aria-hidden="true" tabindex="-1"></a>         <span class="at">seed =</span> <span class="dv">8</span>,</span>
<span id="cb707-13"><a href="conditional-manatees.html#cb707-13" aria-hidden="true" tabindex="-1"></a>         <span class="at">file =</span> <span class="st">&quot;output/Chapter8/b8.5p&quot;</span>)</span></code></pre></div>
<p>事前分布はかなりばらついており、ほとんど情報を持っていないことが分かる。</p>
<div class="sourceCode" id="cb708"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb708-1"><a href="conditional-manatees.html#cb708-1" aria-hidden="true" tabindex="-1"></a>prior8<span class="fl">.4</span> <span class="ot">&lt;-</span> </span>
<span id="cb708-2"><a href="conditional-manatees.html#cb708-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">fitted</span>(b8<span class="fl">.4</span>p, <span class="at">newdata =</span> seq,</span>
<span id="cb708-3"><a href="conditional-manatees.html#cb708-3" aria-hidden="true" tabindex="-1"></a>                   <span class="at">summary=</span>F,<span class="at">nsamples=</span><span class="dv">20</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb708-4"><a href="conditional-manatees.html#cb708-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">data.frame</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb708-5"><a href="conditional-manatees.html#cb708-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_longer</span>(<span class="fu">everything</span>()) <span class="sc">%&gt;%</span> </span>
<span id="cb708-6"><a href="conditional-manatees.html#cb708-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">bind_cols</span>(tidyr<span class="sc">::</span><span class="fu">expand</span>(seq, <span class="at">n =</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">20</span>,</span>
<span id="cb708-7"><a href="conditional-manatees.html#cb708-7" aria-hidden="true" tabindex="-1"></a>                   <span class="fu">nesting</span>(W,S))) <span class="sc">%&gt;%</span> </span>
<span id="cb708-8"><a href="conditional-manatees.html#cb708-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">model =</span> <span class="st">&quot;b8.4&quot;</span>)</span>
<span id="cb708-9"><a href="conditional-manatees.html#cb708-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb708-10"><a href="conditional-manatees.html#cb708-10" aria-hidden="true" tabindex="-1"></a>prior8<span class="fl">.5</span> <span class="ot">&lt;-</span> </span>
<span id="cb708-11"><a href="conditional-manatees.html#cb708-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">fitted</span>(b8<span class="fl">.5</span>p, <span class="at">newdata =</span> seq,</span>
<span id="cb708-12"><a href="conditional-manatees.html#cb708-12" aria-hidden="true" tabindex="-1"></a>                   <span class="at">summary=</span>F,<span class="at">nsamples=</span><span class="dv">20</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb708-13"><a href="conditional-manatees.html#cb708-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">data.frame</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb708-14"><a href="conditional-manatees.html#cb708-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_longer</span>(<span class="fu">everything</span>()) <span class="sc">%&gt;%</span> </span>
<span id="cb708-15"><a href="conditional-manatees.html#cb708-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">bind_cols</span>(tidyr<span class="sc">::</span><span class="fu">expand</span>(seq, <span class="at">n =</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">20</span>,</span>
<span id="cb708-16"><a href="conditional-manatees.html#cb708-16" aria-hidden="true" tabindex="-1"></a>                   <span class="fu">nesting</span>(W,S))) <span class="sc">%&gt;%</span> </span>
<span id="cb708-17"><a href="conditional-manatees.html#cb708-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">model =</span> <span class="st">&quot;b8.5&quot;</span>)</span>
<span id="cb708-18"><a href="conditional-manatees.html#cb708-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb708-19"><a href="conditional-manatees.html#cb708-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb708-20"><a href="conditional-manatees.html#cb708-20" aria-hidden="true" tabindex="-1"></a>labeli8<span class="fl">.4</span>p <span class="ot">&lt;-</span> </span>
<span id="cb708-21"><a href="conditional-manatees.html#cb708-21" aria-hidden="true" tabindex="-1"></a>  <span class="fu">as_labeller</span>(<span class="fu">c</span>(<span class="st">&quot;-1&quot;</span> <span class="ot">=</span> <span class="st">&quot;m8.4 prior: shade = -1&quot;</span>,</span>
<span id="cb708-22"><a href="conditional-manatees.html#cb708-22" aria-hidden="true" tabindex="-1"></a>                <span class="st">&quot;0&quot;</span> <span class="ot">=</span> <span class="st">&quot;m8.4 prior: shade = 0&quot;</span>,</span>
<span id="cb708-23"><a href="conditional-manatees.html#cb708-23" aria-hidden="true" tabindex="-1"></a>                 <span class="st">&quot;1&quot;</span> <span class="ot">=</span> <span class="st">&quot;m8.4 prior: shade = 1&quot;</span>))</span>
<span id="cb708-24"><a href="conditional-manatees.html#cb708-24" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb708-25"><a href="conditional-manatees.html#cb708-25" aria-hidden="true" tabindex="-1"></a>labeli8<span class="fl">.5</span>p <span class="ot">&lt;-</span> </span>
<span id="cb708-26"><a href="conditional-manatees.html#cb708-26" aria-hidden="true" tabindex="-1"></a>  <span class="fu">as_labeller</span>(<span class="fu">c</span>(<span class="st">&quot;-1&quot;</span> <span class="ot">=</span> <span class="st">&quot;m8.5 prior: shade = -1&quot;</span>,</span>
<span id="cb708-27"><a href="conditional-manatees.html#cb708-27" aria-hidden="true" tabindex="-1"></a>                <span class="st">&quot;0&quot;</span> <span class="ot">=</span> <span class="st">&quot;m8.5 prior: shade = 0&quot;</span>,</span>
<span id="cb708-28"><a href="conditional-manatees.html#cb708-28" aria-hidden="true" tabindex="-1"></a>                 <span class="st">&quot;1&quot;</span> <span class="ot">=</span> <span class="st">&quot;m8.5 prior: shade = 1&quot;</span>))</span>
<span id="cb708-29"><a href="conditional-manatees.html#cb708-29" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb708-30"><a href="conditional-manatees.html#cb708-30" aria-hidden="true" tabindex="-1"></a><span class="do">## b8.4</span></span>
<span id="cb708-31"><a href="conditional-manatees.html#cb708-31" aria-hidden="true" tabindex="-1"></a>p3 <span class="ot">&lt;-</span> </span>
<span id="cb708-32"><a href="conditional-manatees.html#cb708-32" aria-hidden="true" tabindex="-1"></a>  d3 <span class="sc">%&gt;%</span> </span>
<span id="cb708-33"><a href="conditional-manatees.html#cb708-33" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x=</span>W, <span class="at">y =</span> B))<span class="sc">+</span></span>
<span id="cb708-34"><a href="conditional-manatees.html#cb708-34" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="at">data =</span> prior8<span class="fl">.4</span>, </span>
<span id="cb708-35"><a href="conditional-manatees.html#cb708-35" aria-hidden="true" tabindex="-1"></a>              <span class="fu">aes</span>(<span class="at">y =</span> value, <span class="at">group =</span> n),</span>
<span id="cb708-36"><a href="conditional-manatees.html#cb708-36" aria-hidden="true" tabindex="-1"></a>            <span class="at">alpha =</span> <span class="dv">1</span><span class="sc">/</span><span class="dv">2</span>)<span class="sc">+</span></span>
<span id="cb708-37"><a href="conditional-manatees.html#cb708-37" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x=</span><span class="st">&quot;water (centered)&quot;</span>, <span class="at">y =</span> <span class="st">&quot;blooms (std)&quot;</span>)<span class="sc">+</span></span>
<span id="cb708-38"><a href="conditional-manatees.html#cb708-38" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">aspect.ratio=</span><span class="dv">1</span>,</span>
<span id="cb708-39"><a href="conditional-manatees.html#cb708-39" aria-hidden="true" tabindex="-1"></a>        <span class="at">strip.background =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb708-40"><a href="conditional-manatees.html#cb708-40" aria-hidden="true" tabindex="-1"></a>        <span class="at">strip.text =</span> <span class="fu">element_text</span>(<span class="at">size=</span><span class="dv">10</span>))<span class="sc">+</span></span>
<span id="cb708-41"><a href="conditional-manatees.html#cb708-41" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_continuous</span>(<span class="at">breaks =</span> <span class="fu">c</span>(<span class="sc">-</span><span class="dv">1</span>,<span class="dv">0</span>,<span class="dv">1</span>))<span class="sc">+</span></span>
<span id="cb708-42"><a href="conditional-manatees.html#cb708-42" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_hline</span>(<span class="at">yintercept =</span> <span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">1</span>), <span class="at">linetype=</span><span class="dv">2</span>)<span class="sc">+</span></span>
<span id="cb708-43"><a href="conditional-manatees.html#cb708-43" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span>S, <span class="at">labeller =</span> labeli8<span class="fl">.4</span>p)</span>
<span id="cb708-44"><a href="conditional-manatees.html#cb708-44" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb708-45"><a href="conditional-manatees.html#cb708-45" aria-hidden="true" tabindex="-1"></a><span class="do">## b8.5</span></span>
<span id="cb708-46"><a href="conditional-manatees.html#cb708-46" aria-hidden="true" tabindex="-1"></a>p4 <span class="ot">&lt;-</span> </span>
<span id="cb708-47"><a href="conditional-manatees.html#cb708-47" aria-hidden="true" tabindex="-1"></a>  d3 <span class="sc">%&gt;%</span> </span>
<span id="cb708-48"><a href="conditional-manatees.html#cb708-48" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x=</span>W, <span class="at">y =</span> B))<span class="sc">+</span></span>
<span id="cb708-49"><a href="conditional-manatees.html#cb708-49" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="at">data =</span> prior8<span class="fl">.5</span>, </span>
<span id="cb708-50"><a href="conditional-manatees.html#cb708-50" aria-hidden="true" tabindex="-1"></a>              <span class="fu">aes</span>(<span class="at">y =</span> value, <span class="at">group =</span> n),</span>
<span id="cb708-51"><a href="conditional-manatees.html#cb708-51" aria-hidden="true" tabindex="-1"></a>            <span class="at">alpha =</span> <span class="dv">1</span><span class="sc">/</span><span class="dv">2</span>)<span class="sc">+</span></span>
<span id="cb708-52"><a href="conditional-manatees.html#cb708-52" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x=</span><span class="st">&quot;water (centered)&quot;</span>, <span class="at">y =</span> <span class="st">&quot;blooms (std)&quot;</span>)<span class="sc">+</span></span>
<span id="cb708-53"><a href="conditional-manatees.html#cb708-53" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">aspect.ratio=</span><span class="dv">1</span>,</span>
<span id="cb708-54"><a href="conditional-manatees.html#cb708-54" aria-hidden="true" tabindex="-1"></a>        <span class="at">strip.background =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb708-55"><a href="conditional-manatees.html#cb708-55" aria-hidden="true" tabindex="-1"></a>        <span class="at">strip.text =</span> <span class="fu">element_text</span>(<span class="at">size=</span><span class="dv">10</span>))<span class="sc">+</span></span>
<span id="cb708-56"><a href="conditional-manatees.html#cb708-56" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_continuous</span>(<span class="at">breaks =</span> <span class="fu">c</span>(<span class="sc">-</span><span class="dv">1</span>,<span class="dv">0</span>,<span class="dv">1</span>))<span class="sc">+</span></span>
<span id="cb708-57"><a href="conditional-manatees.html#cb708-57" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_hline</span>(<span class="at">yintercept =</span> <span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">1</span>), <span class="at">linetype=</span><span class="dv">2</span>)<span class="sc">+</span></span>
<span id="cb708-58"><a href="conditional-manatees.html#cb708-58" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span>S, <span class="at">labeller =</span> labeli8<span class="fl">.4</span>p)</span>
<span id="cb708-59"><a href="conditional-manatees.html#cb708-59" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb708-60"><a href="conditional-manatees.html#cb708-60" aria-hidden="true" tabindex="-1"></a>p3<span class="sc">/</span>p4</span></code></pre></div>
<p><img src="Rethinking_Bookdown_files/figure-html/unnamed-chunk-332-1.png" width="672" style="display: block; margin: auto;" />
<br /></p>
</div>
</div>
<div id="practice-6" class="section level2 hasAnchor" number="8.4">
<h2><span class="header-section-number">8.4</span> Practice<a href="conditional-manatees.html#practice-6" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<div id="m4-5" class="section level3 hasAnchor" number="8.4.1">
<h3><span class="header-section-number">8.4.1</span> 8M4<a href="conditional-manatees.html#m4-5" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<blockquote>
<p>Repeat the tulips analysis, but this time use priors that constrain the effect of water to be positive and the effect of shade to be negative. Use prior predictive simulation. What do these prior asumptions mean for the interaction prior, if anything?</p>
</blockquote>
<p>かなり傾きが制限されていることが分かる。</p>
<div class="sourceCode" id="cb709"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb709-1"><a href="conditional-manatees.html#cb709-1" aria-hidden="true" tabindex="-1"></a>b8<span class="fl">.5</span>_2 <span class="ot">&lt;-</span> <span class="fu">brm</span>(</span>
<span id="cb709-2"><a href="conditional-manatees.html#cb709-2" aria-hidden="true" tabindex="-1"></a>  <span class="at">data =</span> d3,</span>
<span id="cb709-3"><a href="conditional-manatees.html#cb709-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">family =</span> gaussian,</span>
<span id="cb709-4"><a href="conditional-manatees.html#cb709-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">formula =</span> B <span class="sc">~</span> <span class="dv">1</span> <span class="sc">+</span> W<span class="sc">+</span>S<span class="sc">+</span>W<span class="sc">:</span>S,</span>
<span id="cb709-5"><a href="conditional-manatees.html#cb709-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">prior =</span> <span class="fu">c</span>(<span class="fu">prior</span>(<span class="fu">normal</span>(<span class="fl">0.5</span>, <span class="fl">0.25</span>), <span class="at">class =</span> Intercept),</span>
<span id="cb709-6"><a href="conditional-manatees.html#cb709-6" aria-hidden="true" tabindex="-1"></a>            <span class="fu">prior</span>(<span class="fu">normal</span>(<span class="fl">0.25</span>, <span class="fl">0.125</span>), <span class="at">class =</span> b,<span class="at">coef =</span> W),</span>
<span id="cb709-7"><a href="conditional-manatees.html#cb709-7" aria-hidden="true" tabindex="-1"></a>            <span class="fu">prior</span>(<span class="fu">normal</span>(<span class="sc">-</span><span class="fl">0.25</span>, <span class="fl">0.125</span>), <span class="at">class =</span> b,<span class="at">coef =</span> S),</span>
<span id="cb709-8"><a href="conditional-manatees.html#cb709-8" aria-hidden="true" tabindex="-1"></a>            <span class="fu">prior</span>(<span class="fu">normal</span>(<span class="sc">-</span><span class="fl">0.25</span>, <span class="fl">0.125</span>), <span class="at">class =</span> b,<span class="at">coef =</span> W<span class="sc">:</span>S),</span>
<span id="cb709-9"><a href="conditional-manatees.html#cb709-9" aria-hidden="true" tabindex="-1"></a>            <span class="fu">prior</span>(<span class="fu">exponential</span>(<span class="dv">1</span>), <span class="at">class =</span> sigma)),</span>
<span id="cb709-10"><a href="conditional-manatees.html#cb709-10" aria-hidden="true" tabindex="-1"></a>  <span class="at">seed=</span><span class="dv">8</span>, <span class="at">sample_prior=</span><span class="st">&quot;only&quot;</span>,</span>
<span id="cb709-11"><a href="conditional-manatees.html#cb709-11" aria-hidden="true" tabindex="-1"></a>  <span class="at">backend =</span> <span class="st">&quot;cmdstanr&quot;</span>,</span>
<span id="cb709-12"><a href="conditional-manatees.html#cb709-12" aria-hidden="true" tabindex="-1"></a>  <span class="at">file =</span> <span class="st">&quot;output/Chapter8/b8.5_2&quot;</span></span>
<span id="cb709-13"><a href="conditional-manatees.html#cb709-13" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb709-14"><a href="conditional-manatees.html#cb709-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb709-15"><a href="conditional-manatees.html#cb709-15" aria-hidden="true" tabindex="-1"></a>prior8<span class="fl">.5</span>_2 <span class="ot">&lt;-</span> </span>
<span id="cb709-16"><a href="conditional-manatees.html#cb709-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">fitted</span>(b8<span class="fl">.5</span>_2, <span class="at">newdata =</span> seq,</span>
<span id="cb709-17"><a href="conditional-manatees.html#cb709-17" aria-hidden="true" tabindex="-1"></a>                   <span class="at">summary=</span>F,<span class="at">nsamples=</span><span class="dv">20</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb709-18"><a href="conditional-manatees.html#cb709-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">data.frame</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb709-19"><a href="conditional-manatees.html#cb709-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_longer</span>(<span class="fu">everything</span>()) <span class="sc">%&gt;%</span> </span>
<span id="cb709-20"><a href="conditional-manatees.html#cb709-20" aria-hidden="true" tabindex="-1"></a>  <span class="fu">bind_cols</span>(tidyr<span class="sc">::</span><span class="fu">expand</span>(seq, <span class="at">n =</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">20</span>,</span>
<span id="cb709-21"><a href="conditional-manatees.html#cb709-21" aria-hidden="true" tabindex="-1"></a>                   <span class="fu">nesting</span>(W,S))) </span>
<span id="cb709-22"><a href="conditional-manatees.html#cb709-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb709-23"><a href="conditional-manatees.html#cb709-23" aria-hidden="true" tabindex="-1"></a>d3 <span class="sc">%&gt;%</span> </span>
<span id="cb709-24"><a href="conditional-manatees.html#cb709-24" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x=</span>W, <span class="at">y =</span> B))<span class="sc">+</span></span>
<span id="cb709-25"><a href="conditional-manatees.html#cb709-25" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="at">data =</span> prior8<span class="fl">.5</span>_2, </span>
<span id="cb709-26"><a href="conditional-manatees.html#cb709-26" aria-hidden="true" tabindex="-1"></a>              <span class="fu">aes</span>(<span class="at">y =</span> value, <span class="at">group =</span> n),</span>
<span id="cb709-27"><a href="conditional-manatees.html#cb709-27" aria-hidden="true" tabindex="-1"></a>            <span class="at">alpha =</span> <span class="dv">1</span><span class="sc">/</span><span class="dv">2</span>)<span class="sc">+</span></span>
<span id="cb709-28"><a href="conditional-manatees.html#cb709-28" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x=</span><span class="st">&quot;water (centered)&quot;</span>, <span class="at">y =</span> <span class="st">&quot;blooms (std)&quot;</span>)<span class="sc">+</span></span>
<span id="cb709-29"><a href="conditional-manatees.html#cb709-29" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">aspect.ratio=</span><span class="dv">1</span>,</span>
<span id="cb709-30"><a href="conditional-manatees.html#cb709-30" aria-hidden="true" tabindex="-1"></a>        <span class="at">strip.background =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb709-31"><a href="conditional-manatees.html#cb709-31" aria-hidden="true" tabindex="-1"></a>        <span class="at">strip.text =</span> <span class="fu">element_text</span>(<span class="at">size=</span><span class="dv">10</span>))<span class="sc">+</span></span>
<span id="cb709-32"><a href="conditional-manatees.html#cb709-32" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_continuous</span>(<span class="at">breaks =</span> <span class="fu">c</span>(<span class="sc">-</span><span class="dv">1</span>,<span class="dv">0</span>,<span class="dv">1</span>))<span class="sc">+</span></span>
<span id="cb709-33"><a href="conditional-manatees.html#cb709-33" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_hline</span>(<span class="at">yintercept =</span> <span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">1</span>), <span class="at">linetype=</span><span class="dv">2</span>)<span class="sc">+</span></span>
<span id="cb709-34"><a href="conditional-manatees.html#cb709-34" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span>S, <span class="at">labeller =</span> labeli8<span class="fl">.4</span>p)</span></code></pre></div>
<p><img src="Rethinking_Bookdown_files/figure-html/unnamed-chunk-333-1.png" width="672" style="display: block; margin: auto;" />
<br /></p>
<p>結果も傾きが強くなるように少し変化。</p>
<div class="sourceCode" id="cb710"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb710-1"><a href="conditional-manatees.html#cb710-1" aria-hidden="true" tabindex="-1"></a>b8<span class="fl">.5</span>_3 <span class="ot">&lt;-</span></span>
<span id="cb710-2"><a href="conditional-manatees.html#cb710-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">update</span>(b8<span class="fl">.5</span>_2,</span>
<span id="cb710-3"><a href="conditional-manatees.html#cb710-3" aria-hidden="true" tabindex="-1"></a>         <span class="at">sample_prior =</span> <span class="st">&quot;yes&quot;</span>,</span>
<span id="cb710-4"><a href="conditional-manatees.html#cb710-4" aria-hidden="true" tabindex="-1"></a>         <span class="at">iter =</span> <span class="dv">2000</span>, <span class="at">warmup =</span> <span class="dv">1000</span>, <span class="at">chains =</span> <span class="dv">4</span>, <span class="at">cores =</span> <span class="dv">4</span>,</span>
<span id="cb710-5"><a href="conditional-manatees.html#cb710-5" aria-hidden="true" tabindex="-1"></a>         <span class="at">seed =</span> <span class="dv">8</span>,</span>
<span id="cb710-6"><a href="conditional-manatees.html#cb710-6" aria-hidden="true" tabindex="-1"></a>         <span class="at">file =</span> <span class="st">&quot;output/Chapter8/b8.5_3&quot;</span>)</span>
<span id="cb710-7"><a href="conditional-manatees.html#cb710-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb710-8"><a href="conditional-manatees.html#cb710-8" aria-hidden="true" tabindex="-1"></a><span class="fu">posterior_summary</span>(b8<span class="fl">.5</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb710-9"><a href="conditional-manatees.html#cb710-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">data.frame</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb710-10"><a href="conditional-manatees.html#cb710-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">slice</span>(<span class="at">n=</span><span class="dv">1</span><span class="sc">:</span><span class="dv">5</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb710-11"><a href="conditional-manatees.html#cb710-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">gt</span>()</span></code></pre></div>
<div id="xajbkdcqgu" style="padding-left:0px;padding-right:0px;padding-top:10px;padding-bottom:10px;overflow-x:auto;overflow-y:auto;width:auto;height:auto;">
<style>html {
  font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, Cantarell, 'Helvetica Neue', 'Fira Sans', 'Droid Sans', Arial, sans-serif;
}

#xajbkdcqgu .gt_table {
  display: table;
  border-collapse: collapse;
  margin-left: auto;
  margin-right: auto;
  color: #333333;
  font-size: 16px;
  font-weight: normal;
  font-style: normal;
  background-color: #FFFFFF;
  width: auto;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #A8A8A8;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #A8A8A8;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
}

#xajbkdcqgu .gt_heading {
  background-color: #FFFFFF;
  text-align: center;
  border-bottom-color: #FFFFFF;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#xajbkdcqgu .gt_caption {
  padding-top: 4px;
  padding-bottom: 4px;
}

#xajbkdcqgu .gt_title {
  color: #333333;
  font-size: 125%;
  font-weight: initial;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-color: #FFFFFF;
  border-bottom-width: 0;
}

#xajbkdcqgu .gt_subtitle {
  color: #333333;
  font-size: 85%;
  font-weight: initial;
  padding-top: 0;
  padding-bottom: 6px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-color: #FFFFFF;
  border-top-width: 0;
}

#xajbkdcqgu .gt_bottom_border {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#xajbkdcqgu .gt_col_headings {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#xajbkdcqgu .gt_col_heading {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 6px;
  padding-left: 5px;
  padding-right: 5px;
  overflow-x: hidden;
}

#xajbkdcqgu .gt_column_spanner_outer {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  padding-top: 0;
  padding-bottom: 0;
  padding-left: 4px;
  padding-right: 4px;
}

#xajbkdcqgu .gt_column_spanner_outer:first-child {
  padding-left: 0;
}

#xajbkdcqgu .gt_column_spanner_outer:last-child {
  padding-right: 0;
}

#xajbkdcqgu .gt_column_spanner {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 5px;
  overflow-x: hidden;
  display: inline-block;
  width: 100%;
}

#xajbkdcqgu .gt_group_heading {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  text-align: left;
}

#xajbkdcqgu .gt_empty_group_heading {
  padding: 0.5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: middle;
}

#xajbkdcqgu .gt_from_md > :first-child {
  margin-top: 0;
}

#xajbkdcqgu .gt_from_md > :last-child {
  margin-bottom: 0;
}

#xajbkdcqgu .gt_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  margin: 10px;
  border-top-style: solid;
  border-top-width: 1px;
  border-top-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  overflow-x: hidden;
}

#xajbkdcqgu .gt_stub {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
}

#xajbkdcqgu .gt_stub_row_group {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
  vertical-align: top;
}

#xajbkdcqgu .gt_row_group_first td {
  border-top-width: 2px;
}

#xajbkdcqgu .gt_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#xajbkdcqgu .gt_first_summary_row {
  border-top-style: solid;
  border-top-color: #D3D3D3;
}

#xajbkdcqgu .gt_first_summary_row.thick {
  border-top-width: 2px;
}

#xajbkdcqgu .gt_last_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#xajbkdcqgu .gt_grand_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#xajbkdcqgu .gt_first_grand_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-style: double;
  border-top-width: 6px;
  border-top-color: #D3D3D3;
}

#xajbkdcqgu .gt_striped {
  background-color: rgba(128, 128, 128, 0.05);
}

#xajbkdcqgu .gt_table_body {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#xajbkdcqgu .gt_footnotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#xajbkdcqgu .gt_footnote {
  margin: 0px;
  font-size: 90%;
  padding-left: 4px;
  padding-right: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#xajbkdcqgu .gt_sourcenotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#xajbkdcqgu .gt_sourcenote {
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#xajbkdcqgu .gt_left {
  text-align: left;
}

#xajbkdcqgu .gt_center {
  text-align: center;
}

#xajbkdcqgu .gt_right {
  text-align: right;
  font-variant-numeric: tabular-nums;
}

#xajbkdcqgu .gt_font_normal {
  font-weight: normal;
}

#xajbkdcqgu .gt_font_bold {
  font-weight: bold;
}

#xajbkdcqgu .gt_font_italic {
  font-style: italic;
}

#xajbkdcqgu .gt_super {
  font-size: 65%;
}

#xajbkdcqgu .gt_footnote_marks {
  font-style: italic;
  font-weight: normal;
  font-size: 75%;
  vertical-align: 0.4em;
}

#xajbkdcqgu .gt_asterisk {
  font-size: 100%;
  vertical-align: 0;
}

#xajbkdcqgu .gt_indent_1 {
  text-indent: 5px;
}

#xajbkdcqgu .gt_indent_2 {
  text-indent: 10px;
}

#xajbkdcqgu .gt_indent_3 {
  text-indent: 15px;
}

#xajbkdcqgu .gt_indent_4 {
  text-indent: 20px;
}

#xajbkdcqgu .gt_indent_5 {
  text-indent: 25px;
}
</style>
<table class="gt_table">
  
  <thead class="gt_col_headings">
    <tr>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1" scope="col" id="Estimate">Estimate</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1" scope="col" id="Est.Error">Est.Error</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1" scope="col" id="Q2.5">Q2.5</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1" scope="col" id="Q97.5">Q97.5</th>
    </tr>
  </thead>
  <tbody class="gt_table_body">
    <tr><td headers="Estimate" class="gt_row gt_right">0.3580160</td>
<td headers="Est.Error" class="gt_row gt_right">0.02742670</td>
<td headers="Q2.5" class="gt_row gt_right">0.3043584</td>
<td headers="Q97.5" class="gt_row gt_right">0.41166235</td></tr>
    <tr><td headers="Estimate" class="gt_row gt_right">0.2052897</td>
<td headers="Est.Error" class="gt_row gt_right">0.03436065</td>
<td headers="Q2.5" class="gt_row gt_right">0.1368625</td>
<td headers="Q97.5" class="gt_row gt_right">0.27334710</td></tr>
    <tr><td headers="Estimate" class="gt_row gt_right">-0.1138346</td>
<td headers="Est.Error" class="gt_row gt_right">0.03392792</td>
<td headers="Q2.5" class="gt_row gt_right">-0.1785913</td>
<td headers="Q97.5" class="gt_row gt_right">-0.04600386</td></tr>
    <tr><td headers="Estimate" class="gt_row gt_right">-0.1436845</td>
<td headers="Est.Error" class="gt_row gt_right">0.04113197</td>
<td headers="Q2.5" class="gt_row gt_right">-0.2230427</td>
<td headers="Q97.5" class="gt_row gt_right">-0.06313104</td></tr>
    <tr><td headers="Estimate" class="gt_row gt_right">0.1431426</td>
<td headers="Est.Error" class="gt_row gt_right">0.02297448</td>
<td headers="Q2.5" class="gt_row gt_right">0.1064527</td>
<td headers="Q97.5" class="gt_row gt_right">0.19516133</td></tr>
  </tbody>
  
  
</table>
</div>
<div class="sourceCode" id="cb711"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb711-1"><a href="conditional-manatees.html#cb711-1" aria-hidden="true" tabindex="-1"></a><span class="fu">posterior_summary</span>(b8<span class="fl">.5</span>_3) <span class="sc">%&gt;%</span> </span>
<span id="cb711-2"><a href="conditional-manatees.html#cb711-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">data.frame</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb711-3"><a href="conditional-manatees.html#cb711-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">slice</span>(<span class="at">n=</span><span class="dv">1</span><span class="sc">:</span><span class="dv">5</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb711-4"><a href="conditional-manatees.html#cb711-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">gt</span>()</span></code></pre></div>
<div id="jdglcaagto" style="padding-left:0px;padding-right:0px;padding-top:10px;padding-bottom:10px;overflow-x:auto;overflow-y:auto;width:auto;height:auto;">
<style>html {
  font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, Cantarell, 'Helvetica Neue', 'Fira Sans', 'Droid Sans', Arial, sans-serif;
}

#jdglcaagto .gt_table {
  display: table;
  border-collapse: collapse;
  margin-left: auto;
  margin-right: auto;
  color: #333333;
  font-size: 16px;
  font-weight: normal;
  font-style: normal;
  background-color: #FFFFFF;
  width: auto;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #A8A8A8;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #A8A8A8;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
}

#jdglcaagto .gt_heading {
  background-color: #FFFFFF;
  text-align: center;
  border-bottom-color: #FFFFFF;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#jdglcaagto .gt_caption {
  padding-top: 4px;
  padding-bottom: 4px;
}

#jdglcaagto .gt_title {
  color: #333333;
  font-size: 125%;
  font-weight: initial;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-color: #FFFFFF;
  border-bottom-width: 0;
}

#jdglcaagto .gt_subtitle {
  color: #333333;
  font-size: 85%;
  font-weight: initial;
  padding-top: 0;
  padding-bottom: 6px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-color: #FFFFFF;
  border-top-width: 0;
}

#jdglcaagto .gt_bottom_border {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#jdglcaagto .gt_col_headings {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#jdglcaagto .gt_col_heading {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 6px;
  padding-left: 5px;
  padding-right: 5px;
  overflow-x: hidden;
}

#jdglcaagto .gt_column_spanner_outer {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  padding-top: 0;
  padding-bottom: 0;
  padding-left: 4px;
  padding-right: 4px;
}

#jdglcaagto .gt_column_spanner_outer:first-child {
  padding-left: 0;
}

#jdglcaagto .gt_column_spanner_outer:last-child {
  padding-right: 0;
}

#jdglcaagto .gt_column_spanner {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 5px;
  overflow-x: hidden;
  display: inline-block;
  width: 100%;
}

#jdglcaagto .gt_group_heading {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  text-align: left;
}

#jdglcaagto .gt_empty_group_heading {
  padding: 0.5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: middle;
}

#jdglcaagto .gt_from_md > :first-child {
  margin-top: 0;
}

#jdglcaagto .gt_from_md > :last-child {
  margin-bottom: 0;
}

#jdglcaagto .gt_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  margin: 10px;
  border-top-style: solid;
  border-top-width: 1px;
  border-top-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  overflow-x: hidden;
}

#jdglcaagto .gt_stub {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
}

#jdglcaagto .gt_stub_row_group {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
  vertical-align: top;
}

#jdglcaagto .gt_row_group_first td {
  border-top-width: 2px;
}

#jdglcaagto .gt_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#jdglcaagto .gt_first_summary_row {
  border-top-style: solid;
  border-top-color: #D3D3D3;
}

#jdglcaagto .gt_first_summary_row.thick {
  border-top-width: 2px;
}

#jdglcaagto .gt_last_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#jdglcaagto .gt_grand_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#jdglcaagto .gt_first_grand_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-style: double;
  border-top-width: 6px;
  border-top-color: #D3D3D3;
}

#jdglcaagto .gt_striped {
  background-color: rgba(128, 128, 128, 0.05);
}

#jdglcaagto .gt_table_body {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#jdglcaagto .gt_footnotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#jdglcaagto .gt_footnote {
  margin: 0px;
  font-size: 90%;
  padding-left: 4px;
  padding-right: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#jdglcaagto .gt_sourcenotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#jdglcaagto .gt_sourcenote {
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#jdglcaagto .gt_left {
  text-align: left;
}

#jdglcaagto .gt_center {
  text-align: center;
}

#jdglcaagto .gt_right {
  text-align: right;
  font-variant-numeric: tabular-nums;
}

#jdglcaagto .gt_font_normal {
  font-weight: normal;
}

#jdglcaagto .gt_font_bold {
  font-weight: bold;
}

#jdglcaagto .gt_font_italic {
  font-style: italic;
}

#jdglcaagto .gt_super {
  font-size: 65%;
}

#jdglcaagto .gt_footnote_marks {
  font-style: italic;
  font-weight: normal;
  font-size: 75%;
  vertical-align: 0.4em;
}

#jdglcaagto .gt_asterisk {
  font-size: 100%;
  vertical-align: 0;
}

#jdglcaagto .gt_indent_1 {
  text-indent: 5px;
}

#jdglcaagto .gt_indent_2 {
  text-indent: 10px;
}

#jdglcaagto .gt_indent_3 {
  text-indent: 15px;
}

#jdglcaagto .gt_indent_4 {
  text-indent: 20px;
}

#jdglcaagto .gt_indent_5 {
  text-indent: 25px;
}
</style>
<table class="gt_table">
  
  <thead class="gt_col_headings">
    <tr>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1" scope="col" id="Estimate">Estimate</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1" scope="col" id="Est.Error">Est.Error</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1" scope="col" id="Q2.5">Q2.5</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1" scope="col" id="Q97.5">Q97.5</th>
    </tr>
  </thead>
  <tbody class="gt_table_body">
    <tr><td headers="Estimate" class="gt_row gt_right">0.3588534</td>
<td headers="Est.Error" class="gt_row gt_right">0.02685320</td>
<td headers="Q2.5" class="gt_row gt_right">0.3079950</td>
<td headers="Q97.5" class="gt_row gt_right">0.41378615</td></tr>
    <tr><td headers="Estimate" class="gt_row gt_right">0.2130110</td>
<td headers="Est.Error" class="gt_row gt_right">0.03302569</td>
<td headers="Q2.5" class="gt_row gt_right">0.1486325</td>
<td headers="Q97.5" class="gt_row gt_right">0.27752850</td></tr>
    <tr><td headers="Estimate" class="gt_row gt_right">-0.1233921</td>
<td headers="Est.Error" class="gt_row gt_right">0.03278545</td>
<td headers="Q2.5" class="gt_row gt_right">-0.1877740</td>
<td headers="Q97.5" class="gt_row gt_right">-0.05758068</td></tr>
    <tr><td headers="Estimate" class="gt_row gt_right">-0.1566358</td>
<td headers="Est.Error" class="gt_row gt_right">0.04003497</td>
<td headers="Q2.5" class="gt_row gt_right">-0.2367679</td>
<td headers="Q97.5" class="gt_row gt_right">-0.07847675</td></tr>
    <tr><td headers="Estimate" class="gt_row gt_right">0.1428600</td>
<td headers="Est.Error" class="gt_row gt_right">0.02232079</td>
<td headers="Q2.5" class="gt_row gt_right">0.1074478</td>
<td headers="Q97.5" class="gt_row gt_right">0.19472025</td></tr>
  </tbody>
  
  
</table>
</div>
<p><br /></p>
</div>
<div id="h1-6" class="section level3 hasAnchor" number="8.4.2">
<h3><span class="header-section-number">8.4.2</span> 8H1<a href="conditional-manatees.html#h1-6" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<blockquote>
<p>Return to the data(tulips) example in the chapter. Now include the bed variable as a predictor in the interaction model. Don’t interact bed with the other predictors; just include it as a main effect. Note that bed is categorical. So to use it properly, you will need to either construct dummy variables, or rather an index variable, as explained in Chapter 5.</p>
</blockquote>
<div class="sourceCode" id="cb712"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb712-1"><a href="conditional-manatees.html#cb712-1" aria-hidden="true" tabindex="-1"></a>d3 <span class="sc">%&gt;%</span> </span>
<span id="cb712-2"><a href="conditional-manatees.html#cb712-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">BD =</span> <span class="fu">ifelse</span>(bed<span class="sc">==</span><span class="st">&quot;a&quot;</span>,<span class="dv">1</span>,<span class="fu">ifelse</span>(bed<span class="sc">==</span><span class="st">&quot;b&quot;</span>,<span class="dv">2</span>,<span class="dv">3</span>))) <span class="sc">%&gt;%</span> </span>
<span id="cb712-3"><a href="conditional-manatees.html#cb712-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">BD =</span> <span class="fu">as.factor</span>(BD))<span class="ot">-&gt;</span> d4</span>
<span id="cb712-4"><a href="conditional-manatees.html#cb712-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb712-5"><a href="conditional-manatees.html#cb712-5" aria-hidden="true" tabindex="-1"></a>b8<span class="fl">.6</span> <span class="ot">&lt;-</span> <span class="fu">brm</span>(</span>
<span id="cb712-6"><a href="conditional-manatees.html#cb712-6" aria-hidden="true" tabindex="-1"></a>  <span class="at">data =</span> d4,</span>
<span id="cb712-7"><a href="conditional-manatees.html#cb712-7" aria-hidden="true" tabindex="-1"></a>  <span class="at">family =</span> gaussian,</span>
<span id="cb712-8"><a href="conditional-manatees.html#cb712-8" aria-hidden="true" tabindex="-1"></a>  <span class="at">formula =</span> B <span class="sc">~</span> <span class="dv">0</span> <span class="sc">+</span>BD <span class="sc">+</span> W <span class="sc">+</span> S <span class="sc">+</span> W<span class="sc">:</span>S,</span>
<span id="cb712-9"><a href="conditional-manatees.html#cb712-9" aria-hidden="true" tabindex="-1"></a>  <span class="at">prior =</span> <span class="fu">c</span>(<span class="fu">prior</span>(<span class="fu">normal</span>(<span class="fl">0.5</span>, <span class="fl">0.25</span>), <span class="at">class =</span> b, <span class="at">coef =</span> BD1),</span>
<span id="cb712-10"><a href="conditional-manatees.html#cb712-10" aria-hidden="true" tabindex="-1"></a>            <span class="fu">prior</span>(<span class="fu">normal</span>(<span class="fl">0.5</span>, <span class="fl">0.25</span>), <span class="at">class =</span> b, <span class="at">coef =</span> BD2),</span>
<span id="cb712-11"><a href="conditional-manatees.html#cb712-11" aria-hidden="true" tabindex="-1"></a>            <span class="fu">prior</span>(<span class="fu">normal</span>(<span class="fl">0.5</span>, <span class="fl">0.25</span>), <span class="at">class =</span> b, <span class="at">coef =</span> BD3),</span>
<span id="cb712-12"><a href="conditional-manatees.html#cb712-12" aria-hidden="true" tabindex="-1"></a>            <span class="fu">prior</span>(<span class="fu">normal</span>(<span class="dv">0</span>, <span class="fl">0.25</span>), <span class="at">class =</span> b, <span class="at">coef =</span>W),</span>
<span id="cb712-13"><a href="conditional-manatees.html#cb712-13" aria-hidden="true" tabindex="-1"></a>            <span class="fu">prior</span>(<span class="fu">normal</span>(<span class="dv">0</span>, <span class="fl">0.25</span>), <span class="at">class =</span> b, <span class="at">coef =</span>S),</span>
<span id="cb712-14"><a href="conditional-manatees.html#cb712-14" aria-hidden="true" tabindex="-1"></a>            <span class="fu">prior</span>(<span class="fu">normal</span>(<span class="dv">0</span>, <span class="fl">0.25</span>), <span class="at">class =</span> b, <span class="at">coef =</span>W<span class="sc">:</span>S),</span>
<span id="cb712-15"><a href="conditional-manatees.html#cb712-15" aria-hidden="true" tabindex="-1"></a>            <span class="fu">prior</span>(<span class="fu">exponential</span>(<span class="dv">1</span>), <span class="at">class =</span> sigma)),</span>
<span id="cb712-16"><a href="conditional-manatees.html#cb712-16" aria-hidden="true" tabindex="-1"></a>  <span class="at">seed=</span><span class="dv">8</span>, </span>
<span id="cb712-17"><a href="conditional-manatees.html#cb712-17" aria-hidden="true" tabindex="-1"></a>  <span class="at">backend =</span> <span class="st">&quot;cmdstanr&quot;</span>,</span>
<span id="cb712-18"><a href="conditional-manatees.html#cb712-18" aria-hidden="true" tabindex="-1"></a>  <span class="at">file =</span> <span class="st">&quot;output/Chapter8/b8.6&quot;</span></span>
<span id="cb712-19"><a href="conditional-manatees.html#cb712-19" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb712-20"><a href="conditional-manatees.html#cb712-20" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb712-21"><a href="conditional-manatees.html#cb712-21" aria-hidden="true" tabindex="-1"></a><span class="fu">posterior_summary</span>(b8<span class="fl">.6</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb712-22"><a href="conditional-manatees.html#cb712-22" aria-hidden="true" tabindex="-1"></a>  <span class="fu">data.frame</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb712-23"><a href="conditional-manatees.html#cb712-23" aria-hidden="true" tabindex="-1"></a>  <span class="fu">round</span>(<span class="dv">2</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb712-24"><a href="conditional-manatees.html#cb712-24" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rownames_to_column</span>(<span class="at">var =</span> <span class="st">&quot;parameters&quot;</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb712-25"><a href="conditional-manatees.html#cb712-25" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(parameters <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">&quot;sigma&quot;</span>)<span class="sc">|</span></span>
<span id="cb712-26"><a href="conditional-manatees.html#cb712-26" aria-hidden="true" tabindex="-1"></a>           <span class="fu">str_detect</span>(parameters,<span class="st">&quot;^b_&quot;</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb712-27"><a href="conditional-manatees.html#cb712-27" aria-hidden="true" tabindex="-1"></a>  <span class="fu">gt</span>()</span></code></pre></div>
<div id="pgtfccecvh" style="padding-left:0px;padding-right:0px;padding-top:10px;padding-bottom:10px;overflow-x:auto;overflow-y:auto;width:auto;height:auto;">
<style>html {
  font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, Cantarell, 'Helvetica Neue', 'Fira Sans', 'Droid Sans', Arial, sans-serif;
}

#pgtfccecvh .gt_table {
  display: table;
  border-collapse: collapse;
  margin-left: auto;
  margin-right: auto;
  color: #333333;
  font-size: 16px;
  font-weight: normal;
  font-style: normal;
  background-color: #FFFFFF;
  width: auto;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #A8A8A8;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #A8A8A8;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
}

#pgtfccecvh .gt_heading {
  background-color: #FFFFFF;
  text-align: center;
  border-bottom-color: #FFFFFF;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#pgtfccecvh .gt_caption {
  padding-top: 4px;
  padding-bottom: 4px;
}

#pgtfccecvh .gt_title {
  color: #333333;
  font-size: 125%;
  font-weight: initial;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-color: #FFFFFF;
  border-bottom-width: 0;
}

#pgtfccecvh .gt_subtitle {
  color: #333333;
  font-size: 85%;
  font-weight: initial;
  padding-top: 0;
  padding-bottom: 6px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-color: #FFFFFF;
  border-top-width: 0;
}

#pgtfccecvh .gt_bottom_border {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#pgtfccecvh .gt_col_headings {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#pgtfccecvh .gt_col_heading {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 6px;
  padding-left: 5px;
  padding-right: 5px;
  overflow-x: hidden;
}

#pgtfccecvh .gt_column_spanner_outer {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  padding-top: 0;
  padding-bottom: 0;
  padding-left: 4px;
  padding-right: 4px;
}

#pgtfccecvh .gt_column_spanner_outer:first-child {
  padding-left: 0;
}

#pgtfccecvh .gt_column_spanner_outer:last-child {
  padding-right: 0;
}

#pgtfccecvh .gt_column_spanner {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 5px;
  overflow-x: hidden;
  display: inline-block;
  width: 100%;
}

#pgtfccecvh .gt_group_heading {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  text-align: left;
}

#pgtfccecvh .gt_empty_group_heading {
  padding: 0.5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: middle;
}

#pgtfccecvh .gt_from_md > :first-child {
  margin-top: 0;
}

#pgtfccecvh .gt_from_md > :last-child {
  margin-bottom: 0;
}

#pgtfccecvh .gt_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  margin: 10px;
  border-top-style: solid;
  border-top-width: 1px;
  border-top-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  overflow-x: hidden;
}

#pgtfccecvh .gt_stub {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
}

#pgtfccecvh .gt_stub_row_group {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
  vertical-align: top;
}

#pgtfccecvh .gt_row_group_first td {
  border-top-width: 2px;
}

#pgtfccecvh .gt_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#pgtfccecvh .gt_first_summary_row {
  border-top-style: solid;
  border-top-color: #D3D3D3;
}

#pgtfccecvh .gt_first_summary_row.thick {
  border-top-width: 2px;
}

#pgtfccecvh .gt_last_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#pgtfccecvh .gt_grand_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#pgtfccecvh .gt_first_grand_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-style: double;
  border-top-width: 6px;
  border-top-color: #D3D3D3;
}

#pgtfccecvh .gt_striped {
  background-color: rgba(128, 128, 128, 0.05);
}

#pgtfccecvh .gt_table_body {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#pgtfccecvh .gt_footnotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#pgtfccecvh .gt_footnote {
  margin: 0px;
  font-size: 90%;
  padding-left: 4px;
  padding-right: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#pgtfccecvh .gt_sourcenotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#pgtfccecvh .gt_sourcenote {
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#pgtfccecvh .gt_left {
  text-align: left;
}

#pgtfccecvh .gt_center {
  text-align: center;
}

#pgtfccecvh .gt_right {
  text-align: right;
  font-variant-numeric: tabular-nums;
}

#pgtfccecvh .gt_font_normal {
  font-weight: normal;
}

#pgtfccecvh .gt_font_bold {
  font-weight: bold;
}

#pgtfccecvh .gt_font_italic {
  font-style: italic;
}

#pgtfccecvh .gt_super {
  font-size: 65%;
}

#pgtfccecvh .gt_footnote_marks {
  font-style: italic;
  font-weight: normal;
  font-size: 75%;
  vertical-align: 0.4em;
}

#pgtfccecvh .gt_asterisk {
  font-size: 100%;
  vertical-align: 0;
}

#pgtfccecvh .gt_indent_1 {
  text-indent: 5px;
}

#pgtfccecvh .gt_indent_2 {
  text-indent: 10px;
}

#pgtfccecvh .gt_indent_3 {
  text-indent: 15px;
}

#pgtfccecvh .gt_indent_4 {
  text-indent: 20px;
}

#pgtfccecvh .gt_indent_5 {
  text-indent: 25px;
}
</style>
<table class="gt_table">
  
  <thead class="gt_col_headings">
    <tr>
      <th class="gt_col_heading gt_columns_bottom_border gt_left" rowspan="1" colspan="1" scope="col" id="parameters">parameters</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1" scope="col" id="Estimate">Estimate</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1" scope="col" id="Est.Error">Est.Error</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1" scope="col" id="Q2.5">Q2.5</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1" scope="col" id="Q97.5">Q97.5</th>
    </tr>
  </thead>
  <tbody class="gt_table_body">
    <tr><td headers="parameters" class="gt_row gt_left">b_BD1</td>
<td headers="Estimate" class="gt_row gt_right">0.28</td>
<td headers="Est.Error" class="gt_row gt_right">0.05</td>
<td headers="Q2.5" class="gt_row gt_right">0.19</td>
<td headers="Q97.5" class="gt_row gt_right">0.37</td></tr>
    <tr><td headers="parameters" class="gt_row gt_left">b_BD2</td>
<td headers="Estimate" class="gt_row gt_right">0.40</td>
<td headers="Est.Error" class="gt_row gt_right">0.04</td>
<td headers="Q2.5" class="gt_row gt_right">0.31</td>
<td headers="Q97.5" class="gt_row gt_right">0.49</td></tr>
    <tr><td headers="parameters" class="gt_row gt_left">b_BD3</td>
<td headers="Estimate" class="gt_row gt_right">0.41</td>
<td headers="Est.Error" class="gt_row gt_right">0.04</td>
<td headers="Q2.5" class="gt_row gt_right">0.32</td>
<td headers="Q97.5" class="gt_row gt_right">0.50</td></tr>
    <tr><td headers="parameters" class="gt_row gt_left">b_W</td>
<td headers="Estimate" class="gt_row gt_right">0.21</td>
<td headers="Est.Error" class="gt_row gt_right">0.03</td>
<td headers="Q2.5" class="gt_row gt_right">0.14</td>
<td headers="Q97.5" class="gt_row gt_right">0.27</td></tr>
    <tr><td headers="parameters" class="gt_row gt_left">b_S</td>
<td headers="Estimate" class="gt_row gt_right">-0.11</td>
<td headers="Est.Error" class="gt_row gt_right">0.03</td>
<td headers="Q2.5" class="gt_row gt_right">-0.17</td>
<td headers="Q97.5" class="gt_row gt_right">-0.05</td></tr>
    <tr><td headers="parameters" class="gt_row gt_left">b_W:S</td>
<td headers="Estimate" class="gt_row gt_right">-0.14</td>
<td headers="Est.Error" class="gt_row gt_right">0.04</td>
<td headers="Q2.5" class="gt_row gt_right">-0.21</td>
<td headers="Q97.5" class="gt_row gt_right">-0.07</td></tr>
    <tr><td headers="parameters" class="gt_row gt_left">sigma</td>
<td headers="Estimate" class="gt_row gt_right">0.13</td>
<td headers="Est.Error" class="gt_row gt_right">0.02</td>
<td headers="Q2.5" class="gt_row gt_right">0.10</td>
<td headers="Q97.5" class="gt_row gt_right">0.18</td></tr>
  </tbody>
  
  
</table>
</div>
<p><br /></p>
</div>
<div id="h2-6" class="section level3 hasAnchor" number="8.4.3">
<h3><span class="header-section-number">8.4.3</span> 8H2<a href="conditional-manatees.html#h2-6" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<blockquote>
<p>Use WAIC to compare the model from 8H1 to a model that omits bed. What do you infer from this comparison? Can you reconcile the WAIC results with the posterior distribution of the bed coefficients?</p>
</blockquote>
<p>b8.5と比較。<br />
b8.6の方がいいが、あまり変わらない。</p>
<div class="sourceCode" id="cb713"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb713-1"><a href="conditional-manatees.html#cb713-1" aria-hidden="true" tabindex="-1"></a>b8<span class="fl">.5</span> <span class="ot">&lt;-</span> <span class="fu">add_criterion</span>(b8<span class="fl">.5</span>, <span class="fu">c</span>(<span class="st">&quot;waic&quot;</span>,<span class="st">&quot;loo&quot;</span>))</span>
<span id="cb713-2"><a href="conditional-manatees.html#cb713-2" aria-hidden="true" tabindex="-1"></a>b8<span class="fl">.6</span> <span class="ot">&lt;-</span> <span class="fu">add_criterion</span>(b8<span class="fl">.6</span>, <span class="fu">c</span>(<span class="st">&quot;waic&quot;</span>,<span class="st">&quot;loo&quot;</span>))</span>
<span id="cb713-3"><a href="conditional-manatees.html#cb713-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb713-4"><a href="conditional-manatees.html#cb713-4" aria-hidden="true" tabindex="-1"></a><span class="fu">loo_compare</span>(b8<span class="fl">.5</span>,b8<span class="fl">.6</span>, <span class="at">criterion =</span><span class="st">&quot;waic&quot;</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb713-5"><a href="conditional-manatees.html#cb713-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">print</span>(<span class="at">simplify=</span>F)</span></code></pre></div>
<pre><code>##      elpd_diff se_diff elpd_waic se_elpd_waic p_waic se_p_waic waic  se_waic
## b8.6   0.0       0.0    13.9       3.2          6.0    1.3     -27.7   6.5  
## b8.5  -1.5       2.7    12.4       3.8          4.4    1.2     -24.7   7.6</code></pre>
<div class="sourceCode" id="cb715"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb715-1"><a href="conditional-manatees.html#cb715-1" aria-hidden="true" tabindex="-1"></a><span class="fu">model_weights</span>(b8<span class="fl">.5</span>, b8<span class="fl">.6</span>, <span class="at">weights =</span> <span class="st">&quot;waic&quot;</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb715-2"><a href="conditional-manatees.html#cb715-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">round</span>(<span class="at">digits =</span> <span class="dv">2</span>)</span></code></pre></div>
<pre><code>## b8.5 b8.6 
## 0.18 0.82</code></pre>
<p><br /></p>
</div>
<div id="h3-6" class="section level3 hasAnchor" number="8.4.4">
<h3><span class="header-section-number">8.4.4</span> 8H3<a href="conditional-manatees.html#h3-6" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<blockquote>
<p>Consider again the data(rugged) data on economic development and terrain ruggedness, examined in this chapter. One of the African countries in that example Seychelles, is far outside the cloud of other nations, being a rare country with both relatively high GDP and high ruggedness. Seychelles is also unusual, in that it is a group of islands far from the coast of mainland Africa, and its main economic activity is tourism.</p>
</blockquote>
<div id="a-2" class="section level4 hasAnchor" number="8.4.4.1">
<h4><span class="header-section-number">8.4.4.1</span> a<a href="conditional-manatees.html#a-2" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<blockquote>
<p>Focus on model m8.5 from the chapter. Use WAIC pointwise penalties and PSIS Pareto k values to measure relative influence of each country. By these criteria, is Seychelles influencing the results? Are there other nations that are relatively influential? If so, can you explain why?</p>
</blockquote>
<p>シチリアを含め、いくつかkやp_waicが高い国があるよう。　　</p>
<div class="sourceCode" id="cb717"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb717-1"><a href="conditional-manatees.html#cb717-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(loo)</span>
<span id="cb717-2"><a href="conditional-manatees.html#cb717-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb717-3"><a href="conditional-manatees.html#cb717-3" aria-hidden="true" tabindex="-1"></a>b8<span class="fl">.3</span> <span class="ot">&lt;-</span> <span class="fu">add_criterion</span>(b8<span class="fl">.3</span>, <span class="fu">c</span>(<span class="st">&quot;waic&quot;</span>,<span class="st">&quot;loo&quot;</span>))</span>
<span id="cb717-4"><a href="conditional-manatees.html#cb717-4" aria-hidden="true" tabindex="-1"></a>k <span class="ot">&lt;-</span> <span class="fu">pareto_k_values</span>(<span class="fu">loo</span>(b8<span class="fl">.3</span>))</span>
<span id="cb717-5"><a href="conditional-manatees.html#cb717-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb717-6"><a href="conditional-manatees.html#cb717-6" aria-hidden="true" tabindex="-1"></a><span class="fu">tibble</span>(<span class="at">k =</span> k,</span>
<span id="cb717-7"><a href="conditional-manatees.html#cb717-7" aria-hidden="true" tabindex="-1"></a><span class="at">p_waic =</span> b8<span class="fl">.3</span><span class="sc">$</span>criteria<span class="sc">$</span>waic<span class="sc">$</span>pointwise[,<span class="dv">2</span>],</span>
<span id="cb717-8"><a href="conditional-manatees.html#cb717-8" aria-hidden="true" tabindex="-1"></a><span class="at">Loc =</span> <span class="fu">pull</span>(d2,country)) <span class="sc">%&gt;%</span></span>
<span id="cb717-9"><a href="conditional-manatees.html#cb717-9" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> k, <span class="at">y =</span> p_waic, <span class="at">color =</span> Loc <span class="sc">==</span> <span class="st">&quot;Seychelles&quot;</span>))<span class="sc">+</span></span>
<span id="cb717-10"><a href="conditional-manatees.html#cb717-10" aria-hidden="true" tabindex="-1"></a><span class="fu">geom_point</span>(<span class="fu">aes</span>(<span class="at">shape =</span> Loc <span class="sc">==</span> <span class="st">&quot;ID&quot;</span>),<span class="at">size=</span><span class="dv">2</span>, <span class="at">stroke=</span><span class="dv">1</span>)<span class="sc">+</span></span>
<span id="cb717-11"><a href="conditional-manatees.html#cb717-11" aria-hidden="true" tabindex="-1"></a><span class="fu">geom_text_repel</span>(<span class="at">data =</span> . <span class="sc">%&gt;%</span> <span class="fu">filter</span>(k <span class="sc">&gt;</span> <span class="fl">0.3</span><span class="sc">|</span> p_waic <span class="sc">&gt;</span> <span class="fl">0.3</span>),</span>
<span id="cb717-12"><a href="conditional-manatees.html#cb717-12" aria-hidden="true" tabindex="-1"></a><span class="fu">aes</span>(<span class="at">label=</span>Loc))<span class="sc">+</span></span>
<span id="cb717-13"><a href="conditional-manatees.html#cb717-13" aria-hidden="true" tabindex="-1"></a><span class="fu">scale_shape_manual</span>(<span class="at">values=</span><span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">19</span>))<span class="sc">+</span></span>
<span id="cb717-14"><a href="conditional-manatees.html#cb717-14" aria-hidden="true" tabindex="-1"></a><span class="fu">scale_color_manual</span>(<span class="at">values=</span><span class="fu">c</span>(<span class="st">&quot;navy&quot;</span>,<span class="st">&quot;red&quot;</span>))<span class="sc">+</span></span>
<span id="cb717-15"><a href="conditional-manatees.html#cb717-15" aria-hidden="true" tabindex="-1"></a><span class="fu">theme</span>(<span class="at">legend.position=</span><span class="st">&quot;none&quot;</span>,</span>
<span id="cb717-16"><a href="conditional-manatees.html#cb717-16" aria-hidden="true" tabindex="-1"></a><span class="at">aspect.ratio=</span><span class="dv">1</span>)<span class="sc">+</span></span>
<span id="cb717-17"><a href="conditional-manatees.html#cb717-17" aria-hidden="true" tabindex="-1"></a><span class="fu">labs</span>(<span class="at">title =</span> <span class="st">&quot;b8.3&quot;</span>) <span class="ot">-&gt;</span>p5</span>
<span id="cb717-18"><a href="conditional-manatees.html#cb717-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb717-19"><a href="conditional-manatees.html#cb717-19" aria-hidden="true" tabindex="-1"></a>p5</span></code></pre></div>
<p><img src="Rethinking_Bookdown_files/figure-html/unnamed-chunk-337-1.png" width="672" style="display: block; margin: auto;" />
<br /></p>
</div>
<div id="b-2" class="section level4 hasAnchor" number="8.4.4.2">
<h4><span class="header-section-number">8.4.4.2</span> b<a href="conditional-manatees.html#b-2" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<blockquote>
<p>Now use robust regression, as described in the previous chapter. Modify m8.5 to se a Student-t distribution with
ν=2. Does this change the results in a substantial way?</p>
</blockquote>
<p>student_tを用いてrobust回帰を行う。</p>
<div class="sourceCode" id="cb718"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb718-1"><a href="conditional-manatees.html#cb718-1" aria-hidden="true" tabindex="-1"></a>b8<span class="fl">.3</span>r <span class="ot">&lt;-</span> <span class="fu">brm</span>(</span>
<span id="cb718-2"><a href="conditional-manatees.html#cb718-2" aria-hidden="true" tabindex="-1"></a>  <span class="at">data =</span> d2,</span>
<span id="cb718-3"><a href="conditional-manatees.html#cb718-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">family =</span> student,</span>
<span id="cb718-4"><a href="conditional-manatees.html#cb718-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">formula =</span> <span class="fu">bf</span>(G <span class="sc">~</span> <span class="dv">0</span> <span class="sc">+</span> a <span class="sc">+</span> b <span class="sc">*</span> R_c, </span>
<span id="cb718-5"><a href="conditional-manatees.html#cb718-5" aria-hidden="true" tabindex="-1"></a>         a <span class="sc">~</span> <span class="dv">0</span> <span class="sc">+</span> A_ind, </span>
<span id="cb718-6"><a href="conditional-manatees.html#cb718-6" aria-hidden="true" tabindex="-1"></a>         b <span class="sc">~</span> <span class="dv">0</span> <span class="sc">+</span> A_ind,</span>
<span id="cb718-7"><a href="conditional-manatees.html#cb718-7" aria-hidden="true" tabindex="-1"></a>         <span class="at">nl =</span> <span class="cn">TRUE</span>,</span>
<span id="cb718-8"><a href="conditional-manatees.html#cb718-8" aria-hidden="true" tabindex="-1"></a>         <span class="at">nu =</span><span class="dv">2</span>),</span>
<span id="cb718-9"><a href="conditional-manatees.html#cb718-9" aria-hidden="true" tabindex="-1"></a>  <span class="at">prior =</span> <span class="fu">c</span>(<span class="fu">prior</span>(<span class="fu">normal</span>(<span class="dv">1</span>, <span class="fl">0.1</span>), <span class="at">class =</span> b,</span>
<span id="cb718-10"><a href="conditional-manatees.html#cb718-10" aria-hidden="true" tabindex="-1"></a>                  <span class="at">coef=</span><span class="st">&quot;A_ind1&quot;</span>, <span class="at">nlpar=</span>a),</span>
<span id="cb718-11"><a href="conditional-manatees.html#cb718-11" aria-hidden="true" tabindex="-1"></a>            <span class="fu">prior</span>(<span class="fu">normal</span>(<span class="dv">1</span>, <span class="fl">0.1</span>), <span class="at">class =</span> b,</span>
<span id="cb718-12"><a href="conditional-manatees.html#cb718-12" aria-hidden="true" tabindex="-1"></a>                  <span class="at">coef=</span><span class="st">&quot;A_ind2&quot;</span>,<span class="at">nlpar=</span>a),</span>
<span id="cb718-13"><a href="conditional-manatees.html#cb718-13" aria-hidden="true" tabindex="-1"></a>            <span class="fu">prior</span>(<span class="fu">normal</span>(<span class="dv">1</span>, <span class="fl">0.3</span>), <span class="at">class =</span> b,</span>
<span id="cb718-14"><a href="conditional-manatees.html#cb718-14" aria-hidden="true" tabindex="-1"></a>                  <span class="at">coef=</span><span class="st">&quot;A_ind1&quot;</span>, <span class="at">nlpar=</span>b),</span>
<span id="cb718-15"><a href="conditional-manatees.html#cb718-15" aria-hidden="true" tabindex="-1"></a>            <span class="fu">prior</span>(<span class="fu">normal</span>(<span class="dv">1</span>, <span class="fl">0.3</span>), <span class="at">class =</span> b,</span>
<span id="cb718-16"><a href="conditional-manatees.html#cb718-16" aria-hidden="true" tabindex="-1"></a>                  <span class="at">coef=</span><span class="st">&quot;A_ind2&quot;</span>,<span class="at">nlpar=</span>b),</span>
<span id="cb718-17"><a href="conditional-manatees.html#cb718-17" aria-hidden="true" tabindex="-1"></a>            <span class="fu">prior</span>(<span class="fu">exponential</span>(<span class="dv">1</span>), <span class="at">class =</span> sigma)),</span>
<span id="cb718-18"><a href="conditional-manatees.html#cb718-18" aria-hidden="true" tabindex="-1"></a>  <span class="at">seed=</span><span class="dv">8</span>, <span class="at">sample_prior=</span><span class="cn">TRUE</span>,</span>
<span id="cb718-19"><a href="conditional-manatees.html#cb718-19" aria-hidden="true" tabindex="-1"></a>  <span class="at">backend =</span> <span class="st">&quot;cmdstanr&quot;</span>,</span>
<span id="cb718-20"><a href="conditional-manatees.html#cb718-20" aria-hidden="true" tabindex="-1"></a>  <span class="at">file =</span> <span class="st">&quot;output/Chapter8/b8.3r&quot;</span></span>
<span id="cb718-21"><a href="conditional-manatees.html#cb718-21" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb718-22"><a href="conditional-manatees.html#cb718-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb718-23"><a href="conditional-manatees.html#cb718-23" aria-hidden="true" tabindex="-1"></a><span class="fu">posterior_summary</span>(b8<span class="fl">.3</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb718-24"><a href="conditional-manatees.html#cb718-24" aria-hidden="true" tabindex="-1"></a>  <span class="fu">data.frame</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb718-25"><a href="conditional-manatees.html#cb718-25" aria-hidden="true" tabindex="-1"></a>  <span class="fu">round</span>(<span class="dv">2</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb718-26"><a href="conditional-manatees.html#cb718-26" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rownames_to_column</span>(<span class="at">var =</span> <span class="st">&quot;parameters&quot;</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb718-27"><a href="conditional-manatees.html#cb718-27" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(parameters <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">&quot;sigma&quot;</span>)<span class="sc">|</span></span>
<span id="cb718-28"><a href="conditional-manatees.html#cb718-28" aria-hidden="true" tabindex="-1"></a>           <span class="fu">str_detect</span>(parameters,<span class="st">&quot;^b_&quot;</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb718-29"><a href="conditional-manatees.html#cb718-29" aria-hidden="true" tabindex="-1"></a>  <span class="fu">gt</span>()</span></code></pre></div>
<div id="kzvcrfoztt" style="padding-left:0px;padding-right:0px;padding-top:10px;padding-bottom:10px;overflow-x:auto;overflow-y:auto;width:auto;height:auto;">
<style>html {
  font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, Cantarell, 'Helvetica Neue', 'Fira Sans', 'Droid Sans', Arial, sans-serif;
}

#kzvcrfoztt .gt_table {
  display: table;
  border-collapse: collapse;
  margin-left: auto;
  margin-right: auto;
  color: #333333;
  font-size: 16px;
  font-weight: normal;
  font-style: normal;
  background-color: #FFFFFF;
  width: auto;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #A8A8A8;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #A8A8A8;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
}

#kzvcrfoztt .gt_heading {
  background-color: #FFFFFF;
  text-align: center;
  border-bottom-color: #FFFFFF;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#kzvcrfoztt .gt_caption {
  padding-top: 4px;
  padding-bottom: 4px;
}

#kzvcrfoztt .gt_title {
  color: #333333;
  font-size: 125%;
  font-weight: initial;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-color: #FFFFFF;
  border-bottom-width: 0;
}

#kzvcrfoztt .gt_subtitle {
  color: #333333;
  font-size: 85%;
  font-weight: initial;
  padding-top: 0;
  padding-bottom: 6px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-color: #FFFFFF;
  border-top-width: 0;
}

#kzvcrfoztt .gt_bottom_border {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#kzvcrfoztt .gt_col_headings {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#kzvcrfoztt .gt_col_heading {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 6px;
  padding-left: 5px;
  padding-right: 5px;
  overflow-x: hidden;
}

#kzvcrfoztt .gt_column_spanner_outer {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  padding-top: 0;
  padding-bottom: 0;
  padding-left: 4px;
  padding-right: 4px;
}

#kzvcrfoztt .gt_column_spanner_outer:first-child {
  padding-left: 0;
}

#kzvcrfoztt .gt_column_spanner_outer:last-child {
  padding-right: 0;
}

#kzvcrfoztt .gt_column_spanner {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 5px;
  overflow-x: hidden;
  display: inline-block;
  width: 100%;
}

#kzvcrfoztt .gt_group_heading {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  text-align: left;
}

#kzvcrfoztt .gt_empty_group_heading {
  padding: 0.5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: middle;
}

#kzvcrfoztt .gt_from_md > :first-child {
  margin-top: 0;
}

#kzvcrfoztt .gt_from_md > :last-child {
  margin-bottom: 0;
}

#kzvcrfoztt .gt_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  margin: 10px;
  border-top-style: solid;
  border-top-width: 1px;
  border-top-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  overflow-x: hidden;
}

#kzvcrfoztt .gt_stub {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
}

#kzvcrfoztt .gt_stub_row_group {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
  vertical-align: top;
}

#kzvcrfoztt .gt_row_group_first td {
  border-top-width: 2px;
}

#kzvcrfoztt .gt_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#kzvcrfoztt .gt_first_summary_row {
  border-top-style: solid;
  border-top-color: #D3D3D3;
}

#kzvcrfoztt .gt_first_summary_row.thick {
  border-top-width: 2px;
}

#kzvcrfoztt .gt_last_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#kzvcrfoztt .gt_grand_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#kzvcrfoztt .gt_first_grand_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-style: double;
  border-top-width: 6px;
  border-top-color: #D3D3D3;
}

#kzvcrfoztt .gt_striped {
  background-color: rgba(128, 128, 128, 0.05);
}

#kzvcrfoztt .gt_table_body {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#kzvcrfoztt .gt_footnotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#kzvcrfoztt .gt_footnote {
  margin: 0px;
  font-size: 90%;
  padding-left: 4px;
  padding-right: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#kzvcrfoztt .gt_sourcenotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#kzvcrfoztt .gt_sourcenote {
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#kzvcrfoztt .gt_left {
  text-align: left;
}

#kzvcrfoztt .gt_center {
  text-align: center;
}

#kzvcrfoztt .gt_right {
  text-align: right;
  font-variant-numeric: tabular-nums;
}

#kzvcrfoztt .gt_font_normal {
  font-weight: normal;
}

#kzvcrfoztt .gt_font_bold {
  font-weight: bold;
}

#kzvcrfoztt .gt_font_italic {
  font-style: italic;
}

#kzvcrfoztt .gt_super {
  font-size: 65%;
}

#kzvcrfoztt .gt_footnote_marks {
  font-style: italic;
  font-weight: normal;
  font-size: 75%;
  vertical-align: 0.4em;
}

#kzvcrfoztt .gt_asterisk {
  font-size: 100%;
  vertical-align: 0;
}

#kzvcrfoztt .gt_indent_1 {
  text-indent: 5px;
}

#kzvcrfoztt .gt_indent_2 {
  text-indent: 10px;
}

#kzvcrfoztt .gt_indent_3 {
  text-indent: 15px;
}

#kzvcrfoztt .gt_indent_4 {
  text-indent: 20px;
}

#kzvcrfoztt .gt_indent_5 {
  text-indent: 25px;
}
</style>
<table class="gt_table">
  
  <thead class="gt_col_headings">
    <tr>
      <th class="gt_col_heading gt_columns_bottom_border gt_left" rowspan="1" colspan="1" scope="col" id="parameters">parameters</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1" scope="col" id="Estimate">Estimate</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1" scope="col" id="Est.Error">Est.Error</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1" scope="col" id="Q2.5">Q2.5</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1" scope="col" id="Q97.5">Q97.5</th>
    </tr>
  </thead>
  <tbody class="gt_table_body">
    <tr><td headers="parameters" class="gt_row gt_left">b_a_A_ind1</td>
<td headers="Estimate" class="gt_row gt_right">0.89</td>
<td headers="Est.Error" class="gt_row gt_right">0.02</td>
<td headers="Q2.5" class="gt_row gt_right">0.86</td>
<td headers="Q97.5" class="gt_row gt_right">0.92</td></tr>
    <tr><td headers="parameters" class="gt_row gt_left">b_a_A_ind2</td>
<td headers="Estimate" class="gt_row gt_right">1.05</td>
<td headers="Est.Error" class="gt_row gt_right">0.01</td>
<td headers="Q2.5" class="gt_row gt_right">1.03</td>
<td headers="Q97.5" class="gt_row gt_right">1.07</td></tr>
    <tr><td headers="parameters" class="gt_row gt_left">b_b_A_ind1</td>
<td headers="Estimate" class="gt_row gt_right">0.20</td>
<td headers="Est.Error" class="gt_row gt_right">0.08</td>
<td headers="Q2.5" class="gt_row gt_right">0.05</td>
<td headers="Q97.5" class="gt_row gt_right">0.35</td></tr>
    <tr><td headers="parameters" class="gt_row gt_left">b_b_A_ind2</td>
<td headers="Estimate" class="gt_row gt_right">-0.11</td>
<td headers="Est.Error" class="gt_row gt_right">0.06</td>
<td headers="Q2.5" class="gt_row gt_right">-0.22</td>
<td headers="Q97.5" class="gt_row gt_right">0.01</td></tr>
    <tr><td headers="parameters" class="gt_row gt_left">sigma</td>
<td headers="Estimate" class="gt_row gt_right">0.11</td>
<td headers="Est.Error" class="gt_row gt_right">0.01</td>
<td headers="Q2.5" class="gt_row gt_right">0.10</td>
<td headers="Q97.5" class="gt_row gt_right">0.12</td></tr>
  </tbody>
  
  
</table>
</div>
<div class="sourceCode" id="cb719"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb719-1"><a href="conditional-manatees.html#cb719-1" aria-hidden="true" tabindex="-1"></a><span class="fu">posterior_summary</span>(b8<span class="fl">.3</span>r) <span class="sc">%&gt;%</span> </span>
<span id="cb719-2"><a href="conditional-manatees.html#cb719-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">data.frame</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb719-3"><a href="conditional-manatees.html#cb719-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">round</span>(<span class="dv">2</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb719-4"><a href="conditional-manatees.html#cb719-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rownames_to_column</span>(<span class="at">var =</span> <span class="st">&quot;parameters&quot;</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb719-5"><a href="conditional-manatees.html#cb719-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(parameters <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">&quot;sigma&quot;</span>)<span class="sc">|</span></span>
<span id="cb719-6"><a href="conditional-manatees.html#cb719-6" aria-hidden="true" tabindex="-1"></a>           <span class="fu">str_detect</span>(parameters,<span class="st">&quot;^b_&quot;</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb719-7"><a href="conditional-manatees.html#cb719-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">gt</span>()</span></code></pre></div>
<div id="umjvxxgprs" style="padding-left:0px;padding-right:0px;padding-top:10px;padding-bottom:10px;overflow-x:auto;overflow-y:auto;width:auto;height:auto;">
<style>html {
  font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, Cantarell, 'Helvetica Neue', 'Fira Sans', 'Droid Sans', Arial, sans-serif;
}

#umjvxxgprs .gt_table {
  display: table;
  border-collapse: collapse;
  margin-left: auto;
  margin-right: auto;
  color: #333333;
  font-size: 16px;
  font-weight: normal;
  font-style: normal;
  background-color: #FFFFFF;
  width: auto;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #A8A8A8;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #A8A8A8;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
}

#umjvxxgprs .gt_heading {
  background-color: #FFFFFF;
  text-align: center;
  border-bottom-color: #FFFFFF;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#umjvxxgprs .gt_caption {
  padding-top: 4px;
  padding-bottom: 4px;
}

#umjvxxgprs .gt_title {
  color: #333333;
  font-size: 125%;
  font-weight: initial;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-color: #FFFFFF;
  border-bottom-width: 0;
}

#umjvxxgprs .gt_subtitle {
  color: #333333;
  font-size: 85%;
  font-weight: initial;
  padding-top: 0;
  padding-bottom: 6px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-color: #FFFFFF;
  border-top-width: 0;
}

#umjvxxgprs .gt_bottom_border {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#umjvxxgprs .gt_col_headings {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#umjvxxgprs .gt_col_heading {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 6px;
  padding-left: 5px;
  padding-right: 5px;
  overflow-x: hidden;
}

#umjvxxgprs .gt_column_spanner_outer {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  padding-top: 0;
  padding-bottom: 0;
  padding-left: 4px;
  padding-right: 4px;
}

#umjvxxgprs .gt_column_spanner_outer:first-child {
  padding-left: 0;
}

#umjvxxgprs .gt_column_spanner_outer:last-child {
  padding-right: 0;
}

#umjvxxgprs .gt_column_spanner {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 5px;
  overflow-x: hidden;
  display: inline-block;
  width: 100%;
}

#umjvxxgprs .gt_group_heading {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  text-align: left;
}

#umjvxxgprs .gt_empty_group_heading {
  padding: 0.5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: middle;
}

#umjvxxgprs .gt_from_md > :first-child {
  margin-top: 0;
}

#umjvxxgprs .gt_from_md > :last-child {
  margin-bottom: 0;
}

#umjvxxgprs .gt_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  margin: 10px;
  border-top-style: solid;
  border-top-width: 1px;
  border-top-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  overflow-x: hidden;
}

#umjvxxgprs .gt_stub {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
}

#umjvxxgprs .gt_stub_row_group {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
  vertical-align: top;
}

#umjvxxgprs .gt_row_group_first td {
  border-top-width: 2px;
}

#umjvxxgprs .gt_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#umjvxxgprs .gt_first_summary_row {
  border-top-style: solid;
  border-top-color: #D3D3D3;
}

#umjvxxgprs .gt_first_summary_row.thick {
  border-top-width: 2px;
}

#umjvxxgprs .gt_last_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#umjvxxgprs .gt_grand_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#umjvxxgprs .gt_first_grand_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-style: double;
  border-top-width: 6px;
  border-top-color: #D3D3D3;
}

#umjvxxgprs .gt_striped {
  background-color: rgba(128, 128, 128, 0.05);
}

#umjvxxgprs .gt_table_body {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#umjvxxgprs .gt_footnotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#umjvxxgprs .gt_footnote {
  margin: 0px;
  font-size: 90%;
  padding-left: 4px;
  padding-right: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#umjvxxgprs .gt_sourcenotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#umjvxxgprs .gt_sourcenote {
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#umjvxxgprs .gt_left {
  text-align: left;
}

#umjvxxgprs .gt_center {
  text-align: center;
}

#umjvxxgprs .gt_right {
  text-align: right;
  font-variant-numeric: tabular-nums;
}

#umjvxxgprs .gt_font_normal {
  font-weight: normal;
}

#umjvxxgprs .gt_font_bold {
  font-weight: bold;
}

#umjvxxgprs .gt_font_italic {
  font-style: italic;
}

#umjvxxgprs .gt_super {
  font-size: 65%;
}

#umjvxxgprs .gt_footnote_marks {
  font-style: italic;
  font-weight: normal;
  font-size: 75%;
  vertical-align: 0.4em;
}

#umjvxxgprs .gt_asterisk {
  font-size: 100%;
  vertical-align: 0;
}

#umjvxxgprs .gt_indent_1 {
  text-indent: 5px;
}

#umjvxxgprs .gt_indent_2 {
  text-indent: 10px;
}

#umjvxxgprs .gt_indent_3 {
  text-indent: 15px;
}

#umjvxxgprs .gt_indent_4 {
  text-indent: 20px;
}

#umjvxxgprs .gt_indent_5 {
  text-indent: 25px;
}
</style>
<table class="gt_table">
  
  <thead class="gt_col_headings">
    <tr>
      <th class="gt_col_heading gt_columns_bottom_border gt_left" rowspan="1" colspan="1" scope="col" id="parameters">parameters</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1" scope="col" id="Estimate">Estimate</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1" scope="col" id="Est.Error">Est.Error</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1" scope="col" id="Q2.5">Q2.5</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1" scope="col" id="Q97.5">Q97.5</th>
    </tr>
  </thead>
  <tbody class="gt_table_body">
    <tr><td headers="parameters" class="gt_row gt_left">b_a_A_ind1</td>
<td headers="Estimate" class="gt_row gt_right">0.88</td>
<td headers="Est.Error" class="gt_row gt_right">0.02</td>
<td headers="Q2.5" class="gt_row gt_right">0.84</td>
<td headers="Q97.5" class="gt_row gt_right">0.91</td></tr>
    <tr><td headers="parameters" class="gt_row gt_left">b_a_A_ind2</td>
<td headers="Estimate" class="gt_row gt_right">1.05</td>
<td headers="Est.Error" class="gt_row gt_right">0.01</td>
<td headers="Q2.5" class="gt_row gt_right">1.02</td>
<td headers="Q97.5" class="gt_row gt_right">1.07</td></tr>
    <tr><td headers="parameters" class="gt_row gt_left">b_b_A_ind1</td>
<td headers="Estimate" class="gt_row gt_right">0.24</td>
<td headers="Est.Error" class="gt_row gt_right">0.10</td>
<td headers="Q2.5" class="gt_row gt_right">0.05</td>
<td headers="Q97.5" class="gt_row gt_right">0.44</td></tr>
    <tr><td headers="parameters" class="gt_row gt_left">b_b_A_ind2</td>
<td headers="Estimate" class="gt_row gt_right">-0.16</td>
<td headers="Est.Error" class="gt_row gt_right">0.07</td>
<td headers="Q2.5" class="gt_row gt_right">-0.29</td>
<td headers="Q97.5" class="gt_row gt_right">-0.01</td></tr>
    <tr><td headers="parameters" class="gt_row gt_left">sigma</td>
<td headers="Estimate" class="gt_row gt_right">0.09</td>
<td headers="Est.Error" class="gt_row gt_right">0.01</td>
<td headers="Q2.5" class="gt_row gt_right">0.07</td>
<td headers="Q97.5" class="gt_row gt_right">0.10</td></tr>
  </tbody>
  
  
</table>
</div>
<p><br /></p>
<p>結果はほとんど変わらない。<br />
pareto-kとp_waicの値は改善した？。</p>
<div class="sourceCode" id="cb720"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb720-1"><a href="conditional-manatees.html#cb720-1" aria-hidden="true" tabindex="-1"></a>b8<span class="fl">.3</span>r <span class="ot">&lt;-</span> <span class="fu">add_criterion</span>(b8<span class="fl">.3</span>r, <span class="fu">c</span>(<span class="st">&quot;waic&quot;</span>,<span class="st">&quot;loo&quot;</span>))</span>
<span id="cb720-2"><a href="conditional-manatees.html#cb720-2" aria-hidden="true" tabindex="-1"></a>k <span class="ot">&lt;-</span> <span class="fu">pareto_k_values</span>(<span class="fu">loo</span>(b8<span class="fl">.3</span>r))</span>
<span id="cb720-3"><a href="conditional-manatees.html#cb720-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb720-4"><a href="conditional-manatees.html#cb720-4" aria-hidden="true" tabindex="-1"></a><span class="fu">tibble</span>(<span class="at">k =</span> k,</span>
<span id="cb720-5"><a href="conditional-manatees.html#cb720-5" aria-hidden="true" tabindex="-1"></a><span class="at">p_waic =</span> b8<span class="fl">.3</span>r<span class="sc">$</span>criteria<span class="sc">$</span>waic<span class="sc">$</span>pointwise[,<span class="dv">2</span>],</span>
<span id="cb720-6"><a href="conditional-manatees.html#cb720-6" aria-hidden="true" tabindex="-1"></a><span class="at">Loc =</span> <span class="fu">pull</span>(d2,country)) <span class="sc">%&gt;%</span></span>
<span id="cb720-7"><a href="conditional-manatees.html#cb720-7" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> k, <span class="at">y =</span> p_waic, <span class="at">color =</span> Loc <span class="sc">==</span> <span class="st">&quot;Seychelles&quot;</span>))<span class="sc">+</span></span>
<span id="cb720-8"><a href="conditional-manatees.html#cb720-8" aria-hidden="true" tabindex="-1"></a><span class="fu">geom_point</span>(<span class="fu">aes</span>(<span class="at">shape =</span> Loc <span class="sc">==</span> <span class="st">&quot;ID&quot;</span>),<span class="at">size=</span><span class="dv">2</span>, <span class="at">stroke=</span><span class="dv">1</span>)<span class="sc">+</span></span>
<span id="cb720-9"><a href="conditional-manatees.html#cb720-9" aria-hidden="true" tabindex="-1"></a><span class="fu">geom_text_repel</span>(<span class="at">data =</span> . <span class="sc">%&gt;%</span> <span class="fu">filter</span>(k <span class="sc">&gt;</span> <span class="fl">0.3</span><span class="sc">|</span> p_waic <span class="sc">&gt;</span> <span class="fl">0.3</span>),</span>
<span id="cb720-10"><a href="conditional-manatees.html#cb720-10" aria-hidden="true" tabindex="-1"></a><span class="fu">aes</span>(<span class="at">label=</span>Loc))<span class="sc">+</span></span>
<span id="cb720-11"><a href="conditional-manatees.html#cb720-11" aria-hidden="true" tabindex="-1"></a><span class="fu">scale_shape_manual</span>(<span class="at">values=</span><span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">19</span>))<span class="sc">+</span></span>
<span id="cb720-12"><a href="conditional-manatees.html#cb720-12" aria-hidden="true" tabindex="-1"></a><span class="fu">scale_color_manual</span>(<span class="at">values=</span><span class="fu">c</span>(<span class="st">&quot;navy&quot;</span>,<span class="st">&quot;red&quot;</span>))<span class="sc">+</span></span>
<span id="cb720-13"><a href="conditional-manatees.html#cb720-13" aria-hidden="true" tabindex="-1"></a><span class="fu">theme</span>(<span class="at">legend.position=</span><span class="st">&quot;none&quot;</span>,</span>
<span id="cb720-14"><a href="conditional-manatees.html#cb720-14" aria-hidden="true" tabindex="-1"></a><span class="at">aspect.ratio=</span><span class="dv">1</span>)<span class="sc">+</span></span>
<span id="cb720-15"><a href="conditional-manatees.html#cb720-15" aria-hidden="true" tabindex="-1"></a><span class="fu">labs</span>(<span class="at">title =</span> <span class="st">&quot;b8.3r&quot;</span>) <span class="ot">-&gt;</span> p6</span>
<span id="cb720-16"><a href="conditional-manatees.html#cb720-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb720-17"><a href="conditional-manatees.html#cb720-17" aria-hidden="true" tabindex="-1"></a>p5<span class="sc">+</span>p6</span></code></pre></div>
<p><img src="Rethinking_Bookdown_files/figure-html/unnamed-chunk-339-1.png" width="672" style="display: block; margin: auto;" />
<br /></p>
</div>
</div>
<div id="h4-6" class="section level3 hasAnchor" number="8.4.5">
<h3><span class="header-section-number">8.4.5</span> 8H4<a href="conditional-manatees.html#h4-6" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<blockquote>
<p>The values in data(nettle) are data on language diversity in 74 nations.1 The meaning of each column is given below.</p>
</blockquote>
<ol style="list-style-type: decimal">
<li><code>country</code>: Name of the country</li>
<li><code>num.lang</code>: Number of recognized languages spoken</li>
<li><code>area</code>: Area in square kilometers</li>
<li><code>k.pop</code>: Population, in thousands</li>
<li><code>num.stations</code>: Number of weather stations that provided data for the next two columns</li>
<li><code>mean.growing.season</code>: Average length of growing season, in months</li>
<li><code>sd.growing.season</code>: Standard deviation of length of growing season, in months</li>
</ol>
<blockquote>
<p>Use these data to evaluate the hypothesis that language diversity is partly a product of food security. The notion is that, in productive ecologies, people don’t need large social networks to buffer them against risk of food shortfalls. The means cultural groups can be smaller and more self-sufficient, leading to more languages per capita. Use the number of languages per capita as the outcome:</p>
</blockquote>
<div class="sourceCode" id="cb721"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb721-1"><a href="conditional-manatees.html#cb721-1" aria-hidden="true" tabindex="-1"></a><span class="fu">data</span>(nettle)</span>
<span id="cb721-2"><a href="conditional-manatees.html#cb721-2" aria-hidden="true" tabindex="-1"></a>d5 <span class="ot">&lt;-</span> nettle</span>
<span id="cb721-3"><a href="conditional-manatees.html#cb721-3" aria-hidden="true" tabindex="-1"></a>d5<span class="sc">$</span>lang.per.cap <span class="ot">&lt;-</span> d5<span class="sc">$</span>num.lang <span class="sc">/</span> d5<span class="sc">$</span>k.pop</span></code></pre></div>
<blockquote>
<p>Use the logarithm of this new variable as your regression outcome. (A count model would be better here, but you’ll learn those later, in Chapter 11.) This problem is open ended, allowing you to decide how you address the hypotheses and the uncertain advice the modeling provides. If you think you need to use WAIC anyplace, please do. If you think you need certain priors, argue for them. If you think you need to plot predictions in a certain way, please do. Just try to honestly evaluate the main effects of both <code>mean.growing.season</code> and <code>sd.growing.season</code>, as well as their two-way interaction. Here are three parts to help.</p>
</blockquote>
<p><br /></p>
<div class="sourceCode" id="cb722"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb722-1"><a href="conditional-manatees.html#cb722-1" aria-hidden="true" tabindex="-1"></a>d5 <span class="sc">%&gt;%</span> </span>
<span id="cb722-2"><a href="conditional-manatees.html#cb722-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">L =</span> <span class="fu">log</span>(num.lang<span class="sc">/</span>k.pop),</span>
<span id="cb722-3"><a href="conditional-manatees.html#cb722-3" aria-hidden="true" tabindex="-1"></a>         <span class="at">meanG =</span> <span class="fu">standardize</span>(mean.growing.season),</span>
<span id="cb722-4"><a href="conditional-manatees.html#cb722-4" aria-hidden="true" tabindex="-1"></a>         <span class="at">sdG =</span> <span class="fu">standardize</span>(sd.growing.season),</span>
<span id="cb722-5"><a href="conditional-manatees.html#cb722-5" aria-hidden="true" tabindex="-1"></a>         <span class="at">A =</span> <span class="fu">standardize</span>(<span class="fu">log</span>(area))) <span class="ot">-&gt;</span> d5</span>
<span id="cb722-6"><a href="conditional-manatees.html#cb722-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb722-7"><a href="conditional-manatees.html#cb722-7" aria-hidden="true" tabindex="-1"></a>d5 <span class="sc">%&gt;%</span> </span>
<span id="cb722-8"><a href="conditional-manatees.html#cb722-8" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">select</span>(L, meanG, sdG, A) <span class="sc">%&gt;%</span> </span>
<span id="cb722-9"><a href="conditional-manatees.html#cb722-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pairs</span>()</span></code></pre></div>
<p><img src="Rethinking_Bookdown_files/figure-html/unnamed-chunk-341-1.png" width="672" style="display: block; margin: auto;" /></p>
<div class="sourceCode" id="cb723"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb723-1"><a href="conditional-manatees.html#cb723-1" aria-hidden="true" tabindex="-1"></a>d5 <span class="sc">%&gt;%</span> </span>
<span id="cb723-2"><a href="conditional-manatees.html#cb723-2" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">select</span>(L, meanG, sdG, A) <span class="sc">%&gt;%</span> </span>
<span id="cb723-3"><a href="conditional-manatees.html#cb723-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">cor</span>()</span></code></pre></div>
<pre><code>##                L       meanG         sdG          A
## L      1.0000000  0.35963657 -0.25338920 -0.2785991
## meanG  0.3596366  1.00000000  0.02136416 -0.3692084
## sdG   -0.2533892  0.02136416  1.00000000  0.5320083
## A     -0.2785991 -0.36920845  0.53200827  1.0000000</code></pre>
<p><br /></p>
<p>プロットしてみる。</p>
<div class="sourceCode" id="cb725"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb725-1"><a href="conditional-manatees.html#cb725-1" aria-hidden="true" tabindex="-1"></a><span class="do">## L ~ meanG</span></span>
<span id="cb725-2"><a href="conditional-manatees.html#cb725-2" aria-hidden="true" tabindex="-1"></a>d5 <span class="sc">%&gt;%</span> </span>
<span id="cb725-3"><a href="conditional-manatees.html#cb725-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x=</span>meanG, <span class="at">y=</span>L))<span class="sc">+</span></span>
<span id="cb725-4"><a href="conditional-manatees.html#cb725-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>()<span class="sc">+</span></span>
<span id="cb725-5"><a href="conditional-manatees.html#cb725-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">aspect.ratio=</span><span class="dv">1</span>)<span class="sc">+</span></span>
<span id="cb725-6"><a href="conditional-manatees.html#cb725-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(<span class="at">method=</span><span class="st">&quot;lm&quot;</span>)<span class="ot">-&gt;</span> p6</span>
<span id="cb725-7"><a href="conditional-manatees.html#cb725-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb725-8"><a href="conditional-manatees.html#cb725-8" aria-hidden="true" tabindex="-1"></a><span class="do">## L ~ sdG  </span></span>
<span id="cb725-9"><a href="conditional-manatees.html#cb725-9" aria-hidden="true" tabindex="-1"></a>d5 <span class="sc">%&gt;%</span> </span>
<span id="cb725-10"><a href="conditional-manatees.html#cb725-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x=</span>sdG, <span class="at">y=</span>L))<span class="sc">+</span></span>
<span id="cb725-11"><a href="conditional-manatees.html#cb725-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>()<span class="sc">+</span></span>
<span id="cb725-12"><a href="conditional-manatees.html#cb725-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">aspect.ratio=</span><span class="dv">1</span>)<span class="sc">+</span></span>
<span id="cb725-13"><a href="conditional-manatees.html#cb725-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(<span class="at">method=</span><span class="st">&quot;lm&quot;</span>) <span class="ot">-&gt;</span>p7</span>
<span id="cb725-14"><a href="conditional-manatees.html#cb725-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb725-15"><a href="conditional-manatees.html#cb725-15" aria-hidden="true" tabindex="-1"></a><span class="do">## L ~ area  </span></span>
<span id="cb725-16"><a href="conditional-manatees.html#cb725-16" aria-hidden="true" tabindex="-1"></a>d5 <span class="sc">%&gt;%</span> </span>
<span id="cb725-17"><a href="conditional-manatees.html#cb725-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x=</span>A, <span class="at">y=</span>L))<span class="sc">+</span></span>
<span id="cb725-18"><a href="conditional-manatees.html#cb725-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>()<span class="sc">+</span></span>
<span id="cb725-19"><a href="conditional-manatees.html#cb725-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">aspect.ratio=</span><span class="dv">1</span>)<span class="sc">+</span></span>
<span id="cb725-20"><a href="conditional-manatees.html#cb725-20" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(<span class="at">method=</span><span class="st">&quot;lm&quot;</span>) <span class="ot">-&gt;</span>p8</span>
<span id="cb725-21"><a href="conditional-manatees.html#cb725-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb725-22"><a href="conditional-manatees.html#cb725-22" aria-hidden="true" tabindex="-1"></a>p6 <span class="sc">+</span> p7 <span class="sc">+</span> p8　　</span></code></pre></div>
<p><img src="Rethinking_Bookdown_files/figure-html/unnamed-chunk-342-1.png" width="672" style="display: block; margin: auto;" /></p>
<div class="sourceCode" id="cb726"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb726-1"><a href="conditional-manatees.html#cb726-1" aria-hidden="true" tabindex="-1"></a><span class="do">## meanG ~ area  </span></span>
<span id="cb726-2"><a href="conditional-manatees.html#cb726-2" aria-hidden="true" tabindex="-1"></a>d5 <span class="sc">%&gt;%</span> </span>
<span id="cb726-3"><a href="conditional-manatees.html#cb726-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x=</span>A, <span class="at">y=</span>meanG))<span class="sc">+</span></span>
<span id="cb726-4"><a href="conditional-manatees.html#cb726-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>()<span class="sc">+</span></span>
<span id="cb726-5"><a href="conditional-manatees.html#cb726-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">aspect.ratio=</span><span class="dv">1</span>)<span class="sc">+</span></span>
<span id="cb726-6"><a href="conditional-manatees.html#cb726-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(<span class="at">method=</span><span class="st">&quot;lm&quot;</span>) <span class="ot">-&gt;</span>p9</span>
<span id="cb726-7"><a href="conditional-manatees.html#cb726-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb726-8"><a href="conditional-manatees.html#cb726-8" aria-hidden="true" tabindex="-1"></a><span class="do">## sdG ~ area</span></span>
<span id="cb726-9"><a href="conditional-manatees.html#cb726-9" aria-hidden="true" tabindex="-1"></a>d5 <span class="sc">%&gt;%</span> </span>
<span id="cb726-10"><a href="conditional-manatees.html#cb726-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x=</span>A, <span class="at">y=</span>sdG))<span class="sc">+</span></span>
<span id="cb726-11"><a href="conditional-manatees.html#cb726-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>()<span class="sc">+</span></span>
<span id="cb726-12"><a href="conditional-manatees.html#cb726-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">aspect.ratio=</span><span class="dv">1</span>)<span class="sc">+</span></span>
<span id="cb726-13"><a href="conditional-manatees.html#cb726-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(<span class="at">method=</span><span class="st">&quot;lm&quot;</span>) <span class="ot">-&gt;</span>p10</span>
<span id="cb726-14"><a href="conditional-manatees.html#cb726-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb726-15"><a href="conditional-manatees.html#cb726-15" aria-hidden="true" tabindex="-1"></a>p9 <span class="sc">+</span> p10</span></code></pre></div>
<p><img src="Rethinking_Bookdown_files/figure-html/unnamed-chunk-342-2.png" width="672" style="display: block; margin: auto;" />
<br /></p>
<div id="a-3" class="section level4 hasAnchor" number="8.4.5.1">
<h4><span class="header-section-number">8.4.5.1</span> a<a href="conditional-manatees.html#a-3" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<blockquote>
<p>Evaluate the hypothesis that language diversity, as measured by log(lang.per.cap), is positively associated with average length of the growing season, mean.growing.season. Consider log(area) in your regression(s) as a covariate (not an interaction). Interpret your results.</p>
</blockquote>
<p>まずは、L ~ meanG + Aを考える。</p>
<div class="sourceCode" id="cb727"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb727-1"><a href="conditional-manatees.html#cb727-1" aria-hidden="true" tabindex="-1"></a>b8H4.a <span class="ot">&lt;-</span> </span>
<span id="cb727-2"><a href="conditional-manatees.html#cb727-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">brm</span>(<span class="at">data =</span> d5,</span>
<span id="cb727-3"><a href="conditional-manatees.html#cb727-3" aria-hidden="true" tabindex="-1"></a>      <span class="at">family =</span> gaussian,</span>
<span id="cb727-4"><a href="conditional-manatees.html#cb727-4" aria-hidden="true" tabindex="-1"></a>      <span class="at">formula =</span> L <span class="sc">~</span> <span class="dv">1</span> <span class="sc">+</span> meanG <span class="sc">+</span> A,</span>
<span id="cb727-5"><a href="conditional-manatees.html#cb727-5" aria-hidden="true" tabindex="-1"></a>      <span class="at">prior =</span><span class="fu">c</span>(<span class="fu">prior</span>(<span class="fu">normal</span>(<span class="sc">-</span><span class="fl">5.5</span>, <span class="fl">1.5</span>), <span class="at">class =</span> Intercept),</span>
<span id="cb727-6"><a href="conditional-manatees.html#cb727-6" aria-hidden="true" tabindex="-1"></a>               <span class="fu">prior</span>(<span class="fu">normal</span>(<span class="dv">0</span>,<span class="dv">2</span>),<span class="at">class=</span>b),</span>
<span id="cb727-7"><a href="conditional-manatees.html#cb727-7" aria-hidden="true" tabindex="-1"></a>               <span class="fu">prior</span>(<span class="fu">exponential</span>(<span class="dv">1</span>),<span class="at">class=</span>sigma)),</span>
<span id="cb727-8"><a href="conditional-manatees.html#cb727-8" aria-hidden="true" tabindex="-1"></a>      <span class="at">backend =</span> <span class="st">&quot;cmdstanr&quot;</span>,</span>
<span id="cb727-9"><a href="conditional-manatees.html#cb727-9" aria-hidden="true" tabindex="-1"></a>      <span class="at">seed =</span><span class="dv">8</span>, <span class="at">file =</span> <span class="st">&quot;output/Chapter8/b8H4.a&quot;</span>)</span>
<span id="cb727-10"><a href="conditional-manatees.html#cb727-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb727-11"><a href="conditional-manatees.html#cb727-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb727-12"><a href="conditional-manatees.html#cb727-12" aria-hidden="true" tabindex="-1"></a><span class="fu">posterior_summary</span>(b8H4.a)<span class="sc">%&gt;%</span> </span>
<span id="cb727-13"><a href="conditional-manatees.html#cb727-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">data.frame</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb727-14"><a href="conditional-manatees.html#cb727-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">round</span>(<span class="dv">2</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb727-15"><a href="conditional-manatees.html#cb727-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">gt</span>()</span></code></pre></div>
<div id="gxcxjwxoqd" style="padding-left:0px;padding-right:0px;padding-top:10px;padding-bottom:10px;overflow-x:auto;overflow-y:auto;width:auto;height:auto;">
<style>html {
  font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, Cantarell, 'Helvetica Neue', 'Fira Sans', 'Droid Sans', Arial, sans-serif;
}

#gxcxjwxoqd .gt_table {
  display: table;
  border-collapse: collapse;
  margin-left: auto;
  margin-right: auto;
  color: #333333;
  font-size: 16px;
  font-weight: normal;
  font-style: normal;
  background-color: #FFFFFF;
  width: auto;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #A8A8A8;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #A8A8A8;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
}

#gxcxjwxoqd .gt_heading {
  background-color: #FFFFFF;
  text-align: center;
  border-bottom-color: #FFFFFF;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#gxcxjwxoqd .gt_caption {
  padding-top: 4px;
  padding-bottom: 4px;
}

#gxcxjwxoqd .gt_title {
  color: #333333;
  font-size: 125%;
  font-weight: initial;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-color: #FFFFFF;
  border-bottom-width: 0;
}

#gxcxjwxoqd .gt_subtitle {
  color: #333333;
  font-size: 85%;
  font-weight: initial;
  padding-top: 0;
  padding-bottom: 6px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-color: #FFFFFF;
  border-top-width: 0;
}

#gxcxjwxoqd .gt_bottom_border {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#gxcxjwxoqd .gt_col_headings {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#gxcxjwxoqd .gt_col_heading {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 6px;
  padding-left: 5px;
  padding-right: 5px;
  overflow-x: hidden;
}

#gxcxjwxoqd .gt_column_spanner_outer {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  padding-top: 0;
  padding-bottom: 0;
  padding-left: 4px;
  padding-right: 4px;
}

#gxcxjwxoqd .gt_column_spanner_outer:first-child {
  padding-left: 0;
}

#gxcxjwxoqd .gt_column_spanner_outer:last-child {
  padding-right: 0;
}

#gxcxjwxoqd .gt_column_spanner {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 5px;
  overflow-x: hidden;
  display: inline-block;
  width: 100%;
}

#gxcxjwxoqd .gt_group_heading {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  text-align: left;
}

#gxcxjwxoqd .gt_empty_group_heading {
  padding: 0.5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: middle;
}

#gxcxjwxoqd .gt_from_md > :first-child {
  margin-top: 0;
}

#gxcxjwxoqd .gt_from_md > :last-child {
  margin-bottom: 0;
}

#gxcxjwxoqd .gt_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  margin: 10px;
  border-top-style: solid;
  border-top-width: 1px;
  border-top-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  overflow-x: hidden;
}

#gxcxjwxoqd .gt_stub {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
}

#gxcxjwxoqd .gt_stub_row_group {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
  vertical-align: top;
}

#gxcxjwxoqd .gt_row_group_first td {
  border-top-width: 2px;
}

#gxcxjwxoqd .gt_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#gxcxjwxoqd .gt_first_summary_row {
  border-top-style: solid;
  border-top-color: #D3D3D3;
}

#gxcxjwxoqd .gt_first_summary_row.thick {
  border-top-width: 2px;
}

#gxcxjwxoqd .gt_last_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#gxcxjwxoqd .gt_grand_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#gxcxjwxoqd .gt_first_grand_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-style: double;
  border-top-width: 6px;
  border-top-color: #D3D3D3;
}

#gxcxjwxoqd .gt_striped {
  background-color: rgba(128, 128, 128, 0.05);
}

#gxcxjwxoqd .gt_table_body {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#gxcxjwxoqd .gt_footnotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#gxcxjwxoqd .gt_footnote {
  margin: 0px;
  font-size: 90%;
  padding-left: 4px;
  padding-right: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#gxcxjwxoqd .gt_sourcenotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#gxcxjwxoqd .gt_sourcenote {
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#gxcxjwxoqd .gt_left {
  text-align: left;
}

#gxcxjwxoqd .gt_center {
  text-align: center;
}

#gxcxjwxoqd .gt_right {
  text-align: right;
  font-variant-numeric: tabular-nums;
}

#gxcxjwxoqd .gt_font_normal {
  font-weight: normal;
}

#gxcxjwxoqd .gt_font_bold {
  font-weight: bold;
}

#gxcxjwxoqd .gt_font_italic {
  font-style: italic;
}

#gxcxjwxoqd .gt_super {
  font-size: 65%;
}

#gxcxjwxoqd .gt_footnote_marks {
  font-style: italic;
  font-weight: normal;
  font-size: 75%;
  vertical-align: 0.4em;
}

#gxcxjwxoqd .gt_asterisk {
  font-size: 100%;
  vertical-align: 0;
}

#gxcxjwxoqd .gt_indent_1 {
  text-indent: 5px;
}

#gxcxjwxoqd .gt_indent_2 {
  text-indent: 10px;
}

#gxcxjwxoqd .gt_indent_3 {
  text-indent: 15px;
}

#gxcxjwxoqd .gt_indent_4 {
  text-indent: 20px;
}

#gxcxjwxoqd .gt_indent_5 {
  text-indent: 25px;
}
</style>
<table class="gt_table">
  
  <thead class="gt_col_headings">
    <tr>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1" scope="col" id="Estimate">Estimate</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1" scope="col" id="Est.Error">Est.Error</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1" scope="col" id="Q2.5">Q2.5</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1" scope="col" id="Q97.5">Q97.5</th>
    </tr>
  </thead>
  <tbody class="gt_table_body">
    <tr><td headers="Estimate" class="gt_row gt_right">-5.46</td>
<td headers="Est.Error" class="gt_row gt_right">0.17</td>
<td headers="Q2.5" class="gt_row gt_right">-5.79</td>
<td headers="Q97.5" class="gt_row gt_right">-5.12</td></tr>
    <tr><td headers="Estimate" class="gt_row gt_right">0.45</td>
<td headers="Est.Error" class="gt_row gt_right">0.18</td>
<td headers="Q2.5" class="gt_row gt_right">0.11</td>
<td headers="Q97.5" class="gt_row gt_right">0.80</td></tr>
    <tr><td headers="Estimate" class="gt_row gt_right">-0.26</td>
<td headers="Est.Error" class="gt_row gt_right">0.18</td>
<td headers="Q2.5" class="gt_row gt_right">-0.61</td>
<td headers="Q97.5" class="gt_row gt_right">0.11</td></tr>
    <tr><td headers="Estimate" class="gt_row gt_right">1.43</td>
<td headers="Est.Error" class="gt_row gt_right">0.12</td>
<td headers="Q2.5" class="gt_row gt_right">1.21</td>
<td headers="Q97.5" class="gt_row gt_right">1.69</td></tr>
    <tr><td headers="Estimate" class="gt_row gt_right">-6.03</td>
<td headers="Est.Error" class="gt_row gt_right">0.13</td>
<td headers="Q2.5" class="gt_row gt_right">-6.30</td>
<td headers="Q97.5" class="gt_row gt_right">-5.80</td></tr>
    <tr><td headers="Estimate" class="gt_row gt_right">-137.04</td>
<td headers="Est.Error" class="gt_row gt_right">1.47</td>
<td headers="Q2.5" class="gt_row gt_right">-140.73</td>
<td headers="Q97.5" class="gt_row gt_right">-135.22</td></tr>
  </tbody>
  
  
</table>
</div>
<p><br /></p>
<p>事前分布の妥当性を確認。
若干ばらつきはあるものの、大丈夫そう？</p>
<div class="sourceCode" id="cb728"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb728-1"><a href="conditional-manatees.html#cb728-1" aria-hidden="true" tabindex="-1"></a>b8H4.a_p <span class="ot">&lt;-</span></span>
<span id="cb728-2"><a href="conditional-manatees.html#cb728-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">update</span>(b8H4.a,</span>
<span id="cb728-3"><a href="conditional-manatees.html#cb728-3" aria-hidden="true" tabindex="-1"></a>         <span class="at">sample_prior =</span> <span class="st">&quot;only&quot;</span>,</span>
<span id="cb728-4"><a href="conditional-manatees.html#cb728-4" aria-hidden="true" tabindex="-1"></a>         <span class="at">iter =</span> <span class="dv">2000</span>, <span class="at">warmup =</span> <span class="dv">1000</span>, <span class="at">chains =</span> <span class="dv">4</span>, <span class="at">cores =</span> <span class="dv">4</span>,</span>
<span id="cb728-5"><a href="conditional-manatees.html#cb728-5" aria-hidden="true" tabindex="-1"></a>         <span class="at">seed =</span> <span class="dv">8</span>,</span>
<span id="cb728-6"><a href="conditional-manatees.html#cb728-6" aria-hidden="true" tabindex="-1"></a>         <span class="at">file =</span> <span class="st">&quot;output/Chapter8/b8H5.a_p&quot;</span>)</span>
<span id="cb728-7"><a href="conditional-manatees.html#cb728-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb728-8"><a href="conditional-manatees.html#cb728-8" aria-hidden="true" tabindex="-1"></a>seq <span class="ot">&lt;-</span> <span class="fu">tibble</span>(<span class="at">meanG =</span> <span class="fu">c</span>(<span class="sc">-</span><span class="fl">2.5</span>, <span class="dv">2</span>),</span>
<span id="cb728-9"><a href="conditional-manatees.html#cb728-9" aria-hidden="true" tabindex="-1"></a>              <span class="at">A =</span> <span class="fu">mean</span>(d5<span class="sc">$</span>A))</span>
<span id="cb728-10"><a href="conditional-manatees.html#cb728-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb728-11"><a href="conditional-manatees.html#cb728-11" aria-hidden="true" tabindex="-1"></a>prior8H4 <span class="ot">&lt;-</span> </span>
<span id="cb728-12"><a href="conditional-manatees.html#cb728-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">fitted</span>(b8H4.a_p, <span class="at">newdata =</span> seq,</span>
<span id="cb728-13"><a href="conditional-manatees.html#cb728-13" aria-hidden="true" tabindex="-1"></a>                   <span class="at">summary=</span>F,<span class="at">nsamples=</span><span class="dv">50</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb728-14"><a href="conditional-manatees.html#cb728-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">data.frame</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb728-15"><a href="conditional-manatees.html#cb728-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_longer</span>(<span class="fu">everything</span>()) <span class="sc">%&gt;%</span> </span>
<span id="cb728-16"><a href="conditional-manatees.html#cb728-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">bind_cols</span>(tidyr<span class="sc">::</span><span class="fu">expand</span>(seq, <span class="at">n =</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">50</span>,</span>
<span id="cb728-17"><a href="conditional-manatees.html#cb728-17" aria-hidden="true" tabindex="-1"></a>                   <span class="fu">nesting</span>(meanG,A)))</span>
<span id="cb728-18"><a href="conditional-manatees.html#cb728-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb728-19"><a href="conditional-manatees.html#cb728-19" aria-hidden="true" tabindex="-1"></a>d5 <span class="sc">%&gt;%</span> </span>
<span id="cb728-20"><a href="conditional-manatees.html#cb728-20" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x=</span>meanG, <span class="at">y =</span> L))<span class="sc">+</span></span>
<span id="cb728-21"><a href="conditional-manatees.html#cb728-21" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="at">data =</span> prior8H4, </span>
<span id="cb728-22"><a href="conditional-manatees.html#cb728-22" aria-hidden="true" tabindex="-1"></a>              <span class="fu">aes</span>(<span class="at">y =</span> value, <span class="at">group =</span> n),</span>
<span id="cb728-23"><a href="conditional-manatees.html#cb728-23" aria-hidden="true" tabindex="-1"></a>            <span class="at">alpha =</span> <span class="dv">1</span><span class="sc">/</span><span class="dv">2</span>)<span class="sc">+</span></span>
<span id="cb728-24"><a href="conditional-manatees.html#cb728-24" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x=</span><span class="st">&quot;meanG&quot;</span>, <span class="at">y =</span> <span class="st">&quot;L&quot;</span>)<span class="sc">+</span></span>
<span id="cb728-25"><a href="conditional-manatees.html#cb728-25" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">aspect.ratio=</span><span class="dv">1</span>,</span>
<span id="cb728-26"><a href="conditional-manatees.html#cb728-26" aria-hidden="true" tabindex="-1"></a>        <span class="at">strip.background =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb728-27"><a href="conditional-manatees.html#cb728-27" aria-hidden="true" tabindex="-1"></a>        <span class="at">strip.text =</span> <span class="fu">element_text</span>(<span class="at">size=</span><span class="dv">10</span>))<span class="sc">+</span></span>
<span id="cb728-28"><a href="conditional-manatees.html#cb728-28" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_continuous</span>(<span class="at">breaks =</span> <span class="fu">seq</span>(<span class="sc">-</span><span class="fl">2.5</span>,<span class="dv">2</span>,<span class="at">by=</span><span class="fl">0.5</span>))<span class="sc">+</span></span>
<span id="cb728-29"><a href="conditional-manatees.html#cb728-29" aria-hidden="true" tabindex="-1"></a>  <span class="fu">coord_cartesian</span>(<span class="at">ylim =</span> <span class="fu">c</span>(<span class="sc">-</span><span class="dv">15</span>,<span class="dv">5</span>))<span class="sc">+</span></span>
<span id="cb728-30"><a href="conditional-manatees.html#cb728-30" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_hline</span>(<span class="at">yintercept =</span> <span class="fu">c</span>(<span class="fu">min</span>(d5<span class="sc">$</span>L),<span class="fu">max</span>(d5<span class="sc">$</span>L)), <span class="at">linetype=</span><span class="dv">2</span>)</span></code></pre></div>
<p><img src="Rethinking_Bookdown_files/figure-html/unnamed-chunk-344-1.png" width="672" style="display: block; margin: auto;" />
<br /></p>
<p>ちなみに、meanGだけで回帰すると…。<br />
結果を見ると、meanGもAもそれぞれLに少なからず影響しているよう。</p>
<div class="sourceCode" id="cb729"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb729-1"><a href="conditional-manatees.html#cb729-1" aria-hidden="true" tabindex="-1"></a>b8H4.a_2 <span class="ot">&lt;-</span> </span>
<span id="cb729-2"><a href="conditional-manatees.html#cb729-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">brm</span>(<span class="at">data =</span> d5,</span>
<span id="cb729-3"><a href="conditional-manatees.html#cb729-3" aria-hidden="true" tabindex="-1"></a>      <span class="at">family =</span> gaussian,</span>
<span id="cb729-4"><a href="conditional-manatees.html#cb729-4" aria-hidden="true" tabindex="-1"></a>      <span class="at">formula =</span> L <span class="sc">~</span> <span class="dv">1</span> <span class="sc">+</span> meanG,</span>
<span id="cb729-5"><a href="conditional-manatees.html#cb729-5" aria-hidden="true" tabindex="-1"></a>      <span class="at">prior =</span><span class="fu">c</span>(<span class="fu">prior</span>(<span class="fu">normal</span>(<span class="sc">-</span><span class="fl">5.5</span>, <span class="fl">1.5</span>), <span class="at">class =</span> Intercept),</span>
<span id="cb729-6"><a href="conditional-manatees.html#cb729-6" aria-hidden="true" tabindex="-1"></a>               <span class="fu">prior</span>(<span class="fu">normal</span>(<span class="dv">0</span>,<span class="dv">2</span>),<span class="at">class=</span>b),</span>
<span id="cb729-7"><a href="conditional-manatees.html#cb729-7" aria-hidden="true" tabindex="-1"></a>               <span class="fu">prior</span>(<span class="fu">exponential</span>(<span class="dv">1</span>),<span class="at">class=</span>sigma)),</span>
<span id="cb729-8"><a href="conditional-manatees.html#cb729-8" aria-hidden="true" tabindex="-1"></a>      <span class="at">backend =</span> <span class="st">&quot;cmdstanr&quot;</span>,</span>
<span id="cb729-9"><a href="conditional-manatees.html#cb729-9" aria-hidden="true" tabindex="-1"></a>      <span class="at">seed =</span><span class="dv">8</span>, <span class="at">file =</span> <span class="st">&quot;output/Chapter8/b8H4.a_2&quot;</span>)</span>
<span id="cb729-10"><a href="conditional-manatees.html#cb729-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb729-11"><a href="conditional-manatees.html#cb729-11" aria-hidden="true" tabindex="-1"></a><span class="fu">posterior_summary</span>(b8H4.a)<span class="sc">%&gt;%</span> </span>
<span id="cb729-12"><a href="conditional-manatees.html#cb729-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">data.frame</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb729-13"><a href="conditional-manatees.html#cb729-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">round</span>(<span class="dv">2</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb729-14"><a href="conditional-manatees.html#cb729-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">gt</span>()</span></code></pre></div>
<div id="xapqlayjzw" style="padding-left:0px;padding-right:0px;padding-top:10px;padding-bottom:10px;overflow-x:auto;overflow-y:auto;width:auto;height:auto;">
<style>html {
  font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, Cantarell, 'Helvetica Neue', 'Fira Sans', 'Droid Sans', Arial, sans-serif;
}

#xapqlayjzw .gt_table {
  display: table;
  border-collapse: collapse;
  margin-left: auto;
  margin-right: auto;
  color: #333333;
  font-size: 16px;
  font-weight: normal;
  font-style: normal;
  background-color: #FFFFFF;
  width: auto;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #A8A8A8;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #A8A8A8;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
}

#xapqlayjzw .gt_heading {
  background-color: #FFFFFF;
  text-align: center;
  border-bottom-color: #FFFFFF;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#xapqlayjzw .gt_caption {
  padding-top: 4px;
  padding-bottom: 4px;
}

#xapqlayjzw .gt_title {
  color: #333333;
  font-size: 125%;
  font-weight: initial;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-color: #FFFFFF;
  border-bottom-width: 0;
}

#xapqlayjzw .gt_subtitle {
  color: #333333;
  font-size: 85%;
  font-weight: initial;
  padding-top: 0;
  padding-bottom: 6px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-color: #FFFFFF;
  border-top-width: 0;
}

#xapqlayjzw .gt_bottom_border {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#xapqlayjzw .gt_col_headings {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#xapqlayjzw .gt_col_heading {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 6px;
  padding-left: 5px;
  padding-right: 5px;
  overflow-x: hidden;
}

#xapqlayjzw .gt_column_spanner_outer {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  padding-top: 0;
  padding-bottom: 0;
  padding-left: 4px;
  padding-right: 4px;
}

#xapqlayjzw .gt_column_spanner_outer:first-child {
  padding-left: 0;
}

#xapqlayjzw .gt_column_spanner_outer:last-child {
  padding-right: 0;
}

#xapqlayjzw .gt_column_spanner {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 5px;
  overflow-x: hidden;
  display: inline-block;
  width: 100%;
}

#xapqlayjzw .gt_group_heading {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  text-align: left;
}

#xapqlayjzw .gt_empty_group_heading {
  padding: 0.5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: middle;
}

#xapqlayjzw .gt_from_md > :first-child {
  margin-top: 0;
}

#xapqlayjzw .gt_from_md > :last-child {
  margin-bottom: 0;
}

#xapqlayjzw .gt_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  margin: 10px;
  border-top-style: solid;
  border-top-width: 1px;
  border-top-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  overflow-x: hidden;
}

#xapqlayjzw .gt_stub {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
}

#xapqlayjzw .gt_stub_row_group {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
  vertical-align: top;
}

#xapqlayjzw .gt_row_group_first td {
  border-top-width: 2px;
}

#xapqlayjzw .gt_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#xapqlayjzw .gt_first_summary_row {
  border-top-style: solid;
  border-top-color: #D3D3D3;
}

#xapqlayjzw .gt_first_summary_row.thick {
  border-top-width: 2px;
}

#xapqlayjzw .gt_last_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#xapqlayjzw .gt_grand_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#xapqlayjzw .gt_first_grand_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-style: double;
  border-top-width: 6px;
  border-top-color: #D3D3D3;
}

#xapqlayjzw .gt_striped {
  background-color: rgba(128, 128, 128, 0.05);
}

#xapqlayjzw .gt_table_body {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#xapqlayjzw .gt_footnotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#xapqlayjzw .gt_footnote {
  margin: 0px;
  font-size: 90%;
  padding-left: 4px;
  padding-right: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#xapqlayjzw .gt_sourcenotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#xapqlayjzw .gt_sourcenote {
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#xapqlayjzw .gt_left {
  text-align: left;
}

#xapqlayjzw .gt_center {
  text-align: center;
}

#xapqlayjzw .gt_right {
  text-align: right;
  font-variant-numeric: tabular-nums;
}

#xapqlayjzw .gt_font_normal {
  font-weight: normal;
}

#xapqlayjzw .gt_font_bold {
  font-weight: bold;
}

#xapqlayjzw .gt_font_italic {
  font-style: italic;
}

#xapqlayjzw .gt_super {
  font-size: 65%;
}

#xapqlayjzw .gt_footnote_marks {
  font-style: italic;
  font-weight: normal;
  font-size: 75%;
  vertical-align: 0.4em;
}

#xapqlayjzw .gt_asterisk {
  font-size: 100%;
  vertical-align: 0;
}

#xapqlayjzw .gt_indent_1 {
  text-indent: 5px;
}

#xapqlayjzw .gt_indent_2 {
  text-indent: 10px;
}

#xapqlayjzw .gt_indent_3 {
  text-indent: 15px;
}

#xapqlayjzw .gt_indent_4 {
  text-indent: 20px;
}

#xapqlayjzw .gt_indent_5 {
  text-indent: 25px;
}
</style>
<table class="gt_table">
  
  <thead class="gt_col_headings">
    <tr>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1" scope="col" id="Estimate">Estimate</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1" scope="col" id="Est.Error">Est.Error</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1" scope="col" id="Q2.5">Q2.5</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1" scope="col" id="Q97.5">Q97.5</th>
    </tr>
  </thead>
  <tbody class="gt_table_body">
    <tr><td headers="Estimate" class="gt_row gt_right">-5.46</td>
<td headers="Est.Error" class="gt_row gt_right">0.17</td>
<td headers="Q2.5" class="gt_row gt_right">-5.79</td>
<td headers="Q97.5" class="gt_row gt_right">-5.12</td></tr>
    <tr><td headers="Estimate" class="gt_row gt_right">0.45</td>
<td headers="Est.Error" class="gt_row gt_right">0.18</td>
<td headers="Q2.5" class="gt_row gt_right">0.11</td>
<td headers="Q97.5" class="gt_row gt_right">0.80</td></tr>
    <tr><td headers="Estimate" class="gt_row gt_right">-0.26</td>
<td headers="Est.Error" class="gt_row gt_right">0.18</td>
<td headers="Q2.5" class="gt_row gt_right">-0.61</td>
<td headers="Q97.5" class="gt_row gt_right">0.11</td></tr>
    <tr><td headers="Estimate" class="gt_row gt_right">1.43</td>
<td headers="Est.Error" class="gt_row gt_right">0.12</td>
<td headers="Q2.5" class="gt_row gt_right">1.21</td>
<td headers="Q97.5" class="gt_row gt_right">1.69</td></tr>
    <tr><td headers="Estimate" class="gt_row gt_right">-6.03</td>
<td headers="Est.Error" class="gt_row gt_right">0.13</td>
<td headers="Q2.5" class="gt_row gt_right">-6.30</td>
<td headers="Q97.5" class="gt_row gt_right">-5.80</td></tr>
    <tr><td headers="Estimate" class="gt_row gt_right">-137.04</td>
<td headers="Est.Error" class="gt_row gt_right">1.47</td>
<td headers="Q2.5" class="gt_row gt_right">-140.73</td>
<td headers="Q97.5" class="gt_row gt_right">-135.22</td></tr>
  </tbody>
  
  
</table>
</div>
<div class="sourceCode" id="cb730"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb730-1"><a href="conditional-manatees.html#cb730-1" aria-hidden="true" tabindex="-1"></a><span class="fu">posterior_summary</span>(b8H4.a_2)<span class="sc">%&gt;%</span> </span>
<span id="cb730-2"><a href="conditional-manatees.html#cb730-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">data.frame</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb730-3"><a href="conditional-manatees.html#cb730-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">round</span>(<span class="dv">2</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb730-4"><a href="conditional-manatees.html#cb730-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">gt</span>()</span></code></pre></div>
<div id="qmoffbhhzy" style="padding-left:0px;padding-right:0px;padding-top:10px;padding-bottom:10px;overflow-x:auto;overflow-y:auto;width:auto;height:auto;">
<style>html {
  font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, Cantarell, 'Helvetica Neue', 'Fira Sans', 'Droid Sans', Arial, sans-serif;
}

#qmoffbhhzy .gt_table {
  display: table;
  border-collapse: collapse;
  margin-left: auto;
  margin-right: auto;
  color: #333333;
  font-size: 16px;
  font-weight: normal;
  font-style: normal;
  background-color: #FFFFFF;
  width: auto;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #A8A8A8;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #A8A8A8;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
}

#qmoffbhhzy .gt_heading {
  background-color: #FFFFFF;
  text-align: center;
  border-bottom-color: #FFFFFF;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#qmoffbhhzy .gt_caption {
  padding-top: 4px;
  padding-bottom: 4px;
}

#qmoffbhhzy .gt_title {
  color: #333333;
  font-size: 125%;
  font-weight: initial;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-color: #FFFFFF;
  border-bottom-width: 0;
}

#qmoffbhhzy .gt_subtitle {
  color: #333333;
  font-size: 85%;
  font-weight: initial;
  padding-top: 0;
  padding-bottom: 6px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-color: #FFFFFF;
  border-top-width: 0;
}

#qmoffbhhzy .gt_bottom_border {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#qmoffbhhzy .gt_col_headings {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#qmoffbhhzy .gt_col_heading {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 6px;
  padding-left: 5px;
  padding-right: 5px;
  overflow-x: hidden;
}

#qmoffbhhzy .gt_column_spanner_outer {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  padding-top: 0;
  padding-bottom: 0;
  padding-left: 4px;
  padding-right: 4px;
}

#qmoffbhhzy .gt_column_spanner_outer:first-child {
  padding-left: 0;
}

#qmoffbhhzy .gt_column_spanner_outer:last-child {
  padding-right: 0;
}

#qmoffbhhzy .gt_column_spanner {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 5px;
  overflow-x: hidden;
  display: inline-block;
  width: 100%;
}

#qmoffbhhzy .gt_group_heading {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  text-align: left;
}

#qmoffbhhzy .gt_empty_group_heading {
  padding: 0.5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: middle;
}

#qmoffbhhzy .gt_from_md > :first-child {
  margin-top: 0;
}

#qmoffbhhzy .gt_from_md > :last-child {
  margin-bottom: 0;
}

#qmoffbhhzy .gt_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  margin: 10px;
  border-top-style: solid;
  border-top-width: 1px;
  border-top-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  overflow-x: hidden;
}

#qmoffbhhzy .gt_stub {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
}

#qmoffbhhzy .gt_stub_row_group {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
  vertical-align: top;
}

#qmoffbhhzy .gt_row_group_first td {
  border-top-width: 2px;
}

#qmoffbhhzy .gt_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#qmoffbhhzy .gt_first_summary_row {
  border-top-style: solid;
  border-top-color: #D3D3D3;
}

#qmoffbhhzy .gt_first_summary_row.thick {
  border-top-width: 2px;
}

#qmoffbhhzy .gt_last_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#qmoffbhhzy .gt_grand_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#qmoffbhhzy .gt_first_grand_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-style: double;
  border-top-width: 6px;
  border-top-color: #D3D3D3;
}

#qmoffbhhzy .gt_striped {
  background-color: rgba(128, 128, 128, 0.05);
}

#qmoffbhhzy .gt_table_body {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#qmoffbhhzy .gt_footnotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#qmoffbhhzy .gt_footnote {
  margin: 0px;
  font-size: 90%;
  padding-left: 4px;
  padding-right: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#qmoffbhhzy .gt_sourcenotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#qmoffbhhzy .gt_sourcenote {
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#qmoffbhhzy .gt_left {
  text-align: left;
}

#qmoffbhhzy .gt_center {
  text-align: center;
}

#qmoffbhhzy .gt_right {
  text-align: right;
  font-variant-numeric: tabular-nums;
}

#qmoffbhhzy .gt_font_normal {
  font-weight: normal;
}

#qmoffbhhzy .gt_font_bold {
  font-weight: bold;
}

#qmoffbhhzy .gt_font_italic {
  font-style: italic;
}

#qmoffbhhzy .gt_super {
  font-size: 65%;
}

#qmoffbhhzy .gt_footnote_marks {
  font-style: italic;
  font-weight: normal;
  font-size: 75%;
  vertical-align: 0.4em;
}

#qmoffbhhzy .gt_asterisk {
  font-size: 100%;
  vertical-align: 0;
}

#qmoffbhhzy .gt_indent_1 {
  text-indent: 5px;
}

#qmoffbhhzy .gt_indent_2 {
  text-indent: 10px;
}

#qmoffbhhzy .gt_indent_3 {
  text-indent: 15px;
}

#qmoffbhhzy .gt_indent_4 {
  text-indent: 20px;
}

#qmoffbhhzy .gt_indent_5 {
  text-indent: 25px;
}
</style>
<table class="gt_table">
  
  <thead class="gt_col_headings">
    <tr>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1" scope="col" id="Estimate">Estimate</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1" scope="col" id="Est.Error">Est.Error</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1" scope="col" id="Q2.5">Q2.5</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1" scope="col" id="Q97.5">Q97.5</th>
    </tr>
  </thead>
  <tbody class="gt_table_body">
    <tr><td headers="Estimate" class="gt_row gt_right">-5.45</td>
<td headers="Est.Error" class="gt_row gt_right">0.17</td>
<td headers="Q2.5" class="gt_row gt_right">-5.78</td>
<td headers="Q97.5" class="gt_row gt_right">-5.12</td></tr>
    <tr><td headers="Estimate" class="gt_row gt_right">0.54</td>
<td headers="Est.Error" class="gt_row gt_right">0.17</td>
<td headers="Q2.5" class="gt_row gt_right">0.21</td>
<td headers="Q97.5" class="gt_row gt_right">0.87</td></tr>
    <tr><td headers="Estimate" class="gt_row gt_right">1.43</td>
<td headers="Est.Error" class="gt_row gt_right">0.12</td>
<td headers="Q2.5" class="gt_row gt_right">1.23</td>
<td headers="Q97.5" class="gt_row gt_right">1.69</td></tr>
    <tr><td headers="Estimate" class="gt_row gt_right">-4.42</td>
<td headers="Est.Error" class="gt_row gt_right">0.12</td>
<td headers="Q2.5" class="gt_row gt_right">-4.68</td>
<td headers="Q97.5" class="gt_row gt_right">-4.20</td></tr>
    <tr><td headers="Estimate" class="gt_row gt_right">-135.95</td>
<td headers="Est.Error" class="gt_row gt_right">1.22</td>
<td headers="Q2.5" class="gt_row gt_right">-139.09</td>
<td headers="Q97.5" class="gt_row gt_right">-134.54</td></tr>
  </tbody>
  
  
</table>
</div>
<p>一方でPSISをみると、Aはあまり予測には寄与していない。</p>
<div class="sourceCode" id="cb731"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb731-1"><a href="conditional-manatees.html#cb731-1" aria-hidden="true" tabindex="-1"></a>b8H4.a <span class="ot">&lt;-</span> <span class="fu">add_criterion</span>(b8H4.a, <span class="fu">c</span>(<span class="st">&quot;waic&quot;</span>,<span class="st">&quot;loo&quot;</span>))</span>
<span id="cb731-2"><a href="conditional-manatees.html#cb731-2" aria-hidden="true" tabindex="-1"></a>b8H4.a_2 <span class="ot">&lt;-</span> <span class="fu">add_criterion</span>(b8H4.a_2, <span class="fu">c</span>(<span class="st">&quot;waic&quot;</span>,<span class="st">&quot;loo&quot;</span>))　　</span>
<span id="cb731-3"><a href="conditional-manatees.html#cb731-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb731-4"><a href="conditional-manatees.html#cb731-4" aria-hidden="true" tabindex="-1"></a><span class="fu">loo_compare</span>(b8H4.a, b8H4.a_2) <span class="sc">%&gt;%</span> </span>
<span id="cb731-5"><a href="conditional-manatees.html#cb731-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">print</span>(<span class="at">simplify=</span>F) <span class="sc">%&gt;%</span> </span>
<span id="cb731-6"><a href="conditional-manatees.html#cb731-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">data.frame</span>()<span class="ot">-&gt;</span> loo_a</span></code></pre></div>
<pre><code>##          elpd_diff se_diff elpd_loo se_elpd_loo p_loo  se_p_loo looic  se_looic
## b8H4.a_2    0.0       0.0  -133.7      7.3         3.4    1.0    267.4   14.6  
## b8H4.a     -0.2       1.7  -133.9      7.5         4.6    1.4    267.8   15.1</code></pre>
<div class="sourceCode" id="cb733"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb733-1"><a href="conditional-manatees.html#cb733-1" aria-hidden="true" tabindex="-1"></a><span class="fu">model_weights</span>(b8H4.a, b8H4.a_2)</span></code></pre></div>
<pre><code>##    b8H4.a  b8H4.a_2 
## 0.4116151 0.5883849</code></pre>
<p><br /></p>
</div>
<div id="b-3" class="section level4 hasAnchor" number="8.4.5.2">
<h4><span class="header-section-number">8.4.5.2</span> b<a href="conditional-manatees.html#b-3" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<blockquote>
<p>Now evaluate the hypothesis that language diversity is negatively associated with the standard deviation of length of growing season, sd.growing.season. This hypothesis follows from uncertainty in harvest favoring social insurance through larger social networks and therefore fewer languages. Again, consider log(area) as a covariate (not an interaction). Interpret your results.</p>
</blockquote>
<p>次に、L ~ sdGを考える。</p>
<div class="sourceCode" id="cb735"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb735-1"><a href="conditional-manatees.html#cb735-1" aria-hidden="true" tabindex="-1"></a>b8H4.b <span class="ot">&lt;-</span> </span>
<span id="cb735-2"><a href="conditional-manatees.html#cb735-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">brm</span>(<span class="at">data =</span> d5,</span>
<span id="cb735-3"><a href="conditional-manatees.html#cb735-3" aria-hidden="true" tabindex="-1"></a>      <span class="at">family =</span> gaussian,</span>
<span id="cb735-4"><a href="conditional-manatees.html#cb735-4" aria-hidden="true" tabindex="-1"></a>      <span class="at">formula =</span> L <span class="sc">~</span> <span class="dv">1</span> <span class="sc">+</span> sdG,</span>
<span id="cb735-5"><a href="conditional-manatees.html#cb735-5" aria-hidden="true" tabindex="-1"></a>      <span class="at">prior =</span><span class="fu">c</span>(<span class="fu">prior</span>(<span class="fu">normal</span>(<span class="sc">-</span><span class="fl">5.5</span>, <span class="fl">1.5</span>), <span class="at">class =</span> Intercept),</span>
<span id="cb735-6"><a href="conditional-manatees.html#cb735-6" aria-hidden="true" tabindex="-1"></a>               <span class="fu">prior</span>(<span class="fu">normal</span>(<span class="dv">0</span>,<span class="dv">2</span>),<span class="at">class=</span>b),</span>
<span id="cb735-7"><a href="conditional-manatees.html#cb735-7" aria-hidden="true" tabindex="-1"></a>               <span class="fu">prior</span>(<span class="fu">exponential</span>(<span class="dv">1</span>),<span class="at">class=</span>sigma)),</span>
<span id="cb735-8"><a href="conditional-manatees.html#cb735-8" aria-hidden="true" tabindex="-1"></a>      <span class="at">backend =</span> <span class="st">&quot;cmdstanr&quot;</span>,</span>
<span id="cb735-9"><a href="conditional-manatees.html#cb735-9" aria-hidden="true" tabindex="-1"></a>      <span class="at">seed =</span><span class="dv">8</span>, <span class="at">file =</span> <span class="st">&quot;output/Chapter8/b8H4.b&quot;</span>)</span></code></pre></div>
<p><br /></p>
<p>L ~ sdG + Aも考えてみる。</p>
<div class="sourceCode" id="cb736"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb736-1"><a href="conditional-manatees.html#cb736-1" aria-hidden="true" tabindex="-1"></a>b8H4.b_2 <span class="ot">&lt;-</span> </span>
<span id="cb736-2"><a href="conditional-manatees.html#cb736-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">brm</span>(<span class="at">data =</span> d5,</span>
<span id="cb736-3"><a href="conditional-manatees.html#cb736-3" aria-hidden="true" tabindex="-1"></a>      <span class="at">family =</span> gaussian,</span>
<span id="cb736-4"><a href="conditional-manatees.html#cb736-4" aria-hidden="true" tabindex="-1"></a>      <span class="at">formula =</span> L <span class="sc">~</span> <span class="dv">1</span> <span class="sc">+</span> A <span class="sc">+</span> sdG,</span>
<span id="cb736-5"><a href="conditional-manatees.html#cb736-5" aria-hidden="true" tabindex="-1"></a>      <span class="at">prior =</span><span class="fu">c</span>(<span class="fu">prior</span>(<span class="fu">normal</span>(<span class="sc">-</span><span class="fl">5.5</span>, <span class="fl">1.5</span>), <span class="at">class =</span> Intercept),</span>
<span id="cb736-6"><a href="conditional-manatees.html#cb736-6" aria-hidden="true" tabindex="-1"></a>               <span class="fu">prior</span>(<span class="fu">normal</span>(<span class="dv">0</span>,<span class="dv">2</span>),<span class="at">class=</span>b),</span>
<span id="cb736-7"><a href="conditional-manatees.html#cb736-7" aria-hidden="true" tabindex="-1"></a>               <span class="fu">prior</span>(<span class="fu">exponential</span>(<span class="dv">1</span>),<span class="at">class=</span>sigma)),</span>
<span id="cb736-8"><a href="conditional-manatees.html#cb736-8" aria-hidden="true" tabindex="-1"></a>      <span class="at">seed =</span><span class="dv">8</span>, <span class="at">file =</span> <span class="st">&quot;output/Chapter8/b8H4.b_2&quot;</span>)</span></code></pre></div>
<p><br /></p>
<p>結果を見てみると…。</p>
<div class="sourceCode" id="cb737"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb737-1"><a href="conditional-manatees.html#cb737-1" aria-hidden="true" tabindex="-1"></a><span class="fu">posterior_summary</span>(b8H4.b)<span class="sc">%&gt;%</span> </span>
<span id="cb737-2"><a href="conditional-manatees.html#cb737-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">data.frame</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb737-3"><a href="conditional-manatees.html#cb737-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">round</span>(<span class="dv">2</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb737-4"><a href="conditional-manatees.html#cb737-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">gt</span>()</span></code></pre></div>
<div id="arnbxnudwo" style="padding-left:0px;padding-right:0px;padding-top:10px;padding-bottom:10px;overflow-x:auto;overflow-y:auto;width:auto;height:auto;">
<style>html {
  font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, Cantarell, 'Helvetica Neue', 'Fira Sans', 'Droid Sans', Arial, sans-serif;
}

#arnbxnudwo .gt_table {
  display: table;
  border-collapse: collapse;
  margin-left: auto;
  margin-right: auto;
  color: #333333;
  font-size: 16px;
  font-weight: normal;
  font-style: normal;
  background-color: #FFFFFF;
  width: auto;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #A8A8A8;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #A8A8A8;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
}

#arnbxnudwo .gt_heading {
  background-color: #FFFFFF;
  text-align: center;
  border-bottom-color: #FFFFFF;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#arnbxnudwo .gt_caption {
  padding-top: 4px;
  padding-bottom: 4px;
}

#arnbxnudwo .gt_title {
  color: #333333;
  font-size: 125%;
  font-weight: initial;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-color: #FFFFFF;
  border-bottom-width: 0;
}

#arnbxnudwo .gt_subtitle {
  color: #333333;
  font-size: 85%;
  font-weight: initial;
  padding-top: 0;
  padding-bottom: 6px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-color: #FFFFFF;
  border-top-width: 0;
}

#arnbxnudwo .gt_bottom_border {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#arnbxnudwo .gt_col_headings {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#arnbxnudwo .gt_col_heading {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 6px;
  padding-left: 5px;
  padding-right: 5px;
  overflow-x: hidden;
}

#arnbxnudwo .gt_column_spanner_outer {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  padding-top: 0;
  padding-bottom: 0;
  padding-left: 4px;
  padding-right: 4px;
}

#arnbxnudwo .gt_column_spanner_outer:first-child {
  padding-left: 0;
}

#arnbxnudwo .gt_column_spanner_outer:last-child {
  padding-right: 0;
}

#arnbxnudwo .gt_column_spanner {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 5px;
  overflow-x: hidden;
  display: inline-block;
  width: 100%;
}

#arnbxnudwo .gt_group_heading {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  text-align: left;
}

#arnbxnudwo .gt_empty_group_heading {
  padding: 0.5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: middle;
}

#arnbxnudwo .gt_from_md > :first-child {
  margin-top: 0;
}

#arnbxnudwo .gt_from_md > :last-child {
  margin-bottom: 0;
}

#arnbxnudwo .gt_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  margin: 10px;
  border-top-style: solid;
  border-top-width: 1px;
  border-top-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  overflow-x: hidden;
}

#arnbxnudwo .gt_stub {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
}

#arnbxnudwo .gt_stub_row_group {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
  vertical-align: top;
}

#arnbxnudwo .gt_row_group_first td {
  border-top-width: 2px;
}

#arnbxnudwo .gt_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#arnbxnudwo .gt_first_summary_row {
  border-top-style: solid;
  border-top-color: #D3D3D3;
}

#arnbxnudwo .gt_first_summary_row.thick {
  border-top-width: 2px;
}

#arnbxnudwo .gt_last_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#arnbxnudwo .gt_grand_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#arnbxnudwo .gt_first_grand_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-style: double;
  border-top-width: 6px;
  border-top-color: #D3D3D3;
}

#arnbxnudwo .gt_striped {
  background-color: rgba(128, 128, 128, 0.05);
}

#arnbxnudwo .gt_table_body {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#arnbxnudwo .gt_footnotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#arnbxnudwo .gt_footnote {
  margin: 0px;
  font-size: 90%;
  padding-left: 4px;
  padding-right: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#arnbxnudwo .gt_sourcenotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#arnbxnudwo .gt_sourcenote {
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#arnbxnudwo .gt_left {
  text-align: left;
}

#arnbxnudwo .gt_center {
  text-align: center;
}

#arnbxnudwo .gt_right {
  text-align: right;
  font-variant-numeric: tabular-nums;
}

#arnbxnudwo .gt_font_normal {
  font-weight: normal;
}

#arnbxnudwo .gt_font_bold {
  font-weight: bold;
}

#arnbxnudwo .gt_font_italic {
  font-style: italic;
}

#arnbxnudwo .gt_super {
  font-size: 65%;
}

#arnbxnudwo .gt_footnote_marks {
  font-style: italic;
  font-weight: normal;
  font-size: 75%;
  vertical-align: 0.4em;
}

#arnbxnudwo .gt_asterisk {
  font-size: 100%;
  vertical-align: 0;
}

#arnbxnudwo .gt_indent_1 {
  text-indent: 5px;
}

#arnbxnudwo .gt_indent_2 {
  text-indent: 10px;
}

#arnbxnudwo .gt_indent_3 {
  text-indent: 15px;
}

#arnbxnudwo .gt_indent_4 {
  text-indent: 20px;
}

#arnbxnudwo .gt_indent_5 {
  text-indent: 25px;
}
</style>
<table class="gt_table">
  
  <thead class="gt_col_headings">
    <tr>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1" scope="col" id="Estimate">Estimate</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1" scope="col" id="Est.Error">Est.Error</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1" scope="col" id="Q2.5">Q2.5</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1" scope="col" id="Q97.5">Q97.5</th>
    </tr>
  </thead>
  <tbody class="gt_table_body">
    <tr><td headers="Estimate" class="gt_row gt_right">-5.46</td>
<td headers="Est.Error" class="gt_row gt_right">0.17</td>
<td headers="Q2.5" class="gt_row gt_right">-5.78</td>
<td headers="Q97.5" class="gt_row gt_right">-5.12</td></tr>
    <tr><td headers="Estimate" class="gt_row gt_right">-0.38</td>
<td headers="Est.Error" class="gt_row gt_right">0.18</td>
<td headers="Q2.5" class="gt_row gt_right">-0.73</td>
<td headers="Q97.5" class="gt_row gt_right">-0.02</td></tr>
    <tr><td headers="Estimate" class="gt_row gt_right">1.49</td>
<td headers="Est.Error" class="gt_row gt_right">0.13</td>
<td headers="Q2.5" class="gt_row gt_right">1.27</td>
<td headers="Q97.5" class="gt_row gt_right">1.76</td></tr>
    <tr><td headers="Estimate" class="gt_row gt_right">-4.46</td>
<td headers="Est.Error" class="gt_row gt_right">0.13</td>
<td headers="Q2.5" class="gt_row gt_right">-4.73</td>
<td headers="Q97.5" class="gt_row gt_right">-4.23</td></tr>
    <tr><td headers="Estimate" class="gt_row gt_right">-138.65</td>
<td headers="Est.Error" class="gt_row gt_right">1.23</td>
<td headers="Q2.5" class="gt_row gt_right">-141.81</td>
<td headers="Q97.5" class="gt_row gt_right">-137.23</td></tr>
  </tbody>
  
  
</table>
</div>
<div class="sourceCode" id="cb738"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb738-1"><a href="conditional-manatees.html#cb738-1" aria-hidden="true" tabindex="-1"></a><span class="fu">posterior_summary</span>(b8H4.b_2)<span class="sc">%&gt;%</span> </span>
<span id="cb738-2"><a href="conditional-manatees.html#cb738-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">data.frame</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb738-3"><a href="conditional-manatees.html#cb738-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">round</span>(<span class="dv">2</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb738-4"><a href="conditional-manatees.html#cb738-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">gt</span>()</span></code></pre></div>
<div id="dknqhblerk" style="padding-left:0px;padding-right:0px;padding-top:10px;padding-bottom:10px;overflow-x:auto;overflow-y:auto;width:auto;height:auto;">
<style>html {
  font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, Cantarell, 'Helvetica Neue', 'Fira Sans', 'Droid Sans', Arial, sans-serif;
}

#dknqhblerk .gt_table {
  display: table;
  border-collapse: collapse;
  margin-left: auto;
  margin-right: auto;
  color: #333333;
  font-size: 16px;
  font-weight: normal;
  font-style: normal;
  background-color: #FFFFFF;
  width: auto;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #A8A8A8;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #A8A8A8;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
}

#dknqhblerk .gt_heading {
  background-color: #FFFFFF;
  text-align: center;
  border-bottom-color: #FFFFFF;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#dknqhblerk .gt_caption {
  padding-top: 4px;
  padding-bottom: 4px;
}

#dknqhblerk .gt_title {
  color: #333333;
  font-size: 125%;
  font-weight: initial;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-color: #FFFFFF;
  border-bottom-width: 0;
}

#dknqhblerk .gt_subtitle {
  color: #333333;
  font-size: 85%;
  font-weight: initial;
  padding-top: 0;
  padding-bottom: 6px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-color: #FFFFFF;
  border-top-width: 0;
}

#dknqhblerk .gt_bottom_border {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#dknqhblerk .gt_col_headings {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#dknqhblerk .gt_col_heading {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 6px;
  padding-left: 5px;
  padding-right: 5px;
  overflow-x: hidden;
}

#dknqhblerk .gt_column_spanner_outer {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  padding-top: 0;
  padding-bottom: 0;
  padding-left: 4px;
  padding-right: 4px;
}

#dknqhblerk .gt_column_spanner_outer:first-child {
  padding-left: 0;
}

#dknqhblerk .gt_column_spanner_outer:last-child {
  padding-right: 0;
}

#dknqhblerk .gt_column_spanner {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 5px;
  overflow-x: hidden;
  display: inline-block;
  width: 100%;
}

#dknqhblerk .gt_group_heading {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  text-align: left;
}

#dknqhblerk .gt_empty_group_heading {
  padding: 0.5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: middle;
}

#dknqhblerk .gt_from_md > :first-child {
  margin-top: 0;
}

#dknqhblerk .gt_from_md > :last-child {
  margin-bottom: 0;
}

#dknqhblerk .gt_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  margin: 10px;
  border-top-style: solid;
  border-top-width: 1px;
  border-top-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  overflow-x: hidden;
}

#dknqhblerk .gt_stub {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
}

#dknqhblerk .gt_stub_row_group {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
  vertical-align: top;
}

#dknqhblerk .gt_row_group_first td {
  border-top-width: 2px;
}

#dknqhblerk .gt_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#dknqhblerk .gt_first_summary_row {
  border-top-style: solid;
  border-top-color: #D3D3D3;
}

#dknqhblerk .gt_first_summary_row.thick {
  border-top-width: 2px;
}

#dknqhblerk .gt_last_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#dknqhblerk .gt_grand_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#dknqhblerk .gt_first_grand_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-style: double;
  border-top-width: 6px;
  border-top-color: #D3D3D3;
}

#dknqhblerk .gt_striped {
  background-color: rgba(128, 128, 128, 0.05);
}

#dknqhblerk .gt_table_body {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#dknqhblerk .gt_footnotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#dknqhblerk .gt_footnote {
  margin: 0px;
  font-size: 90%;
  padding-left: 4px;
  padding-right: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#dknqhblerk .gt_sourcenotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#dknqhblerk .gt_sourcenote {
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#dknqhblerk .gt_left {
  text-align: left;
}

#dknqhblerk .gt_center {
  text-align: center;
}

#dknqhblerk .gt_right {
  text-align: right;
  font-variant-numeric: tabular-nums;
}

#dknqhblerk .gt_font_normal {
  font-weight: normal;
}

#dknqhblerk .gt_font_bold {
  font-weight: bold;
}

#dknqhblerk .gt_font_italic {
  font-style: italic;
}

#dknqhblerk .gt_super {
  font-size: 65%;
}

#dknqhblerk .gt_footnote_marks {
  font-style: italic;
  font-weight: normal;
  font-size: 75%;
  vertical-align: 0.4em;
}

#dknqhblerk .gt_asterisk {
  font-size: 100%;
  vertical-align: 0;
}

#dknqhblerk .gt_indent_1 {
  text-indent: 5px;
}

#dknqhblerk .gt_indent_2 {
  text-indent: 10px;
}

#dknqhblerk .gt_indent_3 {
  text-indent: 15px;
}

#dknqhblerk .gt_indent_4 {
  text-indent: 20px;
}

#dknqhblerk .gt_indent_5 {
  text-indent: 25px;
}
</style>
<table class="gt_table">
  
  <thead class="gt_col_headings">
    <tr>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1" scope="col" id="Estimate">Estimate</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1" scope="col" id="Est.Error">Est.Error</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1" scope="col" id="Q2.5">Q2.5</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1" scope="col" id="Q97.5">Q97.5</th>
    </tr>
  </thead>
  <tbody class="gt_table_body">
    <tr><td headers="Estimate" class="gt_row gt_right">-5.45</td>
<td headers="Est.Error" class="gt_row gt_right">0.17</td>
<td headers="Q2.5" class="gt_row gt_right">-5.79</td>
<td headers="Q97.5" class="gt_row gt_right">-5.12</td></tr>
    <tr><td headers="Estimate" class="gt_row gt_right">-0.30</td>
<td headers="Est.Error" class="gt_row gt_right">0.20</td>
<td headers="Q2.5" class="gt_row gt_right">-0.70</td>
<td headers="Q97.5" class="gt_row gt_right">0.10</td></tr>
    <tr><td headers="Estimate" class="gt_row gt_right">-0.22</td>
<td headers="Est.Error" class="gt_row gt_right">0.20</td>
<td headers="Q2.5" class="gt_row gt_right">-0.63</td>
<td headers="Q97.5" class="gt_row gt_right">0.18</td></tr>
    <tr><td headers="Estimate" class="gt_row gt_right">1.48</td>
<td headers="Est.Error" class="gt_row gt_right">0.12</td>
<td headers="Q2.5" class="gt_row gt_right">1.27</td>
<td headers="Q97.5" class="gt_row gt_right">1.75</td></tr>
    <tr><td headers="Estimate" class="gt_row gt_right">-6.06</td>
<td headers="Est.Error" class="gt_row gt_right">0.13</td>
<td headers="Q2.5" class="gt_row gt_right">-6.34</td>
<td headers="Q97.5" class="gt_row gt_right">-5.84</td></tr>
    <tr><td headers="Estimate" class="gt_row gt_right">-139.58</td>
<td headers="Est.Error" class="gt_row gt_right">1.44</td>
<td headers="Q2.5" class="gt_row gt_right">-143.34</td>
<td headers="Q97.5" class="gt_row gt_right">-137.79</td></tr>
  </tbody>
  
  
</table>
</div>
<p><br/></p>
<p>PSISも比較。<br />
Aは加えても加えなくても変わらない。</p>
<div class="sourceCode" id="cb739"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb739-1"><a href="conditional-manatees.html#cb739-1" aria-hidden="true" tabindex="-1"></a>b8H4.b <span class="ot">&lt;-</span> <span class="fu">add_criterion</span>(b8H4.b, <span class="fu">c</span>(<span class="st">&quot;waic&quot;</span>,<span class="st">&quot;loo&quot;</span>))</span>
<span id="cb739-2"><a href="conditional-manatees.html#cb739-2" aria-hidden="true" tabindex="-1"></a>b8H4.b_2 <span class="ot">&lt;-</span> <span class="fu">add_criterion</span>(b8H4.b_2, <span class="fu">c</span>(<span class="st">&quot;waic&quot;</span>,<span class="st">&quot;loo&quot;</span>))　　</span>
<span id="cb739-3"><a href="conditional-manatees.html#cb739-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb739-4"><a href="conditional-manatees.html#cb739-4" aria-hidden="true" tabindex="-1"></a><span class="fu">loo_compare</span>(b8H4.b, b8H4.b_2) <span class="sc">%&gt;%</span> </span>
<span id="cb739-5"><a href="conditional-manatees.html#cb739-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">print</span>(<span class="at">simplify=</span>F) <span class="sc">%&gt;%</span> </span>
<span id="cb739-6"><a href="conditional-manatees.html#cb739-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">data.frame</span>() <span class="ot">-&gt;</span> loo_b</span></code></pre></div>
<pre><code>##          elpd_diff se_diff elpd_loo se_elpd_loo p_loo  se_p_loo looic  se_looic
## b8H4.b_2    0.0       0.0  -136.5      8.0         4.8    1.3    273.0   15.9  
## b8H4.b     -0.1       1.9  -136.6      8.2         3.7    1.1    273.1   16.5</code></pre>
<div class="sourceCode" id="cb741"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb741-1"><a href="conditional-manatees.html#cb741-1" aria-hidden="true" tabindex="-1"></a><span class="fu">model_weights</span>(b8H4.b, b8H4.b_2)</span></code></pre></div>
<pre><code>##    b8H4.b  b8H4.b_2 
## 0.4869283 0.5130717</code></pre>
<p><br /></p>
</div>
<div id="c" class="section level4 hasAnchor" number="8.4.5.3">
<h4><span class="header-section-number">8.4.5.3</span> c<a href="conditional-manatees.html#c" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<blockquote>
<p>Finally, evaluate the hypothesis that mean.growing.season and sd.growing.season interact to synergistically reduce language diversity. The idea is that, in nations with longer average growing seasons, high variance makes storage and redistribution even more important than it would be otherwise. That way, people can cooperate to preserve and protect windfalls to be used during the droughts.</p>
</blockquote>
<p>まずは、交互作用なしのモデルを考える。</p>
<div class="sourceCode" id="cb743"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb743-1"><a href="conditional-manatees.html#cb743-1" aria-hidden="true" tabindex="-1"></a>b8H4.c <span class="ot">&lt;-</span> </span>
<span id="cb743-2"><a href="conditional-manatees.html#cb743-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">brm</span>(<span class="at">data =</span> d5,</span>
<span id="cb743-3"><a href="conditional-manatees.html#cb743-3" aria-hidden="true" tabindex="-1"></a>      <span class="at">family =</span> gaussian,</span>
<span id="cb743-4"><a href="conditional-manatees.html#cb743-4" aria-hidden="true" tabindex="-1"></a>      <span class="at">formula =</span> L <span class="sc">~</span> <span class="dv">1</span> <span class="sc">+</span> A <span class="sc">+</span> meanG <span class="sc">+</span> sdG,</span>
<span id="cb743-5"><a href="conditional-manatees.html#cb743-5" aria-hidden="true" tabindex="-1"></a>      <span class="at">prior =</span><span class="fu">c</span>(<span class="fu">prior</span>(<span class="fu">normal</span>(<span class="sc">-</span><span class="fl">5.5</span>, <span class="fl">1.5</span>), <span class="at">class =</span> Intercept),</span>
<span id="cb743-6"><a href="conditional-manatees.html#cb743-6" aria-hidden="true" tabindex="-1"></a>               <span class="fu">prior</span>(<span class="fu">normal</span>(<span class="dv">0</span>,<span class="dv">2</span>),<span class="at">class=</span>b),</span>
<span id="cb743-7"><a href="conditional-manatees.html#cb743-7" aria-hidden="true" tabindex="-1"></a>               <span class="fu">prior</span>(<span class="fu">exponential</span>(<span class="dv">1</span>),<span class="at">class=</span>sigma)),</span>
<span id="cb743-8"><a href="conditional-manatees.html#cb743-8" aria-hidden="true" tabindex="-1"></a>      <span class="at">backend =</span> <span class="st">&quot;cmdstanr&quot;</span>,</span>
<span id="cb743-9"><a href="conditional-manatees.html#cb743-9" aria-hidden="true" tabindex="-1"></a>      <span class="at">seed =</span><span class="dv">8</span>, <span class="at">file =</span> <span class="st">&quot;output/Chapter8/b8H4.c&quot;</span>)</span>
<span id="cb743-10"><a href="conditional-manatees.html#cb743-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb743-11"><a href="conditional-manatees.html#cb743-11" aria-hidden="true" tabindex="-1"></a>b8H4.c <span class="ot">&lt;-</span> <span class="fu">add_criterion</span>(b8H4.c, <span class="fu">c</span>(<span class="st">&quot;waic&quot;</span>,<span class="st">&quot;loo&quot;</span>))</span>
<span id="cb743-12"><a href="conditional-manatees.html#cb743-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb743-13"><a href="conditional-manatees.html#cb743-13" aria-hidden="true" tabindex="-1"></a><span class="fu">posterior_summary</span>(b8H4.c)<span class="sc">%&gt;%</span> </span>
<span id="cb743-14"><a href="conditional-manatees.html#cb743-14" aria-hidden="true" tabindex="-1"></a>   <span class="fu">data.frame</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb743-15"><a href="conditional-manatees.html#cb743-15" aria-hidden="true" tabindex="-1"></a>   <span class="fu">round</span>(<span class="dv">2</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb743-16"><a href="conditional-manatees.html#cb743-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">gt</span>()</span></code></pre></div>
<div id="hxzjyxcrfh" style="padding-left:0px;padding-right:0px;padding-top:10px;padding-bottom:10px;overflow-x:auto;overflow-y:auto;width:auto;height:auto;">
<style>html {
  font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, Cantarell, 'Helvetica Neue', 'Fira Sans', 'Droid Sans', Arial, sans-serif;
}

#hxzjyxcrfh .gt_table {
  display: table;
  border-collapse: collapse;
  margin-left: auto;
  margin-right: auto;
  color: #333333;
  font-size: 16px;
  font-weight: normal;
  font-style: normal;
  background-color: #FFFFFF;
  width: auto;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #A8A8A8;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #A8A8A8;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
}

#hxzjyxcrfh .gt_heading {
  background-color: #FFFFFF;
  text-align: center;
  border-bottom-color: #FFFFFF;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#hxzjyxcrfh .gt_caption {
  padding-top: 4px;
  padding-bottom: 4px;
}

#hxzjyxcrfh .gt_title {
  color: #333333;
  font-size: 125%;
  font-weight: initial;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-color: #FFFFFF;
  border-bottom-width: 0;
}

#hxzjyxcrfh .gt_subtitle {
  color: #333333;
  font-size: 85%;
  font-weight: initial;
  padding-top: 0;
  padding-bottom: 6px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-color: #FFFFFF;
  border-top-width: 0;
}

#hxzjyxcrfh .gt_bottom_border {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#hxzjyxcrfh .gt_col_headings {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#hxzjyxcrfh .gt_col_heading {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 6px;
  padding-left: 5px;
  padding-right: 5px;
  overflow-x: hidden;
}

#hxzjyxcrfh .gt_column_spanner_outer {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  padding-top: 0;
  padding-bottom: 0;
  padding-left: 4px;
  padding-right: 4px;
}

#hxzjyxcrfh .gt_column_spanner_outer:first-child {
  padding-left: 0;
}

#hxzjyxcrfh .gt_column_spanner_outer:last-child {
  padding-right: 0;
}

#hxzjyxcrfh .gt_column_spanner {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 5px;
  overflow-x: hidden;
  display: inline-block;
  width: 100%;
}

#hxzjyxcrfh .gt_group_heading {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  text-align: left;
}

#hxzjyxcrfh .gt_empty_group_heading {
  padding: 0.5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: middle;
}

#hxzjyxcrfh .gt_from_md > :first-child {
  margin-top: 0;
}

#hxzjyxcrfh .gt_from_md > :last-child {
  margin-bottom: 0;
}

#hxzjyxcrfh .gt_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  margin: 10px;
  border-top-style: solid;
  border-top-width: 1px;
  border-top-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  overflow-x: hidden;
}

#hxzjyxcrfh .gt_stub {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
}

#hxzjyxcrfh .gt_stub_row_group {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
  vertical-align: top;
}

#hxzjyxcrfh .gt_row_group_first td {
  border-top-width: 2px;
}

#hxzjyxcrfh .gt_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#hxzjyxcrfh .gt_first_summary_row {
  border-top-style: solid;
  border-top-color: #D3D3D3;
}

#hxzjyxcrfh .gt_first_summary_row.thick {
  border-top-width: 2px;
}

#hxzjyxcrfh .gt_last_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#hxzjyxcrfh .gt_grand_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#hxzjyxcrfh .gt_first_grand_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-style: double;
  border-top-width: 6px;
  border-top-color: #D3D3D3;
}

#hxzjyxcrfh .gt_striped {
  background-color: rgba(128, 128, 128, 0.05);
}

#hxzjyxcrfh .gt_table_body {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#hxzjyxcrfh .gt_footnotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#hxzjyxcrfh .gt_footnote {
  margin: 0px;
  font-size: 90%;
  padding-left: 4px;
  padding-right: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#hxzjyxcrfh .gt_sourcenotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#hxzjyxcrfh .gt_sourcenote {
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#hxzjyxcrfh .gt_left {
  text-align: left;
}

#hxzjyxcrfh .gt_center {
  text-align: center;
}

#hxzjyxcrfh .gt_right {
  text-align: right;
  font-variant-numeric: tabular-nums;
}

#hxzjyxcrfh .gt_font_normal {
  font-weight: normal;
}

#hxzjyxcrfh .gt_font_bold {
  font-weight: bold;
}

#hxzjyxcrfh .gt_font_italic {
  font-style: italic;
}

#hxzjyxcrfh .gt_super {
  font-size: 65%;
}

#hxzjyxcrfh .gt_footnote_marks {
  font-style: italic;
  font-weight: normal;
  font-size: 75%;
  vertical-align: 0.4em;
}

#hxzjyxcrfh .gt_asterisk {
  font-size: 100%;
  vertical-align: 0;
}

#hxzjyxcrfh .gt_indent_1 {
  text-indent: 5px;
}

#hxzjyxcrfh .gt_indent_2 {
  text-indent: 10px;
}

#hxzjyxcrfh .gt_indent_3 {
  text-indent: 15px;
}

#hxzjyxcrfh .gt_indent_4 {
  text-indent: 20px;
}

#hxzjyxcrfh .gt_indent_5 {
  text-indent: 25px;
}
</style>
<table class="gt_table">
  
  <thead class="gt_col_headings">
    <tr>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1" scope="col" id="Estimate">Estimate</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1" scope="col" id="Est.Error">Est.Error</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1" scope="col" id="Q2.5">Q2.5</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1" scope="col" id="Q97.5">Q97.5</th>
    </tr>
  </thead>
  <tbody class="gt_table_body">
    <tr><td headers="Estimate" class="gt_row gt_right">-5.46</td>
<td headers="Est.Error" class="gt_row gt_right">0.16</td>
<td headers="Q2.5" class="gt_row gt_right">-5.79</td>
<td headers="Q97.5" class="gt_row gt_right">-5.14</td></tr>
    <tr><td headers="Estimate" class="gt_row gt_right">-0.02</td>
<td headers="Est.Error" class="gt_row gt_right">0.22</td>
<td headers="Q2.5" class="gt_row gt_right">-0.45</td>
<td headers="Q97.5" class="gt_row gt_right">0.40</td></tr>
    <tr><td headers="Estimate" class="gt_row gt_right">0.54</td>
<td headers="Est.Error" class="gt_row gt_right">0.18</td>
<td headers="Q2.5" class="gt_row gt_right">0.18</td>
<td headers="Q97.5" class="gt_row gt_right">0.90</td></tr>
    <tr><td headers="Estimate" class="gt_row gt_right">-0.38</td>
<td headers="Est.Error" class="gt_row gt_right">0.21</td>
<td headers="Q2.5" class="gt_row gt_right">-0.80</td>
<td headers="Q97.5" class="gt_row gt_right">0.02</td></tr>
    <tr><td headers="Estimate" class="gt_row gt_right">1.40</td>
<td headers="Est.Error" class="gt_row gt_right">0.12</td>
<td headers="Q2.5" class="gt_row gt_right">1.19</td>
<td headers="Q97.5" class="gt_row gt_right">1.66</td></tr>
    <tr><td headers="Estimate" class="gt_row gt_right">-7.64</td>
<td headers="Est.Error" class="gt_row gt_right">0.13</td>
<td headers="Q2.5" class="gt_row gt_right">-7.92</td>
<td headers="Q97.5" class="gt_row gt_right">-7.41</td></tr>
    <tr><td headers="Estimate" class="gt_row gt_right">-137.26</td>
<td headers="Est.Error" class="gt_row gt_right">1.66</td>
<td headers="Q2.5" class="gt_row gt_right">-141.34</td>
<td headers="Q97.5" class="gt_row gt_right">-135.08</td></tr>
  </tbody>
  
  
</table>
</div>
<p><br /></p>
<p>続いて、交互作用ありのモデル。<br />
交互作用が強く働いていそう。</p>
<div class="sourceCode" id="cb744"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb744-1"><a href="conditional-manatees.html#cb744-1" aria-hidden="true" tabindex="-1"></a>b8H4.c_2 <span class="ot">&lt;-</span> </span>
<span id="cb744-2"><a href="conditional-manatees.html#cb744-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">brm</span>(<span class="at">data =</span> d5,</span>
<span id="cb744-3"><a href="conditional-manatees.html#cb744-3" aria-hidden="true" tabindex="-1"></a>      <span class="at">family =</span> gaussian,</span>
<span id="cb744-4"><a href="conditional-manatees.html#cb744-4" aria-hidden="true" tabindex="-1"></a>      <span class="at">formula =</span> L <span class="sc">~</span> <span class="dv">1</span> <span class="sc">+</span> A <span class="sc">+</span> meanG <span class="sc">+</span> sdG <span class="sc">+</span> meanG<span class="sc">:</span>sdG,</span>
<span id="cb744-5"><a href="conditional-manatees.html#cb744-5" aria-hidden="true" tabindex="-1"></a>      <span class="at">prior =</span><span class="fu">c</span>(<span class="fu">prior</span>(<span class="fu">normal</span>(<span class="sc">-</span><span class="fl">5.5</span>, <span class="fl">1.5</span>), <span class="at">class =</span> Intercept),</span>
<span id="cb744-6"><a href="conditional-manatees.html#cb744-6" aria-hidden="true" tabindex="-1"></a>               <span class="fu">prior</span>(<span class="fu">normal</span>(<span class="dv">0</span>,<span class="dv">2</span>),<span class="at">class=</span>b),</span>
<span id="cb744-7"><a href="conditional-manatees.html#cb744-7" aria-hidden="true" tabindex="-1"></a>               <span class="fu">prior</span>(<span class="fu">exponential</span>(<span class="dv">1</span>),<span class="at">class=</span>sigma)),</span>
<span id="cb744-8"><a href="conditional-manatees.html#cb744-8" aria-hidden="true" tabindex="-1"></a>      <span class="at">backend =</span> <span class="st">&quot;cmdstanr&quot;</span>,</span>
<span id="cb744-9"><a href="conditional-manatees.html#cb744-9" aria-hidden="true" tabindex="-1"></a>      <span class="at">seed =</span><span class="dv">8</span>, <span class="at">file =</span> <span class="st">&quot;output/Chapter8/b8H4.c_2&quot;</span>)</span>
<span id="cb744-10"><a href="conditional-manatees.html#cb744-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb744-11"><a href="conditional-manatees.html#cb744-11" aria-hidden="true" tabindex="-1"></a>b8H4.c_2 <span class="ot">&lt;-</span> <span class="fu">add_criterion</span>(b8H4.c_2, <span class="fu">c</span>(<span class="st">&quot;waic&quot;</span>,<span class="st">&quot;loo&quot;</span>))</span>
<span id="cb744-12"><a href="conditional-manatees.html#cb744-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb744-13"><a href="conditional-manatees.html#cb744-13" aria-hidden="true" tabindex="-1"></a><span class="fu">posterior_summary</span>(b8H4.c_2)<span class="sc">%&gt;%</span> </span>
<span id="cb744-14"><a href="conditional-manatees.html#cb744-14" aria-hidden="true" tabindex="-1"></a>   <span class="fu">data.frame</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb744-15"><a href="conditional-manatees.html#cb744-15" aria-hidden="true" tabindex="-1"></a>   <span class="fu">round</span>(<span class="dv">2</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb744-16"><a href="conditional-manatees.html#cb744-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">gt</span>()</span></code></pre></div>
<div id="oetvelaufc" style="padding-left:0px;padding-right:0px;padding-top:10px;padding-bottom:10px;overflow-x:auto;overflow-y:auto;width:auto;height:auto;">
<style>html {
  font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, Cantarell, 'Helvetica Neue', 'Fira Sans', 'Droid Sans', Arial, sans-serif;
}

#oetvelaufc .gt_table {
  display: table;
  border-collapse: collapse;
  margin-left: auto;
  margin-right: auto;
  color: #333333;
  font-size: 16px;
  font-weight: normal;
  font-style: normal;
  background-color: #FFFFFF;
  width: auto;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #A8A8A8;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #A8A8A8;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
}

#oetvelaufc .gt_heading {
  background-color: #FFFFFF;
  text-align: center;
  border-bottom-color: #FFFFFF;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#oetvelaufc .gt_caption {
  padding-top: 4px;
  padding-bottom: 4px;
}

#oetvelaufc .gt_title {
  color: #333333;
  font-size: 125%;
  font-weight: initial;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-color: #FFFFFF;
  border-bottom-width: 0;
}

#oetvelaufc .gt_subtitle {
  color: #333333;
  font-size: 85%;
  font-weight: initial;
  padding-top: 0;
  padding-bottom: 6px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-color: #FFFFFF;
  border-top-width: 0;
}

#oetvelaufc .gt_bottom_border {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#oetvelaufc .gt_col_headings {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#oetvelaufc .gt_col_heading {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 6px;
  padding-left: 5px;
  padding-right: 5px;
  overflow-x: hidden;
}

#oetvelaufc .gt_column_spanner_outer {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  padding-top: 0;
  padding-bottom: 0;
  padding-left: 4px;
  padding-right: 4px;
}

#oetvelaufc .gt_column_spanner_outer:first-child {
  padding-left: 0;
}

#oetvelaufc .gt_column_spanner_outer:last-child {
  padding-right: 0;
}

#oetvelaufc .gt_column_spanner {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 5px;
  overflow-x: hidden;
  display: inline-block;
  width: 100%;
}

#oetvelaufc .gt_group_heading {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  text-align: left;
}

#oetvelaufc .gt_empty_group_heading {
  padding: 0.5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: middle;
}

#oetvelaufc .gt_from_md > :first-child {
  margin-top: 0;
}

#oetvelaufc .gt_from_md > :last-child {
  margin-bottom: 0;
}

#oetvelaufc .gt_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  margin: 10px;
  border-top-style: solid;
  border-top-width: 1px;
  border-top-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  overflow-x: hidden;
}

#oetvelaufc .gt_stub {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
}

#oetvelaufc .gt_stub_row_group {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
  vertical-align: top;
}

#oetvelaufc .gt_row_group_first td {
  border-top-width: 2px;
}

#oetvelaufc .gt_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#oetvelaufc .gt_first_summary_row {
  border-top-style: solid;
  border-top-color: #D3D3D3;
}

#oetvelaufc .gt_first_summary_row.thick {
  border-top-width: 2px;
}

#oetvelaufc .gt_last_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#oetvelaufc .gt_grand_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#oetvelaufc .gt_first_grand_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-style: double;
  border-top-width: 6px;
  border-top-color: #D3D3D3;
}

#oetvelaufc .gt_striped {
  background-color: rgba(128, 128, 128, 0.05);
}

#oetvelaufc .gt_table_body {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#oetvelaufc .gt_footnotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#oetvelaufc .gt_footnote {
  margin: 0px;
  font-size: 90%;
  padding-left: 4px;
  padding-right: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#oetvelaufc .gt_sourcenotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#oetvelaufc .gt_sourcenote {
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#oetvelaufc .gt_left {
  text-align: left;
}

#oetvelaufc .gt_center {
  text-align: center;
}

#oetvelaufc .gt_right {
  text-align: right;
  font-variant-numeric: tabular-nums;
}

#oetvelaufc .gt_font_normal {
  font-weight: normal;
}

#oetvelaufc .gt_font_bold {
  font-weight: bold;
}

#oetvelaufc .gt_font_italic {
  font-style: italic;
}

#oetvelaufc .gt_super {
  font-size: 65%;
}

#oetvelaufc .gt_footnote_marks {
  font-style: italic;
  font-weight: normal;
  font-size: 75%;
  vertical-align: 0.4em;
}

#oetvelaufc .gt_asterisk {
  font-size: 100%;
  vertical-align: 0;
}

#oetvelaufc .gt_indent_1 {
  text-indent: 5px;
}

#oetvelaufc .gt_indent_2 {
  text-indent: 10px;
}

#oetvelaufc .gt_indent_3 {
  text-indent: 15px;
}

#oetvelaufc .gt_indent_4 {
  text-indent: 20px;
}

#oetvelaufc .gt_indent_5 {
  text-indent: 25px;
}
</style>
<table class="gt_table">
  
  <thead class="gt_col_headings">
    <tr>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1" scope="col" id="Estimate">Estimate</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1" scope="col" id="Est.Error">Est.Error</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1" scope="col" id="Q2.5">Q2.5</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1" scope="col" id="Q97.5">Q97.5</th>
    </tr>
  </thead>
  <tbody class="gt_table_body">
    <tr><td headers="Estimate" class="gt_row gt_right">-5.45</td>
<td headers="Est.Error" class="gt_row gt_right">0.16</td>
<td headers="Q2.5" class="gt_row gt_right">-5.76</td>
<td headers="Q97.5" class="gt_row gt_right">-5.14</td></tr>
    <tr><td headers="Estimate" class="gt_row gt_right">-0.02</td>
<td headers="Est.Error" class="gt_row gt_right">0.21</td>
<td headers="Q2.5" class="gt_row gt_right">-0.42</td>
<td headers="Q97.5" class="gt_row gt_right">0.40</td></tr>
    <tr><td headers="Estimate" class="gt_row gt_right">0.35</td>
<td headers="Est.Error" class="gt_row gt_right">0.20</td>
<td headers="Q2.5" class="gt_row gt_right">-0.04</td>
<td headers="Q97.5" class="gt_row gt_right">0.75</td></tr>
    <tr><td headers="Estimate" class="gt_row gt_right">-0.35</td>
<td headers="Est.Error" class="gt_row gt_right">0.19</td>
<td headers="Q2.5" class="gt_row gt_right">-0.73</td>
<td headers="Q97.5" class="gt_row gt_right">0.04</td></tr>
    <tr><td headers="Estimate" class="gt_row gt_right">-0.37</td>
<td headers="Est.Error" class="gt_row gt_right">0.16</td>
<td headers="Q2.5" class="gt_row gt_right">-0.68</td>
<td headers="Q97.5" class="gt_row gt_right">-0.06</td></tr>
    <tr><td headers="Estimate" class="gt_row gt_right">1.36</td>
<td headers="Est.Error" class="gt_row gt_right">0.12</td>
<td headers="Q2.5" class="gt_row gt_right">1.15</td>
<td headers="Q97.5" class="gt_row gt_right">1.62</td></tr>
    <tr><td headers="Estimate" class="gt_row gt_right">-9.21</td>
<td headers="Est.Error" class="gt_row gt_right">0.13</td>
<td headers="Q2.5" class="gt_row gt_right">-9.48</td>
<td headers="Q97.5" class="gt_row gt_right">-8.98</td></tr>
    <tr><td headers="Estimate" class="gt_row gt_right">-136.81</td>
<td headers="Est.Error" class="gt_row gt_right">1.81</td>
<td headers="Q2.5" class="gt_row gt_right">-141.27</td>
<td headers="Q97.5" class="gt_row gt_right">-134.28</td></tr>
  </tbody>
  
  
</table>
</div>
<p><br /></p>
<p>Aはほとんど効果がないので、おそらくmeanGとsdGでLへのルートをすべてブロックされている。Aを外したモデルも回してみる。</p>
<div class="sourceCode" id="cb745"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb745-1"><a href="conditional-manatees.html#cb745-1" aria-hidden="true" tabindex="-1"></a>b8H4.c_3 <span class="ot">&lt;-</span> </span>
<span id="cb745-2"><a href="conditional-manatees.html#cb745-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">brm</span>(<span class="at">data =</span> d5,</span>
<span id="cb745-3"><a href="conditional-manatees.html#cb745-3" aria-hidden="true" tabindex="-1"></a>      <span class="at">family =</span> gaussian,</span>
<span id="cb745-4"><a href="conditional-manatees.html#cb745-4" aria-hidden="true" tabindex="-1"></a>      <span class="at">formula =</span> L <span class="sc">~</span> <span class="dv">1</span> <span class="sc">+</span> meanG <span class="sc">+</span> sdG <span class="sc">+</span> meanG<span class="sc">:</span>sdG,</span>
<span id="cb745-5"><a href="conditional-manatees.html#cb745-5" aria-hidden="true" tabindex="-1"></a>      <span class="at">prior =</span><span class="fu">c</span>(<span class="fu">prior</span>(<span class="fu">normal</span>(<span class="sc">-</span><span class="fl">5.5</span>, <span class="fl">1.5</span>), <span class="at">class =</span> Intercept),</span>
<span id="cb745-6"><a href="conditional-manatees.html#cb745-6" aria-hidden="true" tabindex="-1"></a>               <span class="fu">prior</span>(<span class="fu">normal</span>(<span class="dv">0</span>,<span class="dv">2</span>),<span class="at">class=</span>b),</span>
<span id="cb745-7"><a href="conditional-manatees.html#cb745-7" aria-hidden="true" tabindex="-1"></a>               <span class="fu">prior</span>(<span class="fu">exponential</span>(<span class="dv">1</span>),<span class="at">class=</span>sigma)),</span>
<span id="cb745-8"><a href="conditional-manatees.html#cb745-8" aria-hidden="true" tabindex="-1"></a>      <span class="at">backend =</span> <span class="st">&quot;cmdstanr&quot;</span>,</span>
<span id="cb745-9"><a href="conditional-manatees.html#cb745-9" aria-hidden="true" tabindex="-1"></a>      <span class="at">seed =</span><span class="dv">8</span>, <span class="at">file =</span> <span class="st">&quot;output/Chapter8/b8H4.c_3&quot;</span>)</span>
<span id="cb745-10"><a href="conditional-manatees.html#cb745-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb745-11"><a href="conditional-manatees.html#cb745-11" aria-hidden="true" tabindex="-1"></a>b8H4.c_3 <span class="ot">&lt;-</span> <span class="fu">add_criterion</span>(b8H4.c_3, <span class="fu">c</span>(<span class="st">&quot;waic&quot;</span>, <span class="st">&quot;loo&quot;</span>))</span>
<span id="cb745-12"><a href="conditional-manatees.html#cb745-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb745-13"><a href="conditional-manatees.html#cb745-13" aria-hidden="true" tabindex="-1"></a><span class="fu">posterior_summary</span>(b8H4.c_3)<span class="sc">%&gt;%</span> </span>
<span id="cb745-14"><a href="conditional-manatees.html#cb745-14" aria-hidden="true" tabindex="-1"></a>   <span class="fu">data.frame</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb745-15"><a href="conditional-manatees.html#cb745-15" aria-hidden="true" tabindex="-1"></a>   <span class="fu">round</span>(<span class="dv">2</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb745-16"><a href="conditional-manatees.html#cb745-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">gt</span>()</span></code></pre></div>
<div id="umuyhdvnha" style="padding-left:0px;padding-right:0px;padding-top:10px;padding-bottom:10px;overflow-x:auto;overflow-y:auto;width:auto;height:auto;">
<style>html {
  font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, Cantarell, 'Helvetica Neue', 'Fira Sans', 'Droid Sans', Arial, sans-serif;
}

#umuyhdvnha .gt_table {
  display: table;
  border-collapse: collapse;
  margin-left: auto;
  margin-right: auto;
  color: #333333;
  font-size: 16px;
  font-weight: normal;
  font-style: normal;
  background-color: #FFFFFF;
  width: auto;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #A8A8A8;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #A8A8A8;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
}

#umuyhdvnha .gt_heading {
  background-color: #FFFFFF;
  text-align: center;
  border-bottom-color: #FFFFFF;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#umuyhdvnha .gt_caption {
  padding-top: 4px;
  padding-bottom: 4px;
}

#umuyhdvnha .gt_title {
  color: #333333;
  font-size: 125%;
  font-weight: initial;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-color: #FFFFFF;
  border-bottom-width: 0;
}

#umuyhdvnha .gt_subtitle {
  color: #333333;
  font-size: 85%;
  font-weight: initial;
  padding-top: 0;
  padding-bottom: 6px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-color: #FFFFFF;
  border-top-width: 0;
}

#umuyhdvnha .gt_bottom_border {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#umuyhdvnha .gt_col_headings {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#umuyhdvnha .gt_col_heading {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 6px;
  padding-left: 5px;
  padding-right: 5px;
  overflow-x: hidden;
}

#umuyhdvnha .gt_column_spanner_outer {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  padding-top: 0;
  padding-bottom: 0;
  padding-left: 4px;
  padding-right: 4px;
}

#umuyhdvnha .gt_column_spanner_outer:first-child {
  padding-left: 0;
}

#umuyhdvnha .gt_column_spanner_outer:last-child {
  padding-right: 0;
}

#umuyhdvnha .gt_column_spanner {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 5px;
  overflow-x: hidden;
  display: inline-block;
  width: 100%;
}

#umuyhdvnha .gt_group_heading {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  text-align: left;
}

#umuyhdvnha .gt_empty_group_heading {
  padding: 0.5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: middle;
}

#umuyhdvnha .gt_from_md > :first-child {
  margin-top: 0;
}

#umuyhdvnha .gt_from_md > :last-child {
  margin-bottom: 0;
}

#umuyhdvnha .gt_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  margin: 10px;
  border-top-style: solid;
  border-top-width: 1px;
  border-top-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  overflow-x: hidden;
}

#umuyhdvnha .gt_stub {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
}

#umuyhdvnha .gt_stub_row_group {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
  vertical-align: top;
}

#umuyhdvnha .gt_row_group_first td {
  border-top-width: 2px;
}

#umuyhdvnha .gt_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#umuyhdvnha .gt_first_summary_row {
  border-top-style: solid;
  border-top-color: #D3D3D3;
}

#umuyhdvnha .gt_first_summary_row.thick {
  border-top-width: 2px;
}

#umuyhdvnha .gt_last_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#umuyhdvnha .gt_grand_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#umuyhdvnha .gt_first_grand_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-style: double;
  border-top-width: 6px;
  border-top-color: #D3D3D3;
}

#umuyhdvnha .gt_striped {
  background-color: rgba(128, 128, 128, 0.05);
}

#umuyhdvnha .gt_table_body {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#umuyhdvnha .gt_footnotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#umuyhdvnha .gt_footnote {
  margin: 0px;
  font-size: 90%;
  padding-left: 4px;
  padding-right: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#umuyhdvnha .gt_sourcenotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#umuyhdvnha .gt_sourcenote {
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#umuyhdvnha .gt_left {
  text-align: left;
}

#umuyhdvnha .gt_center {
  text-align: center;
}

#umuyhdvnha .gt_right {
  text-align: right;
  font-variant-numeric: tabular-nums;
}

#umuyhdvnha .gt_font_normal {
  font-weight: normal;
}

#umuyhdvnha .gt_font_bold {
  font-weight: bold;
}

#umuyhdvnha .gt_font_italic {
  font-style: italic;
}

#umuyhdvnha .gt_super {
  font-size: 65%;
}

#umuyhdvnha .gt_footnote_marks {
  font-style: italic;
  font-weight: normal;
  font-size: 75%;
  vertical-align: 0.4em;
}

#umuyhdvnha .gt_asterisk {
  font-size: 100%;
  vertical-align: 0;
}

#umuyhdvnha .gt_indent_1 {
  text-indent: 5px;
}

#umuyhdvnha .gt_indent_2 {
  text-indent: 10px;
}

#umuyhdvnha .gt_indent_3 {
  text-indent: 15px;
}

#umuyhdvnha .gt_indent_4 {
  text-indent: 20px;
}

#umuyhdvnha .gt_indent_5 {
  text-indent: 25px;
}
</style>
<table class="gt_table">
  
  <thead class="gt_col_headings">
    <tr>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1" scope="col" id="Estimate">Estimate</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1" scope="col" id="Est.Error">Est.Error</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1" scope="col" id="Q2.5">Q2.5</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1" scope="col" id="Q97.5">Q97.5</th>
    </tr>
  </thead>
  <tbody class="gt_table_body">
    <tr><td headers="Estimate" class="gt_row gt_right">-5.45</td>
<td headers="Est.Error" class="gt_row gt_right">0.15</td>
<td headers="Q2.5" class="gt_row gt_right">-5.75</td>
<td headers="Q97.5" class="gt_row gt_right">-5.15</td></tr>
    <tr><td headers="Estimate" class="gt_row gt_right">0.37</td>
<td headers="Est.Error" class="gt_row gt_right">0.18</td>
<td headers="Q2.5" class="gt_row gt_right">0.01</td>
<td headers="Q97.5" class="gt_row gt_right">0.72</td></tr>
    <tr><td headers="Estimate" class="gt_row gt_right">-0.37</td>
<td headers="Est.Error" class="gt_row gt_right">0.16</td>
<td headers="Q2.5" class="gt_row gt_right">-0.68</td>
<td headers="Q97.5" class="gt_row gt_right">-0.05</td></tr>
    <tr><td headers="Estimate" class="gt_row gt_right">-0.36</td>
<td headers="Est.Error" class="gt_row gt_right">0.16</td>
<td headers="Q2.5" class="gt_row gt_right">-0.68</td>
<td headers="Q97.5" class="gt_row gt_right">-0.05</td></tr>
    <tr><td headers="Estimate" class="gt_row gt_right">1.35</td>
<td headers="Est.Error" class="gt_row gt_right">0.12</td>
<td headers="Q2.5" class="gt_row gt_right">1.15</td>
<td headers="Q97.5" class="gt_row gt_right">1.60</td></tr>
    <tr><td headers="Estimate" class="gt_row gt_right">-7.58</td>
<td headers="Est.Error" class="gt_row gt_right">0.12</td>
<td headers="Q2.5" class="gt_row gt_right">-7.84</td>
<td headers="Q97.5" class="gt_row gt_right">-7.37</td></tr>
    <tr><td headers="Estimate" class="gt_row gt_right">-134.57</td>
<td headers="Est.Error" class="gt_row gt_right">1.62</td>
<td headers="Q2.5" class="gt_row gt_right">-138.58</td>
<td headers="Q97.5" class="gt_row gt_right">-132.45</td></tr>
  </tbody>
  
  
</table>
</div>
<p><br /></p>
<p>全てのモデルのPSISを比較してみる。
最後のmeanGとsdGおよびその交互作用だけのモデルが最もPSISが低い。</p>
<div class="sourceCode" id="cb746"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb746-1"><a href="conditional-manatees.html#cb746-1" aria-hidden="true" tabindex="-1"></a><span class="fu">loo_compare</span>(b8H4.c, b8H4.c_2, b8H4.c_3, <span class="at">criterion=</span><span class="st">&quot;loo&quot;</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb746-2"><a href="conditional-manatees.html#cb746-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">print</span>(<span class="at">simplify=</span>F) <span class="sc">%&gt;%</span> </span>
<span id="cb746-3"><a href="conditional-manatees.html#cb746-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">data.frame</span>() <span class="ot">-&gt;</span> loo_c</span></code></pre></div>
<pre><code>##          elpd_diff se_diff elpd_loo se_elpd_loo p_loo  se_p_loo looic  se_looic
## b8H4.c_3    0.0       0.0  -130.2      7.4         5.2    1.2    260.4   14.9  
## b8H4.c_2   -1.4       0.2  -131.6      7.5         6.4    1.5    263.1   15.1  
## b8H4.c     -2.8       2.3  -133.0      7.4         5.5    1.4    266.0   14.8</code></pre>
<div class="sourceCode" id="cb748"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb748-1"><a href="conditional-manatees.html#cb748-1" aria-hidden="true" tabindex="-1"></a><span class="fu">bind_rows</span>(loo_a, loo_b, loo_c) <span class="sc">%&gt;%</span> </span>
<span id="cb748-2"><a href="conditional-manatees.html#cb748-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(looic) <span class="sc">%&gt;%</span> </span>
<span id="cb748-3"><a href="conditional-manatees.html#cb748-3" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">select</span>(looic, se_looic)</span></code></pre></div>
<pre><code>##             looic se_looic
## b8H4.c_3 260.3982 14.89968
## b8H4.c_2 263.1379 15.07885
## b8H4.c   266.0279 14.84678
## b8H4.a_2 267.3554 14.64422
## b8H4.a   267.8227 15.05103
## b8H4.b_2 273.0191 15.92537
## b8H4.b   273.1233 16.45595</code></pre>
<p><br /></p>
<p>プロットしてみる。</p>
<div class="sourceCode" id="cb750"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb750-1"><a href="conditional-manatees.html#cb750-1" aria-hidden="true" tabindex="-1"></a>seq <span class="ot">&lt;-</span> <span class="fu">crossing</span>(<span class="at">meanG =</span> <span class="fu">seq</span>(<span class="sc">-</span><span class="fl">2.5</span>, <span class="dv">2</span>, <span class="at">length.out =</span> <span class="dv">50</span>),</span>
<span id="cb750-2"><a href="conditional-manatees.html#cb750-2" aria-hidden="true" tabindex="-1"></a>              <span class="at">sdG =</span> <span class="fu">c</span>(<span class="fu">quantile</span>(d5<span class="sc">$</span>sdG,<span class="fl">0.1</span>)[[<span class="dv">1</span>]],</span>
<span id="cb750-3"><a href="conditional-manatees.html#cb750-3" aria-hidden="true" tabindex="-1"></a>                      <span class="fu">quantile</span>(d5<span class="sc">$</span>sdG,<span class="fl">0.5</span>)[[<span class="dv">1</span>]],</span>
<span id="cb750-4"><a href="conditional-manatees.html#cb750-4" aria-hidden="true" tabindex="-1"></a>                      <span class="fu">quantile</span>(d5<span class="sc">$</span>sdG,<span class="fl">0.9</span>)[[<span class="dv">1</span>]]))</span>
<span id="cb750-5"><a href="conditional-manatees.html#cb750-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb750-6"><a href="conditional-manatees.html#cb750-6" aria-hidden="true" tabindex="-1"></a><span class="fu">fitted</span>(b8H4.c_3, <span class="at">newdata =</span> seq) <span class="sc">%&gt;%</span> </span>
<span id="cb750-7"><a href="conditional-manatees.html#cb750-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">data.frame</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb750-8"><a href="conditional-manatees.html#cb750-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">bind_cols</span>(seq) <span class="sc">%&gt;%</span> </span>
<span id="cb750-9"><a href="conditional-manatees.html#cb750-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">cat_sdG =</span> <span class="fu">ifelse</span>(sdG <span class="sc">&lt;</span> <span class="sc">-</span><span class="dv">1</span>, <span class="st">&quot;sdG 10% quantile&quot;</span>,</span>
<span id="cb750-10"><a href="conditional-manatees.html#cb750-10" aria-hidden="true" tabindex="-1"></a>                   <span class="fu">ifelse</span>(sdG <span class="sc">&gt;</span> <span class="dv">1</span>, <span class="st">&quot;sdG 90% quantile&quot;</span>,</span>
<span id="cb750-11"><a href="conditional-manatees.html#cb750-11" aria-hidden="true" tabindex="-1"></a>                          <span class="st">&quot;sdG 50% quantile&quot;</span>))) <span class="sc">%&gt;%</span> </span>
<span id="cb750-12"><a href="conditional-manatees.html#cb750-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">cat_sdG =</span> <span class="fu">as.factor</span>(cat_sdG)) <span class="ot">-&gt;</span> fitted8H5.c</span>
<span id="cb750-13"><a href="conditional-manatees.html#cb750-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb750-14"><a href="conditional-manatees.html#cb750-14" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(fitted8H5.c, <span class="fu">aes</span>(<span class="at">x=</span>meanG))<span class="sc">+</span></span>
<span id="cb750-15"><a href="conditional-manatees.html#cb750-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_ribbon</span>(<span class="fu">aes</span>(<span class="at">y =</span> Estimate,</span>
<span id="cb750-16"><a href="conditional-manatees.html#cb750-16" aria-hidden="true" tabindex="-1"></a>                  <span class="at">ymin =</span> Q2<span class="fl">.5</span>, <span class="at">ymax =</span> Q97<span class="fl">.5</span>),</span>
<span id="cb750-17"><a href="conditional-manatees.html#cb750-17" aria-hidden="true" tabindex="-1"></a>            <span class="at">alpha =</span> <span class="dv">1</span><span class="sc">/</span><span class="dv">4</span>, <span class="at">fill =</span> <span class="st">&quot;black&quot;</span>)<span class="sc">+</span></span>
<span id="cb750-18"><a href="conditional-manatees.html#cb750-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">y =</span> Estimate),</span>
<span id="cb750-19"><a href="conditional-manatees.html#cb750-19" aria-hidden="true" tabindex="-1"></a>            <span class="at">alpha =</span> <span class="dv">1</span><span class="sc">/</span><span class="dv">2</span>, <span class="at">color =</span> <span class="st">&quot;black&quot;</span>)<span class="sc">+</span></span>
<span id="cb750-20"><a href="conditional-manatees.html#cb750-20" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">data =</span> d5, <span class="fu">aes</span>(<span class="at">y=</span>L, <span class="at">color =</span> sdG),<span class="at">size=</span><span class="dv">2</span>)<span class="sc">+</span></span>
<span id="cb750-21"><a href="conditional-manatees.html#cb750-21" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x=</span><span class="st">&quot;mean growing season(std)&quot;</span>, </span>
<span id="cb750-22"><a href="conditional-manatees.html#cb750-22" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">&quot;log Language per capita&quot;</span>)<span class="sc">+</span></span>
<span id="cb750-23"><a href="conditional-manatees.html#cb750-23" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">aspect.ratio=</span><span class="dv">1</span>,</span>
<span id="cb750-24"><a href="conditional-manatees.html#cb750-24" aria-hidden="true" tabindex="-1"></a>        <span class="at">strip.background =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb750-25"><a href="conditional-manatees.html#cb750-25" aria-hidden="true" tabindex="-1"></a>        <span class="at">strip.text =</span> <span class="fu">element_text</span>(<span class="at">size=</span><span class="dv">10</span>))<span class="sc">+</span></span>
<span id="cb750-26"><a href="conditional-manatees.html#cb750-26" aria-hidden="true" tabindex="-1"></a>  <span class="fu">coord_cartesian</span>(<span class="at">ylim =</span><span class="fu">c</span>(<span class="sc">-</span><span class="dv">10</span>,<span class="dv">0</span>))<span class="sc">+</span></span>
<span id="cb750-27"><a href="conditional-manatees.html#cb750-27" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span>cat_sdG)<span class="ot">-&gt;</span> p10</span></code></pre></div>
<p><br /></p>
<div class="sourceCode" id="cb751"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb751-1"><a href="conditional-manatees.html#cb751-1" aria-hidden="true" tabindex="-1"></a>seq <span class="ot">&lt;-</span> <span class="fu">crossing</span>(<span class="at">sdG =</span> <span class="fu">seq</span>(<span class="sc">-</span><span class="fl">2.5</span>, <span class="dv">4</span>, <span class="at">length.out =</span> <span class="dv">50</span>),</span>
<span id="cb751-2"><a href="conditional-manatees.html#cb751-2" aria-hidden="true" tabindex="-1"></a>               <span class="at">meanG =</span> <span class="fu">c</span>(<span class="fu">quantile</span>(d5<span class="sc">$</span>meanG,<span class="fl">0.1</span>)[[<span class="dv">1</span>]],</span>
<span id="cb751-3"><a href="conditional-manatees.html#cb751-3" aria-hidden="true" tabindex="-1"></a>                      <span class="fu">quantile</span>(d5<span class="sc">$</span>meanG,<span class="fl">0.5</span>)[[<span class="dv">1</span>]],</span>
<span id="cb751-4"><a href="conditional-manatees.html#cb751-4" aria-hidden="true" tabindex="-1"></a>                      <span class="fu">quantile</span>(d5<span class="sc">$</span>meanG,<span class="fl">0.9</span>)[[<span class="dv">1</span>]]))</span>
<span id="cb751-5"><a href="conditional-manatees.html#cb751-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb751-6"><a href="conditional-manatees.html#cb751-6" aria-hidden="true" tabindex="-1"></a><span class="fu">fitted</span>(b8H4.c_3, <span class="at">newdata =</span> seq) <span class="sc">%&gt;%</span> </span>
<span id="cb751-7"><a href="conditional-manatees.html#cb751-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">data.frame</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb751-8"><a href="conditional-manatees.html#cb751-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">bind_cols</span>(seq) <span class="sc">%&gt;%</span> </span>
<span id="cb751-9"><a href="conditional-manatees.html#cb751-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">cat_meanG =</span> <span class="fu">ifelse</span>(meanG <span class="sc">&lt;</span> <span class="sc">-</span><span class="dv">1</span>,<span class="st">&quot;meanG 10% quantile&quot;</span>,</span>
<span id="cb751-10"><a href="conditional-manatees.html#cb751-10" aria-hidden="true" tabindex="-1"></a>                   <span class="fu">ifelse</span>(meanG <span class="sc">&gt;</span> <span class="dv">1</span>, <span class="st">&quot;meanG 90% quantile&quot;</span>,</span>
<span id="cb751-11"><a href="conditional-manatees.html#cb751-11" aria-hidden="true" tabindex="-1"></a>                          <span class="st">&quot;meanG 50% quantile&quot;</span>))) <span class="sc">%&gt;%</span> </span>
<span id="cb751-12"><a href="conditional-manatees.html#cb751-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">cat_meanG =</span> <span class="fu">as.factor</span>(cat_meanG)) <span class="ot">-&gt;</span> fitted8H5.c2</span>
<span id="cb751-13"><a href="conditional-manatees.html#cb751-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb751-14"><a href="conditional-manatees.html#cb751-14" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(fitted8H5.c2, <span class="fu">aes</span>(<span class="at">x=</span>sdG))<span class="sc">+</span></span>
<span id="cb751-15"><a href="conditional-manatees.html#cb751-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_ribbon</span>(<span class="fu">aes</span>(<span class="at">y =</span> Estimate,</span>
<span id="cb751-16"><a href="conditional-manatees.html#cb751-16" aria-hidden="true" tabindex="-1"></a>                  <span class="at">ymin =</span> Q2<span class="fl">.5</span>, <span class="at">ymax =</span> Q97<span class="fl">.5</span>),</span>
<span id="cb751-17"><a href="conditional-manatees.html#cb751-17" aria-hidden="true" tabindex="-1"></a>            <span class="at">alpha =</span> <span class="dv">1</span><span class="sc">/</span><span class="dv">4</span>, <span class="at">fill =</span> <span class="st">&quot;black&quot;</span>)<span class="sc">+</span></span>
<span id="cb751-18"><a href="conditional-manatees.html#cb751-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">y =</span> Estimate),</span>
<span id="cb751-19"><a href="conditional-manatees.html#cb751-19" aria-hidden="true" tabindex="-1"></a>            <span class="at">alpha =</span> <span class="dv">1</span><span class="sc">/</span><span class="dv">2</span>, <span class="at">color =</span> <span class="st">&quot;black&quot;</span>)<span class="sc">+</span></span>
<span id="cb751-20"><a href="conditional-manatees.html#cb751-20" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">data =</span> d5, <span class="fu">aes</span>(<span class="at">y=</span>L, <span class="at">color =</span> meanG),<span class="at">size=</span><span class="dv">2</span>)<span class="sc">+</span></span>
<span id="cb751-21"><a href="conditional-manatees.html#cb751-21" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x=</span><span class="st">&quot;sd growing season(std)&quot;</span>, </span>
<span id="cb751-22"><a href="conditional-manatees.html#cb751-22" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">&quot;log Language per capita&quot;</span>)<span class="sc">+</span></span>
<span id="cb751-23"><a href="conditional-manatees.html#cb751-23" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">aspect.ratio=</span><span class="dv">1</span>,</span>
<span id="cb751-24"><a href="conditional-manatees.html#cb751-24" aria-hidden="true" tabindex="-1"></a>        <span class="at">strip.background =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb751-25"><a href="conditional-manatees.html#cb751-25" aria-hidden="true" tabindex="-1"></a>        <span class="at">strip.text =</span> <span class="fu">element_text</span>(<span class="at">size=</span><span class="dv">10</span>))<span class="sc">+</span></span>
<span id="cb751-26"><a href="conditional-manatees.html#cb751-26" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span>cat_meanG) <span class="ot">-&gt;</span> p11</span></code></pre></div>
<p><br /></p>
<p>meanGはsdGが小さいほど、sdGはmeanGが大きいほどLに与える影響が大きくなる。これは、教科書の予想通りである。</p>
<div class="sourceCode" id="cb752"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb752-1"><a href="conditional-manatees.html#cb752-1" aria-hidden="true" tabindex="-1"></a>p10<span class="sc">/</span>p11</span></code></pre></div>
<p><img src="Rethinking_Bookdown_files/figure-html/unnamed-chunk-357-1.png" width="672" style="display: block; margin: auto;" />
<br /></p>
</div>
</div>
<div id="h5-4" class="section level3 hasAnchor" number="8.4.6">
<h3><span class="header-section-number">8.4.6</span> 8H5<a href="conditional-manatees.html#h5-4" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<blockquote>
<p>Consider the data(Wines2012) data table. These data are expert ratings of 20 different French and American wines by 9 different French and American judges. Your goal is to model score, the subjective rating assigned by each judge to each wine. I recommend standardizing it. In this problem, consider only variation among judges and wines. Construct index variables of judge and wine and then use these index variables to construct a linear regression model. Justify your priors. You should end up with 9 judge parameters and 20 wine parameters. How do you interpret the variation among individual judges and individual wines? Do you notice any patterns, just by plotting the differences? Which judges gave the highest/lowest ratings? Which wines were rated worst/best on average?</p>
</blockquote>
<p>9人の審査員(アメリカ人とフランス人)が20本のワインについて得点を付けている。</p>
<div class="sourceCode" id="cb753"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb753-1"><a href="conditional-manatees.html#cb753-1" aria-hidden="true" tabindex="-1"></a><span class="fu">data</span>(Wines2012)</span>
<span id="cb753-2"><a href="conditional-manatees.html#cb753-2" aria-hidden="true" tabindex="-1"></a>d6 <span class="ot">&lt;-</span> Wines2012</span>
<span id="cb753-3"><a href="conditional-manatees.html#cb753-3" aria-hidden="true" tabindex="-1"></a><span class="fu">slice</span>(d6, <span class="dv">1</span><span class="sc">:</span><span class="dv">20</span>)</span></code></pre></div>
<pre><code>##              judge flight wine score wine.amer judge.amer
## 1  Jean-M Cardebat  white   A1    10         1          0
## 2  Jean-M Cardebat  white   B1    13         1          0
## 3  Jean-M Cardebat  white   C1    14         0          0
## 4  Jean-M Cardebat  white   D1    15         0          0
## 5  Jean-M Cardebat  white   E1     8         1          0
## 6  Jean-M Cardebat  white   F1    13         1          0
## 7  Jean-M Cardebat  white   G1    15         1          0
## 8  Jean-M Cardebat  white   H1    11         0          0
## 9  Jean-M Cardebat  white   I1     9         1          0
## 10 Jean-M Cardebat  white   J1    12         0          0
## 11    Tyler Colman  white   A1    16         1          1
## 12    Tyler Colman  white   B1    14         1          1
## 13    Tyler Colman  white   C1    14         0          1
## 14    Tyler Colman  white   D1    16         0          1
## 15    Tyler Colman  white   E1    12         1          1
## 16    Tyler Colman  white   F1    11         1          1
## 17    Tyler Colman  white   G1    11         1          1
## 18    Tyler Colman  white   H1    14         0          1
## 19    Tyler Colman  white   I1    11         1          1
## 20    Tyler Colman  white   J1    14         0          1</code></pre>
<p><br /></p>
<p>まずは、審査員のID(judgeID)とワインのID(wine)が得点(S)に与える影響を考える。</p>
<div class="sourceCode" id="cb755"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb755-1"><a href="conditional-manatees.html#cb755-1" aria-hidden="true" tabindex="-1"></a>d6 <span class="sc">%&gt;%</span> </span>
<span id="cb755-2"><a href="conditional-manatees.html#cb755-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">judgeID =</span> <span class="fu">str_sub</span>(judge, <span class="dv">1</span>,<span class="dv">3</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb755-3"><a href="conditional-manatees.html#cb755-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">S =</span> <span class="fu">standardize</span>(score)) <span class="ot">-&gt;</span> d6</span>
<span id="cb755-4"><a href="conditional-manatees.html#cb755-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb755-5"><a href="conditional-manatees.html#cb755-5" aria-hidden="true" tabindex="-1"></a><span class="do">## judgeのID</span></span>
<span id="cb755-6"><a href="conditional-manatees.html#cb755-6" aria-hidden="true" tabindex="-1"></a>d6 <span class="sc">%&gt;%</span> </span>
<span id="cb755-7"><a href="conditional-manatees.html#cb755-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x=</span>judgeID, <span class="at">y =</span> S))<span class="sc">+</span></span>
<span id="cb755-8"><a href="conditional-manatees.html#cb755-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_boxplot</span>()<span class="sc">+</span></span>
<span id="cb755-9"><a href="conditional-manatees.html#cb755-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">aspect.ratio =</span> .<span class="dv">5</span>)</span></code></pre></div>
<p><img src="Rethinking_Bookdown_files/figure-html/unnamed-chunk-359-1.png" width="672" style="display: block; margin: auto;" /></p>
<div class="sourceCode" id="cb756"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb756-1"><a href="conditional-manatees.html#cb756-1" aria-hidden="true" tabindex="-1"></a><span class="do">## wineのID</span></span>
<span id="cb756-2"><a href="conditional-manatees.html#cb756-2" aria-hidden="true" tabindex="-1"></a>d6 <span class="sc">%&gt;%</span> </span>
<span id="cb756-3"><a href="conditional-manatees.html#cb756-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x=</span>wine, <span class="at">y =</span> S))<span class="sc">+</span></span>
<span id="cb756-4"><a href="conditional-manatees.html#cb756-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_boxplot</span>()<span class="sc">+</span></span>
<span id="cb756-5"><a href="conditional-manatees.html#cb756-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">aspect.ratio =</span> .<span class="dv">5</span>)</span></code></pre></div>
<p><img src="Rethinking_Bookdown_files/figure-html/unnamed-chunk-359-2.png" width="672" style="display: block; margin: auto;" />
<br /></p>
<p>モデリングする。Sは標準化しているので、事前分布は標準正規分布とする。</p>
<div class="sourceCode" id="cb757"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb757-1"><a href="conditional-manatees.html#cb757-1" aria-hidden="true" tabindex="-1"></a>b8H5 <span class="ot">&lt;-</span> <span class="fu">brm</span>(</span>
<span id="cb757-2"><a href="conditional-manatees.html#cb757-2" aria-hidden="true" tabindex="-1"></a>  <span class="at">data =</span> d6,</span>
<span id="cb757-3"><a href="conditional-manatees.html#cb757-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">family =</span> gaussian,</span>
<span id="cb757-4"><a href="conditional-manatees.html#cb757-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">formula =</span> <span class="fu">bf</span>(S <span class="sc">~</span> <span class="dv">0</span> <span class="sc">+</span>a <span class="sc">+</span> b,</span>
<span id="cb757-5"><a href="conditional-manatees.html#cb757-5" aria-hidden="true" tabindex="-1"></a>               a <span class="sc">~</span> <span class="dv">0</span> <span class="sc">+</span> judgeID,</span>
<span id="cb757-6"><a href="conditional-manatees.html#cb757-6" aria-hidden="true" tabindex="-1"></a>               b <span class="sc">~</span> <span class="dv">0</span> <span class="sc">+</span> wine,</span>
<span id="cb757-7"><a href="conditional-manatees.html#cb757-7" aria-hidden="true" tabindex="-1"></a>               <span class="at">nl =</span> <span class="cn">TRUE</span>),</span>
<span id="cb757-8"><a href="conditional-manatees.html#cb757-8" aria-hidden="true" tabindex="-1"></a>  <span class="at">prior =</span> <span class="fu">c</span>(<span class="fu">prior</span>(<span class="fu">normal</span>(<span class="dv">0</span>,<span class="dv">1</span>), <span class="at">nlpar =</span> <span class="st">&quot;a&quot;</span>),</span>
<span id="cb757-9"><a href="conditional-manatees.html#cb757-9" aria-hidden="true" tabindex="-1"></a>            <span class="fu">prior</span>(<span class="fu">normal</span>(<span class="dv">0</span>,<span class="dv">1</span>), <span class="at">nlpar =</span> <span class="st">&quot;b&quot;</span>),</span>
<span id="cb757-10"><a href="conditional-manatees.html#cb757-10" aria-hidden="true" tabindex="-1"></a>            <span class="fu">prior</span>(<span class="fu">exponential</span>(<span class="dv">1</span>), <span class="at">class =</span> sigma)),</span>
<span id="cb757-11"><a href="conditional-manatees.html#cb757-11" aria-hidden="true" tabindex="-1"></a>  <span class="at">backend =</span> <span class="st">&quot;cmdstanr&quot;</span>,</span>
<span id="cb757-12"><a href="conditional-manatees.html#cb757-12" aria-hidden="true" tabindex="-1"></a>  <span class="at">seed =</span> <span class="dv">8</span>, <span class="at">file =</span> <span class="st">&quot;output/Chapter8/b8H5&quot;</span></span>
<span id="cb757-13"><a href="conditional-manatees.html#cb757-13" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb757-14"><a href="conditional-manatees.html#cb757-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb757-15"><a href="conditional-manatees.html#cb757-15" aria-hidden="true" tabindex="-1"></a><span class="fu">posterior_summary</span>(b8H5)<span class="sc">%&gt;%</span> </span>
<span id="cb757-16"><a href="conditional-manatees.html#cb757-16" aria-hidden="true" tabindex="-1"></a>   <span class="fu">data.frame</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb757-17"><a href="conditional-manatees.html#cb757-17" aria-hidden="true" tabindex="-1"></a>   <span class="fu">round</span>(<span class="dv">2</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb757-18"><a href="conditional-manatees.html#cb757-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">gt</span>()</span></code></pre></div>
<div id="ptmkgovred" style="padding-left:0px;padding-right:0px;padding-top:10px;padding-bottom:10px;overflow-x:auto;overflow-y:auto;width:auto;height:auto;">
<style>html {
  font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, Cantarell, 'Helvetica Neue', 'Fira Sans', 'Droid Sans', Arial, sans-serif;
}

#ptmkgovred .gt_table {
  display: table;
  border-collapse: collapse;
  margin-left: auto;
  margin-right: auto;
  color: #333333;
  font-size: 16px;
  font-weight: normal;
  font-style: normal;
  background-color: #FFFFFF;
  width: auto;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #A8A8A8;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #A8A8A8;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
}

#ptmkgovred .gt_heading {
  background-color: #FFFFFF;
  text-align: center;
  border-bottom-color: #FFFFFF;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#ptmkgovred .gt_caption {
  padding-top: 4px;
  padding-bottom: 4px;
}

#ptmkgovred .gt_title {
  color: #333333;
  font-size: 125%;
  font-weight: initial;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-color: #FFFFFF;
  border-bottom-width: 0;
}

#ptmkgovred .gt_subtitle {
  color: #333333;
  font-size: 85%;
  font-weight: initial;
  padding-top: 0;
  padding-bottom: 6px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-color: #FFFFFF;
  border-top-width: 0;
}

#ptmkgovred .gt_bottom_border {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#ptmkgovred .gt_col_headings {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#ptmkgovred .gt_col_heading {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 6px;
  padding-left: 5px;
  padding-right: 5px;
  overflow-x: hidden;
}

#ptmkgovred .gt_column_spanner_outer {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  padding-top: 0;
  padding-bottom: 0;
  padding-left: 4px;
  padding-right: 4px;
}

#ptmkgovred .gt_column_spanner_outer:first-child {
  padding-left: 0;
}

#ptmkgovred .gt_column_spanner_outer:last-child {
  padding-right: 0;
}

#ptmkgovred .gt_column_spanner {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 5px;
  overflow-x: hidden;
  display: inline-block;
  width: 100%;
}

#ptmkgovred .gt_group_heading {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  text-align: left;
}

#ptmkgovred .gt_empty_group_heading {
  padding: 0.5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: middle;
}

#ptmkgovred .gt_from_md > :first-child {
  margin-top: 0;
}

#ptmkgovred .gt_from_md > :last-child {
  margin-bottom: 0;
}

#ptmkgovred .gt_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  margin: 10px;
  border-top-style: solid;
  border-top-width: 1px;
  border-top-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  overflow-x: hidden;
}

#ptmkgovred .gt_stub {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
}

#ptmkgovred .gt_stub_row_group {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
  vertical-align: top;
}

#ptmkgovred .gt_row_group_first td {
  border-top-width: 2px;
}

#ptmkgovred .gt_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#ptmkgovred .gt_first_summary_row {
  border-top-style: solid;
  border-top-color: #D3D3D3;
}

#ptmkgovred .gt_first_summary_row.thick {
  border-top-width: 2px;
}

#ptmkgovred .gt_last_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#ptmkgovred .gt_grand_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#ptmkgovred .gt_first_grand_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-style: double;
  border-top-width: 6px;
  border-top-color: #D3D3D3;
}

#ptmkgovred .gt_striped {
  background-color: rgba(128, 128, 128, 0.05);
}

#ptmkgovred .gt_table_body {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#ptmkgovred .gt_footnotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#ptmkgovred .gt_footnote {
  margin: 0px;
  font-size: 90%;
  padding-left: 4px;
  padding-right: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#ptmkgovred .gt_sourcenotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#ptmkgovred .gt_sourcenote {
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#ptmkgovred .gt_left {
  text-align: left;
}

#ptmkgovred .gt_center {
  text-align: center;
}

#ptmkgovred .gt_right {
  text-align: right;
  font-variant-numeric: tabular-nums;
}

#ptmkgovred .gt_font_normal {
  font-weight: normal;
}

#ptmkgovred .gt_font_bold {
  font-weight: bold;
}

#ptmkgovred .gt_font_italic {
  font-style: italic;
}

#ptmkgovred .gt_super {
  font-size: 65%;
}

#ptmkgovred .gt_footnote_marks {
  font-style: italic;
  font-weight: normal;
  font-size: 75%;
  vertical-align: 0.4em;
}

#ptmkgovred .gt_asterisk {
  font-size: 100%;
  vertical-align: 0;
}

#ptmkgovred .gt_indent_1 {
  text-indent: 5px;
}

#ptmkgovred .gt_indent_2 {
  text-indent: 10px;
}

#ptmkgovred .gt_indent_3 {
  text-indent: 15px;
}

#ptmkgovred .gt_indent_4 {
  text-indent: 20px;
}

#ptmkgovred .gt_indent_5 {
  text-indent: 25px;
}
</style>
<table class="gt_table">
  
  <thead class="gt_col_headings">
    <tr>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1" scope="col" id="Estimate">Estimate</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1" scope="col" id="Est.Error">Est.Error</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1" scope="col" id="Q2.5">Q2.5</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1" scope="col" id="Q97.5">Q97.5</th>
    </tr>
  </thead>
  <tbody class="gt_table_body">
    <tr><td headers="Estimate" class="gt_row gt_right">-0.30</td>
<td headers="Est.Error" class="gt_row gt_right">0.25</td>
<td headers="Q2.5" class="gt_row gt_right">-0.79</td>
<td headers="Q97.5" class="gt_row gt_right">0.20</td></tr>
    <tr><td headers="Estimate" class="gt_row gt_right">0.24</td>
<td headers="Est.Error" class="gt_row gt_right">0.26</td>
<td headers="Q2.5" class="gt_row gt_right">-0.27</td>
<td headers="Q97.5" class="gt_row gt_right">0.76</td></tr>
    <tr><td headers="Estimate" class="gt_row gt_right">0.23</td>
<td headers="Est.Error" class="gt_row gt_right">0.26</td>
<td headers="Q2.5" class="gt_row gt_right">-0.27</td>
<td headers="Q97.5" class="gt_row gt_right">0.73</td></tr>
    <tr><td headers="Estimate" class="gt_row gt_right">-0.59</td>
<td headers="Est.Error" class="gt_row gt_right">0.26</td>
<td headers="Q2.5" class="gt_row gt_right">-1.09</td>
<td headers="Q97.5" class="gt_row gt_right">-0.08</td></tr>
    <tr><td headers="Estimate" class="gt_row gt_right">0.88</td>
<td headers="Est.Error" class="gt_row gt_right">0.26</td>
<td headers="Q2.5" class="gt_row gt_right">0.39</td>
<td headers="Q97.5" class="gt_row gt_right">1.40</td></tr>
    <tr><td headers="Estimate" class="gt_row gt_right">0.53</td>
<td headers="Est.Error" class="gt_row gt_right">0.26</td>
<td headers="Q2.5" class="gt_row gt_right">0.03</td>
<td headers="Q97.5" class="gt_row gt_right">1.04</td></tr>
    <tr><td headers="Estimate" class="gt_row gt_right">0.15</td>
<td headers="Est.Error" class="gt_row gt_right">0.26</td>
<td headers="Q2.5" class="gt_row gt_right">-0.35</td>
<td headers="Q97.5" class="gt_row gt_right">0.66</td></tr>
    <tr><td headers="Estimate" class="gt_row gt_right">-0.72</td>
<td headers="Est.Error" class="gt_row gt_right">0.26</td>
<td headers="Q2.5" class="gt_row gt_right">-1.23</td>
<td headers="Q97.5" class="gt_row gt_right">-0.21</td></tr>
    <tr><td headers="Estimate" class="gt_row gt_right">-0.37</td>
<td headers="Est.Error" class="gt_row gt_right">0.25</td>
<td headers="Q2.5" class="gt_row gt_right">-0.86</td>
<td headers="Q97.5" class="gt_row gt_right">0.12</td></tr>
    <tr><td headers="Estimate" class="gt_row gt_right">0.14</td>
<td headers="Est.Error" class="gt_row gt_right">0.33</td>
<td headers="Q2.5" class="gt_row gt_right">-0.50</td>
<td headers="Q97.5" class="gt_row gt_right">0.78</td></tr>
    <tr><td headers="Estimate" class="gt_row gt_right">0.09</td>
<td headers="Est.Error" class="gt_row gt_right">0.32</td>
<td headers="Q2.5" class="gt_row gt_right">-0.54</td>
<td headers="Q97.5" class="gt_row gt_right">0.74</td></tr>
    <tr><td headers="Estimate" class="gt_row gt_right">0.27</td>
<td headers="Est.Error" class="gt_row gt_right">0.32</td>
<td headers="Q2.5" class="gt_row gt_right">-0.37</td>
<td headers="Q97.5" class="gt_row gt_right">0.87</td></tr>
    <tr><td headers="Estimate" class="gt_row gt_right">0.56</td>
<td headers="Est.Error" class="gt_row gt_right">0.32</td>
<td headers="Q2.5" class="gt_row gt_right">-0.08</td>
<td headers="Q97.5" class="gt_row gt_right">1.18</td></tr>
    <tr><td headers="Estimate" class="gt_row gt_right">-0.14</td>
<td headers="Est.Error" class="gt_row gt_right">0.32</td>
<td headers="Q2.5" class="gt_row gt_right">-0.78</td>
<td headers="Q97.5" class="gt_row gt_right">0.49</td></tr>
    <tr><td headers="Estimate" class="gt_row gt_right">-0.38</td>
<td headers="Est.Error" class="gt_row gt_right">0.32</td>
<td headers="Q2.5" class="gt_row gt_right">-1.02</td>
<td headers="Q97.5" class="gt_row gt_right">0.25</td></tr>
    <tr><td headers="Estimate" class="gt_row gt_right">0.29</td>
<td headers="Est.Error" class="gt_row gt_right">0.32</td>
<td headers="Q2.5" class="gt_row gt_right">-0.35</td>
<td headers="Q97.5" class="gt_row gt_right">0.90</td></tr>
    <tr><td headers="Estimate" class="gt_row gt_right">0.27</td>
<td headers="Est.Error" class="gt_row gt_right">0.33</td>
<td headers="Q2.5" class="gt_row gt_right">-0.36</td>
<td headers="Q97.5" class="gt_row gt_right">0.92</td></tr>
    <tr><td headers="Estimate" class="gt_row gt_right">0.08</td>
<td headers="Est.Error" class="gt_row gt_right">0.33</td>
<td headers="Q2.5" class="gt_row gt_right">-0.56</td>
<td headers="Q97.5" class="gt_row gt_right">0.72</td></tr>
    <tr><td headers="Estimate" class="gt_row gt_right">0.12</td>
<td headers="Est.Error" class="gt_row gt_right">0.33</td>
<td headers="Q2.5" class="gt_row gt_right">-0.52</td>
<td headers="Q97.5" class="gt_row gt_right">0.74</td></tr>
    <tr><td headers="Estimate" class="gt_row gt_right">-0.02</td>
<td headers="Est.Error" class="gt_row gt_right">0.32</td>
<td headers="Q2.5" class="gt_row gt_right">-0.65</td>
<td headers="Q97.5" class="gt_row gt_right">0.61</td></tr>
    <tr><td headers="Estimate" class="gt_row gt_right">-0.04</td>
<td headers="Est.Error" class="gt_row gt_right">0.32</td>
<td headers="Q2.5" class="gt_row gt_right">-0.68</td>
<td headers="Q97.5" class="gt_row gt_right">0.58</td></tr>
    <tr><td headers="Estimate" class="gt_row gt_right">-0.11</td>
<td headers="Est.Error" class="gt_row gt_right">0.33</td>
<td headers="Q2.5" class="gt_row gt_right">-0.75</td>
<td headers="Q97.5" class="gt_row gt_right">0.51</td></tr>
    <tr><td headers="Estimate" class="gt_row gt_right">-0.01</td>
<td headers="Est.Error" class="gt_row gt_right">0.33</td>
<td headers="Q2.5" class="gt_row gt_right">-0.64</td>
<td headers="Q97.5" class="gt_row gt_right">0.64</td></tr>
    <tr><td headers="Estimate" class="gt_row gt_right">-0.23</td>
<td headers="Est.Error" class="gt_row gt_right">0.33</td>
<td headers="Q2.5" class="gt_row gt_right">-0.87</td>
<td headers="Q97.5" class="gt_row gt_right">0.40</td></tr>
    <tr><td headers="Estimate" class="gt_row gt_right">-0.21</td>
<td headers="Est.Error" class="gt_row gt_right">0.32</td>
<td headers="Q2.5" class="gt_row gt_right">-0.86</td>
<td headers="Q97.5" class="gt_row gt_right">0.41</td></tr>
    <tr><td headers="Estimate" class="gt_row gt_right">-0.15</td>
<td headers="Est.Error" class="gt_row gt_right">0.32</td>
<td headers="Q2.5" class="gt_row gt_right">-0.79</td>
<td headers="Q97.5" class="gt_row gt_right">0.48</td></tr>
    <tr><td headers="Estimate" class="gt_row gt_right">-0.88</td>
<td headers="Est.Error" class="gt_row gt_right">0.33</td>
<td headers="Q2.5" class="gt_row gt_right">-1.54</td>
<td headers="Q97.5" class="gt_row gt_right">-0.25</td></tr>
    <tr><td headers="Estimate" class="gt_row gt_right">-0.18</td>
<td headers="Est.Error" class="gt_row gt_right">0.32</td>
<td headers="Q2.5" class="gt_row gt_right">-0.80</td>
<td headers="Q97.5" class="gt_row gt_right">0.44</td></tr>
    <tr><td headers="Estimate" class="gt_row gt_right">0.39</td>
<td headers="Est.Error" class="gt_row gt_right">0.33</td>
<td headers="Q2.5" class="gt_row gt_right">-0.25</td>
<td headers="Q97.5" class="gt_row gt_right">1.05</td></tr>
    <tr><td headers="Estimate" class="gt_row gt_right">0.85</td>
<td headers="Est.Error" class="gt_row gt_right">0.05</td>
<td headers="Q2.5" class="gt_row gt_right">0.77</td>
<td headers="Q97.5" class="gt_row gt_right">0.95</td></tr>
    <tr><td headers="Estimate" class="gt_row gt_right">-30.92</td>
<td headers="Est.Error" class="gt_row gt_right">0.89</td>
<td headers="Q2.5" class="gt_row gt_right">-33.15</td>
<td headers="Q97.5" class="gt_row gt_right">-29.66</td></tr>
    <tr><td headers="Estimate" class="gt_row gt_right">-257.20</td>
<td headers="Est.Error" class="gt_row gt_right">4.17</td>
<td headers="Q2.5" class="gt_row gt_right">-266.32</td>
<td headers="Q97.5" class="gt_row gt_right">-250.18</td></tr>
  </tbody>
  
  
</table>
</div>
<p><br /></p>
<p>結果を図示してみる。</p>
<div class="sourceCode" id="cb758"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb758-1"><a href="conditional-manatees.html#cb758-1" aria-hidden="true" tabindex="-1"></a><span class="fu">conditional_effects</span>(b8H5, <span class="at">method =</span> <span class="st">&quot;fitted&quot;</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb758-2"><a href="conditional-manatees.html#cb758-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">plot</span>()</span></code></pre></div>
<p><img src="Rethinking_Bookdown_files/figure-html/unnamed-chunk-361-1.png" width="672" style="display: block; margin: auto;" /><img src="Rethinking_Bookdown_files/figure-html/unnamed-chunk-361-2.png" width="672" style="display: block; margin: auto;" />
<br /></p>
</div>
<div id="h6-1" class="section level3 hasAnchor" number="8.4.7">
<h3><span class="header-section-number">8.4.7</span> 8H6<a href="conditional-manatees.html#h6-1" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<blockquote>
<p>Now consider three features of the wines and judges:</p>
</blockquote>
<ol style="list-style-type: decimal">
<li><code>flight</code>: Whether the wine is red or white.</li>
<li><code>wine.amer</code>: Indicator variable for American wines.</li>
<li><code>judge.amer</code>: Indicator variable for American judges.</li>
</ol>
<blockquote>
<p>Use indicator or index variables to model the influence of these features on the scores. Omit the individual judge and wine index variables from Problem 1. Do not include interaction effects yet. Again justify your priors What do you conclude about the differences among the wines and judges? Try to relate the results to the inferences in the previous problem.</p>
</blockquote>
<p>続いて、ワインの種類(flight)、ワインがアメリカ産か否か(wine.amer)、審査員がアメリカ人か否か(judge.amer)が得点(S)に与える影響を考える。<br />
グラフを書いても、今一つ関係がはっきりしない。</p>
<div class="sourceCode" id="cb759"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb759-1"><a href="conditional-manatees.html#cb759-1" aria-hidden="true" tabindex="-1"></a>d6 <span class="sc">%&gt;%</span> </span>
<span id="cb759-2"><a href="conditional-manatees.html#cb759-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x=</span>flight, <span class="at">y =</span> score,<span class="at">color =</span> <span class="fu">as.factor</span>(wine.amer)))<span class="sc">+</span></span>
<span id="cb759-3"><a href="conditional-manatees.html#cb759-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_boxplot</span>()</span></code></pre></div>
<p><img src="Rethinking_Bookdown_files/figure-html/unnamed-chunk-362-1.png" width="672" style="display: block; margin: auto;" /></p>
<div class="sourceCode" id="cb760"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb760-1"><a href="conditional-manatees.html#cb760-1" aria-hidden="true" tabindex="-1"></a>d6 <span class="sc">%&gt;%</span> </span>
<span id="cb760-2"><a href="conditional-manatees.html#cb760-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x=</span>flight, <span class="at">y =</span> score,<span class="at">color =</span> <span class="fu">as.factor</span>(judge.amer)))<span class="sc">+</span></span>
<span id="cb760-3"><a href="conditional-manatees.html#cb760-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_boxplot</span>()</span></code></pre></div>
<p><img src="Rethinking_Bookdown_files/figure-html/unnamed-chunk-362-2.png" width="672" style="display: block; margin: auto;" /></p>
<div class="sourceCode" id="cb761"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb761-1"><a href="conditional-manatees.html#cb761-1" aria-hidden="true" tabindex="-1"></a>d6 <span class="sc">%&gt;%</span> </span>
<span id="cb761-2"><a href="conditional-manatees.html#cb761-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x=</span><span class="fu">as.factor</span>(judge.amer), <span class="at">y =</span> score,<span class="at">color =</span> <span class="fu">as.factor</span>(wine.amer)))<span class="sc">+</span></span>
<span id="cb761-3"><a href="conditional-manatees.html#cb761-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_boxplot</span>()</span></code></pre></div>
<p><img src="Rethinking_Bookdown_files/figure-html/unnamed-chunk-362-3.png" width="672" style="display: block; margin: auto;" /></p>
<div class="sourceCode" id="cb762"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb762-1"><a href="conditional-manatees.html#cb762-1" aria-hidden="true" tabindex="-1"></a>d6 <span class="sc">%&gt;%</span> </span>
<span id="cb762-2"><a href="conditional-manatees.html#cb762-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x=</span><span class="fu">as.factor</span>(wine.amer), <span class="at">y =</span> score,<span class="at">color =</span> <span class="fu">as.factor</span>(judge.amer)))<span class="sc">+</span></span>
<span id="cb762-3"><a href="conditional-manatees.html#cb762-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_boxplot</span>()</span></code></pre></div>
<p><img src="Rethinking_Bookdown_files/figure-html/unnamed-chunk-362-4.png" width="672" style="display: block; margin: auto;" />
<br /></p>
<p>モデリングしてみる。<br />
まずは交互作用を考えない。</p>
<div class="sourceCode" id="cb763"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb763-1"><a href="conditional-manatees.html#cb763-1" aria-hidden="true" tabindex="-1"></a>d6 <span class="sc">%&gt;%</span> </span>
<span id="cb763-2"><a href="conditional-manatees.html#cb763-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">WA =</span> <span class="fu">as.factor</span>(wine.amer<span class="sc">+</span><span class="dv">1</span>),</span>
<span id="cb763-3"><a href="conditional-manatees.html#cb763-3" aria-hidden="true" tabindex="-1"></a>         <span class="at">JA =</span> <span class="fu">as.factor</span>(judge.amer<span class="sc">+</span><span class="dv">1</span>)) <span class="ot">-&gt;</span> d6</span>
<span id="cb763-4"><a href="conditional-manatees.html#cb763-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb763-5"><a href="conditional-manatees.html#cb763-5" aria-hidden="true" tabindex="-1"></a>b8H6 <span class="ot">&lt;-</span> <span class="fu">brm</span>(</span>
<span id="cb763-6"><a href="conditional-manatees.html#cb763-6" aria-hidden="true" tabindex="-1"></a>  <span class="at">data =</span> d6,</span>
<span id="cb763-7"><a href="conditional-manatees.html#cb763-7" aria-hidden="true" tabindex="-1"></a>  <span class="at">family =</span> gaussian,</span>
<span id="cb763-8"><a href="conditional-manatees.html#cb763-8" aria-hidden="true" tabindex="-1"></a>  <span class="at">formula =</span> <span class="fu">bf</span>(S <span class="sc">~</span> <span class="dv">0</span> <span class="sc">+</span> a <span class="sc">+</span> b <span class="sc">+</span> c,</span>
<span id="cb763-9"><a href="conditional-manatees.html#cb763-9" aria-hidden="true" tabindex="-1"></a>               a <span class="sc">~</span> <span class="dv">0</span> <span class="sc">+</span> JA,</span>
<span id="cb763-10"><a href="conditional-manatees.html#cb763-10" aria-hidden="true" tabindex="-1"></a>               b <span class="sc">~</span> <span class="dv">0</span> <span class="sc">+</span> WA,</span>
<span id="cb763-11"><a href="conditional-manatees.html#cb763-11" aria-hidden="true" tabindex="-1"></a>               c <span class="sc">~</span> <span class="dv">0</span> <span class="sc">+</span> flight,</span>
<span id="cb763-12"><a href="conditional-manatees.html#cb763-12" aria-hidden="true" tabindex="-1"></a>               <span class="at">nl =</span> <span class="cn">TRUE</span>),</span>
<span id="cb763-13"><a href="conditional-manatees.html#cb763-13" aria-hidden="true" tabindex="-1"></a>  <span class="at">prior =</span> <span class="fu">c</span>(<span class="fu">prior</span>(<span class="fu">normal</span>(<span class="dv">0</span>,<span class="dv">1</span>), <span class="at">nlpar =</span> <span class="st">&quot;a&quot;</span>),</span>
<span id="cb763-14"><a href="conditional-manatees.html#cb763-14" aria-hidden="true" tabindex="-1"></a>            <span class="fu">prior</span>(<span class="fu">normal</span>(<span class="dv">0</span>,<span class="dv">1</span>), <span class="at">nlpar =</span> <span class="st">&quot;b&quot;</span>),</span>
<span id="cb763-15"><a href="conditional-manatees.html#cb763-15" aria-hidden="true" tabindex="-1"></a>            <span class="fu">prior</span>(<span class="fu">normal</span>(<span class="dv">0</span>,<span class="dv">1</span>), <span class="at">nlpar =</span> <span class="st">&quot;c&quot;</span>),</span>
<span id="cb763-16"><a href="conditional-manatees.html#cb763-16" aria-hidden="true" tabindex="-1"></a>            <span class="fu">prior</span>(<span class="fu">exponential</span>(<span class="dv">1</span>), <span class="at">class =</span> sigma)),</span>
<span id="cb763-17"><a href="conditional-manatees.html#cb763-17" aria-hidden="true" tabindex="-1"></a>  <span class="at">backend =</span> <span class="st">&quot;cmdstanr&quot;</span>,</span>
<span id="cb763-18"><a href="conditional-manatees.html#cb763-18" aria-hidden="true" tabindex="-1"></a>  <span class="at">seed =</span> <span class="dv">8</span>, <span class="at">file =</span> <span class="st">&quot;output/Chapter8/b8H6&quot;</span></span>
<span id="cb763-19"><a href="conditional-manatees.html#cb763-19" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb763-20"><a href="conditional-manatees.html#cb763-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb763-21"><a href="conditional-manatees.html#cb763-21" aria-hidden="true" tabindex="-1"></a>b8H6 <span class="ot">&lt;-</span> <span class="fu">add_criterion</span>(b8H6, <span class="fu">c</span>(<span class="st">&quot;waic&quot;</span>,<span class="st">&quot;loo&quot;</span>))</span></code></pre></div>
<p><br /></p>
<p>いずれの要因もほとんど影響がない。</p>
<div class="sourceCode" id="cb764"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb764-1"><a href="conditional-manatees.html#cb764-1" aria-hidden="true" tabindex="-1"></a><span class="fu">posterior_summary</span>(b8H6)<span class="sc">%&gt;%</span> </span>
<span id="cb764-2"><a href="conditional-manatees.html#cb764-2" aria-hidden="true" tabindex="-1"></a>   <span class="fu">data.frame</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb764-3"><a href="conditional-manatees.html#cb764-3" aria-hidden="true" tabindex="-1"></a>   <span class="fu">round</span>(<span class="dv">2</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb764-4"><a href="conditional-manatees.html#cb764-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">gt</span>()</span></code></pre></div>
<div id="akyjyzmyuu" style="padding-left:0px;padding-right:0px;padding-top:10px;padding-bottom:10px;overflow-x:auto;overflow-y:auto;width:auto;height:auto;">
<style>html {
  font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, Cantarell, 'Helvetica Neue', 'Fira Sans', 'Droid Sans', Arial, sans-serif;
}

#akyjyzmyuu .gt_table {
  display: table;
  border-collapse: collapse;
  margin-left: auto;
  margin-right: auto;
  color: #333333;
  font-size: 16px;
  font-weight: normal;
  font-style: normal;
  background-color: #FFFFFF;
  width: auto;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #A8A8A8;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #A8A8A8;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
}

#akyjyzmyuu .gt_heading {
  background-color: #FFFFFF;
  text-align: center;
  border-bottom-color: #FFFFFF;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#akyjyzmyuu .gt_caption {
  padding-top: 4px;
  padding-bottom: 4px;
}

#akyjyzmyuu .gt_title {
  color: #333333;
  font-size: 125%;
  font-weight: initial;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-color: #FFFFFF;
  border-bottom-width: 0;
}

#akyjyzmyuu .gt_subtitle {
  color: #333333;
  font-size: 85%;
  font-weight: initial;
  padding-top: 0;
  padding-bottom: 6px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-color: #FFFFFF;
  border-top-width: 0;
}

#akyjyzmyuu .gt_bottom_border {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#akyjyzmyuu .gt_col_headings {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#akyjyzmyuu .gt_col_heading {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 6px;
  padding-left: 5px;
  padding-right: 5px;
  overflow-x: hidden;
}

#akyjyzmyuu .gt_column_spanner_outer {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  padding-top: 0;
  padding-bottom: 0;
  padding-left: 4px;
  padding-right: 4px;
}

#akyjyzmyuu .gt_column_spanner_outer:first-child {
  padding-left: 0;
}

#akyjyzmyuu .gt_column_spanner_outer:last-child {
  padding-right: 0;
}

#akyjyzmyuu .gt_column_spanner {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 5px;
  overflow-x: hidden;
  display: inline-block;
  width: 100%;
}

#akyjyzmyuu .gt_group_heading {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  text-align: left;
}

#akyjyzmyuu .gt_empty_group_heading {
  padding: 0.5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: middle;
}

#akyjyzmyuu .gt_from_md > :first-child {
  margin-top: 0;
}

#akyjyzmyuu .gt_from_md > :last-child {
  margin-bottom: 0;
}

#akyjyzmyuu .gt_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  margin: 10px;
  border-top-style: solid;
  border-top-width: 1px;
  border-top-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  overflow-x: hidden;
}

#akyjyzmyuu .gt_stub {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
}

#akyjyzmyuu .gt_stub_row_group {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
  vertical-align: top;
}

#akyjyzmyuu .gt_row_group_first td {
  border-top-width: 2px;
}

#akyjyzmyuu .gt_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#akyjyzmyuu .gt_first_summary_row {
  border-top-style: solid;
  border-top-color: #D3D3D3;
}

#akyjyzmyuu .gt_first_summary_row.thick {
  border-top-width: 2px;
}

#akyjyzmyuu .gt_last_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#akyjyzmyuu .gt_grand_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#akyjyzmyuu .gt_first_grand_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-style: double;
  border-top-width: 6px;
  border-top-color: #D3D3D3;
}

#akyjyzmyuu .gt_striped {
  background-color: rgba(128, 128, 128, 0.05);
}

#akyjyzmyuu .gt_table_body {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#akyjyzmyuu .gt_footnotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#akyjyzmyuu .gt_footnote {
  margin: 0px;
  font-size: 90%;
  padding-left: 4px;
  padding-right: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#akyjyzmyuu .gt_sourcenotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#akyjyzmyuu .gt_sourcenote {
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#akyjyzmyuu .gt_left {
  text-align: left;
}

#akyjyzmyuu .gt_center {
  text-align: center;
}

#akyjyzmyuu .gt_right {
  text-align: right;
  font-variant-numeric: tabular-nums;
}

#akyjyzmyuu .gt_font_normal {
  font-weight: normal;
}

#akyjyzmyuu .gt_font_bold {
  font-weight: bold;
}

#akyjyzmyuu .gt_font_italic {
  font-style: italic;
}

#akyjyzmyuu .gt_super {
  font-size: 65%;
}

#akyjyzmyuu .gt_footnote_marks {
  font-style: italic;
  font-weight: normal;
  font-size: 75%;
  vertical-align: 0.4em;
}

#akyjyzmyuu .gt_asterisk {
  font-size: 100%;
  vertical-align: 0;
}

#akyjyzmyuu .gt_indent_1 {
  text-indent: 5px;
}

#akyjyzmyuu .gt_indent_2 {
  text-indent: 10px;
}

#akyjyzmyuu .gt_indent_3 {
  text-indent: 15px;
}

#akyjyzmyuu .gt_indent_4 {
  text-indent: 20px;
}

#akyjyzmyuu .gt_indent_5 {
  text-indent: 25px;
}
</style>
<table class="gt_table">
  
  <thead class="gt_col_headings">
    <tr>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1" scope="col" id="Estimate">Estimate</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1" scope="col" id="Est.Error">Est.Error</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1" scope="col" id="Q2.5">Q2.5</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1" scope="col" id="Q97.5">Q97.5</th>
    </tr>
  </thead>
  <tbody class="gt_table_body">
    <tr><td headers="Estimate" class="gt_row gt_right">-0.12</td>
<td headers="Est.Error" class="gt_row gt_right">0.59</td>
<td headers="Q2.5" class="gt_row gt_right">-1.24</td>
<td headers="Q97.5" class="gt_row gt_right">1.02</td></tr>
    <tr><td headers="Estimate" class="gt_row gt_right">0.12</td>
<td headers="Est.Error" class="gt_row gt_right">0.59</td>
<td headers="Q2.5" class="gt_row gt_right">-1.00</td>
<td headers="Q97.5" class="gt_row gt_right">1.28</td></tr>
    <tr><td headers="Estimate" class="gt_row gt_right">0.11</td>
<td headers="Est.Error" class="gt_row gt_right">0.56</td>
<td headers="Q2.5" class="gt_row gt_right">-1.01</td>
<td headers="Q97.5" class="gt_row gt_right">1.17</td></tr>
    <tr><td headers="Estimate" class="gt_row gt_right">-0.08</td>
<td headers="Est.Error" class="gt_row gt_right">0.56</td>
<td headers="Q2.5" class="gt_row gt_right">-1.17</td>
<td headers="Q97.5" class="gt_row gt_right">1.01</td></tr>
    <tr><td headers="Estimate" class="gt_row gt_right">-0.01</td>
<td headers="Est.Error" class="gt_row gt_right">0.58</td>
<td headers="Q2.5" class="gt_row gt_right">-1.15</td>
<td headers="Q97.5" class="gt_row gt_right">1.10</td></tr>
    <tr><td headers="Estimate" class="gt_row gt_right">-0.01</td>
<td headers="Est.Error" class="gt_row gt_right">0.58</td>
<td headers="Q2.5" class="gt_row gt_right">-1.13</td>
<td headers="Q97.5" class="gt_row gt_right">1.10</td></tr>
    <tr><td headers="Estimate" class="gt_row gt_right">1.00</td>
<td headers="Est.Error" class="gt_row gt_right">0.05</td>
<td headers="Q2.5" class="gt_row gt_right">0.90</td>
<td headers="Q97.5" class="gt_row gt_right">1.11</td></tr>
    <tr><td headers="Estimate" class="gt_row gt_right">-7.54</td>
<td headers="Est.Error" class="gt_row gt_right">0.96</td>
<td headers="Q2.5" class="gt_row gt_right">-10.07</td>
<td headers="Q97.5" class="gt_row gt_right">-6.55</td></tr>
    <tr><td headers="Estimate" class="gt_row gt_right">-262.79</td>
<td headers="Est.Error" class="gt_row gt_right">1.89</td>
<td headers="Q2.5" class="gt_row gt_right">-267.29</td>
<td headers="Q97.5" class="gt_row gt_right">-260.11</td></tr>
  </tbody>
  
  
</table>
</div>
<p><br /></p>
</div>
<div id="h7" class="section level3 hasAnchor" number="8.4.8">
<h3><span class="header-section-number">8.4.8</span> 8H7<a href="conditional-manatees.html#h7" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<blockquote>
<p>Now consider two-way interactions among the three features. You should end up with three different interaction terms in your model. These will be easier to build, if you use indicator variables. Again justify your priors. Explain what each interaction means. Be sure to interpret the model’s predictions on the outcome scale (mu, the expected score), not on the scale of individual parameters. You can use link to help with this, or just use your knowledge of the linear model instead. What do you conclude about the features and the scores? Can you relate the results of your model(s) to the individual judge and wine inferences from 8H5?</p>
</blockquote>
<div class="sourceCode" id="cb765"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb765-1"><a href="conditional-manatees.html#cb765-1" aria-hidden="true" tabindex="-1"></a>b8H7 <span class="ot">&lt;-</span> <span class="fu">brm</span>(</span>
<span id="cb765-2"><a href="conditional-manatees.html#cb765-2" aria-hidden="true" tabindex="-1"></a>  <span class="at">data =</span> d6,</span>
<span id="cb765-3"><a href="conditional-manatees.html#cb765-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">family =</span> gaussian,</span>
<span id="cb765-4"><a href="conditional-manatees.html#cb765-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">formula =</span> <span class="fu">bf</span>(S <span class="sc">~</span> <span class="dv">0</span> <span class="sc">+</span> a<span class="sc">+</span>b<span class="sc">+</span>c<span class="sc">+</span>d<span class="sc">+</span>e<span class="sc">+</span>f ,</span>
<span id="cb765-5"><a href="conditional-manatees.html#cb765-5" aria-hidden="true" tabindex="-1"></a>               a <span class="sc">~</span> <span class="dv">0</span> <span class="sc">+</span> JA,</span>
<span id="cb765-6"><a href="conditional-manatees.html#cb765-6" aria-hidden="true" tabindex="-1"></a>               b <span class="sc">~</span> <span class="dv">0</span> <span class="sc">+</span> WA,</span>
<span id="cb765-7"><a href="conditional-manatees.html#cb765-7" aria-hidden="true" tabindex="-1"></a>               c <span class="sc">~</span> <span class="dv">0</span> <span class="sc">+</span> flight,</span>
<span id="cb765-8"><a href="conditional-manatees.html#cb765-8" aria-hidden="true" tabindex="-1"></a>               d <span class="sc">~</span> <span class="dv">0</span> <span class="sc">+</span> JA<span class="sc">:</span>WA,</span>
<span id="cb765-9"><a href="conditional-manatees.html#cb765-9" aria-hidden="true" tabindex="-1"></a>               e <span class="sc">~</span> <span class="dv">0</span> <span class="sc">+</span> WA<span class="sc">:</span>flight,</span>
<span id="cb765-10"><a href="conditional-manatees.html#cb765-10" aria-hidden="true" tabindex="-1"></a>               f <span class="sc">~</span> <span class="dv">0</span> <span class="sc">+</span> flight<span class="sc">:</span>JA,</span>
<span id="cb765-11"><a href="conditional-manatees.html#cb765-11" aria-hidden="true" tabindex="-1"></a>               <span class="at">nl =</span> <span class="cn">TRUE</span>),</span>
<span id="cb765-12"><a href="conditional-manatees.html#cb765-12" aria-hidden="true" tabindex="-1"></a>  <span class="at">prior =</span> <span class="fu">c</span>(<span class="fu">prior</span>(<span class="fu">normal</span>(<span class="dv">0</span>,<span class="dv">1</span>), <span class="at">nlpar =</span> <span class="st">&quot;a&quot;</span>),</span>
<span id="cb765-13"><a href="conditional-manatees.html#cb765-13" aria-hidden="true" tabindex="-1"></a>            <span class="fu">prior</span>(<span class="fu">normal</span>(<span class="dv">0</span>,<span class="dv">1</span>), <span class="at">nlpar =</span> <span class="st">&quot;b&quot;</span>),</span>
<span id="cb765-14"><a href="conditional-manatees.html#cb765-14" aria-hidden="true" tabindex="-1"></a>            <span class="fu">prior</span>(<span class="fu">normal</span>(<span class="dv">0</span>,<span class="dv">1</span>), <span class="at">nlpar =</span> <span class="st">&quot;c&quot;</span>),</span>
<span id="cb765-15"><a href="conditional-manatees.html#cb765-15" aria-hidden="true" tabindex="-1"></a>            <span class="fu">prior</span>(<span class="fu">normal</span>(<span class="dv">0</span>,<span class="dv">1</span>), <span class="at">nlpar =</span> <span class="st">&quot;d&quot;</span>),</span>
<span id="cb765-16"><a href="conditional-manatees.html#cb765-16" aria-hidden="true" tabindex="-1"></a>            <span class="fu">prior</span>(<span class="fu">normal</span>(<span class="dv">0</span>,<span class="dv">1</span>), <span class="at">nlpar =</span> <span class="st">&quot;e&quot;</span>),</span>
<span id="cb765-17"><a href="conditional-manatees.html#cb765-17" aria-hidden="true" tabindex="-1"></a>            <span class="fu">prior</span>(<span class="fu">normal</span>(<span class="dv">0</span>,<span class="dv">1</span>), <span class="at">nlpar =</span> <span class="st">&quot;f&quot;</span>),</span>
<span id="cb765-18"><a href="conditional-manatees.html#cb765-18" aria-hidden="true" tabindex="-1"></a>            <span class="fu">prior</span>(<span class="fu">exponential</span>(<span class="dv">1</span>), <span class="at">class =</span> sigma)),</span>
<span id="cb765-19"><a href="conditional-manatees.html#cb765-19" aria-hidden="true" tabindex="-1"></a>  <span class="at">backend =</span> <span class="st">&quot;cmdstanr&quot;</span>,</span>
<span id="cb765-20"><a href="conditional-manatees.html#cb765-20" aria-hidden="true" tabindex="-1"></a>  <span class="at">seed =</span> <span class="dv">8</span>, <span class="at">file =</span> <span class="st">&quot;output/Chapter8/b8H7&quot;</span></span>
<span id="cb765-21"><a href="conditional-manatees.html#cb765-21" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb765-22"><a href="conditional-manatees.html#cb765-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb765-23"><a href="conditional-manatees.html#cb765-23" aria-hidden="true" tabindex="-1"></a>b8H7 <span class="ot">&lt;-</span> <span class="fu">add_criterion</span>(b8H7, <span class="fu">c</span>(<span class="st">&quot;waic&quot;</span>,<span class="st">&quot;loo&quot;</span>))</span></code></pre></div>
<p><br /></p>
<p>あまり大きな違いはない。</p>
<div class="sourceCode" id="cb766"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb766-1"><a href="conditional-manatees.html#cb766-1" aria-hidden="true" tabindex="-1"></a><span class="fu">posterior_summary</span>(b8H7)<span class="sc">%&gt;%</span> </span>
<span id="cb766-2"><a href="conditional-manatees.html#cb766-2" aria-hidden="true" tabindex="-1"></a>   <span class="fu">data.frame</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb766-3"><a href="conditional-manatees.html#cb766-3" aria-hidden="true" tabindex="-1"></a>   <span class="fu">round</span>(<span class="dv">2</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb766-4"><a href="conditional-manatees.html#cb766-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">gt</span>()</span></code></pre></div>
<div id="ahkxgjvbsv" style="padding-left:0px;padding-right:0px;padding-top:10px;padding-bottom:10px;overflow-x:auto;overflow-y:auto;width:auto;height:auto;">
<style>html {
  font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, Cantarell, 'Helvetica Neue', 'Fira Sans', 'Droid Sans', Arial, sans-serif;
}

#ahkxgjvbsv .gt_table {
  display: table;
  border-collapse: collapse;
  margin-left: auto;
  margin-right: auto;
  color: #333333;
  font-size: 16px;
  font-weight: normal;
  font-style: normal;
  background-color: #FFFFFF;
  width: auto;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #A8A8A8;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #A8A8A8;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
}

#ahkxgjvbsv .gt_heading {
  background-color: #FFFFFF;
  text-align: center;
  border-bottom-color: #FFFFFF;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#ahkxgjvbsv .gt_caption {
  padding-top: 4px;
  padding-bottom: 4px;
}

#ahkxgjvbsv .gt_title {
  color: #333333;
  font-size: 125%;
  font-weight: initial;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-color: #FFFFFF;
  border-bottom-width: 0;
}

#ahkxgjvbsv .gt_subtitle {
  color: #333333;
  font-size: 85%;
  font-weight: initial;
  padding-top: 0;
  padding-bottom: 6px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-color: #FFFFFF;
  border-top-width: 0;
}

#ahkxgjvbsv .gt_bottom_border {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#ahkxgjvbsv .gt_col_headings {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#ahkxgjvbsv .gt_col_heading {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 6px;
  padding-left: 5px;
  padding-right: 5px;
  overflow-x: hidden;
}

#ahkxgjvbsv .gt_column_spanner_outer {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  padding-top: 0;
  padding-bottom: 0;
  padding-left: 4px;
  padding-right: 4px;
}

#ahkxgjvbsv .gt_column_spanner_outer:first-child {
  padding-left: 0;
}

#ahkxgjvbsv .gt_column_spanner_outer:last-child {
  padding-right: 0;
}

#ahkxgjvbsv .gt_column_spanner {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 5px;
  overflow-x: hidden;
  display: inline-block;
  width: 100%;
}

#ahkxgjvbsv .gt_group_heading {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  text-align: left;
}

#ahkxgjvbsv .gt_empty_group_heading {
  padding: 0.5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: middle;
}

#ahkxgjvbsv .gt_from_md > :first-child {
  margin-top: 0;
}

#ahkxgjvbsv .gt_from_md > :last-child {
  margin-bottom: 0;
}

#ahkxgjvbsv .gt_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  margin: 10px;
  border-top-style: solid;
  border-top-width: 1px;
  border-top-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  overflow-x: hidden;
}

#ahkxgjvbsv .gt_stub {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
}

#ahkxgjvbsv .gt_stub_row_group {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
  vertical-align: top;
}

#ahkxgjvbsv .gt_row_group_first td {
  border-top-width: 2px;
}

#ahkxgjvbsv .gt_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#ahkxgjvbsv .gt_first_summary_row {
  border-top-style: solid;
  border-top-color: #D3D3D3;
}

#ahkxgjvbsv .gt_first_summary_row.thick {
  border-top-width: 2px;
}

#ahkxgjvbsv .gt_last_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#ahkxgjvbsv .gt_grand_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#ahkxgjvbsv .gt_first_grand_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-style: double;
  border-top-width: 6px;
  border-top-color: #D3D3D3;
}

#ahkxgjvbsv .gt_striped {
  background-color: rgba(128, 128, 128, 0.05);
}

#ahkxgjvbsv .gt_table_body {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#ahkxgjvbsv .gt_footnotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#ahkxgjvbsv .gt_footnote {
  margin: 0px;
  font-size: 90%;
  padding-left: 4px;
  padding-right: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#ahkxgjvbsv .gt_sourcenotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#ahkxgjvbsv .gt_sourcenote {
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#ahkxgjvbsv .gt_left {
  text-align: left;
}

#ahkxgjvbsv .gt_center {
  text-align: center;
}

#ahkxgjvbsv .gt_right {
  text-align: right;
  font-variant-numeric: tabular-nums;
}

#ahkxgjvbsv .gt_font_normal {
  font-weight: normal;
}

#ahkxgjvbsv .gt_font_bold {
  font-weight: bold;
}

#ahkxgjvbsv .gt_font_italic {
  font-style: italic;
}

#ahkxgjvbsv .gt_super {
  font-size: 65%;
}

#ahkxgjvbsv .gt_footnote_marks {
  font-style: italic;
  font-weight: normal;
  font-size: 75%;
  vertical-align: 0.4em;
}

#ahkxgjvbsv .gt_asterisk {
  font-size: 100%;
  vertical-align: 0;
}

#ahkxgjvbsv .gt_indent_1 {
  text-indent: 5px;
}

#ahkxgjvbsv .gt_indent_2 {
  text-indent: 10px;
}

#ahkxgjvbsv .gt_indent_3 {
  text-indent: 15px;
}

#ahkxgjvbsv .gt_indent_4 {
  text-indent: 20px;
}

#ahkxgjvbsv .gt_indent_5 {
  text-indent: 25px;
}
</style>
<table class="gt_table">
  
  <thead class="gt_col_headings">
    <tr>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1" scope="col" id="Estimate">Estimate</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1" scope="col" id="Est.Error">Est.Error</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1" scope="col" id="Q2.5">Q2.5</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1" scope="col" id="Q97.5">Q97.5</th>
    </tr>
  </thead>
  <tbody class="gt_table_body">
    <tr><td headers="Estimate" class="gt_row gt_right">-0.05</td>
<td headers="Est.Error" class="gt_row gt_right">0.81</td>
<td headers="Q2.5" class="gt_row gt_right">-1.62</td>
<td headers="Q97.5" class="gt_row gt_right">1.55</td></tr>
    <tr><td headers="Estimate" class="gt_row gt_right">0.04</td>
<td headers="Est.Error" class="gt_row gt_right">0.79</td>
<td headers="Q2.5" class="gt_row gt_right">-1.53</td>
<td headers="Q97.5" class="gt_row gt_right">1.58</td></tr>
    <tr><td headers="Estimate" class="gt_row gt_right">0.04</td>
<td headers="Est.Error" class="gt_row gt_right">0.80</td>
<td headers="Q2.5" class="gt_row gt_right">-1.51</td>
<td headers="Q97.5" class="gt_row gt_right">1.59</td></tr>
    <tr><td headers="Estimate" class="gt_row gt_right">-0.02</td>
<td headers="Est.Error" class="gt_row gt_right">0.81</td>
<td headers="Q2.5" class="gt_row gt_right">-1.61</td>
<td headers="Q97.5" class="gt_row gt_right">1.59</td></tr>
    <tr><td headers="Estimate" class="gt_row gt_right">0.01</td>
<td headers="Est.Error" class="gt_row gt_right">0.83</td>
<td headers="Q2.5" class="gt_row gt_right">-1.62</td>
<td headers="Q97.5" class="gt_row gt_right">1.61</td></tr>
    <tr><td headers="Estimate" class="gt_row gt_right">0.01</td>
<td headers="Est.Error" class="gt_row gt_right">0.79</td>
<td headers="Q2.5" class="gt_row gt_right">-1.54</td>
<td headers="Q97.5" class="gt_row gt_right">1.58</td></tr>
    <tr><td headers="Estimate" class="gt_row gt_right">-0.03</td>
<td headers="Est.Error" class="gt_row gt_right">0.77</td>
<td headers="Q2.5" class="gt_row gt_right">-1.56</td>
<td headers="Q97.5" class="gt_row gt_right">1.48</td></tr>
    <tr><td headers="Estimate" class="gt_row gt_right">0.11</td>
<td headers="Est.Error" class="gt_row gt_right">0.77</td>
<td headers="Q2.5" class="gt_row gt_right">-1.39</td>
<td headers="Q97.5" class="gt_row gt_right">1.61</td></tr>
    <tr><td headers="Estimate" class="gt_row gt_right">-0.06</td>
<td headers="Est.Error" class="gt_row gt_right">0.77</td>
<td headers="Q2.5" class="gt_row gt_right">-1.59</td>
<td headers="Q97.5" class="gt_row gt_right">1.41</td></tr>
    <tr><td headers="Estimate" class="gt_row gt_right">-0.03</td>
<td headers="Est.Error" class="gt_row gt_right">0.79</td>
<td headers="Q2.5" class="gt_row gt_right">-1.57</td>
<td headers="Q97.5" class="gt_row gt_right">1.54</td></tr>
    <tr><td headers="Estimate" class="gt_row gt_right">0.17</td>
<td headers="Est.Error" class="gt_row gt_right">0.78</td>
<td headers="Q2.5" class="gt_row gt_right">-1.35</td>
<td headers="Q97.5" class="gt_row gt_right">1.75</td></tr>
    <tr><td headers="Estimate" class="gt_row gt_right">-0.15</td>
<td headers="Est.Error" class="gt_row gt_right">0.78</td>
<td headers="Q2.5" class="gt_row gt_right">-1.64</td>
<td headers="Q97.5" class="gt_row gt_right">1.39</td></tr>
    <tr><td headers="Estimate" class="gt_row gt_right">-0.13</td>
<td headers="Est.Error" class="gt_row gt_right">0.78</td>
<td headers="Q2.5" class="gt_row gt_right">-1.65</td>
<td headers="Q97.5" class="gt_row gt_right">1.40</td></tr>
    <tr><td headers="Estimate" class="gt_row gt_right">0.13</td>
<td headers="Est.Error" class="gt_row gt_right">0.79</td>
<td headers="Q2.5" class="gt_row gt_right">-1.40</td>
<td headers="Q97.5" class="gt_row gt_right">1.72</td></tr>
    <tr><td headers="Estimate" class="gt_row gt_right">-0.04</td>
<td headers="Est.Error" class="gt_row gt_right">0.79</td>
<td headers="Q2.5" class="gt_row gt_right">-1.52</td>
<td headers="Q97.5" class="gt_row gt_right">1.48</td></tr>
    <tr><td headers="Estimate" class="gt_row gt_right">-0.06</td>
<td headers="Est.Error" class="gt_row gt_right">0.76</td>
<td headers="Q2.5" class="gt_row gt_right">-1.56</td>
<td headers="Q97.5" class="gt_row gt_right">1.50</td></tr>
    <tr><td headers="Estimate" class="gt_row gt_right">0.06</td>
<td headers="Est.Error" class="gt_row gt_right">0.76</td>
<td headers="Q2.5" class="gt_row gt_right">-1.45</td>
<td headers="Q97.5" class="gt_row gt_right">1.53</td></tr>
    <tr><td headers="Estimate" class="gt_row gt_right">0.00</td>
<td headers="Est.Error" class="gt_row gt_right">0.78</td>
<td headers="Q2.5" class="gt_row gt_right">-1.55</td>
<td headers="Q97.5" class="gt_row gt_right">1.48</td></tr>
    <tr><td headers="Estimate" class="gt_row gt_right">1.00</td>
<td headers="Est.Error" class="gt_row gt_right">0.05</td>
<td headers="Q2.5" class="gt_row gt_right">0.90</td>
<td headers="Q97.5" class="gt_row gt_right">1.11</td></tr>
    <tr><td headers="Estimate" class="gt_row gt_right">-23.17</td>
<td headers="Est.Error" class="gt_row gt_right">2.32</td>
<td headers="Q2.5" class="gt_row gt_right">-28.65</td>
<td headers="Q97.5" class="gt_row gt_right">-19.52</td></tr>
    <tr><td headers="Estimate" class="gt_row gt_right">-277.90</td>
<td headers="Est.Error" class="gt_row gt_right">3.12</td>
<td headers="Q2.5" class="gt_row gt_right">-284.92</td>
<td headers="Q97.5" class="gt_row gt_right">-272.82</td></tr>
  </tbody>
  
  
</table>
</div>
<div class="sourceCode" id="cb767"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb767-1"><a href="conditional-manatees.html#cb767-1" aria-hidden="true" tabindex="-1"></a><span class="fu">conditional_effects</span>(b8H7) <span class="sc">%&gt;%</span> </span>
<span id="cb767-2"><a href="conditional-manatees.html#cb767-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">plot</span>()</span></code></pre></div>
<p><img src="Rethinking_Bookdown_files/figure-html/unnamed-chunk-366-1.png" width="672" style="display: block; margin: auto;" /><img src="Rethinking_Bookdown_files/figure-html/unnamed-chunk-366-2.png" width="672" style="display: block; margin: auto;" /><img src="Rethinking_Bookdown_files/figure-html/unnamed-chunk-366-3.png" width="672" style="display: block; margin: auto;" /><img src="Rethinking_Bookdown_files/figure-html/unnamed-chunk-366-4.png" width="672" style="display: block; margin: auto;" /><img src="Rethinking_Bookdown_files/figure-html/unnamed-chunk-366-5.png" width="672" style="display: block; margin: auto;" /><img src="Rethinking_Bookdown_files/figure-html/unnamed-chunk-366-6.png" width="672" style="display: block; margin: auto;" />
<br /></p>
<p>交互作用があるモデルとないモデルに違いはあまりない。<br />
むしろ、交互作用がないモデルの方がPSISは低く、model weightも低い。</p>
<div class="sourceCode" id="cb768"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb768-1"><a href="conditional-manatees.html#cb768-1" aria-hidden="true" tabindex="-1"></a><span class="fu">loo_compare</span>(b8H7, b8H6) <span class="sc">%&gt;%</span> </span>
<span id="cb768-2"><a href="conditional-manatees.html#cb768-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">print</span>(<span class="at">simplify =</span> F)</span></code></pre></div>
<pre><code>##      elpd_diff se_diff elpd_loo se_elpd_loo p_loo  se_p_loo looic  se_looic
## b8H6    0.0       0.0  -257.7      8.6         4.8    0.5    515.4   17.2  
## b8H7   -1.0       2.0  -258.7      8.6         7.5    0.7    517.3   17.3</code></pre>
<div class="sourceCode" id="cb770"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb770-1"><a href="conditional-manatees.html#cb770-1" aria-hidden="true" tabindex="-1"></a><span class="fu">model_weights</span>(b8H6, b8H7) <span class="sc">%&gt;%</span> </span>
<span id="cb770-2"><a href="conditional-manatees.html#cb770-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">round</span>(<span class="dv">2</span>)</span></code></pre></div>
<pre><code>## b8H6 b8H7 
## 0.73 0.27</code></pre>

</div>
</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="ulysses-compass.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="marcov-chain-monte-carlo.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"whatsapp": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": null,
"text": null
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": null,
"search": {
"engine": "fuse",
"options": null
},
"toc": {
"collapse": "subsection"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.9/latest.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
